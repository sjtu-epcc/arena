
[I] Loading Crius kernel-level profiler...
[TMP] Profiling results not found in `None`, creating it...

[I] Loading model and generating sharded HLO module...
[I] Initializing XLA devices takes 0.41105175018310547 s.
[I] Loading flax model....
[I] Model 'wide_resnet' loads sucessfully. Model Info: 

WideResNet(
    # attributes
    stage_sizes = [3, 4, 6, 3]
    block_cls = BottleneckResNetBlock
    num_classes = 1024
    num_filters = 640
    width_factor = 2
    dtype = float32
    act = relu
) 

[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing general train step func...
[I] General train step func construction is completed.
[I] Model has been loaded, begin Jaxpr transformation...


Layer 0:
Eqn 2 in layer 0: Primitive: conv_general_dilated | FLOPs (GB): 34.63462829589844 | Memory access (GB): 0.4878382682800293 | Attainable performance: 37400 | Computation load: 0.0009260595801042363
Eqn 27 in layer 0: Primitive: custom_jvp_call | FLOPs (GB): 0.11962890625 | Memory access (GB): 1.9140625 | Attainable performance: 43.5 | Computation load: 0.0027500897988505745
Eqn 29 in layer 0: Primitive: conv_general_dilated | FLOPs (GB): 38.28125 | Memory access (GB): 0.24078369140625 | Attainable performance: 37400 | Computation load: 0.001023562834224599
Eqn 54 in layer 0: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 55 in layer 0: Primitive: conv_general_dilated | FLOPs (GB): 672.75390625 | Memory access (GB): 0.3863525390625 | Attainable performance: 37400 | Computation load: 0.017988072359625667
Eqn 80 in layer 0: Primitive: custom_jvp_call | FLOPs (GB): 0.059814453125 | Memory access (GB): 0.95703125 | Attainable performance: 43.5 | Computation load: 0.0013750448994252872
Eqn 89 in layer 0: Primitive: remat2 | FLOPs (GB): 2202.5242614746094 | Memory access (GB): 5.249663352966309 | Attainable performance: 37400 | Computation load: 0.05889102303408046
Layer computation load: 0.08364137495602347

Layer 1:
Eqn 1 in layer 1: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.72998046875 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 26 in layer 1: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.604248046875 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 52 in layer 1: Primitive: custom_jvp_call | FLOPs (GB): 0.11962890625 | Memory access (GB): 1.9140625 | Attainable performance: 43.5 | Computation load: 0.0027500897988505745
Eqn 53 in layer 1: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.604248046875 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 78 in layer 1: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 79 in layer 1: Primitive: conv_general_dilated | FLOPs (GB): 672.75390625 | Memory access (GB): 0.3863525390625 | Attainable performance: 37400 | Computation load: 0.017988072359625667
Eqn 104 in layer 1: Primitive: custom_jvp_call | FLOPs (GB): 0.059814453125 | Memory access (GB): 0.95703125 | Attainable performance: 43.5 | Computation load: 0.0013750448994252872
Eqn 105 in layer 1: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.72998046875 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 143 in layer 1: Primitive: remat2 | FLOPs (GB): 4774.7210693359375 | Memory access (GB): 12.5140380859375 | Attainable performance: 37400 | Computation load: 0.1276663387522978
Layer computation load: 0.17503257628130234

Layer 2:
Eqn 1 in layer 2: Primitive: custom_jvp_call | FLOPs (GB): 0.11962890625 | Memory access (GB): 1.9140625 | Attainable performance: 43.5 | Computation load: 0.0027500897988505745
Eqn 2 in layer 2: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.604248046875 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 27 in layer 2: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 28 in layer 2: Primitive: conv_general_dilated | FLOPs (GB): 672.75390625 | Memory access (GB): 0.3863525390625 | Attainable performance: 37400 | Computation load: 0.017988072359625667
Eqn 53 in layer 2: Primitive: custom_jvp_call | FLOPs (GB): 0.059814453125 | Memory access (GB): 0.95703125 | Attainable performance: 43.5 | Computation load: 0.0013750448994252872
Eqn 54 in layer 2: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.72998046875 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 80 in layer 2: Primitive: custom_jvp_call | FLOPs (GB): 0.11962890625 | Memory access (GB): 1.9140625 | Attainable performance: 43.5 | Computation load: 0.0027500897988505745
Eqn 89 in layer 2: Primitive: remat2 | FLOPs (GB): 3396.5960693359375 | Memory access (GB): 8.5113525390625 | Attainable performance: 37400 | Computation load: 0.09081807672021223
Layer computation load: 0.12865165003737217

Layer 3:
Eqn 1 in layer 3: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.72998046875 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 26 in layer 3: Primitive: custom_jvp_call | FLOPs (GB): 0.059814453125 | Memory access (GB): 0.95703125 | Attainable performance: 43.5 | Computation load: 0.0013750448994252872
Eqn 27 in layer 3: Primitive: conv_general_dilated | FLOPs (GB): 672.75390625 | Memory access (GB): 0.46875 | Attainable performance: 37400 | Computation load: 0.017988072359625667
Eqn 52 in layer 3: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 53 in layer 3: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.40771484375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 78 in layer 3: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.7666015625 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 114 in layer 3: Primitive: remat2 | FLOPs (GB): 4774.6014404296875 | Memory access (GB): 8.5546875 | Attainable performance: 37400 | Computation load: 0.12766314011844085
Layer computation load: 0.1722792878485948

Layer 4:
Eqn 1 in layer 4: Primitive: custom_jvp_call | FLOPs (GB): 0.059814453125 | Memory access (GB): 0.95703125 | Attainable performance: 43.5 | Computation load: 0.0013750448994252872
Eqn 2 in layer 4: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.323486328125 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 27 in layer 4: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 28 in layer 4: Primitive: conv_general_dilated | FLOPs (GB): 656.640625 | Memory access (GB): 0.289306640625 | Attainable performance: 37400 | Computation load: 0.017557235962566847
Eqn 53 in layer 4: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 54 in layer 4: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.40771484375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 88 in layer 4: Primitive: remat2 | FLOPs (GB): 3348.1515502929688 | Memory access (GB): 4.736328125 | Attainable performance: 37400 | Computation load: 0.08952276872441092
Layer computation load: 0.12176908727166721

Layer 5:
Eqn 1 in layer 5: Primitive: custom_jvp_call | FLOPs (GB): 0.059814453125 | Memory access (GB): 0.95703125 | Attainable performance: 43.5 | Computation load: 0.0013750448994252872
Eqn 2 in layer 5: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.323486328125 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 27 in layer 5: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 28 in layer 5: Primitive: conv_general_dilated | FLOPs (GB): 656.640625 | Memory access (GB): 0.289306640625 | Attainable performance: 37400 | Computation load: 0.017557235962566847
Eqn 53 in layer 5: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 54 in layer 5: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.40771484375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 80 in layer 5: Primitive: custom_jvp_call | FLOPs (GB): 0.059814453125 | Memory access (GB): 0.95703125 | Attainable performance: 43.5 | Computation load: 0.0013750448994252872
Eqn 89 in layer 5: Primitive: remat2 | FLOPs (GB): 3348.1515502929688 | Memory access (GB): 4.736328125 | Attainable performance: 37400 | Computation load: 0.08952276872441092
Layer computation load: 0.12314413217109249

Layer 6:
Eqn 1 in layer 6: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.323486328125 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 26 in layer 6: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 27 in layer 6: Primitive: conv_general_dilated | FLOPs (GB): 656.640625 | Memory access (GB): 0.289306640625 | Attainable performance: 37400 | Computation load: 0.017557235962566847
Eqn 52 in layer 6: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 53 in layer 6: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.40771484375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 79 in layer 6: Primitive: custom_jvp_call | FLOPs (GB): 0.059814453125 | Memory access (GB): 0.95703125 | Attainable performance: 43.5 | Computation load: 0.0013750448994252872
Eqn 88 in layer 6: Primitive: remat2 | FLOPs (GB): 3348.0917358398438 | Memory access (GB): 3.779296875 | Attainable performance: 37400 | Computation load: 0.08952116940748245
Layer computation load: 0.12176748795473874

Layer 7:
Eqn 1 in layer 7: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.40771484375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 26 in layer 7: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 27 in layer 7: Primitive: conv_general_dilated | FLOPs (GB): 656.640625 | Memory access (GB): 0.618896484375 | Attainable performance: 37400 | Computation load: 0.017557235962566847
Eqn 52 in layer 7: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 53 in layer 7: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.374755859375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 78 in layer 7: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.55419921875 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 114 in layer 7: Primitive: remat2 | FLOPs (GB): 4726.216735839844 | Memory access (GB): 6.58447265625 | Attainable performance: 37400 | Computation load: 0.12636943143956803
Layer computation load: 0.16952345909809421

Layer 8:
Eqn 1 in layer 8: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 2 in layer 8: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.2471923828125 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 27 in layer 8: Primitive: custom_jvp_call | FLOPs (GB): 0.007476806640625 | Memory access (GB): 0.1196289137005806 | Attainable performance: 43.4999972907866 | Computation load: 0.0001718806231330181
Eqn 28 in layer 8: Primitive: conv_general_dilated | FLOPs (GB): 625.0 | Memory access (GB): 0.5291748046875 | Attainable performance: 37400 | Computation load: 0.016711229946524065
Eqn 53 in layer 8: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 54 in layer 8: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.374755859375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 88 in layer 8: Primitive: remat2 | FLOPs (GB): 3253.1773376464844 | Memory access (GB): 4.290771491825581 | Attainable performance: 37400 | Computation load: 0.08698335127397017
Layer computation load: 0.1171804995288914

Layer 9:
Eqn 1 in layer 9: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 2 in layer 9: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.2471923828125 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 27 in layer 9: Primitive: custom_jvp_call | FLOPs (GB): 0.007476806640625 | Memory access (GB): 0.1196289137005806 | Attainable performance: 43.4999972907866 | Computation load: 0.0001718806231330181
Eqn 28 in layer 9: Primitive: conv_general_dilated | FLOPs (GB): 625.0 | Memory access (GB): 0.5291748046875 | Attainable performance: 37400 | Computation load: 0.016711229946524065
Eqn 53 in layer 9: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 54 in layer 9: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.374755859375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 80 in layer 9: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 89 in layer 9: Primitive: remat2 | FLOPs (GB): 3253.1773376464844 | Memory access (GB): 4.290771491825581 | Attainable performance: 37400 | Computation load: 0.08698335127397017
Layer computation load: 0.11786802197860405

Layer 10:
Eqn 1 in layer 10: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.2471923828125 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 26 in layer 10: Primitive: custom_jvp_call | FLOPs (GB): 0.007476806640625 | Memory access (GB): 0.1196289137005806 | Attainable performance: 43.4999972907866 | Computation load: 0.0001718806231330181
Eqn 27 in layer 10: Primitive: conv_general_dilated | FLOPs (GB): 625.0 | Memory access (GB): 0.5291748046875 | Attainable performance: 37400 | Computation load: 0.016711229946524065
Eqn 52 in layer 10: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 53 in layer 10: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.374755859375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 79 in layer 10: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 88 in layer 10: Primitive: remat2 | FLOPs (GB): 3253.147430419922 | Memory access (GB): 3.8122558668255806 | Attainable performance: 37400 | Computation load: 0.08698255161550593
Layer computation load: 0.11717969987042717

Layer 11:
Eqn 1 in layer 11: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.2471923828125 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 26 in layer 11: Primitive: custom_jvp_call | FLOPs (GB): 0.007476806640625 | Memory access (GB): 0.1196289137005806 | Attainable performance: 43.4999972907866 | Computation load: 0.0001718806231330181
Eqn 27 in layer 11: Primitive: conv_general_dilated | FLOPs (GB): 625.0 | Memory access (GB): 0.5291748046875 | Attainable performance: 37400 | Computation load: 0.016711229946524065
Eqn 52 in layer 11: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 53 in layer 11: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.374755859375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 79 in layer 11: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 88 in layer 11: Primitive: remat2 | FLOPs (GB): 3253.147430419922 | Memory access (GB): 3.8122558668255806 | Attainable performance: 37400 | Computation load: 0.08698255161550593
Layer computation load: 0.11717969987042717

Layer 12:
Eqn 1 in layer 12: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.2471923828125 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 26 in layer 12: Primitive: custom_jvp_call | FLOPs (GB): 0.007476806640625 | Memory access (GB): 0.1196289137005806 | Attainable performance: 43.4999972907866 | Computation load: 0.0001718806231330181
Eqn 27 in layer 12: Primitive: conv_general_dilated | FLOPs (GB): 625.0 | Memory access (GB): 0.5291748046875 | Attainable performance: 37400 | Computation load: 0.016711229946524065
Eqn 52 in layer 12: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 53 in layer 12: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.374755859375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 79 in layer 12: Primitive: custom_jvp_call | FLOPs (GB): 0.0299072265625 | Memory access (GB): 0.478515625 | Attainable performance: 43.5 | Computation load: 0.0006875224497126436
Eqn 88 in layer 12: Primitive: remat2 | FLOPs (GB): 3253.147430419922 | Memory access (GB): 3.8122558668255806 | Attainable performance: 37400 | Computation load: 0.08698255161550593
Layer computation load: 0.11717969987042717

Layer 13:
Eqn 1 in layer 13: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.374755859375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 26 in layer 13: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 27 in layer 13: Primitive: conv_general_dilated | FLOPs (GB): 625.0 | Memory access (GB): 1.8475341796875 | Attainable performance: 37400 | Computation load: 0.016711229946524065
Eqn 52 in layer 13: Primitive: custom_jvp_call | FLOPs (GB): 0.007476806640625 | Memory access (GB): 0.1196289137005806 | Attainable performance: 43.4999972907866 | Computation load: 0.0001718806231330181
Eqn 53 in layer 13: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.8709716796875 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 78 in layer 13: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.960693359375 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 114 in layer 13: Primitive: remat2 | FLOPs (GB): 4631.272430419922 | Memory access (GB): 12.52075196057558 | Attainable performance: 37400 | Computation load: 0.12383081364759149
Layer computation load: 0.16562319346349527

Layer 14:
Eqn 1 in layer 14: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 2 in layer 14: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.46539306640625 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 27 in layer 14: Primitive: custom_jvp_call | FLOPs (GB): 0.0037384033203125 | Memory access (GB): 0.059814464300870895 | Attainable performance: 0 | Computation load: 8.594032227136623e-05
Eqn 28 in layer 14: Primitive: conv_general_dilated | FLOPs (GB): 564.0625 | Memory access (GB): 1.80267333984375 | Attainable performance: 37400 | Computation load: 0.015081885026737967
Eqn 53 in layer 14: Primitive: custom_jvp_call | FLOPs (GB): 0.007476806640625 | Memory access (GB): 0.1196289137005806 | Attainable performance: 43.4999972907866 | Computation load: 0.0001718806231330181
Eqn 54 in layer 14: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.8709716796875 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 80 in layer 14: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 89 in layer 14: Primitive: remat2 | FLOPs (GB): 3070.338668823242 | Memory access (GB): 9.835815448313951 | Attainable performance: 37400 | Computation load: 0.08209461681345567
Layer computation load: 0.11040459924600586

Layer 15:
Eqn 1 in layer 15: Primitive: conv_general_dilated | FLOPs (GB): 153.125 | Memory access (GB): 0.46539306640625 | Attainable performance: 37400 | Computation load: 0.004094251336898396
Eqn 26 in layer 15: Primitive: custom_jvp_call | FLOPs (GB): 0.0037384033203125 | Memory access (GB): 0.059814464300870895 | Attainable performance: 0 | Computation load: 8.594032227136623e-05
Eqn 27 in layer 15: Primitive: conv_general_dilated | FLOPs (GB): 564.0625 | Memory access (GB): 1.80267333984375 | Attainable performance: 37400 | Computation load: 0.015081885026737967
Eqn 52 in layer 15: Primitive: custom_jvp_call | FLOPs (GB): 0.007476806640625 | Memory access (GB): 0.1196289137005806 | Attainable performance: 43.4999972907866 | Computation load: 0.0001718806231330181
Eqn 53 in layer 15: Primitive: conv_general_dilated | FLOPs (GB): 306.25 | Memory access (GB): 0.8709716796875 | Attainable performance: 37400 | Computation load: 0.008188502673796791
Eqn 79 in layer 15: Primitive: custom_jvp_call | FLOPs (GB): 0.01495361328125 | Memory access (GB): 0.2392578125 | Attainable performance: 43.5 | Computation load: 0.0003437612248563218
Eqn 82 in layer 15: Primitive: dot_general | FLOPs (GB): 0.625 | Memory access (GB): 0.0794067457318306 | Attainable performance: 5478.124005598533 | Computation load: 0.0001140901519135497
Eqn 148 in layer 15: Primitive: remat2 | FLOPs (GB): 3072.213668823242 | Memory access (GB): 10.074035685509443 | Attainable performance: 37400 | Computation load: 0.08214475050329524
Layer computation load: 0.11022506186290265
Layer memory access: [3.972059726715088, 12.21923828125, 6.88232421875, 9.4921875, 4.08203125, 4.08203125, 4.08203125, 7.822265625, 4.6044921875, 4.6044921875, 4.6044921875, 4.6044921875, 4.6044921875, 16.2158203125, 12.55615234375, 12.873779326677322]
[TMP] Optimization status of GPU fraction: optimal

Layer GPU fractions:
[0.139, 0.435, 0.426, 0.713, 0.605, 0.714, 0.807, 1.263, 0.97, 1.074, 1.164, 1.261, 1.358, 2.057, 1.463, 1.552]

Layer GPU fractions:
[0.139, 0.435, 0.426, 0.713, 0.605, 0.714, 0.807, 1.263, 0.97, 1.074, 1.164, 1.261, 1.358, 2.057, 1.463, 1.552]

[[0, 1, 2, 3], [4, 5, 6], [7, 8], [9, 10], [11, 12], [13], [14], [15]]
919229408.0
1.041470594880143
([2, 2, 2, 2, 2, 2, 2, 2], 1.041470594880143)

[[0, 1, 2, 3, 4], [5, 6], [7, 8], [9, 10], [11, 12], [13], [14], [15]]
919229408.0
1.1475979261047833
([2, 2, 2, 2, 2, 2, 2, 2], 1.1475979261047833)

[I] Pipeline partition mode: auto | Layer-to-stage partition: [[0, 1, 2, 3, 4], [5, 6], [7, 8], [9, 10], [11, 12], [13], [14], [15]]
[I] Pipeline partition mode: auto | Cell-generated physical mesh shapes: [(1, 2), (1, 2), (1, 2), (1, 2), (1, 2), (1, 2), (1, 2), (1, 2)]
[I] Loading model and transform to Jaxpr stages takes 57.01093244552612 s.
[I] The GPU sharding of pipeline stages is: [2, 2, 2, 2, 2, 2, 2, 2]
[TMP] Plans in the non-dominated set:
0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__1_2__1_2
[[0, 1, 2, 3], [4, 5, 6], [7, 8], [9, 10], [11, 12], [13], [14], [15]]
[StageShape(type='single', stage_shape=(1, 2), layer_shape=None), StageShape(type='single', stage_shape=(1, 2), layer_shape=None), StageShape(type='single', stage_shape=(1, 2), layer_shape=None), StageShape(type='single', stage_shape=(1, 2), layer_shape=None), StageShape(type='single', stage_shape=(1, 2), layer_shape=None), StageShape(type='single', stage_shape=(1, 2), layer_shape=None), StageShape(type='single', stage_shape=(1, 2), layer_shape=None), StageShape(type='single', stage_shape=(1, 2), layer_shape=None)]
1.041470594880143
34681651200.0

0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__2_1
[[0, 1, 2, 3], [4, 5, 6], [7, 8], [9, 10], [11, 12], [13], [14], [15]]
[StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None)]
1.041470594880143
26250439200.0

0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__2_1
[[0, 1, 2, 3, 4], [5, 6], [7, 8], [9, 10], [11, 12], [13], [14], [15]]
[StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None)]
1.1475979261047833
26250439200.0

[TMP] Existed tuning database in `/home/cyxue/Projects/crius/Crius/runtime/jaxpr/tuning_database/tuning_database.pkl`, updating/rewriting it...
{'plan_set': {'wide_resnet__1B::256__16::1::a40__2__2': ['0_15::4_1'], 'wide_resnet__1B::256__16::2::a40__2__2': ['0_9__10_15::1_2__1_2', '0_9__10_15::2_1__2_1', '0_8__9_15::2_1__2_1', '0_10__11_15::2_1__2_1', '0_7__8_15::2_1__2_1', '0_11__12_15::2_1__2_1'], 'wide_resnet__1B::256__16::3::a40__2__2': ['0_5__6_9__10_15::2_1__1_1__1_1', '0_6__7_9__10_15::2_1__1_1__1_1', '0_5__6_10__11_15::2_1__1_1__1_1', '0_6__7_10__11_15::2_1__1_1__1_1', '0_3__4_11__12_15::1_1__1_2__1_1', '0_3__4_11__12_15::1_1__2_1__1_1', '0_5__6_11__12_15::2_1__1_1__1_1', '0_6__7_11__12_15::2_1__1_1__1_1', '0_7__8_11__12_15::2_1__1_1__1_1', '0_7__8_12__13_15::2_1__1_1__1_1'], 'wide_resnet__1B::256__16::4::a40__2__2': ['0_4__5_8__9_10__11_15::1_1__1_1__1_1__1_1', '0_3__4_7__8_11__12_15::1_1__1_1__1_1__1_1', '0_4__5_7__8_11__12_15::1_1__1_1__1_1__1_1', '0_4__5_8__9_11__12_15::1_1__1_1__1_1__1_1', '0_5__6_8__9_11__12_15::1_1__1_1__1_1__1_1', '0_3__4_7__8_12__13_15::1_1__1_1__1_1__1_1', '0_3__4_8__9_12__13_15::1_1__1_1__1_1__1_1', '0_4__5_8__9_12__13_15::1_1__1_1__1_1__1_1', '0_5__6_8__9_12__13_15::1_1__1_1__1_1__1_1', '0_4__5_9__10_12__13_15::1_1__1_1__1_1__1_1', '0_5__6_9__10_12__13_15::1_1__1_1__1_1__1_1', '0_3__4_8__9_13__14_15::1_1__1_1__1_1__1_1', '0_4__5_8__9_13__14_15::1_1__1_1__1_1__1_1', '0_5__6_8__9_13__14_15::1_1__1_1__1_1__1_1', '0_4__5_9__10_13__14_15::1_1__1_1__1_1__1_1', '0_5__6_9__10_13__14_15::1_1__1_1__1_1__1_1', '0_4__5_10__11_13__14_15::1_1__1_1__1_1__1_1', '0_5__6_10__11_13__14_15::1_1__1_1__1_1__1_1', '0_7__8_10__11_13__14_15::1_1__1_1__1_1__1_1', '0_4__5_8__9_14__15_15::1_1__1_1__1_1__1_1', '0_5__6_8__9_14__15_15::1_1__1_1__1_1__1_1', '0_4__5_9__10_14__15_15::1_1__1_1__1_1__1_1', '0_5__6_9__10_14__15_15::1_1__1_1__1_1__1_1', '0_4__5_10__11_14__15_15::1_1__1_1__1_1__1_1', '0_5__6_10__11_14__15_15::1_1__1_1__1_1__1_1', '0_6__7_10__11_14__15_15::1_1__1_1__1_1__1_1', '0_4__5_11__12_14__15_15::1_1__1_1__1_1__1_1', '0_5__6_11__12_14__15_15::1_1__1_1__1_1__1_1', '0_8__9_11__12_14__15_15::1_1__1_1__1_1__1_1', '0_7__8_12__13_14__15_15::1_1__1_1__1_1__1_1', '0_10__11_13__14_14__15_15::1_1__1_1__1_1__1_1', '0_12__13_13__14_14__15_15::1_1__1_1__1_1__1_1'], 'wide_resnet__500M::256__16::2::a40__2__2': ['0_7__8_15::2_1__2_1', '0_8__9_15::2_1__2_1'], 'wide_resnet__500M::512__16::2::a40__2__2': ['0_7__8_15::2_1__2_1', '0_8__9_15::2_1__2_1'], 'wide_resnet__2B::512__16::4::a40__4__2': ['0_5__6_9__10_12__13_15::1_2__1_2__1_2__1_2', '0_5__6_9__10_12__13_15::2_1__2_1__2_1__2_1', '0_4__5_8__9_12__13_15::2_1__2_1__2_1__2_1', '0_5__6_8__9_12__13_15::2_1__2_1__2_1__2_1', '0_4__5_9__10_12__13_15::2_1__2_1__2_1__2_1', '0_6__7_9__10_12__13_15::2_1__2_1__2_1__2_1', '0_3__4_8__9_12__13_15::2_1__2_1__2_1__2_1', '0_6__7_10__11_13__14_15::2_1__2_1__2_1__2_1', '0_5__6_10__11_13__14_15::2_1__2_1__2_1__2_1', '0_4__5_8__9_11__12_15::2_1__2_1__2_1__2_1', '0_5__6_9__10_13__14_15::2_1__2_1__2_1__2_1', '0_4__5_7__8_12__13_15::2_1__2_1__2_1__2_1', '0_5__6_8__9_11__12_15::2_1__2_1__2_1__2_1', '0_6__7_10__11_12__13_15::2_1__2_1__2_1__2_1', '0_4__5_7__8_11__12_15::2_1__2_1__2_1__2_1', '0_3__4_7__8_12__13_15::2_1__2_1__2_1__2_1', '0_5__6_10__11_12__13_15::2_1__2_1__2_1__2_1', '0_6__7_8__9_12__13_15::2_1__2_1__2_1__2_1', '0_3__4_7__8_11__12_15::2_1__2_1__2_1__2_1', '0_4__5_9__10_13__14_15::2_1__2_1__2_1__2_1', '0_3__4_9__10_12__13_15::2_1__2_1__2_1__2_1', '0_6__7_9__10_13__14_15::2_1__2_1__2_1__2_1', '0_3__4_8__9_11__12_15::2_1__2_1__2_1__2_1', '0_5__6_7__8_12__13_15::2_1__2_1__2_1__2_1', '0_5__6_9__10_11__12_15::2_1__2_1__2_1__2_1', '0_5__6_7__8_11__12_15::2_1__2_1__2_1__2_1', '0_6__7_11__12_13__14_15::2_1__2_1__2_1__2_1', '0_4__5_9__10_11__12_15::2_1__2_1__2_1__2_1', '0_6__7_8__9_11__12_15::2_1__2_1__2_1__2_1', '0_6__7_9__10_11__12_15::2_1__2_1__2_1__2_1', '0_2__3_7__8_12__13_15::2_1__2_1__2_1__2_1', '0_2__3_8__9_12__13_15::2_1__2_1__2_1__2_1'], 'wide_resnet__2B::256__16::4::a40__4__2': ['0_6__7_10__11_13__14_15::1_2__1_2__1_2__1_2', '0_6__7_10__11_13__14_15::2_1__2_1__2_1__2_1', '0_6__7_9__10_12__13_15::2_1__2_1__2_1__2_1', '0_5__6_9__10_12__13_15::2_1__2_1__2_1__2_1', '0_7__8_11__12_13__14_15::2_1__2_1__2_1__2_1', '0_7__8_10__11_13__14_15::2_1__2_1__2_1__2_1', '0_5__6_8__9_12__13_15::2_1__2_1__2_1__2_1', '0_5__6_10__11_13__14_15::2_1__2_1__2_1__2_1', '0_6__7_11__12_13__14_15::2_1__2_1__2_1__2_1', '0_6__7_9__10_13__14_15::2_1__2_1__2_1__2_1', '0_5__6_9__10_13__14_15::2_1__2_1__2_1__2_1', '0_8__9_11__12_13__14_15::2_1__2_1__2_1__2_1'], 'wide_resnet__4B::256__16::8::a40__8__2': ['0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__1_2__1_2', '0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__2_1', '0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__2_1']}, 'selected_cell_num_stages': {'wide_resnet__1B::256__16::a40__2__2': 2}}
[TMP] Storing tuning database to '/home/cyxue/Projects/crius/Crius/runtime/jaxpr/tuning_database/tuning_database.pkl'...
[I] Pipeline partition mode: auto | Parallel enum mode: auto | Parallel plans: [[StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None)]]

[I] (Parallel plan idx: 0) Sharding stages...
[I] Sharding stages takes 6.44064736366272 s.
[I] (Parallel plan idx: 0) SPMD partitioning and compiling (kernel fusing) HLO stages...
[I] SPMD partitioning and pre-compiling HLO modules concurrently takes 5.043433666229248 s.

[I] All parallel plans in the cell have been sharded and compiled.
[TMP] Writing only-sharded HLO text to '/home/cyxue/Projects/crius/Crius/runtime/jaxpr/tmp/wide_resnet_4B_256_sharded_stages.pkl'...
[TMP] Writing optimized HLO text to '/home/cyxue/Projects/crius/Crius/runtime/jaxpr/tmp/wide_resnet_4B_256_optimized_stages.pkl'...
[TMP] Writing inter-stages communicated vars to '/home/cyxue/Projects/crius/Crius/runtime/jaxpr/tmp/wide_resnet_4B_256_inter_stages_comm_vars.pkl'

[I] Parallel plan idx: 0 | Parallelism: [(2, 1), (2, 1), (2, 1), (2, 1), (2, 1), (2, 1), (2, 1), (2, 1)]

[I] (Parallel plan idx: 0) Parsing HLO texts and profiling XLA operators...
[I] Pipeline partition mode: auto | Preset physical mesh shapes: [(1, 2), (1, 2), (1, 2), (1, 2), (1, 2), (1, 2), (1, 2), (1, 2)]
[TMP] Loading offline profiled communication data: `1_a40_1_n_2_d_ib.pkl`...
[TMP] Loading offline profiled communication data: `2_a40_2_n_1_d_ib.pkl`...
\Time of module 0 (stage 0):
Intra-stage comm time: 0.0017522424459457397
Grad sync time: 0

[I] Optimized module 0 for stage 0, comm time has been statically analyzed.
\Time of module 1 (stage 1):
Intra-stage comm time: 0.0006656631827354431
Grad sync time: 0

[I] Optimized module 1 for stage 1, comm time has been statically analyzed.
\Time of module 2 (stage 2):
Intra-stage comm time: 0.0007106937468051911
Grad sync time: 0

[I] Optimized module 2 for stage 2, comm time has been statically analyzed.
\Time of module 3 (stage 3):
Intra-stage comm time: 0.0007000371813774108
Grad sync time: 0

[I] Optimized module 3 for stage 3, comm time has been statically analyzed.
\Time of module 4 (stage 4):
Intra-stage comm time: 0.0007000371813774108
Grad sync time: 0

[I] Optimized module 4 for stage 4, comm time has been statically analyzed.
\Time of module 5 (stage 5):
Intra-stage comm time: 0.0003981959074735641
Grad sync time: 0

[I] Optimized module 5 for stage 5, comm time has been statically analyzed.
\Time of module 6 (stage 6):
Intra-stage comm time: 0.0003773041069507599
Grad sync time: 0

[I] Optimized module 6 for stage 6, comm time has been statically analyzed.
\Time of module 7 (stage 7):
Intra-stage comm time: 0.0004846580326557159
Grad sync time: 0

[I] Optimized module 7 for stage 7, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 807476224 | Estimated comm time: 0.3308899641232816
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 8 (stage 7):
Intra-stage comm time: 0.0007273226976394764
Grad sync time: 0.3308899641232816

[I] Optimized module 8 for stage 7, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 786503680 | Estimated comm time: 0.29236598147768533
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 9 (stage 6):
Intra-stage comm time: 0.0007273226976394764
Grad sync time: 0.29236598147768533

[I] Optimized module 9 for stage 6, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 943790080 | Estimated comm time: 0.3865896370685208
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 10 (stage 5):
Intra-stage comm time: 0.0007787130773067585
Grad sync time: 0.3865896370685208

[I] Optimized module 10 for stage 5, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 393287680 | Estimated comm time: 0.1331228062019218
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 11 (stage 4):
Intra-stage comm time: 0.0013657003641128485
Grad sync time: 0.1331228062019218

[I] Optimized module 11 for stage 4, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 393287680 | Estimated comm time: 0.1331228062019218
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 12 (stage 3):
Intra-stage comm time: 0.0013657003641128485
Grad sync time: 0.1331228062019218

[I] Optimized module 12 for stage 3, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 432609280 | Estimated comm time: 0.14631830219427744
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 13 (stage 2):
Intra-stage comm time: 0.0013956394046545084
Grad sync time: 0.14631830219427744

[I] Optimized module 13 for stage 2, comm time has been statically analyzed.
\Time of module 14 (stage 1):
Intra-stage comm time: 0.001308351755142212
Grad sync time: 0.030452021535231986

[I] Optimized module 14 for stage 1, comm time has been statically analyzed.
\Time of module 15 (stage 0):
Intra-stage comm time: 0.003476908523589374
Grad sync time: 0.04476631971442008

[I] Optimized module 15 for stage 0, comm time has been statically analyzed.
\Time of module 16 (stage 0):
Intra-stage comm time: 0.026707577332854275
Grad sync time: 0

[I] Optimized module 16 for stage 0, comm time has been statically analyzed.
\Time of module 17 (stage 1):
Intra-stage comm time: 0.017891987413167956
Grad sync time: 0

[I] Optimized module 17 for stage 1, comm time has been statically analyzed.
\Time of module 18 (stage 2):
Intra-stage comm time: 0.07251048874523905
Grad sync time: 0

[I] Optimized module 18 for stage 2, comm time has been statically analyzed.
\Time of module 19 (stage 3):
Intra-stage comm time: 0.06619054194953707
Grad sync time: 0

[I] Optimized module 19 for stage 3, comm time has been statically analyzed.
\Time of module 20 (stage 4):
Intra-stage comm time: 0.06619054194953707
Grad sync time: 0

[I] Optimized module 20 for stage 4, comm time has been statically analyzed.
[WARN] Communication size of 'all-gather' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 471859200 | Estimated comm time: 0.08268975067138672
       - Max profiled communication size: 267386880 | Comm time: 0.042454824447631836
\Time of module 21 (stage 5):
Intra-stage comm time: 0.15998273822665215
Grad sync time: 0

[I] Optimized module 21 for stage 5, comm time has been statically analyzed.
[WARN] Communication size of 'all-gather' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 471859200 | Estimated comm time: 0.08268975067138672
       - Max profiled communication size: 267386880 | Comm time: 0.042454824447631836
\Time of module 22 (stage 6):
Intra-stage comm time: 0.1338289623260498
Grad sync time: 0

[I] Optimized module 22 for stage 6, comm time has been statically analyzed.
[WARN] Communication size of 'all-gather' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 471859200 | Estimated comm time: 0.08268975067138672
       - Max profiled communication size: 267386880 | Comm time: 0.042454824447631836
\Time of module 23 (stage 7):
Intra-stage comm time: 0.13728301870822904
Grad sync time: 0

[I] Optimized module 23 for stage 7, comm time has been statically analyzed.
[TMP] Memory footprint of the stage 0 is 3.889823440462351 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 1 is 2.493710521608591 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 2 is 9.223775867372751 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 3 is 8.297967914491892 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 4 is 8.297967914491892 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 5 is 19.488649372011423 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 6 is 16.205072406679392 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 7 is 16.60487375035882 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[I] Only-sharded module 0 for stage 0, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.2117208360000001 s.
    - Iteration 1/5: Kernel execution time: 0.21324085500000003 s.
    - Iteration 2/5: Kernel execution time: 0.21395493799999998 s.
    - Iteration 3/5: Kernel execution time: 0.21484346199999999 s.
    - Iteration 4/5: Kernel execution time: 0.21325640100000004 s.
[I] Only-sharded module 1 for stage 1, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.07561635200000001 s.
    - Iteration 1/5: Kernel execution time: 0.076748075 s.
    - Iteration 2/5: Kernel execution time: 0.07618384899999998 s.
    - Iteration 3/5: Kernel execution time: 0.07661952899999998 s.
    - Iteration 4/5: Kernel execution time: 0.076465929 s.
[I] Only-sharded module 2 for stage 2, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.13482165700000007 s.
    - Iteration 1/5: Kernel execution time: 0.13489890200000004 s.
    - Iteration 2/5: Kernel execution time: 0.13443390900000002 s.
    - Iteration 3/5: Kernel execution time: 0.13500242700000004 s.
    - Iteration 4/5: Kernel execution time: 0.135313083 s.
[I] Only-sharded module 3 for stage 3, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.11762259900000002 s.
    - Iteration 1/5: Kernel execution time: 0.11797114400000003 s.
    - Iteration 2/5: Kernel execution time: 0.11792026300000001 s.
    - Iteration 3/5: Kernel execution time: 0.11803866399999999 s.
    - Iteration 4/5: Kernel execution time: 0.11792404499999998 s.
[I] Only-sharded module 4 for stage 4, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.11792132400000002 s.
    - Iteration 1/5: Kernel execution time: 0.117637101 s.
    - Iteration 2/5: Kernel execution time: 0.11789700200000004 s.
    - Iteration 3/5: Kernel execution time: 0.117967053 s.
    - Iteration 4/5: Kernel execution time: 0.11759568700000003 s.
[I] Only-sharded module 5 for stage 5, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.20897205200000002 s.
    - Iteration 1/5: Kernel execution time: 0.209417239 s.
    - Iteration 2/5: Kernel execution time: 0.209576318 s.
    - Iteration 3/5: Kernel execution time: 0.208467956 s.
    - Iteration 4/5: Kernel execution time: 0.208683254 s.
[I] Only-sharded module 6 for stage 6, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.1713358 s.
    - Iteration 1/5: Kernel execution time: 0.172194492 s.
    - Iteration 2/5: Kernel execution time: 0.17206988600000006 s.
    - Iteration 3/5: Kernel execution time: 0.171801052 s.
    - Iteration 4/5: Kernel execution time: 0.171423671 s.
[I] Only-sharded module 7 for stage 7, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.17178633099999993 s.
    - Iteration 1/5: Kernel execution time: 0.171710781 s.
    - Iteration 2/5: Kernel execution time: 0.17154770299999997 s.
    - Iteration 3/5: Kernel execution time: 0.171618361 s.
    - Iteration 4/5: Kernel execution time: 0.17158168899999995 s.
[I] Only-sharded module 8 for stage 7, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.4969871910000001 s.
    - Iteration 1/5: Kernel execution time: 0.4977088320000001 s.
    - Iteration 2/5: Kernel execution time: 0.49672188 s.
    - Iteration 3/5: Kernel execution time: 0.495967985 s.
    - Iteration 4/5: Kernel execution time: 0.497322619 s.
[I] Only-sharded module 9 for stage 6, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.497118681 s.
    - Iteration 1/5: Kernel execution time: 0.4967172720000002 s.
    - Iteration 2/5: Kernel execution time: 0.49770991100000006 s.
    - Iteration 3/5: Kernel execution time: 0.49748507700000016 s.
    - Iteration 4/5: Kernel execution time: 0.496617837 s.
[I] Only-sharded module 10 for stage 5, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.6306875310000002 s.
    - Iteration 1/5: Kernel execution time: 0.6313284010000001 s.
    - Iteration 2/5: Kernel execution time: 0.631730518 s.
    - Iteration 3/5: Kernel execution time: 0.630776332 s.
    - Iteration 4/5: Kernel execution time: 0.630923856 s.
[I] Only-sharded module 11 for stage 4, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.3519679359999999 s.
    - Iteration 1/5: Kernel execution time: 0.35106552300000005 s.
    - Iteration 2/5: Kernel execution time: 0.3524177970000001 s.
    - Iteration 3/5: Kernel execution time: 0.3517017560000001 s.
    - Iteration 4/5: Kernel execution time: 0.353300433 s.
[I] Only-sharded module 12 for stage 3, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.353822611 s.
    - Iteration 1/5: Kernel execution time: 0.35246128600000004 s.
    - Iteration 2/5: Kernel execution time: 0.351952604 s.
    - Iteration 3/5: Kernel execution time: 0.353857683 s.
    - Iteration 4/5: Kernel execution time: 0.353337996 s.
[I] Only-sharded module 13 for stage 2, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.43542266500000004 s.
    - Iteration 1/5: Kernel execution time: 0.43506790400000006 s.
    - Iteration 2/5: Kernel execution time: 0.43556334100000005 s.
    - Iteration 3/5: Kernel execution time: 0.434931401 s.
    - Iteration 4/5: Kernel execution time: 0.4347686420000001 s.
[I] Only-sharded module 14 for stage 1, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.23704587599999996 s.
    - Iteration 1/5: Kernel execution time: 0.23860045299999996 s.
    - Iteration 2/5: Kernel execution time: 0.23850399900000002 s.
    - Iteration 3/5: Kernel execution time: 0.237390071 s.
    - Iteration 4/5: Kernel execution time: 0.23886662600000008 s.
[I] Only-sharded module 15 for stage 0, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.659514176 s.
    - Iteration 1/5: Kernel execution time: 0.6562544379999998 s.
    - Iteration 2/5: Kernel execution time: 0.6571519179999998 s.
    - Iteration 3/5: Kernel execution time: 0.6584184749999995 s.
    - Iteration 4/5: Kernel execution time: 0.6597547539999998 s.
[I] Only-sharded module 16 for stage 0, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.004267621 s.
    - Iteration 1/5: Kernel execution time: 0.004141543 s.
    - Iteration 2/5: Kernel execution time: 0.004135366 s.
    - Iteration 3/5: Kernel execution time: 0.004137125 s.
    - Iteration 4/5: Kernel execution time: 0.0041355260000000005 s.
[I] Only-sharded module 17 for stage 1, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.0027644410000000003 s.
    - Iteration 1/5: Kernel execution time: 0.002767098000000001 s.
    - Iteration 2/5: Kernel execution time: 0.00273916 s.
    - Iteration 3/5: Kernel execution time: 0.002756987 s.
    - Iteration 4/5: Kernel execution time: 0.002743545 s.
[I] Only-sharded module 18 for stage 2, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.011920111 s.
    - Iteration 1/5: Kernel execution time: 0.011920175 s.
    - Iteration 2/5: Kernel execution time: 0.011915791 s.
    - Iteration 3/5: Kernel execution time: 0.011912781 s.
    - Iteration 4/5: Kernel execution time: 0.011910032000000001 s.
[I] Only-sharded module 19 for stage 3, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.010828899 s.
    - Iteration 1/5: Kernel execution time: 0.010854115000000001 s.
    - Iteration 2/5: Kernel execution time: 0.010834244 s.
    - Iteration 3/5: Kernel execution time: 0.010830499 s.
    - Iteration 4/5: Kernel execution time: 0.010841284000000001 s.
[I] Only-sharded module 20 for stage 4, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.010836259 s.
    - Iteration 1/5: Kernel execution time: 0.010843652 s.
    - Iteration 2/5: Kernel execution time: 0.010844803 s.
    - Iteration 3/5: Kernel execution time: 0.01085146 s.
    - Iteration 4/5: Kernel execution time: 0.010828771000000001 s.
[I] Only-sharded module 21 for stage 5, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.025752302 s.
    - Iteration 1/5: Kernel execution time: 0.025738288 s.
    - Iteration 2/5: Kernel execution time: 0.025755501 s.
    - Iteration 3/5: Kernel execution time: 0.025752524000000002 s.
    - Iteration 4/5: Kernel execution time: 0.025732749000000003 s.
[I] Only-sharded module 22 for stage 6, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.02136938 s.
    - Iteration 1/5: Kernel execution time: 0.021383558000000004 s.
    - Iteration 2/5: Kernel execution time: 0.021404421 s.
    - Iteration 3/5: Kernel execution time: 0.021419010000000002 s.
    - Iteration 4/5: Kernel execution time: 0.021308003000000002 s.
[I] Only-sharded module 23 for stage 7, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.021998443 s.
    - Iteration 1/5: Kernel execution time: 0.021967145 s.
    - Iteration 2/5: Kernel execution time: 0.021990825000000002 s.
    - Iteration 3/5: Kernel execution time: 0.021983276000000003 s.
    - Iteration 4/5: Kernel execution time: 0.02195937 s.
[I] Constructing single-device HLO modules concurrently takes 0.021891355514526367 s.
[I] Compile single-device HLO modules concurrently takes 6.42347526550293 s.
[I] Profile all compiled sequentially on one GPU takes 50.58661913871765 s.
[I] Estimated e2e pipeline iteration time is: 22.248550310532046 s.
    - Kernel computation time is: -1.0 s.
    - Communication time is: -1.0 s.
    - Cross-stages communication time is: -1.0 s.
