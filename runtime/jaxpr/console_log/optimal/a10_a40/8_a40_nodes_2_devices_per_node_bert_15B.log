
------------------------------------------------------------------
- (1/3) Profiling bert_15B with batch size: 128...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/bert_15B_128.pkl`, updating/rewriting it...
[WARN] Local batch size 8 is not divisible by num devices 16, skipping...
[TMP] Current profiling results of key `8_a40_8_n_2_d`: none
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/bert_15B_128.pkl`...

------------------------------------------------------------------
- (2/3) Profiling bert_15B with batch size: 256...
------------------------------------------------------------------
[TMP] Profiling results not found in `./jaxpr/prof_log/optimal/bert_15B_256.pkl`, creating it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 8
[I] Loading flax model....
[I] Model 'bert' loads sucessfully. Model Info: 

FlaxBertForMaskedLMModule(
    # attributes
    config = <model.bert_model.BertConfig object at 0x7f547a74bfd0>
    dtype = float16
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2), (4, 2))
- Profiling for submesh 3 (4, 2):
[TMP] Skip profiling of 4 due to legacy error in tensorflow...
- Profiling for submesh 2 (2, 2):
[TMP] Skip profiling of 2 due to legacy error in tensorflow...
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 1, 1, 0), 0] = ModuleProfileResult(compute_cost=0.236, peak_memory=4.635 GB, invar_size=3.619 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(0, 1, 1, 2), 0] = ModuleProfileResult(compute_cost=0.259, peak_memory=4.466 GB, invar_size=3.372 GB, outvar_size=0.156 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(2, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(0, 1, 1, 1), 0] = ModuleProfileResult(compute_cost=0.503, peak_memory=2.982 GB, invar_size=1.810 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(1, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(5, 6, 1, 0), 0] = ModuleProfileResult(compute_cost=0.254, peak_memory=5.001 GB, invar_size=3.985 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(6, 7, 1, 0), 0] = ModuleProfileResult(compute_cost=0.254, peak_memory=5.001 GB, invar_size=3.985 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(1, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(5, 6, 1, 2), 0] = ModuleProfileResult(compute_cost=0.254, peak_memory=5.001 GB, invar_size=3.985 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(3, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(5, 6, 1, 1), 0] = ModuleProfileResult(compute_cost=0.560, peak_memory=3.360 GB, invar_size=2.110 GB, outvar_size=0.312 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(2, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(1, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(3, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(2, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(7, 8, 1, 2), 0] = ModuleProfileResult(compute_cost=0.243, peak_memory=4.806 GB, invar_size=3.790 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(8, 9, 1, 0), 0] = ModuleProfileResult(compute_cost=0.243, peak_memory=4.806 GB, invar_size=3.790 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(3, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(4, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(4, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(8, 9, 1, 2), 0] = ModuleProfileResult(compute_cost=0.243, peak_memory=4.806 GB, invar_size=3.790 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(8, 9, 1, 1), 0] = ModuleProfileResult(compute_cost=0.534, peak_memory=3.184 GB, invar_size=2.012 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(9, 10, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(4, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(9, 10, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(9, 10, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(0, 1, 1, 1), 1] = ModuleProfileResult(compute_cost=1.218, peak_memory=14.364 GB, invar_size=3.932 GB, outvar_size=1.810 GB, temp_buffer_size=10.432 GB, available_memory=35.446 GB)
result[(0, 1, 1, 0), 1] = ModuleProfileResult(compute_cost=0.710, peak_memory=15.219 GB, invar_size=7.394 GB, outvar_size=3.619 GB, temp_buffer_size=7.825 GB, available_memory=35.446 GB)
result[(10, 11, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(1, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=1.253, peak_memory=14.253 GB, invar_size=3.985 GB, outvar_size=1.915 GB, temp_buffer_size=10.111 GB, available_memory=35.446 GB)
result[(2, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=1.253, peak_memory=14.253 GB, invar_size=3.985 GB, outvar_size=1.915 GB, temp_buffer_size=10.111 GB, available_memory=35.446 GB)
result[(4, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=14.928 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(1, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=14.928 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(2, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=14.928 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(1, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=14.928 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(10, 11, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(11, 12, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(11, 12, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(5, 6, 1, 0), 1] = ModuleProfileResult(compute_cost=0.785, peak_memory=16.570 GB, invar_size=8.048 GB, outvar_size=3.985 GB, temp_buffer_size=8.443 GB, available_memory=35.446 GB)
result[(10, 11, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(5, 6, 1, 1), 1] = ModuleProfileResult(compute_cost=1.338, peak_memory=15.115 GB, invar_size=4.376 GB, outvar_size=2.110 GB, temp_buffer_size=10.583 GB, available_memory=35.446 GB)
result[(5, 6, 1, 2), 1] = ModuleProfileResult(compute_cost=0.785, peak_memory=16.726 GB, invar_size=8.127 GB, outvar_size=3.985 GB, temp_buffer_size=8.521 GB, available_memory=35.446 GB)
result[(0, 1, 1, 2), 1] = ModuleProfileResult(compute_cost=0.735, peak_memory=14.727 GB, invar_size=6.901 GB, outvar_size=3.372 GB, temp_buffer_size=7.826 GB, available_memory=35.446 GB)
result[(3, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=14.928 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(2, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=14.928 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(11, 12, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(12, 13, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(7, 8, 1, 1), 1] = ModuleProfileResult(compute_cost=1.315, peak_memory=15.010 GB, invar_size=4.181 GB, outvar_size=2.012 GB, temp_buffer_size=10.673 GB, available_memory=35.446 GB)
result[(14, 15, 1, 1), 0] = ModuleProfileResult(compute_cost=0.256, peak_memory=2.129 GB, invar_size=1.035 GB, outvar_size=0.156 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(14, 15, 1, 0), 0] = ModuleProfileResult(compute_cost=0.115, peak_memory=2.774 GB, invar_size=1.836 GB, outvar_size=0.078 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(12, 13, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(12, 13, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(14, 15, 1, 2), 0] = ModuleProfileResult(compute_cost=0.115, peak_memory=2.774 GB, invar_size=1.836 GB, outvar_size=0.078 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(13, 14, 1, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(9, 10, 1, 1), 1] = ModuleProfileResult(compute_cost=1.200, peak_memory=14.235 GB, invar_size=3.985 GB, outvar_size=1.915 GB, temp_buffer_size=10.094 GB, available_memory=35.446 GB)
result[(13, 14, 1, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=4.610 GB, invar_size=3.595 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(8, 9, 1, 1), 1] = ModuleProfileResult(compute_cost=1.288, peak_memory=16.176 GB, invar_size=4.181 GB, outvar_size=2.012 GB, temp_buffer_size=11.839 GB, available_memory=35.446 GB)
result[(9, 10, 1, 0), 1] = ModuleProfileResult(compute_cost=0.714, peak_memory=15.006 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(3, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=1.253, peak_memory=14.253 GB, invar_size=3.985 GB, outvar_size=1.915 GB, temp_buffer_size=10.111 GB, available_memory=35.446 GB)
result[(7, 8, 1, 2), 1] = ModuleProfileResult(compute_cost=0.760, peak_memory=17.117 GB, invar_size=7.736 GB, outvar_size=3.790 GB, temp_buffer_size=9.303 GB, available_memory=35.446 GB)
result[(4, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=1.253, peak_memory=14.253 GB, invar_size=3.985 GB, outvar_size=1.915 GB, temp_buffer_size=10.111 GB, available_memory=35.446 GB)
result[(8, 9, 1, 2), 1] = ModuleProfileResult(compute_cost=0.757, peak_memory=17.117 GB, invar_size=7.736 GB, outvar_size=3.790 GB, temp_buffer_size=9.303 GB, available_memory=35.446 GB)
result[(8, 9, 1, 0), 1] = ModuleProfileResult(compute_cost=0.757, peak_memory=17.039 GB, invar_size=7.658 GB, outvar_size=3.790 GB, temp_buffer_size=9.303 GB, available_memory=35.446 GB)
result[(13, 14, 1, 1), 0] = ModuleProfileResult(compute_cost=0.496, peak_memory=3.087 GB, invar_size=1.915 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(9, 10, 1, 2), 1] = ModuleProfileResult(compute_cost=0.714, peak_memory=15.084 GB, invar_size=7.345 GB, outvar_size=3.594 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(4, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=14.928 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(3, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=14.928 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(10, 11, 1, 0), 1] = ModuleProfileResult(compute_cost=0.714, peak_memory=15.006 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(11, 12, 1, 0), 1] = ModuleProfileResult(compute_cost=0.714, peak_memory=15.006 GB, invar_size=7.267 GB, outvar_size=3.594 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(10, 11, 1, 2), 1] = ModuleProfileResult(compute_cost=0.714, peak_memory=15.084 GB, invar_size=7.345 GB, outvar_size=3.594 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(11, 12, 1, 1), 1] = ModuleProfileResult(compute_cost=1.200, peak_memory=14.235 GB, invar_size=3.985 GB, outvar_size=1.915 GB, temp_buffer_size=10.094 GB, available_memory=35.446 GB)
result[(10, 11, 1, 1), 1] = ModuleProfileResult(compute_cost=1.200, peak_memory=14.235 GB, invar_size=3.985 GB, outvar_size=1.915 GB, temp_buffer_size=10.094 GB, available_memory=35.446 GB)
result[(11, 12, 1, 2), 1] = ModuleProfileResult(compute_cost=0.714, peak_memory=15.084 GB, invar_size=7.345 GB, outvar_size=3.594 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(12, 13, 1, 0), 1] = ModuleProfileResult(compute_cost=0.717, peak_memory=15.006 GB, invar_size=7.267 GB, outvar_size=3.595 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(12, 13, 1, 1), 1] = ModuleProfileResult(compute_cost=1.227, peak_memory=14.251 GB, invar_size=3.986 GB, outvar_size=1.915 GB, temp_buffer_size=10.109 GB, available_memory=35.446 GB)
result[(13, 14, 1, 1), 1] = ModuleProfileResult(compute_cost=1.253, peak_memory=14.422 GB, invar_size=3.986 GB, outvar_size=1.915 GB, temp_buffer_size=10.280 GB, available_memory=35.446 GB)
result[(12, 13, 1, 2), 1] = ModuleProfileResult(compute_cost=0.717, peak_memory=15.006 GB, invar_size=7.267 GB, outvar_size=3.595 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(13, 14, 1, 2), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=15.006 GB, invar_size=7.267 GB, outvar_size=3.595 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(14, 15, 1, 1), 1] = ModuleProfileResult(compute_cost=1.321, peak_memory=14.201 GB, invar_size=4.171 GB, outvar_size=2.086 GB, temp_buffer_size=9.873 GB, available_memory=35.446 GB)
result[(13, 14, 1, 0), 1] = ModuleProfileResult(compute_cost=0.720, peak_memory=15.006 GB, invar_size=7.267 GB, outvar_size=3.595 GB, temp_buffer_size=7.661 GB, available_memory=35.446 GB)
result[(14, 15, 1, 0), 1] = ModuleProfileResult(compute_cost=0.784, peak_memory=15.534 GB, invar_size=7.873 GB, outvar_size=3.936 GB, temp_buffer_size=7.583 GB, available_memory=35.446 GB)
result[(14, 15, 1, 2), 1] = ModuleProfileResult(compute_cost=0.810, peak_memory=15.045 GB, invar_size=7.384 GB, outvar_size=3.692 GB, temp_buffer_size=7.582 GB, available_memory=35.446 GB)
result[(6, 7, 1, 2), 0] = ModuleProfileResult(compute_cost=0.254, peak_memory=5.001 GB, invar_size=3.985 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(6, 7, 1, 1), 0] = ModuleProfileResult(compute_cost=0.560, peak_memory=3.360 GB, invar_size=2.110 GB, outvar_size=0.312 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(7, 8, 1, 0), 0] = ModuleProfileResult(compute_cost=0.243, peak_memory=4.806 GB, invar_size=3.790 GB, outvar_size=0.156 GB, temp_buffer_size=0.859 GB, available_memory=35.446 GB)
result[(7, 8, 1, 1), 0] = ModuleProfileResult(compute_cost=0.534, peak_memory=3.184 GB, invar_size=2.012 GB, outvar_size=0.234 GB, temp_buffer_size=0.938 GB, available_memory=35.446 GB)
result[(6, 7, 1, 2), 1] = ModuleProfileResult(compute_cost=0.785, peak_memory=16.649 GB, invar_size=8.049 GB, outvar_size=3.985 GB, temp_buffer_size=8.522 GB, available_memory=35.446 GB)
result[(6, 7, 1, 0), 1] = ModuleProfileResult(compute_cost=0.785, peak_memory=16.649 GB, invar_size=8.049 GB, outvar_size=3.985 GB, temp_buffer_size=8.522 GB, available_memory=35.446 GB)
result[(7, 8, 1, 0), 1] = ModuleProfileResult(compute_cost=0.760, peak_memory=16.961 GB, invar_size=7.658 GB, outvar_size=3.790 GB, temp_buffer_size=9.225 GB, available_memory=35.446 GB)
result[(6, 7, 1, 1), 1] = ModuleProfileResult(compute_cost=1.338, peak_memory=15.581 GB, invar_size=4.376 GB, outvar_size=2.110 GB, temp_buffer_size=11.049 GB, available_memory=35.446 GB)
Profiling for submesh 1 (1, 2) takes 78.30 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(7, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.790 GB, invar_size=1.915 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(2, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(3, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(4, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(4, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(3, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(2, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(7, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.790 GB, invar_size=1.915 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(6, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.278, peak_memory=4.180 GB, invar_size=2.305 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(6, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.278, peak_memory=4.180 GB, invar_size=2.305 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(1, 1, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(1, 1, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.242, peak_memory=3.736 GB, invar_size=1.861 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.242, peak_memory=3.736 GB, invar_size=1.861 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(5, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(5, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(8, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.256, peak_memory=3.985 GB, invar_size=2.110 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(9, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(9, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(8, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.256, peak_memory=3.985 GB, invar_size=2.110 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(10, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(10, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(4, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(4, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(11, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(3, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(7, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=19.778 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.793 GB, available_memory=35.446 GB)
result[(3, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(1, 1, 0, 1), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(6, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.809, peak_memory=21.653 GB, invar_size=4.610 GB, outvar_size=2.305 GB, temp_buffer_size=16.887 GB, available_memory=35.446 GB)
result[(2, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(15, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.000 GB, invar_size=0.000 GB, outvar_size=0.000 GB, temp_buffer_size=0.000 GB, available_memory=35.446 GB)
result[(7, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=19.778 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.793 GB, available_memory=35.446 GB)
result[(6, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.809, peak_memory=21.653 GB, invar_size=4.610 GB, outvar_size=2.305 GB, temp_buffer_size=16.887 GB, available_memory=35.446 GB)
result[(15, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.000 GB, invar_size=0.000 GB, outvar_size=0.000 GB, temp_buffer_size=0.000 GB, available_memory=35.446 GB)
result[(1, 1, 0, 0), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.663, peak_memory=19.530 GB, invar_size=3.878 GB, outvar_size=1.861 GB, temp_buffer_size=15.652 GB, available_memory=35.446 GB)
result[(2, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.663, peak_memory=19.530 GB, invar_size=3.878 GB, outvar_size=1.861 GB, temp_buffer_size=15.652 GB, available_memory=35.446 GB)
result[(12, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(11, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(12, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(13, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.790 GB, invar_size=1.915 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(5, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(13, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.790 GB, invar_size=1.915 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(14, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(5, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(14, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=3.789 GB, invar_size=1.914 GB, outvar_size=0.156 GB, temp_buffer_size=1.719 GB, available_memory=35.446 GB)
result[(9, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.680, peak_memory=19.149 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.164 GB, available_memory=35.446 GB)
result[(9, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.680, peak_memory=19.149 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.164 GB, available_memory=35.446 GB)
result[(10, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.680, peak_memory=19.149 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.164 GB, available_memory=35.446 GB)
result[(8, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.761, peak_memory=22.825 GB, invar_size=4.220 GB, outvar_size=2.110 GB, temp_buffer_size=18.449 GB, available_memory=35.446 GB)
result[(10, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.680, peak_memory=19.149 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.164 GB, available_memory=35.446 GB)
result[(8, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.761, peak_memory=22.825 GB, invar_size=4.220 GB, outvar_size=2.110 GB, temp_buffer_size=18.449 GB, available_memory=35.446 GB)
result[(11, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.680, peak_memory=19.149 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.164 GB, available_memory=35.446 GB)
result[(14, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(14, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=18.997 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.012 GB, available_memory=35.446 GB)
result[(11, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.680, peak_memory=19.149 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.164 GB, available_memory=35.446 GB)
result[(12, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.680, peak_memory=19.149 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.164 GB, available_memory=35.446 GB)
result[(12, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.680, peak_memory=19.149 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.164 GB, available_memory=35.446 GB)
result[(13, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=19.310 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.324 GB, available_memory=35.446 GB)
result[(15, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.808, peak_memory=19.365 GB, invar_size=4.356 GB, outvar_size=2.256 GB, temp_buffer_size=14.852 GB, available_memory=35.446 GB)
result[(15, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.808, peak_memory=19.365 GB, invar_size=4.356 GB, outvar_size=2.256 GB, temp_buffer_size=14.852 GB, available_memory=35.446 GB)
result[(13, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.686, peak_memory=19.310 GB, invar_size=3.829 GB, outvar_size=1.914 GB, temp_buffer_size=15.324 GB, available_memory=35.446 GB)
Profiling for submesh 0 (1, 1) takes 26.53 seconds
--------------------------------------------------
----------------------------------------------------------------------
[TMP] Stage (0, 3, 2, 0) has been pruned...
[TMP] Stage (0, 3, 2, 1) has been pruned...
[TMP] Stage (0, 3, 2, 2) has been pruned...
[TMP] Stage (0, 4, 2, 0) has been pruned...
[TMP] Stage (0, 4, 2, 1) has been pruned...
[TMP] Stage (0, 4, 2, 2) has been pruned...
[TMP] Stage (0, 6, 3, 0) has been pruned...
[TMP] Stage (0, 6, 3, 1) has been pruned...
[TMP] Stage (0, 6, 3, 2) has been pruned...
[TMP] Stage (0, 7, 3, 0) has been pruned...
[TMP] Stage (0, 7, 3, 1) has been pruned...
[TMP] Stage (0, 7, 3, 2) has been pruned...
[TMP] Stage (0, 8, 3, 0) has been pruned...
[TMP] Stage (0, 8, 3, 1) has been pruned...
[TMP] Stage (0, 8, 3, 2) has been pruned...
[TMP] Stage (1, 4, 2, 0) has been pruned...
[TMP] Stage (1, 4, 2, 1) has been pruned...
[TMP] Stage (1, 4, 2, 2) has been pruned...
[TMP] Stage (1, 5, 2, 0) has been pruned...
[TMP] Stage (1, 5, 2, 1) has been pruned...
[TMP] Stage (1, 5, 2, 2) has been pruned...
[TMP] Stage (1, 7, 3, 0) has been pruned...
[TMP] Stage (1, 7, 3, 1) has been pruned...
[TMP] Stage (1, 7, 3, 2) has been pruned...
[TMP] Stage (1, 8, 3, 0) has been pruned...
[TMP] Stage (1, 8, 3, 1) has been pruned...
[TMP] Stage (1, 8, 3, 2) has been pruned...
[TMP] Stage (1, 9, 3, 0) has been pruned...
[TMP] Stage (1, 9, 3, 1) has been pruned...
[TMP] Stage (1, 9, 3, 2) has been pruned...
[TMP] Stage (2, 5, 2, 0) has been pruned...
[TMP] Stage (2, 5, 2, 1) has been pruned...
[TMP] Stage (2, 5, 2, 2) has been pruned...
[TMP] Stage (2, 8, 3, 0) has been pruned...
[TMP] Stage (2, 8, 3, 1) has been pruned...
[TMP] Stage (2, 8, 3, 2) has been pruned...
[TMP] Stage (2, 9, 3, 0) has been pruned...
[TMP] Stage (2, 9, 3, 1) has been pruned...
[TMP] Stage (2, 9, 3, 2) has been pruned...
[TMP] Stage (2, 10, 3, 0) has been pruned...
[TMP] Stage (2, 10, 3, 1) has been pruned...
[TMP] Stage (2, 10, 3, 2) has been pruned...
[TMP] Stage (3, 6, 2, 0) has been pruned...
[TMP] Stage (3, 6, 2, 1) has been pruned...
