
------------------------------------------------------------------
- (1/3) Profiling wide_resnet_1B with batch size: 256...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/wide_resnet_1B_256.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 1
[I] Loading flax model....
[I] Model 'wide_resnet' loads sucessfully. Model Info: 

WideResNet(
    # attributes
    stage_sizes = [3, 4, 6, 3]
    block_cls = BottleneckResNetBlock
    num_classes = 1024
    num_filters = 320
    width_factor = 2
    dtype = float32
    act = relu
) 

[I] Manually construct dummy batch with the shape of (256, 224, 224, 3).
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2))
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 15, 1, 0), 0] = ModuleProfileResult(compute_cost=0.003, peak_memory=5.478 GB, invar_size=3.752 GB, outvar_size=0.778 GB, temp_buffer_size=0.949 GB, available_memory=35.242 GB)
result[(0, 15, 1, 1), 0] = ModuleProfileResult(compute_cost=0.368, peak_memory=3.528 GB, invar_size=1.884 GB, outvar_size=1.047 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(0, 15, 1, 2), 0] = ModuleProfileResult(compute_cost=0.084, peak_memory=3.636 GB, invar_size=2.115 GB, outvar_size=0.808 GB, temp_buffer_size=0.714 GB, available_memory=35.242 GB)
result[(0, 15, 1, 0), 1] = ModuleProfileResult(compute_cost=0.076, peak_memory=13.266 GB, invar_size=8.275 GB, outvar_size=3.746 GB, temp_buffer_size=4.992 GB, available_memory=35.242 GB)
result[(0, 15, 1, 1), 1] = ModuleProfileResult(compute_cost=0.547, peak_memory=6.128 GB, invar_size=4.802 GB, outvar_size=1.873 GB, temp_buffer_size=1.325 GB, available_memory=35.242 GB)
result[(0, 15, 1, 2), 1] = ModuleProfileResult(compute_cost=0.161, peak_memory=6.228 GB, invar_size=5.030 GB, outvar_size=2.109 GB, temp_buffer_size=1.198 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 28.11 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.028 GB, invar_size=0.237 GB, outvar_size=1.137 GB, temp_buffer_size=0.655 GB, available_memory=35.242 GB)
result[(0, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.028 GB, invar_size=0.237 GB, outvar_size=1.137 GB, temp_buffer_size=0.655 GB, available_memory=35.242 GB)
result[(0, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.528 GB, invar_size=0.457 GB, outvar_size=1.197 GB, temp_buffer_size=0.874 GB, available_memory=35.242 GB)
result[(0, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.528 GB, invar_size=0.457 GB, outvar_size=1.197 GB, temp_buffer_size=0.874 GB, available_memory=35.242 GB)
result[(0, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.954 GB, invar_size=0.640 GB, outvar_size=1.256 GB, temp_buffer_size=1.058 GB, available_memory=35.242 GB)
result[(0, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.582 GB, invar_size=1.600 GB, outvar_size=0.227 GB, temp_buffer_size=1.982 GB, available_memory=35.242 GB)
result[(0, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.954 GB, invar_size=0.640 GB, outvar_size=1.256 GB, temp_buffer_size=1.058 GB, available_memory=35.242 GB)
result[(0, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.582 GB, invar_size=1.600 GB, outvar_size=0.227 GB, temp_buffer_size=1.982 GB, available_memory=35.242 GB)
result[(0, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.082 GB, invar_size=2.100 GB, outvar_size=0.447 GB, temp_buffer_size=1.982 GB, available_memory=35.242 GB)
result[(1, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.999 GB, invar_size=0.400 GB, outvar_size=0.957 GB, temp_buffer_size=0.643 GB, available_memory=35.242 GB)
result[(1, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.999 GB, invar_size=0.400 GB, outvar_size=0.957 GB, temp_buffer_size=0.643 GB, available_memory=35.242 GB)
result[(0, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.082 GB, invar_size=2.100 GB, outvar_size=0.447 GB, temp_buffer_size=1.982 GB, available_memory=35.242 GB)
result[(1, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.511 GB, invar_size=0.620 GB, outvar_size=1.017 GB, temp_buffer_size=0.874 GB, available_memory=35.242 GB)
result[(0, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.509 GB, invar_size=2.526 GB, outvar_size=0.630 GB, temp_buffer_size=1.983 GB, available_memory=35.242 GB)
result[(1, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.559 GB, invar_size=1.576 GB, outvar_size=0.399 GB, temp_buffer_size=1.803 GB, available_memory=35.242 GB)
result[(1, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.511 GB, invar_size=0.620 GB, outvar_size=1.017 GB, temp_buffer_size=0.874 GB, available_memory=35.242 GB)
result[(1, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.559 GB, invar_size=1.576 GB, outvar_size=0.399 GB, temp_buffer_size=1.803 GB, available_memory=35.242 GB)
result[(1, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.931 GB, invar_size=0.803 GB, outvar_size=1.077 GB, temp_buffer_size=1.051 GB, available_memory=35.242 GB)
result[(0, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.509 GB, invar_size=2.526 GB, outvar_size=0.630 GB, temp_buffer_size=1.983 GB, available_memory=35.242 GB)
result[(1, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.058 GB, invar_size=2.076 GB, outvar_size=0.619 GB, temp_buffer_size=1.803 GB, available_memory=35.242 GB)
result[(1, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.931 GB, invar_size=0.803 GB, outvar_size=1.077 GB, temp_buffer_size=1.051 GB, available_memory=35.242 GB)
result[(1, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.308 GB, invar_size=0.986 GB, outvar_size=1.137 GB, temp_buffer_size=1.185 GB, available_memory=35.242 GB)
result[(1, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.058 GB, invar_size=2.076 GB, outvar_size=0.619 GB, temp_buffer_size=1.803 GB, available_memory=35.242 GB)
result[(1, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.308 GB, invar_size=0.986 GB, outvar_size=1.137 GB, temp_buffer_size=1.185 GB, available_memory=35.242 GB)
result[(2, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.307 GB, invar_size=0.664 GB, outvar_size=0.778 GB, temp_buffer_size=0.866 GB, available_memory=35.242 GB)
result[(1, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.485 GB, invar_size=2.502 GB, outvar_size=0.802 GB, temp_buffer_size=1.804 GB, available_memory=35.242 GB)
result[(2, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.307 GB, invar_size=0.664 GB, outvar_size=0.778 GB, temp_buffer_size=0.866 GB, available_memory=35.242 GB)
result[(1, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.485 GB, invar_size=2.502 GB, outvar_size=0.802 GB, temp_buffer_size=1.804 GB, available_memory=35.242 GB)
result[(2, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.282 GB, invar_size=0.847 GB, outvar_size=0.838 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(2, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.428 GB, invar_size=1.864 GB, outvar_size=0.663 GB, temp_buffer_size=1.324 GB, available_memory=35.242 GB)
result[(1, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.912 GB, invar_size=2.928 GB, outvar_size=0.986 GB, temp_buffer_size=1.804 GB, available_memory=35.242 GB)
result[(2, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.282 GB, invar_size=0.847 GB, outvar_size=0.838 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(1, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.912 GB, invar_size=2.928 GB, outvar_size=0.986 GB, temp_buffer_size=1.804 GB, available_memory=35.242 GB)
result[(2, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.428 GB, invar_size=1.864 GB, outvar_size=0.663 GB, temp_buffer_size=1.324 GB, available_memory=35.242 GB)
result[(2, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.526 GB, invar_size=1.030 GB, outvar_size=0.898 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(2, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.854 GB, invar_size=2.290 GB, outvar_size=0.846 GB, temp_buffer_size=1.324 GB, available_memory=35.242 GB)
result[(2, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.526 GB, invar_size=1.030 GB, outvar_size=0.898 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(2, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.769 GB, invar_size=1.213 GB, outvar_size=0.958 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(2, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.854 GB, invar_size=2.290 GB, outvar_size=0.846 GB, temp_buffer_size=1.324 GB, available_memory=35.242 GB)
result[(2, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.769 GB, invar_size=1.213 GB, outvar_size=0.958 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(2, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.281 GB, invar_size=2.716 GB, outvar_size=1.029 GB, temp_buffer_size=1.325 GB, available_memory=35.242 GB)
result[(3, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.245 GB, invar_size=1.019 GB, outvar_size=0.658 GB, temp_buffer_size=0.568 GB, available_memory=35.242 GB)
result[(2, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.281 GB, invar_size=2.716 GB, outvar_size=1.029 GB, temp_buffer_size=1.325 GB, available_memory=35.242 GB)
result[(3, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.245 GB, invar_size=1.019 GB, outvar_size=0.658 GB, temp_buffer_size=0.568 GB, available_memory=35.242 GB)
result[(2, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.708 GB, invar_size=3.143 GB, outvar_size=1.212 GB, temp_buffer_size=1.326 GB, available_memory=35.242 GB)
result[(3, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.518 GB, invar_size=1.202 GB, outvar_size=0.718 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(2, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.708 GB, invar_size=3.143 GB, outvar_size=1.212 GB, temp_buffer_size=1.326 GB, available_memory=35.242 GB)
result[(3, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.697 GB, invar_size=2.454 GB, outvar_size=1.018 GB, temp_buffer_size=1.003 GB, available_memory=35.242 GB)
result[(3, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.518 GB, invar_size=1.202 GB, outvar_size=0.718 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(3, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.697 GB, invar_size=2.454 GB, outvar_size=1.018 GB, temp_buffer_size=1.003 GB, available_memory=35.242 GB)
result[(3, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.761 GB, invar_size=1.385 GB, outvar_size=0.778 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(3, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.124 GB, invar_size=2.880 GB, outvar_size=1.201 GB, temp_buffer_size=1.004 GB, available_memory=35.242 GB)
result[(3, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.761 GB, invar_size=1.385 GB, outvar_size=0.778 GB, temp_buffer_size=0.598 GB, available_memory=35.242 GB)
result[(4, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.104 GB, invar_size=1.027 GB, outvar_size=0.599 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(4, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.104 GB, invar_size=1.027 GB, outvar_size=0.599 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(3, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.124 GB, invar_size=2.880 GB, outvar_size=1.201 GB, temp_buffer_size=1.004 GB, available_memory=35.242 GB)
result[(4, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.347 GB, invar_size=1.211 GB, outvar_size=0.658 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(4, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.339 GB, invar_size=2.531 GB, outvar_size=1.026 GB, temp_buffer_size=0.688 GB, available_memory=35.242 GB)
result[(3, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.551 GB, invar_size=3.307 GB, outvar_size=1.384 GB, temp_buffer_size=1.005 GB, available_memory=35.242 GB)
result[(3, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.551 GB, invar_size=3.307 GB, outvar_size=1.384 GB, temp_buffer_size=1.005 GB, available_memory=35.242 GB)
result[(4, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.347 GB, invar_size=1.211 GB, outvar_size=0.658 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(4, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.339 GB, invar_size=2.531 GB, outvar_size=1.026 GB, temp_buffer_size=0.688 GB, available_memory=35.242 GB)
result[(4, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.590 GB, invar_size=1.394 GB, outvar_size=0.718 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(4, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.590 GB, invar_size=1.394 GB, outvar_size=0.718 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(5, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.007 GB, invar_size=1.165 GB, outvar_size=0.539 GB, temp_buffer_size=0.304 GB, available_memory=35.242 GB)
result[(4, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.766 GB, invar_size=2.957 GB, outvar_size=1.210 GB, temp_buffer_size=0.689 GB, available_memory=35.242 GB)
result[(4, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.766 GB, invar_size=2.957 GB, outvar_size=1.210 GB, temp_buffer_size=0.689 GB, available_memory=35.242 GB)
result[(5, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.007 GB, invar_size=1.165 GB, outvar_size=0.539 GB, temp_buffer_size=0.304 GB, available_memory=35.242 GB)
result[(4, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.193 GB, invar_size=3.384 GB, outvar_size=1.393 GB, temp_buffer_size=0.689 GB, available_memory=35.242 GB)
result[(5, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.250 GB, invar_size=1.348 GB, outvar_size=0.599 GB, temp_buffer_size=0.304 GB, available_memory=35.242 GB)
result[(4, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.193 GB, invar_size=3.384 GB, outvar_size=1.393 GB, temp_buffer_size=0.689 GB, available_memory=35.242 GB)
result[(5, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.554 GB, invar_size=2.746 GB, outvar_size=1.164 GB, temp_buffer_size=0.689 GB, available_memory=35.242 GB)
result[(5, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.250 GB, invar_size=1.348 GB, outvar_size=0.599 GB, temp_buffer_size=0.304 GB, available_memory=35.242 GB)
result[(5, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.554 GB, invar_size=2.746 GB, outvar_size=1.164 GB, temp_buffer_size=0.689 GB, available_memory=35.242 GB)
result[(5, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.505 GB, invar_size=2.227 GB, outvar_size=0.629 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(5, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.505 GB, invar_size=2.227 GB, outvar_size=0.629 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(5, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.981 GB, invar_size=3.172 GB, outvar_size=1.347 GB, temp_buffer_size=0.689 GB, available_memory=35.242 GB)
result[(5, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.297 GB, invar_size=2.960 GB, outvar_size=0.659 GB, temp_buffer_size=0.679 GB, available_memory=35.242 GB)
result[(5, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.981 GB, invar_size=3.172 GB, outvar_size=1.347 GB, temp_buffer_size=0.689 GB, available_memory=35.242 GB)
result[(5, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.297 GB, invar_size=2.960 GB, outvar_size=0.659 GB, temp_buffer_size=0.679 GB, available_memory=35.242 GB)
result[(5, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.095 GB, invar_size=4.960 GB, outvar_size=2.226 GB, temp_buffer_size=1.015 GB, available_memory=35.242 GB)
result[(6, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.085 GB, invar_size=1.302 GB, outvar_size=0.479 GB, temp_buffer_size=0.304 GB, available_memory=35.242 GB)
result[(5, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.095 GB, invar_size=4.960 GB, outvar_size=2.226 GB, temp_buffer_size=1.015 GB, available_memory=35.242 GB)
result[(6, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.085 GB, invar_size=1.302 GB, outvar_size=0.479 GB, temp_buffer_size=0.304 GB, available_memory=35.242 GB)
result[(5, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.621 GB, invar_size=6.455 GB, outvar_size=2.959 GB, temp_buffer_size=1.046 GB, available_memory=35.242 GB)
result[(6, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.339 GB, invar_size=2.182 GB, outvar_size=0.509 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(6, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.735 GB, invar_size=2.961 GB, outvar_size=1.301 GB, temp_buffer_size=0.654 GB, available_memory=35.242 GB)
result[(5, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.621 GB, invar_size=6.455 GB, outvar_size=2.959 GB, temp_buffer_size=1.046 GB, available_memory=35.242 GB)
result[(6, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.339 GB, invar_size=2.182 GB, outvar_size=0.509 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(6, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.735 GB, invar_size=2.961 GB, outvar_size=1.301 GB, temp_buffer_size=0.654 GB, available_memory=35.242 GB)
result[(6, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.132 GB, invar_size=2.914 GB, outvar_size=0.539 GB, temp_buffer_size=0.679 GB, available_memory=35.242 GB)
result[(6, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.884 GB, invar_size=4.749 GB, outvar_size=2.180 GB, temp_buffer_size=1.015 GB, available_memory=35.242 GB)
result[(6, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.132 GB, invar_size=2.914 GB, outvar_size=0.539 GB, temp_buffer_size=0.679 GB, available_memory=35.242 GB)
result[(6, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.874 GB, invar_size=3.686 GB, outvar_size=0.539 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(6, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.884 GB, invar_size=4.749 GB, outvar_size=2.180 GB, temp_buffer_size=1.015 GB, available_memory=35.242 GB)
result[(6, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.874 GB, invar_size=3.686 GB, outvar_size=0.539 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(6, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.410 GB, invar_size=6.244 GB, outvar_size=2.913 GB, temp_buffer_size=1.046 GB, available_memory=35.242 GB)
result[(7, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.174 GB, invar_size=2.136 GB, outvar_size=0.389 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(6, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.410 GB, invar_size=6.244 GB, outvar_size=2.913 GB, temp_buffer_size=1.046 GB, available_memory=35.242 GB)
result[(7, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.174 GB, invar_size=2.136 GB, outvar_size=0.389 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(6, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.954 GB, invar_size=7.787 GB, outvar_size=3.684 GB, temp_buffer_size=1.047 GB, available_memory=35.242 GB)
result[(7, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.966 GB, invar_size=2.869 GB, outvar_size=0.419 GB, temp_buffer_size=0.679 GB, available_memory=35.242 GB)
result[(7, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.672 GB, invar_size=4.538 GB, outvar_size=2.134 GB, temp_buffer_size=1.015 GB, available_memory=35.242 GB)
result[(6, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.954 GB, invar_size=7.787 GB, outvar_size=3.684 GB, temp_buffer_size=1.047 GB, available_memory=35.242 GB)
result[(7, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.966 GB, invar_size=2.869 GB, outvar_size=0.419 GB, temp_buffer_size=0.679 GB, available_memory=35.242 GB)
result[(7, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.672 GB, invar_size=4.538 GB, outvar_size=2.134 GB, temp_buffer_size=1.015 GB, available_memory=35.242 GB)
result[(7, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.708 GB, invar_size=3.640 GB, outvar_size=0.420 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(7, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.198 GB, invar_size=6.033 GB, outvar_size=2.867 GB, temp_buffer_size=1.046 GB, available_memory=35.242 GB)
result[(7, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.708 GB, invar_size=3.640 GB, outvar_size=0.420 GB, temp_buffer_size=0.649 GB, available_memory=35.242 GB)
result[(8, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.567 GB, invar_size=2.589 GB, outvar_size=0.360 GB, temp_buffer_size=0.619 GB, available_memory=35.242 GB)
result[(8, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.567 GB, invar_size=2.589 GB, outvar_size=0.360 GB, temp_buffer_size=0.619 GB, available_memory=35.242 GB)
result[(7, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.198 GB, invar_size=6.033 GB, outvar_size=2.867 GB, temp_buffer_size=1.046 GB, available_memory=35.242 GB)
result[(8, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.309 GB, invar_size=3.361 GB, outvar_size=0.360 GB, temp_buffer_size=0.589 GB, available_memory=35.242 GB)
result[(7, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.743 GB, invar_size=7.576 GB, outvar_size=3.639 GB, temp_buffer_size=1.047 GB, available_memory=35.242 GB)
result[(7, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.743 GB, invar_size=7.576 GB, outvar_size=3.639 GB, temp_buffer_size=1.047 GB, available_memory=35.242 GB)
result[(8, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.549 GB, invar_size=5.474 GB, outvar_size=2.587 GB, temp_buffer_size=1.016 GB, available_memory=35.242 GB)
result[(8, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.309 GB, invar_size=3.361 GB, outvar_size=0.360 GB, temp_buffer_size=0.589 GB, available_memory=35.242 GB)
result[(8, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.549 GB, invar_size=5.474 GB, outvar_size=2.587 GB, temp_buffer_size=1.016 GB, available_memory=35.242 GB)
result[(9, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.980 GB, invar_size=3.177 GB, outvar_size=0.300 GB, temp_buffer_size=0.504 GB, available_memory=35.242 GB)
result[(9, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.980 GB, invar_size=3.177 GB, outvar_size=0.300 GB, temp_buffer_size=0.504 GB, available_memory=35.242 GB)
result[(8, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.094 GB, invar_size=7.017 GB, outvar_size=3.359 GB, temp_buffer_size=1.017 GB, available_memory=35.242 GB)
result[(9, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.668 GB, invar_size=6.591 GB, outvar_size=3.176 GB, temp_buffer_size=1.017 GB, available_memory=35.242 GB)
result[(8, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.094 GB, invar_size=7.017 GB, outvar_size=3.359 GB, temp_buffer_size=1.017 GB, available_memory=35.242 GB)
result[(9, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.668 GB, invar_size=6.591 GB, outvar_size=3.176 GB, temp_buffer_size=1.017 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 112.06 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-17-15-24-05.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2, 3, 4, 5, 6, 7, 8], [9, 10, 11, 12, 13, 14, 15]]
Result mesh_shapes: [(1, 1), (1, 1)]
Result logical_mesh_shapes: [(1, 1), (1, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 161.08 s
compilation time breakdown: {'stage-construction': '143.05', 'stage-construction-dp': '1.36', 'stage-construction-compilation': '23.54', 'stage-construction-profiling': '52.85'}
 - Compile (worker): 7.32 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 145.24 s

[24.587300539016724, 19.23550510406494, 19.235118627548218, 19.235230445861816, 19.24136209487915, 19.249692678451538, 19.251352310180664]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 99.925 s.
 - Average e2e iteration time: 19.985000610351562 s.
 - Total local training time: 96.21300506591797 s.
 - Average local iteration time: 19.243000030517578 s.
 - Max allocated memory among devices: 23.279 GB.
 - Compilation times:  {'stage-construction': 143.05170059204102, 'stage-construction-dp': 1.3633198738098145, 'stage-construction-compilation': 23.53827214241028, 'stage-construction-profiling': 52.852782249450684}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `1_a40_1_n_2_d`: 19.242551803588867
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/wide_resnet_1B_256.pkl`...

------------------------------------------------------------------
- (2/3) Profiling wide_resnet_1B with batch size: 512...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/wide_resnet_1B_512.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 1
[I] Loading flax model....
[I] Model 'wide_resnet' loads sucessfully. Model Info: 

WideResNet(
    # attributes
    stage_sizes = [3, 4, 6, 3]
    block_cls = BottleneckResNetBlock
    num_classes = 1024
    num_filters = 320
    width_factor = 2
    dtype = float32
    act = relu
) 

[I] Manually construct dummy batch with the shape of (512, 224, 224, 3).
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2))
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 15, 1, 0), 0] = ModuleProfileResult(compute_cost=0.003, peak_memory=6.769 GB, invar_size=3.756 GB, outvar_size=1.556 GB, temp_buffer_size=1.457 GB, available_memory=35.242 GB)
result[(0, 15, 1, 0), 1] = ModuleProfileResult(compute_cost=0.076, peak_memory=14.009 GB, invar_size=9.057 GB, outvar_size=3.746 GB, temp_buffer_size=4.952 GB, available_memory=35.242 GB)
result[(0, 15, 1, 1), 1] = ModuleProfileResult(compute_cost=1.065, peak_memory=8.498 GB, invar_size=5.858 GB, outvar_size=1.873 GB, temp_buffer_size=2.639 GB, available_memory=35.242 GB)
result[(0, 15, 1, 2), 0] = ModuleProfileResult(compute_cost=0.087, peak_memory=5.377 GB, invar_size=2.565 GB, outvar_size=1.616 GB, temp_buffer_size=1.197 GB, available_memory=35.242 GB)
result[(0, 15, 1, 2), 1] = ModuleProfileResult(compute_cost=0.123, peak_memory=8.926 GB, invar_size=6.733 GB, outvar_size=2.555 GB, temp_buffer_size=2.192 GB, available_memory=35.242 GB)
result[(0, 15, 1, 1), 0] = ModuleProfileResult(compute_cost=0.731, peak_memory=5.182 GB, invar_size=1.893 GB, outvar_size=2.094 GB, temp_buffer_size=1.196 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 34.90 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.701 GB, invar_size=2.746 GB, outvar_size=0.227 GB, temp_buffer_size=3.956 GB, available_memory=35.242 GB)
result[(0, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.701 GB, invar_size=2.746 GB, outvar_size=0.227 GB, temp_buffer_size=3.956 GB, available_memory=35.242 GB)
result[(0, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.261 GB, invar_size=3.305 GB, outvar_size=0.447 GB, temp_buffer_size=3.956 GB, available_memory=35.242 GB)
result[(0, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.261 GB, invar_size=3.305 GB, outvar_size=0.447 GB, temp_buffer_size=3.956 GB, available_memory=35.242 GB)
result[(0, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.747 GB, invar_size=3.791 GB, outvar_size=0.630 GB, temp_buffer_size=3.957 GB, available_memory=35.242 GB)
result[(0, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.747 GB, invar_size=3.791 GB, outvar_size=0.630 GB, temp_buffer_size=3.957 GB, available_memory=35.242 GB)
result[(0, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.652 GB, invar_size=0.246 GB, outvar_size=2.273 GB, temp_buffer_size=1.133 GB, available_memory=35.242 GB)
result[(0, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.652 GB, invar_size=0.246 GB, outvar_size=2.273 GB, temp_buffer_size=1.133 GB, available_memory=35.242 GB)
result[(1, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.668 GB, invar_size=2.713 GB, outvar_size=0.579 GB, temp_buffer_size=3.597 GB, available_memory=35.242 GB)
result[(0, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.199 GB, invar_size=0.466 GB, outvar_size=2.393 GB, temp_buffer_size=1.341 GB, available_memory=35.242 GB)
result[(0, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.199 GB, invar_size=0.466 GB, outvar_size=2.393 GB, temp_buffer_size=1.341 GB, available_memory=35.242 GB)
result[(1, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.668 GB, invar_size=2.713 GB, outvar_size=0.579 GB, temp_buffer_size=3.597 GB, available_memory=35.242 GB)
result[(1, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.228 GB, invar_size=3.272 GB, outvar_size=0.799 GB, temp_buffer_size=3.597 GB, available_memory=35.242 GB)
result[(1, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.614 GB, invar_size=0.579 GB, outvar_size=1.914 GB, temp_buffer_size=1.121 GB, available_memory=35.242 GB)
result[(1, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.228 GB, invar_size=3.272 GB, outvar_size=0.799 GB, temp_buffer_size=3.597 GB, available_memory=35.242 GB)
result[(0, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.697 GB, invar_size=0.649 GB, outvar_size=2.513 GB, temp_buffer_size=1.536 GB, available_memory=35.242 GB)
result[(1, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.614 GB, invar_size=0.579 GB, outvar_size=1.914 GB, temp_buffer_size=1.121 GB, available_memory=35.242 GB)
result[(0, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.697 GB, invar_size=0.649 GB, outvar_size=2.513 GB, temp_buffer_size=1.536 GB, available_memory=35.242 GB)
result[(1, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.714 GB, invar_size=3.758 GB, outvar_size=0.982 GB, temp_buffer_size=3.597 GB, available_memory=35.242 GB)
result[(1, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.714 GB, invar_size=3.758 GB, outvar_size=0.982 GB, temp_buffer_size=3.597 GB, available_memory=35.242 GB)
result[(1, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.200 GB, invar_size=4.244 GB, outvar_size=1.165 GB, temp_buffer_size=3.598 GB, available_memory=35.242 GB)
result[(1, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.186 GB, invar_size=0.799 GB, outvar_size=2.034 GB, temp_buffer_size=1.353 GB, available_memory=35.242 GB)
result[(1, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.186 GB, invar_size=0.799 GB, outvar_size=2.034 GB, temp_buffer_size=1.353 GB, available_memory=35.242 GB)
result[(1, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.200 GB, invar_size=4.244 GB, outvar_size=1.165 GB, temp_buffer_size=3.598 GB, available_memory=35.242 GB)
result[(2, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.999 GB, invar_size=2.881 GB, outvar_size=0.902 GB, temp_buffer_size=2.640 GB, available_memory=35.242 GB)
result[(2, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.999 GB, invar_size=2.881 GB, outvar_size=0.902 GB, temp_buffer_size=2.640 GB, available_memory=35.242 GB)
result[(1, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.665 GB, invar_size=0.983 GB, outvar_size=2.154 GB, temp_buffer_size=1.529 GB, available_memory=35.242 GB)
result[(1, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.665 GB, invar_size=0.983 GB, outvar_size=2.154 GB, temp_buffer_size=1.529 GB, available_memory=35.242 GB)
result[(2, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.803 GB, invar_size=0.903 GB, outvar_size=1.555 GB, temp_buffer_size=1.345 GB, available_memory=35.242 GB)
result[(2, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.486 GB, invar_size=3.367 GB, outvar_size=1.085 GB, temp_buffer_size=2.640 GB, available_memory=35.242 GB)
result[(2, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.803 GB, invar_size=0.903 GB, outvar_size=1.555 GB, temp_buffer_size=1.345 GB, available_memory=35.242 GB)
result[(2, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.486 GB, invar_size=3.367 GB, outvar_size=1.085 GB, temp_buffer_size=2.640 GB, available_memory=35.242 GB)
result[(2, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.972 GB, invar_size=3.853 GB, outvar_size=1.269 GB, temp_buffer_size=2.640 GB, available_memory=35.242 GB)
result[(1, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.041 GB, invar_size=1.166 GB, outvar_size=2.273 GB, temp_buffer_size=1.603 GB, available_memory=35.242 GB)
result[(1, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.041 GB, invar_size=1.166 GB, outvar_size=2.273 GB, temp_buffer_size=1.603 GB, available_memory=35.242 GB)
result[(2, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.972 GB, invar_size=3.853 GB, outvar_size=1.269 GB, temp_buffer_size=2.640 GB, available_memory=35.242 GB)
result[(2, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.458 GB, invar_size=4.339 GB, outvar_size=1.452 GB, temp_buffer_size=2.641 GB, available_memory=35.242 GB)
result[(2, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.286 GB, invar_size=1.086 GB, outvar_size=1.675 GB, temp_buffer_size=1.525 GB, available_memory=35.242 GB)
result[(2, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.458 GB, invar_size=4.339 GB, outvar_size=1.452 GB, temp_buffer_size=2.641 GB, available_memory=35.242 GB)
result[(2, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.286 GB, invar_size=1.086 GB, outvar_size=1.675 GB, temp_buffer_size=1.525 GB, available_memory=35.242 GB)
result[(2, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.662 GB, invar_size=1.269 GB, outvar_size=1.795 GB, temp_buffer_size=1.598 GB, available_memory=35.242 GB)
result[(3, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.794 GB, invar_size=3.352 GB, outvar_size=1.257 GB, temp_buffer_size=1.964 GB, available_memory=35.242 GB)
result[(2, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.662 GB, invar_size=1.269 GB, outvar_size=1.795 GB, temp_buffer_size=1.598 GB, available_memory=35.242 GB)
result[(3, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.794 GB, invar_size=3.352 GB, outvar_size=1.257 GB, temp_buffer_size=1.964 GB, available_memory=35.242 GB)
result[(3, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.280 GB, invar_size=3.837 GB, outvar_size=1.440 GB, temp_buffer_size=1.964 GB, available_memory=35.242 GB)
result[(3, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.280 GB, invar_size=3.837 GB, outvar_size=1.440 GB, temp_buffer_size=1.964 GB, available_memory=35.242 GB)
result[(3, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.666 GB, invar_size=1.258 GB, outvar_size=1.316 GB, temp_buffer_size=1.092 GB, available_memory=35.242 GB)
result[(2, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.099 GB, invar_size=1.453 GB, outvar_size=1.915 GB, temp_buffer_size=1.732 GB, available_memory=35.242 GB)
result[(2, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.099 GB, invar_size=1.453 GB, outvar_size=1.915 GB, temp_buffer_size=1.732 GB, available_memory=35.242 GB)
result[(3, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.666 GB, invar_size=1.258 GB, outvar_size=1.316 GB, temp_buffer_size=1.092 GB, available_memory=35.242 GB)
result[(3, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.766 GB, invar_size=4.323 GB, outvar_size=1.623 GB, temp_buffer_size=1.964 GB, available_memory=35.242 GB)
result[(3, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.766 GB, invar_size=4.323 GB, outvar_size=1.623 GB, temp_buffer_size=1.964 GB, available_memory=35.242 GB)
result[(4, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.835 GB, invar_size=3.249 GB, outvar_size=1.146 GB, temp_buffer_size=1.346 GB, available_memory=35.242 GB)
result[(4, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.835 GB, invar_size=3.249 GB, outvar_size=1.146 GB, temp_buffer_size=1.346 GB, available_memory=35.242 GB)
result[(3, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.103 GB, invar_size=1.441 GB, outvar_size=1.436 GB, temp_buffer_size=1.226 GB, available_memory=35.242 GB)
result[(3, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.103 GB, invar_size=1.441 GB, outvar_size=1.436 GB, temp_buffer_size=1.226 GB, available_memory=35.242 GB)
result[(4, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.320 GB, invar_size=3.735 GB, outvar_size=1.329 GB, temp_buffer_size=1.346 GB, available_memory=35.242 GB)
result[(4, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.320 GB, invar_size=3.735 GB, outvar_size=1.329 GB, temp_buffer_size=1.346 GB, available_memory=35.242 GB)
result[(3, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.540 GB, invar_size=1.624 GB, outvar_size=1.556 GB, temp_buffer_size=1.361 GB, available_memory=35.242 GB)
result[(4, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.301 GB, invar_size=1.147 GB, outvar_size=1.197 GB, temp_buffer_size=0.957 GB, available_memory=35.242 GB)
result[(4, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.301 GB, invar_size=1.147 GB, outvar_size=1.197 GB, temp_buffer_size=0.957 GB, available_memory=35.242 GB)
result[(3, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.540 GB, invar_size=1.624 GB, outvar_size=1.556 GB, temp_buffer_size=1.361 GB, available_memory=35.242 GB)
result[(4, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.807 GB, invar_size=4.221 GB, outvar_size=1.512 GB, temp_buffer_size=1.347 GB, available_memory=35.242 GB)
result[(5, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.990 GB, invar_size=3.404 GB, outvar_size=1.283 GB, temp_buffer_size=1.346 GB, available_memory=35.242 GB)
result[(4, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.807 GB, invar_size=4.221 GB, outvar_size=1.512 GB, temp_buffer_size=1.347 GB, available_memory=35.242 GB)
result[(4, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.604 GB, invar_size=1.330 GB, outvar_size=1.316 GB, temp_buffer_size=0.958 GB, available_memory=35.242 GB)
result[(4, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.604 GB, invar_size=1.330 GB, outvar_size=1.316 GB, temp_buffer_size=0.958 GB, available_memory=35.242 GB)
result[(5, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.990 GB, invar_size=3.404 GB, outvar_size=1.283 GB, temp_buffer_size=1.346 GB, available_memory=35.242 GB)
result[(5, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.475 GB, invar_size=3.890 GB, outvar_size=1.467 GB, temp_buffer_size=1.346 GB, available_memory=35.242 GB)
result[(5, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.475 GB, invar_size=3.890 GB, outvar_size=1.467 GB, temp_buffer_size=1.346 GB, available_memory=35.242 GB)
result[(4, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.907 GB, invar_size=1.513 GB, outvar_size=1.436 GB, temp_buffer_size=0.958 GB, available_memory=35.242 GB)
result[(5, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.840 GB, invar_size=1.284 GB, outvar_size=1.077 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(5, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.393 GB, invar_size=5.708 GB, outvar_size=2.346 GB, temp_buffer_size=1.445 GB, available_memory=35.242 GB)
result[(4, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.907 GB, invar_size=1.513 GB, outvar_size=1.436 GB, temp_buffer_size=0.958 GB, available_memory=35.242 GB)
result[(5, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.840 GB, invar_size=1.284 GB, outvar_size=1.077 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(5, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.393 GB, invar_size=5.708 GB, outvar_size=2.346 GB, temp_buffer_size=1.445 GB, available_memory=35.242 GB)
result[(5, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.143 GB, invar_size=1.468 GB, outvar_size=1.197 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(5, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.918 GB, invar_size=7.233 GB, outvar_size=3.078 GB, temp_buffer_size=1.445 GB, available_memory=35.242 GB)
result[(5, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.143 GB, invar_size=1.468 GB, outvar_size=1.197 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(6, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.926 GB, invar_size=3.559 GB, outvar_size=1.421 GB, temp_buffer_size=1.127 GB, available_memory=35.242 GB)
result[(5, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.918 GB, invar_size=7.233 GB, outvar_size=3.078 GB, temp_buffer_size=1.445 GB, available_memory=35.242 GB)
result[(6, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.926 GB, invar_size=3.559 GB, outvar_size=1.421 GB, temp_buffer_size=1.127 GB, available_memory=35.242 GB)
result[(5, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.462 GB, invar_size=2.347 GB, outvar_size=1.257 GB, temp_buffer_size=0.859 GB, available_memory=35.242 GB)
result[(6, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.858 GB, invar_size=1.422 GB, outvar_size=0.958 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(5, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.462 GB, invar_size=2.347 GB, outvar_size=1.257 GB, temp_buffer_size=0.859 GB, available_memory=35.242 GB)
result[(6, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.844 GB, invar_size=5.377 GB, outvar_size=2.300 GB, temp_buffer_size=1.228 GB, available_memory=35.242 GB)
result[(6, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.844 GB, invar_size=5.377 GB, outvar_size=2.300 GB, temp_buffer_size=1.228 GB, available_memory=35.242 GB)
result[(6, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.858 GB, invar_size=1.422 GB, outvar_size=0.958 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(5, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.315 GB, invar_size=3.080 GB, outvar_size=1.317 GB, temp_buffer_size=0.919 GB, available_memory=35.242 GB)
result[(5, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.315 GB, invar_size=3.080 GB, outvar_size=1.317 GB, temp_buffer_size=0.919 GB, available_memory=35.242 GB)
result[(6, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.417 GB, invar_size=6.902 GB, outvar_size=3.032 GB, temp_buffer_size=1.276 GB, available_memory=35.242 GB)
result[(6, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.177 GB, invar_size=2.301 GB, outvar_size=1.018 GB, temp_buffer_size=0.859 GB, available_memory=35.242 GB)
result[(6, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.417 GB, invar_size=6.902 GB, outvar_size=3.032 GB, temp_buffer_size=1.276 GB, available_memory=35.242 GB)
result[(6, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.960 GB, invar_size=8.445 GB, outvar_size=3.804 GB, temp_buffer_size=1.275 GB, available_memory=35.242 GB)
result[(6, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.960 GB, invar_size=8.445 GB, outvar_size=3.804 GB, temp_buffer_size=1.275 GB, available_memory=35.242 GB)
result[(6, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.177 GB, invar_size=2.301 GB, outvar_size=1.018 GB, temp_buffer_size=0.859 GB, available_memory=35.242 GB)
result[(7, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.520 GB, invar_size=5.046 GB, outvar_size=2.254 GB, temp_buffer_size=1.234 GB, available_memory=35.242 GB)
result[(7, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.520 GB, invar_size=5.046 GB, outvar_size=2.254 GB, temp_buffer_size=1.234 GB, available_memory=35.242 GB)
result[(6, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.029 GB, invar_size=3.034 GB, outvar_size=1.077 GB, temp_buffer_size=0.919 GB, available_memory=35.242 GB)
result[(6, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.029 GB, invar_size=3.034 GB, outvar_size=1.077 GB, temp_buffer_size=0.919 GB, available_memory=35.242 GB)
result[(7, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.892 GB, invar_size=2.255 GB, outvar_size=0.778 GB, temp_buffer_size=0.859 GB, available_memory=35.242 GB)
result[(7, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.085 GB, invar_size=6.571 GB, outvar_size=2.987 GB, temp_buffer_size=1.275 GB, available_memory=35.242 GB)
result[(6, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.750 GB, invar_size=3.806 GB, outvar_size=1.078 GB, temp_buffer_size=0.868 GB, available_memory=35.242 GB)
result[(6, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.750 GB, invar_size=3.806 GB, outvar_size=1.078 GB, temp_buffer_size=0.868 GB, available_memory=35.242 GB)
result[(7, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.085 GB, invar_size=6.571 GB, outvar_size=2.987 GB, temp_buffer_size=1.275 GB, available_memory=35.242 GB)
result[(7, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.629 GB, invar_size=8.114 GB, outvar_size=3.758 GB, temp_buffer_size=1.276 GB, available_memory=35.242 GB)
result[(7, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.892 GB, invar_size=2.255 GB, outvar_size=0.778 GB, temp_buffer_size=0.859 GB, available_memory=35.242 GB)
result[(7, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.629 GB, invar_size=8.114 GB, outvar_size=3.758 GB, temp_buffer_size=1.276 GB, available_memory=35.242 GB)
result[(8, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.331 GB, invar_size=5.892 GB, outvar_size=2.647 GB, temp_buffer_size=1.319 GB, available_memory=35.242 GB)
result[(7, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.744 GB, invar_size=2.988 GB, outvar_size=0.838 GB, temp_buffer_size=0.919 GB, available_memory=35.242 GB)
result[(8, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.331 GB, invar_size=5.892 GB, outvar_size=2.647 GB, temp_buffer_size=1.319 GB, available_memory=35.242 GB)
result[(8, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.875 GB, invar_size=7.436 GB, outvar_size=3.419 GB, temp_buffer_size=1.320 GB, available_memory=35.242 GB)
result[(7, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.744 GB, invar_size=2.988 GB, outvar_size=0.838 GB, temp_buffer_size=0.919 GB, available_memory=35.242 GB)
result[(8, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.165 GB, invar_size=2.649 GB, outvar_size=0.718 GB, temp_buffer_size=0.799 GB, available_memory=35.242 GB)
result[(8, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.875 GB, invar_size=7.436 GB, outvar_size=3.419 GB, temp_buffer_size=1.320 GB, available_memory=35.242 GB)
result[(8, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.165 GB, invar_size=2.649 GB, outvar_size=0.718 GB, temp_buffer_size=0.799 GB, available_memory=35.242 GB)
result[(7, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.471 GB, invar_size=3.760 GB, outvar_size=0.838 GB, temp_buffer_size=0.874 GB, available_memory=35.242 GB)
result[(9, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.389 GB, invar_size=6.950 GB, outvar_size=3.236 GB, temp_buffer_size=1.320 GB, available_memory=35.242 GB)
result[(7, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.471 GB, invar_size=3.760 GB, outvar_size=0.838 GB, temp_buffer_size=0.874 GB, available_memory=35.242 GB)
result[(9, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.389 GB, invar_size=6.950 GB, outvar_size=3.236 GB, temp_buffer_size=1.320 GB, available_memory=35.242 GB)
result[(8, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.892 GB, invar_size=3.420 GB, outvar_size=0.719 GB, temp_buffer_size=0.754 GB, available_memory=35.242 GB)
result[(8, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.892 GB, invar_size=3.420 GB, outvar_size=0.719 GB, temp_buffer_size=0.754 GB, available_memory=35.242 GB)
result[(9, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.463 GB, invar_size=3.237 GB, outvar_size=0.599 GB, temp_buffer_size=0.628 GB, available_memory=35.242 GB)
result[(9, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.463 GB, invar_size=3.237 GB, outvar_size=0.599 GB, temp_buffer_size=0.628 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 206.35 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-17-15-31-10.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2, 3, 4, 5, 6, 7, 8], [9, 10, 11, 12, 13, 14, 15]]
Result mesh_shapes: [(1, 1), (1, 1)]
Result logical_mesh_shapes: [(1, 1), (1, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 261.97 s
compilation time breakdown: {'stage-construction': '244.16', 'stage-construction-dp': '1.35', 'stage-construction-compilation': '22.86', 'stage-construction-profiling': '153.87'}
 - Compile (worker): 19.96 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
[E] Meet unexpected error in profiling executables...

[E] Unexpected error occurred in compiling or profiling executables...
[E] Meet unexpected error in compiling and executing model...
[TMP] Current profiling results of key `1_a40_1_n_2_d`: none
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/wide_resnet_1B_512.pkl`...

------------------------------------------------------------------
- (3/3) Profiling wide_resnet_1B with batch size: 1024...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/wide_resnet_1B_1024.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 1
[I] Loading flax model....
[I] Model 'wide_resnet' loads sucessfully. Model Info: 

WideResNet(
    # attributes
    stage_sizes = [3, 4, 6, 3]
    block_cls = BottleneckResNetBlock
    num_classes = 1024
    num_filters = 320
    width_factor = 2
    dtype = float32
    act = relu
) 

[I] Manually construct dummy batch with the shape of (1024, 224, 224, 3).
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2))
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 15, 1, 0), 0] = ModuleProfileResult(compute_cost=0.003, peak_memory=8.910 GB, invar_size=3.765 GB, outvar_size=3.111 GB, temp_buffer_size=2.035 GB, available_memory=35.242 GB)
result[(0, 15, 1, 0), 1] = ModuleProfileResult(compute_cost=0.076, peak_memory=15.558 GB, invar_size=10.621 GB, outvar_size=3.746 GB, temp_buffer_size=4.937 GB, available_memory=35.242 GB)
result[(0, 15, 1, 1), 1] = ModuleProfileResult(compute_cost=2.095, peak_memory=13.241 GB, invar_size=7.970 GB, outvar_size=1.873 GB, temp_buffer_size=5.272 GB, available_memory=35.242 GB)
result[(0, 15, 1, 2), 0] = ModuleProfileResult(compute_cost=0.172, peak_memory=8.078 GB, invar_size=2.574 GB, outvar_size=3.231 GB, temp_buffer_size=2.274 GB, available_memory=35.242 GB)
result[(0, 15, 1, 2), 1] = ModuleProfileResult(compute_cost=0.194, peak_memory=12.568 GB, invar_size=8.357 GB, outvar_size=2.555 GB, temp_buffer_size=4.211 GB, available_memory=35.242 GB)
result[(0, 15, 1, 1), 0] = ModuleProfileResult(compute_cost=1.456, peak_memory=8.490 GB, invar_size=1.910 GB, outvar_size=4.188 GB, temp_buffer_size=2.393 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 34.57 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.941 GB, invar_size=5.036 GB, outvar_size=0.227 GB, temp_buffer_size=7.904 GB, available_memory=35.242 GB)
result[(0, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.941 GB, invar_size=5.036 GB, outvar_size=0.227 GB, temp_buffer_size=7.904 GB, available_memory=35.242 GB)
result[(0, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=13.620 GB, invar_size=5.715 GB, outvar_size=0.447 GB, temp_buffer_size=7.905 GB, available_memory=35.242 GB)
result[(0, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=13.620 GB, invar_size=5.715 GB, outvar_size=0.447 GB, temp_buffer_size=7.905 GB, available_memory=35.242 GB)
result[(0, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=14.227 GB, invar_size=6.321 GB, outvar_size=0.630 GB, temp_buffer_size=7.906 GB, available_memory=35.242 GB)
result[(0, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=14.227 GB, invar_size=6.321 GB, outvar_size=0.630 GB, temp_buffer_size=7.906 GB, available_memory=35.242 GB)
result[(0, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.900 GB, invar_size=0.264 GB, outvar_size=4.546 GB, temp_buffer_size=2.090 GB, available_memory=35.242 GB)
result[(0, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.900 GB, invar_size=0.264 GB, outvar_size=4.546 GB, temp_buffer_size=2.090 GB, available_memory=35.242 GB)
result[(0, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.567 GB, invar_size=0.484 GB, outvar_size=4.785 GB, temp_buffer_size=2.298 GB, available_memory=35.242 GB)
result[(1, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.889 GB, invar_size=4.986 GB, outvar_size=0.938 GB, temp_buffer_size=7.186 GB, available_memory=35.242 GB)
result[(0, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.567 GB, invar_size=0.484 GB, outvar_size=4.785 GB, temp_buffer_size=2.298 GB, available_memory=35.242 GB)
result[(1, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.889 GB, invar_size=4.986 GB, outvar_size=0.938 GB, temp_buffer_size=7.186 GB, available_memory=35.242 GB)
result[(1, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=13.569 GB, invar_size=5.665 GB, outvar_size=1.158 GB, temp_buffer_size=7.186 GB, available_memory=35.242 GB)
result[(1, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.844 GB, invar_size=0.938 GB, outvar_size=3.828 GB, temp_buffer_size=2.078 GB, available_memory=35.242 GB)
result[(1, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=13.569 GB, invar_size=5.665 GB, outvar_size=1.158 GB, temp_buffer_size=7.186 GB, available_memory=35.242 GB)
result[(0, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.185 GB, invar_size=0.667 GB, outvar_size=5.025 GB, temp_buffer_size=2.493 GB, available_memory=35.242 GB)
result[(1, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.844 GB, invar_size=0.938 GB, outvar_size=3.828 GB, temp_buffer_size=2.078 GB, available_memory=35.242 GB)
result[(1, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=14.175 GB, invar_size=6.270 GB, outvar_size=1.341 GB, temp_buffer_size=7.187 GB, available_memory=35.242 GB)
result[(0, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.185 GB, invar_size=0.667 GB, outvar_size=5.025 GB, temp_buffer_size=2.493 GB, available_memory=35.242 GB)
result[(1, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=14.175 GB, invar_size=6.270 GB, outvar_size=1.341 GB, temp_buffer_size=7.187 GB, available_memory=35.242 GB)
result[(1, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.536 GB, invar_size=1.158 GB, outvar_size=4.068 GB, temp_buffer_size=2.310 GB, available_memory=35.242 GB)
result[(1, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=14.781 GB, invar_size=6.876 GB, outvar_size=1.524 GB, temp_buffer_size=7.187 GB, available_memory=35.242 GB)
result[(1, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.536 GB, invar_size=1.158 GB, outvar_size=4.068 GB, temp_buffer_size=2.310 GB, available_memory=35.242 GB)
result[(1, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=14.781 GB, invar_size=6.876 GB, outvar_size=1.524 GB, temp_buffer_size=7.187 GB, available_memory=35.242 GB)
result[(2, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.144 GB, invar_size=4.915 GB, outvar_size=1.381 GB, temp_buffer_size=5.272 GB, available_memory=35.242 GB)
result[(2, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.144 GB, invar_size=4.915 GB, outvar_size=1.381 GB, temp_buffer_size=5.272 GB, available_memory=35.242 GB)
result[(1, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.134 GB, invar_size=1.341 GB, outvar_size=4.307 GB, temp_buffer_size=2.486 GB, available_memory=35.242 GB)
result[(1, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.134 GB, invar_size=1.341 GB, outvar_size=4.307 GB, temp_buffer_size=2.486 GB, available_memory=35.242 GB)
result[(2, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.793 GB, invar_size=1.381 GB, outvar_size=3.111 GB, temp_buffer_size=2.302 GB, available_memory=35.242 GB)
result[(2, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.750 GB, invar_size=5.520 GB, outvar_size=1.564 GB, temp_buffer_size=5.273 GB, available_memory=35.242 GB)
result[(2, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.750 GB, invar_size=5.520 GB, outvar_size=1.564 GB, temp_buffer_size=5.273 GB, available_memory=35.242 GB)
result[(2, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.793 GB, invar_size=1.381 GB, outvar_size=3.111 GB, temp_buffer_size=2.302 GB, available_memory=35.242 GB)
result[(2, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.356 GB, invar_size=6.126 GB, outvar_size=1.747 GB, temp_buffer_size=5.273 GB, available_memory=35.242 GB)
result[(1, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.630 GB, invar_size=1.525 GB, outvar_size=4.546 GB, temp_buffer_size=2.560 GB, available_memory=35.242 GB)
result[(1, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.630 GB, invar_size=1.525 GB, outvar_size=4.546 GB, temp_buffer_size=2.560 GB, available_memory=35.242 GB)
result[(2, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.356 GB, invar_size=6.126 GB, outvar_size=1.747 GB, temp_buffer_size=5.273 GB, available_memory=35.242 GB)
result[(2, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.396 GB, invar_size=1.565 GB, outvar_size=3.350 GB, temp_buffer_size=2.482 GB, available_memory=35.242 GB)
result[(2, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.962 GB, invar_size=6.732 GB, outvar_size=1.930 GB, temp_buffer_size=5.273 GB, available_memory=35.242 GB)
result[(2, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.396 GB, invar_size=1.565 GB, outvar_size=3.350 GB, temp_buffer_size=2.482 GB, available_memory=35.242 GB)
result[(2, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.962 GB, invar_size=6.732 GB, outvar_size=1.930 GB, temp_buffer_size=5.273 GB, available_memory=35.242 GB)
result[(2, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.892 GB, invar_size=1.748 GB, outvar_size=3.589 GB, temp_buffer_size=2.555 GB, available_memory=35.242 GB)
result[(3, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.990 GB, invar_size=5.146 GB, outvar_size=1.736 GB, temp_buffer_size=3.887 GB, available_memory=35.242 GB)
result[(2, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.892 GB, invar_size=1.748 GB, outvar_size=3.589 GB, temp_buffer_size=2.555 GB, available_memory=35.242 GB)
result[(3, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.990 GB, invar_size=5.146 GB, outvar_size=1.736 GB, temp_buffer_size=3.887 GB, available_memory=35.242 GB)
result[(3, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.596 GB, invar_size=5.752 GB, outvar_size=1.919 GB, temp_buffer_size=3.887 GB, available_memory=35.242 GB)
result[(3, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.596 GB, invar_size=5.752 GB, outvar_size=1.919 GB, temp_buffer_size=3.887 GB, available_memory=35.242 GB)
result[(3, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.939 GB, invar_size=1.736 GB, outvar_size=2.632 GB, temp_buffer_size=1.570 GB, available_memory=35.242 GB)
result[(2, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.449 GB, invar_size=1.931 GB, outvar_size=3.829 GB, temp_buffer_size=2.689 GB, available_memory=35.242 GB)
result[(2, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.449 GB, invar_size=1.931 GB, outvar_size=3.829 GB, temp_buffer_size=2.689 GB, available_memory=35.242 GB)
result[(3, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.939 GB, invar_size=1.736 GB, outvar_size=2.632 GB, temp_buffer_size=1.570 GB, available_memory=35.242 GB)
result[(3, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.202 GB, invar_size=6.357 GB, outvar_size=2.102 GB, temp_buffer_size=3.888 GB, available_memory=35.242 GB)
result[(3, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.202 GB, invar_size=6.357 GB, outvar_size=2.102 GB, temp_buffer_size=3.888 GB, available_memory=35.242 GB)
result[(3, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.496 GB, invar_size=1.920 GB, outvar_size=2.872 GB, temp_buffer_size=1.705 GB, available_memory=35.242 GB)
result[(4, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.827 GB, invar_size=4.685 GB, outvar_size=1.385 GB, temp_buffer_size=2.664 GB, available_memory=35.242 GB)
result[(4, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.827 GB, invar_size=4.685 GB, outvar_size=1.385 GB, temp_buffer_size=2.664 GB, available_memory=35.242 GB)
result[(3, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.496 GB, invar_size=1.920 GB, outvar_size=2.872 GB, temp_buffer_size=1.705 GB, available_memory=35.242 GB)
result[(4, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.432 GB, invar_size=5.290 GB, outvar_size=1.568 GB, temp_buffer_size=2.664 GB, available_memory=35.242 GB)
result[(4, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.432 GB, invar_size=5.290 GB, outvar_size=1.568 GB, temp_buffer_size=2.664 GB, available_memory=35.242 GB)
result[(4, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.358 GB, invar_size=1.386 GB, outvar_size=2.393 GB, temp_buffer_size=1.580 GB, available_memory=35.242 GB)
result[(3, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.052 GB, invar_size=2.103 GB, outvar_size=3.111 GB, temp_buffer_size=1.839 GB, available_memory=35.242 GB)
result[(4, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.040 GB, invar_size=5.896 GB, outvar_size=1.752 GB, temp_buffer_size=2.666 GB, available_memory=35.242 GB)
result[(4, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.358 GB, invar_size=1.386 GB, outvar_size=2.393 GB, temp_buffer_size=1.580 GB, available_memory=35.242 GB)
result[(3, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.052 GB, invar_size=2.103 GB, outvar_size=3.111 GB, temp_buffer_size=1.839 GB, available_memory=35.242 GB)
result[(4, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.040 GB, invar_size=5.896 GB, outvar_size=1.752 GB, temp_buffer_size=2.666 GB, available_memory=35.242 GB)
result[(4, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.915 GB, invar_size=1.569 GB, outvar_size=2.632 GB, temp_buffer_size=1.714 GB, available_memory=35.242 GB)
result[(5, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.863 GB, invar_size=4.720 GB, outvar_size=1.523 GB, temp_buffer_size=2.664 GB, available_memory=35.242 GB)
result[(5, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.863 GB, invar_size=4.720 GB, outvar_size=1.523 GB, temp_buffer_size=2.664 GB, available_memory=35.242 GB)
result[(4, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.915 GB, invar_size=1.569 GB, outvar_size=2.632 GB, temp_buffer_size=1.714 GB, available_memory=35.242 GB)
result[(5, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.468 GB, invar_size=5.326 GB, outvar_size=1.706 GB, temp_buffer_size=2.663 GB, available_memory=35.242 GB)
result[(5, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.468 GB, invar_size=5.326 GB, outvar_size=1.706 GB, temp_buffer_size=2.663 GB, available_memory=35.242 GB)
result[(4, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.411 GB, invar_size=1.753 GB, outvar_size=2.872 GB, temp_buffer_size=1.787 GB, available_memory=35.242 GB)
result[(5, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.391 GB, invar_size=1.524 GB, outvar_size=2.154 GB, temp_buffer_size=1.714 GB, available_memory=35.242 GB)
result[(4, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.411 GB, invar_size=1.753 GB, outvar_size=2.872 GB, temp_buffer_size=1.787 GB, available_memory=35.242 GB)
result[(5, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.391 GB, invar_size=1.524 GB, outvar_size=2.154 GB, temp_buffer_size=1.714 GB, available_memory=35.242 GB)
result[(5, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.346 GB, invar_size=7.203 GB, outvar_size=2.585 GB, temp_buffer_size=2.664 GB, available_memory=35.242 GB)
result[(5, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.887 GB, invar_size=1.707 GB, outvar_size=2.393 GB, temp_buffer_size=1.787 GB, available_memory=35.242 GB)
result[(5, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.346 GB, invar_size=7.203 GB, outvar_size=2.585 GB, temp_buffer_size=2.664 GB, available_memory=35.242 GB)
result[(5, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.931 GB, invar_size=8.788 GB, outvar_size=3.317 GB, temp_buffer_size=2.665 GB, available_memory=35.242 GB)
result[(5, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.887 GB, invar_size=1.707 GB, outvar_size=2.393 GB, temp_buffer_size=1.787 GB, available_memory=35.242 GB)
result[(5, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.931 GB, invar_size=8.788 GB, outvar_size=3.317 GB, temp_buffer_size=2.665 GB, available_memory=35.242 GB)
result[(6, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.419 GB, invar_size=4.756 GB, outvar_size=1.660 GB, temp_buffer_size=2.185 GB, available_memory=35.242 GB)
result[(6, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.419 GB, invar_size=4.756 GB, outvar_size=1.660 GB, temp_buffer_size=2.185 GB, available_memory=35.242 GB)
result[(5, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.415 GB, invar_size=2.586 GB, outvar_size=2.513 GB, temp_buffer_size=1.316 GB, available_memory=35.242 GB)
result[(6, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.362 GB, invar_size=1.661 GB, outvar_size=1.915 GB, temp_buffer_size=1.787 GB, available_memory=35.242 GB)
result[(5, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.415 GB, invar_size=2.586 GB, outvar_size=2.513 GB, temp_buffer_size=1.316 GB, available_memory=35.242 GB)
result[(6, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.297 GB, invar_size=6.633 GB, outvar_size=2.539 GB, temp_buffer_size=2.185 GB, available_memory=35.242 GB)
result[(6, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.362 GB, invar_size=1.661 GB, outvar_size=1.915 GB, temp_buffer_size=1.787 GB, available_memory=35.242 GB)
result[(6, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.297 GB, invar_size=6.633 GB, outvar_size=2.539 GB, temp_buffer_size=2.185 GB, available_memory=35.242 GB)
result[(5, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.378 GB, invar_size=3.319 GB, outvar_size=2.633 GB, temp_buffer_size=1.427 GB, available_memory=35.242 GB)
result[(6, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.882 GB, invar_size=8.218 GB, outvar_size=3.272 GB, temp_buffer_size=2.185 GB, available_memory=35.242 GB)
result[(5, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.378 GB, invar_size=3.319 GB, outvar_size=2.633 GB, temp_buffer_size=1.427 GB, available_memory=35.242 GB)
result[(6, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.890 GB, invar_size=2.540 GB, outvar_size=2.034 GB, temp_buffer_size=1.316 GB, available_memory=35.242 GB)
result[(6, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.882 GB, invar_size=8.218 GB, outvar_size=3.272 GB, temp_buffer_size=2.185 GB, available_memory=35.242 GB)
result[(6, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.426 GB, invar_size=9.761 GB, outvar_size=4.043 GB, temp_buffer_size=2.186 GB, available_memory=35.242 GB)
result[(6, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=12.426 GB, invar_size=9.761 GB, outvar_size=4.043 GB, temp_buffer_size=2.186 GB, available_memory=35.242 GB)
result[(7, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.637 GB, invar_size=6.063 GB, outvar_size=2.493 GB, temp_buffer_size=2.095 GB, available_memory=35.242 GB)
result[(6, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.890 GB, invar_size=2.540 GB, outvar_size=2.034 GB, temp_buffer_size=1.316 GB, available_memory=35.242 GB)
result[(7, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.637 GB, invar_size=6.063 GB, outvar_size=2.493 GB, temp_buffer_size=2.095 GB, available_memory=35.242 GB)
result[(6, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.854 GB, invar_size=3.273 GB, outvar_size=2.154 GB, temp_buffer_size=1.427 GB, available_memory=35.242 GB)
result[(7, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.222 GB, invar_size=7.648 GB, outvar_size=3.226 GB, temp_buffer_size=2.095 GB, available_memory=35.242 GB)
result[(6, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.854 GB, invar_size=3.273 GB, outvar_size=2.154 GB, temp_buffer_size=1.427 GB, available_memory=35.242 GB)
result[(7, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.366 GB, invar_size=2.495 GB, outvar_size=1.556 GB, temp_buffer_size=1.316 GB, available_memory=35.242 GB)
result[(6, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.494 GB, invar_size=4.045 GB, outvar_size=2.154 GB, temp_buffer_size=1.295 GB, available_memory=35.242 GB)
result[(6, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.494 GB, invar_size=4.045 GB, outvar_size=2.154 GB, temp_buffer_size=1.295 GB, available_memory=35.242 GB)
result[(7, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.222 GB, invar_size=7.648 GB, outvar_size=3.226 GB, temp_buffer_size=2.095 GB, available_memory=35.242 GB)
result[(7, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.366 GB, invar_size=2.495 GB, outvar_size=1.556 GB, temp_buffer_size=1.316 GB, available_memory=35.242 GB)
result[(7, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.765 GB, invar_size=9.191 GB, outvar_size=3.998 GB, temp_buffer_size=2.096 GB, available_memory=35.242 GB)
result[(7, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=11.765 GB, invar_size=9.191 GB, outvar_size=3.998 GB, temp_buffer_size=2.096 GB, available_memory=35.242 GB)
result[(8, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.761 GB, invar_size=6.730 GB, outvar_size=2.767 GB, temp_buffer_size=1.792 GB, available_memory=35.242 GB)
result[(7, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.329 GB, invar_size=3.227 GB, outvar_size=1.676 GB, temp_buffer_size=1.427 GB, available_memory=35.242 GB)
result[(8, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.761 GB, invar_size=6.730 GB, outvar_size=2.767 GB, temp_buffer_size=1.792 GB, available_memory=35.242 GB)
result[(8, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.306 GB, invar_size=8.273 GB, outvar_size=3.538 GB, temp_buffer_size=1.793 GB, available_memory=35.242 GB)
result[(7, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.329 GB, invar_size=3.227 GB, outvar_size=1.676 GB, temp_buffer_size=1.427 GB, available_memory=35.242 GB)
result[(8, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.391 GB, invar_size=2.768 GB, outvar_size=1.436 GB, temp_buffer_size=1.188 GB, available_memory=35.242 GB)
result[(8, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=10.306 GB, invar_size=8.273 GB, outvar_size=3.538 GB, temp_buffer_size=1.793 GB, available_memory=35.242 GB)
result[(8, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.391 GB, invar_size=2.768 GB, outvar_size=1.436 GB, temp_buffer_size=1.188 GB, available_memory=35.242 GB)
result[(7, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.008 GB, invar_size=3.999 GB, outvar_size=1.676 GB, temp_buffer_size=1.334 GB, available_memory=35.242 GB)
result[(9, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.699 GB, invar_size=7.667 GB, outvar_size=3.355 GB, temp_buffer_size=1.792 GB, available_memory=35.242 GB)
result[(7, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.008 GB, invar_size=3.999 GB, outvar_size=1.676 GB, temp_buffer_size=1.334 GB, available_memory=35.242 GB)
result[(9, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=9.699 GB, invar_size=7.667 GB, outvar_size=3.355 GB, temp_buffer_size=1.792 GB, available_memory=35.242 GB)
result[(8, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.044 GB, invar_size=3.540 GB, outvar_size=1.436 GB, temp_buffer_size=1.068 GB, available_memory=35.242 GB)
result[(8, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.044 GB, invar_size=3.540 GB, outvar_size=1.436 GB, temp_buffer_size=1.068 GB, available_memory=35.242 GB)
result[(9, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.369 GB, invar_size=3.357 GB, outvar_size=1.197 GB, temp_buffer_size=0.816 GB, available_memory=35.242 GB)
result[(9, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.369 GB, invar_size=3.357 GB, outvar_size=1.197 GB, temp_buffer_size=0.816 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 208.63 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-17-15-36-21.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2, 3, 4, 5, 6, 7, 8], [9, 10, 11, 12, 13, 14, 15]]
Result mesh_shapes: [(1, 1), (1, 1)]
Result logical_mesh_shapes: [(1, 1), (1, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {}]
 - Compile (driver): 263.58 s
compilation time breakdown: {'stage-construction': '245.74', 'stage-construction-dp': '1.10', 'stage-construction-compilation': '23.02', 'stage-construction-profiling': '155.28'}
 - Compile (worker): 19.70 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
[E] Meet unexpected error in profiling executables...

[E] Unexpected error occurred in compiling or profiling executables...
[E] Meet unexpected error in compiling and executing model...
[TMP] Current profiling results of key `1_a40_1_n_2_d`: none
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/wide_resnet_1B_1024.pkl`...
