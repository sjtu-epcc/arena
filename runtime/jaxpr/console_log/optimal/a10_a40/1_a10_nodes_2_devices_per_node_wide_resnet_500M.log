
------------------------------------------------------------------
- (1/3) Profiling wide_resnet_500M with batch size: 256...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/wide_resnet_500M_256.pkl`, updating/rewriting it...
[TMP] Key `1_a10_1_n_2_d` has been profiled in `./jaxpr/prof_log/optimal/wide_resnet_500M_256.pkl` when optimizing with alpa, loading cache...

------------------------------------------------------------------
- (2/3) Profiling wide_resnet_500M with batch size: 512...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/wide_resnet_500M_512.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 1
[I] Loading flax model....
[I] Model 'wide_resnet' loads sucessfully. Model Info: 

WideResNet(
    # attributes
    stage_sizes = [3, 4, 6, 3]
    block_cls = BottleneckResNetBlock
    num_classes = 1024
    num_filters = 224
    width_factor = 2
    dtype = float32
    act = relu
) 

[I] Manually construct dummy batch with the shape of (512, 224, 224, 3).
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2))
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 15, 1, 0), 0] = ModuleProfileResult(compute_cost=0.002, peak_memory=3.870 GB, invar_size=1.854 GB, outvar_size=1.089 GB, temp_buffer_size=0.928 GB, available_memory=19.578 GB)
result[(0, 15, 1, 0), 1] = ModuleProfileResult(compute_cost=0.039, peak_memory=7.227 GB, invar_size=4.786 GB, outvar_size=1.844 GB, temp_buffer_size=2.441 GB, available_memory=19.578 GB)
result[(0, 15, 1, 2), 0] = ModuleProfileResult(compute_cost=0.061, peak_memory=3.234 GB, invar_size=1.266 GB, outvar_size=1.131 GB, temp_buffer_size=0.838 GB, available_memory=19.578 GB)
result[(0, 15, 1, 1), 1] = ModuleProfileResult(compute_cost=0.742, peak_memory=5.174 GB, invar_size=3.328 GB, outvar_size=0.922 GB, temp_buffer_size=1.846 GB, available_memory=19.578 GB)
result[(0, 15, 1, 2), 1] = ModuleProfileResult(compute_cost=0.077, peak_memory=5.134 GB, invar_size=3.652 GB, outvar_size=1.256 GB, temp_buffer_size=1.482 GB, available_memory=19.578 GB)
result[(0, 15, 1, 1), 0] = ModuleProfileResult(compute_cost=0.512, peak_memory=3.244 GB, invar_size=0.941 GB, outvar_size=1.466 GB, temp_buffer_size=0.837 GB, available_memory=19.578 GB)
Profiling for submesh 1 (1, 2) takes 40.35 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.899 GB, invar_size=2.131 GB, outvar_size=0.219 GB, temp_buffer_size=2.768 GB, available_memory=19.578 GB)
result[(0, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.600 GB, invar_size=1.832 GB, outvar_size=0.111 GB, temp_buffer_size=2.768 GB, available_memory=19.578 GB)
result[(0, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.600 GB, invar_size=1.832 GB, outvar_size=0.111 GB, temp_buffer_size=2.768 GB, available_memory=19.578 GB)
result[(0, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.899 GB, invar_size=2.131 GB, outvar_size=0.219 GB, temp_buffer_size=2.768 GB, available_memory=19.578 GB)
result[(0, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.163 GB, invar_size=2.394 GB, outvar_size=0.309 GB, temp_buffer_size=2.768 GB, available_memory=19.578 GB)
result[(1, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.574 GB, invar_size=1.807 GB, outvar_size=0.359 GB, temp_buffer_size=2.516 GB, available_memory=19.578 GB)
result[(0, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.163 GB, invar_size=2.394 GB, outvar_size=0.309 GB, temp_buffer_size=2.768 GB, available_memory=19.578 GB)
result[(1, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.574 GB, invar_size=1.807 GB, outvar_size=0.359 GB, temp_buffer_size=2.516 GB, available_memory=19.578 GB)
result[(1, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.874 GB, invar_size=2.106 GB, outvar_size=0.467 GB, temp_buffer_size=2.516 GB, available_memory=19.578 GB)
result[(1, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.874 GB, invar_size=2.106 GB, outvar_size=0.467 GB, temp_buffer_size=2.516 GB, available_memory=19.578 GB)
result[(0, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.477 GB, invar_size=0.130 GB, outvar_size=1.591 GB, temp_buffer_size=0.756 GB, available_memory=19.578 GB)
result[(0, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.477 GB, invar_size=0.130 GB, outvar_size=1.591 GB, temp_buffer_size=0.756 GB, available_memory=19.578 GB)
result[(1, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.449 GB, invar_size=0.359 GB, outvar_size=1.340 GB, temp_buffer_size=0.750 GB, available_memory=19.578 GB)
result[(1, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.449 GB, invar_size=0.359 GB, outvar_size=1.340 GB, temp_buffer_size=0.750 GB, available_memory=19.578 GB)
result[(0, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.770 GB, invar_size=0.238 GB, outvar_size=1.675 GB, temp_buffer_size=0.858 GB, available_memory=19.578 GB)
result[(1, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.137 GB, invar_size=2.369 GB, outvar_size=0.557 GB, temp_buffer_size=2.517 GB, available_memory=19.578 GB)
result[(0, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.770 GB, invar_size=0.238 GB, outvar_size=1.675 GB, temp_buffer_size=0.858 GB, available_memory=19.578 GB)
result[(1, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.137 GB, invar_size=2.369 GB, outvar_size=0.557 GB, temp_buffer_size=2.517 GB, available_memory=19.578 GB)
result[(0, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.040 GB, invar_size=0.327 GB, outvar_size=1.759 GB, temp_buffer_size=0.954 GB, available_memory=19.578 GB)
result[(1, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.755 GB, invar_size=0.467 GB, outvar_size=1.424 GB, temp_buffer_size=0.864 GB, available_memory=19.578 GB)
result[(0, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.040 GB, invar_size=0.327 GB, outvar_size=1.759 GB, temp_buffer_size=0.954 GB, available_memory=19.578 GB)
result[(1, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.400 GB, invar_size=2.632 GB, outvar_size=0.646 GB, temp_buffer_size=2.517 GB, available_memory=19.578 GB)
result[(1, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.400 GB, invar_size=2.632 GB, outvar_size=0.646 GB, temp_buffer_size=2.517 GB, available_memory=19.578 GB)
result[(1, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.755 GB, invar_size=0.467 GB, outvar_size=1.424 GB, temp_buffer_size=0.864 GB, available_memory=19.578 GB)
result[(2, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.020 GB, invar_size=1.839 GB, outvar_size=0.543 GB, temp_buffer_size=1.846 GB, available_memory=19.578 GB)
result[(2, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.020 GB, invar_size=1.839 GB, outvar_size=0.543 GB, temp_buffer_size=1.846 GB, available_memory=19.578 GB)
result[(2, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.284 GB, invar_size=2.102 GB, outvar_size=0.632 GB, temp_buffer_size=1.847 GB, available_memory=19.578 GB)
result[(2, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.284 GB, invar_size=2.102 GB, outvar_size=0.632 GB, temp_buffer_size=1.847 GB, available_memory=19.578 GB)
result[(2, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.547 GB, invar_size=2.365 GB, outvar_size=0.722 GB, temp_buffer_size=1.847 GB, available_memory=19.578 GB)
result[(2, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.491 GB, invar_size=0.543 GB, outvar_size=1.089 GB, temp_buffer_size=0.860 GB, available_memory=19.578 GB)
result[(2, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.547 GB, invar_size=2.365 GB, outvar_size=0.722 GB, temp_buffer_size=1.847 GB, available_memory=19.578 GB)
result[(1, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.015 GB, invar_size=0.557 GB, outvar_size=1.508 GB, temp_buffer_size=0.950 GB, available_memory=19.578 GB)
result[(2, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.491 GB, invar_size=0.543 GB, outvar_size=1.089 GB, temp_buffer_size=0.860 GB, available_memory=19.578 GB)
result[(1, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.015 GB, invar_size=0.557 GB, outvar_size=1.508 GB, temp_buffer_size=0.950 GB, available_memory=19.578 GB)
result[(2, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.811 GB, invar_size=2.629 GB, outvar_size=0.812 GB, temp_buffer_size=1.847 GB, available_memory=19.578 GB)
result[(2, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.753 GB, invar_size=0.633 GB, outvar_size=1.173 GB, temp_buffer_size=0.948 GB, available_memory=19.578 GB)
result[(2, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.753 GB, invar_size=0.633 GB, outvar_size=1.173 GB, temp_buffer_size=0.948 GB, available_memory=19.578 GB)
result[(2, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.811 GB, invar_size=2.629 GB, outvar_size=0.812 GB, temp_buffer_size=1.847 GB, available_memory=19.578 GB)
result[(3, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.721 GB, invar_size=2.019 GB, outvar_size=0.717 GB, temp_buffer_size=1.366 GB, available_memory=19.578 GB)
result[(1, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.224 GB, invar_size=0.647 GB, outvar_size=1.591 GB, temp_buffer_size=0.986 GB, available_memory=19.578 GB)
result[(3, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.721 GB, invar_size=2.019 GB, outvar_size=0.717 GB, temp_buffer_size=1.366 GB, available_memory=19.578 GB)
result[(1, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.224 GB, invar_size=0.647 GB, outvar_size=1.591 GB, temp_buffer_size=0.986 GB, available_memory=19.578 GB)
result[(2, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.963 GB, invar_size=0.723 GB, outvar_size=1.256 GB, temp_buffer_size=0.984 GB, available_memory=19.578 GB)
result[(3, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.984 GB, invar_size=2.283 GB, outvar_size=0.806 GB, temp_buffer_size=1.366 GB, available_memory=19.578 GB)
result[(3, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.984 GB, invar_size=2.283 GB, outvar_size=0.806 GB, temp_buffer_size=1.366 GB, available_memory=19.578 GB)
result[(2, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.963 GB, invar_size=0.723 GB, outvar_size=1.256 GB, temp_buffer_size=0.984 GB, available_memory=19.578 GB)
result[(3, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.247 GB, invar_size=2.546 GB, outvar_size=0.896 GB, temp_buffer_size=1.367 GB, available_memory=19.578 GB)
result[(3, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.247 GB, invar_size=2.546 GB, outvar_size=0.896 GB, temp_buffer_size=1.367 GB, available_memory=19.578 GB)
result[(3, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.274 GB, invar_size=0.717 GB, outvar_size=0.921 GB, temp_buffer_size=0.636 GB, available_memory=19.578 GB)
result[(4, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.998 GB, invar_size=1.894 GB, outvar_size=0.612 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(2, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.202 GB, invar_size=0.813 GB, outvar_size=1.340 GB, temp_buffer_size=1.050 GB, available_memory=19.578 GB)
result[(4, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.998 GB, invar_size=1.894 GB, outvar_size=0.612 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(3, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.274 GB, invar_size=0.717 GB, outvar_size=0.921 GB, temp_buffer_size=0.636 GB, available_memory=19.578 GB)
result[(2, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.202 GB, invar_size=0.813 GB, outvar_size=1.340 GB, temp_buffer_size=1.050 GB, available_memory=19.578 GB)
result[(4, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.261 GB, invar_size=2.157 GB, outvar_size=0.702 GB, temp_buffer_size=0.936 GB, available_memory=19.578 GB)
result[(4, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.261 GB, invar_size=2.157 GB, outvar_size=0.702 GB, temp_buffer_size=0.936 GB, available_memory=19.578 GB)
result[(3, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.513 GB, invar_size=0.807 GB, outvar_size=1.005 GB, temp_buffer_size=0.701 GB, available_memory=19.578 GB)
result[(3, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.513 GB, invar_size=0.807 GB, outvar_size=1.005 GB, temp_buffer_size=0.701 GB, available_memory=19.578 GB)
result[(4, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.090 GB, invar_size=0.612 GB, outvar_size=0.838 GB, temp_buffer_size=0.640 GB, available_memory=19.578 GB)
result[(4, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.525 GB, invar_size=2.420 GB, outvar_size=0.791 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(4, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.525 GB, invar_size=2.420 GB, outvar_size=0.791 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(4, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.090 GB, invar_size=0.612 GB, outvar_size=0.838 GB, temp_buffer_size=0.640 GB, available_memory=19.578 GB)
result[(4, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.428 GB, invar_size=3.324 GB, outvar_size=1.222 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(3, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.753 GB, invar_size=0.897 GB, outvar_size=1.089 GB, temp_buffer_size=0.767 GB, available_memory=19.578 GB)
result[(3, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.753 GB, invar_size=0.897 GB, outvar_size=1.089 GB, temp_buffer_size=0.767 GB, available_memory=19.578 GB)
result[(4, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.428 GB, invar_size=3.324 GB, outvar_size=1.222 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(5, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.049 GB, invar_size=1.945 GB, outvar_size=0.679 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(4, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.329 GB, invar_size=0.702 GB, outvar_size=0.921 GB, temp_buffer_size=0.706 GB, available_memory=19.578 GB)
result[(5, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.049 GB, invar_size=1.945 GB, outvar_size=0.679 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(5, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.312 GB, invar_size=2.208 GB, outvar_size=0.769 GB, temp_buffer_size=0.936 GB, available_memory=19.578 GB)
result[(4, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.329 GB, invar_size=0.702 GB, outvar_size=0.921 GB, temp_buffer_size=0.706 GB, available_memory=19.578 GB)
result[(5, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.312 GB, invar_size=2.208 GB, outvar_size=0.769 GB, temp_buffer_size=0.936 GB, available_memory=19.578 GB)
result[(5, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.216 GB, invar_size=3.111 GB, outvar_size=1.200 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(4, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.539 GB, invar_size=0.792 GB, outvar_size=1.005 GB, temp_buffer_size=0.742 GB, available_memory=19.578 GB)
result[(4, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.539 GB, invar_size=0.792 GB, outvar_size=1.005 GB, temp_buffer_size=0.742 GB, available_memory=19.578 GB)
result[(5, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.216 GB, invar_size=3.111 GB, outvar_size=1.200 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(5, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.769 GB, invar_size=0.680 GB, outvar_size=0.754 GB, temp_buffer_size=0.335 GB, available_memory=19.578 GB)
result[(5, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.769 GB, invar_size=0.680 GB, outvar_size=0.754 GB, temp_buffer_size=0.335 GB, available_memory=19.578 GB)
result[(5, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.976 GB, invar_size=3.871 GB, outvar_size=1.559 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(5, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.976 GB, invar_size=3.871 GB, outvar_size=1.559 GB, temp_buffer_size=0.937 GB, available_memory=19.578 GB)
result[(4, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.221 GB, invar_size=1.223 GB, outvar_size=1.047 GB, temp_buffer_size=0.951 GB, available_memory=19.578 GB)
result[(5, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.942 GB, invar_size=0.770 GB, outvar_size=0.838 GB, temp_buffer_size=0.335 GB, available_memory=19.578 GB)
result[(6, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.932 GB, invar_size=1.995 GB, outvar_size=0.747 GB, temp_buffer_size=0.769 GB, available_memory=19.578 GB)
result[(5, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.942 GB, invar_size=0.770 GB, outvar_size=0.838 GB, temp_buffer_size=0.335 GB, available_memory=19.578 GB)
result[(4, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.221 GB, invar_size=1.223 GB, outvar_size=1.047 GB, temp_buffer_size=0.951 GB, available_memory=19.578 GB)
result[(6, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.932 GB, invar_size=1.995 GB, outvar_size=0.747 GB, temp_buffer_size=0.769 GB, available_memory=19.578 GB)
result[(6, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.851 GB, invar_size=2.899 GB, outvar_size=1.177 GB, temp_buffer_size=0.784 GB, available_memory=19.578 GB)
result[(6, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.851 GB, invar_size=2.899 GB, outvar_size=1.177 GB, temp_buffer_size=0.784 GB, available_memory=19.578 GB)
result[(6, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.612 GB, invar_size=3.659 GB, outvar_size=1.536 GB, temp_buffer_size=0.785 GB, available_memory=19.578 GB)
result[(5, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.589 GB, invar_size=1.201 GB, outvar_size=0.880 GB, temp_buffer_size=0.509 GB, available_memory=19.578 GB)
result[(5, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.589 GB, invar_size=1.201 GB, outvar_size=0.880 GB, temp_buffer_size=0.509 GB, available_memory=19.578 GB)
result[(6, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.752 GB, invar_size=0.747 GB, outvar_size=0.670 GB, temp_buffer_size=0.335 GB, available_memory=19.578 GB)
result[(6, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.612 GB, invar_size=3.659 GB, outvar_size=1.536 GB, temp_buffer_size=0.785 GB, available_memory=19.578 GB)
result[(6, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.752 GB, invar_size=0.747 GB, outvar_size=0.670 GB, temp_buffer_size=0.335 GB, available_memory=19.578 GB)
result[(6, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.383 GB, invar_size=4.431 GB, outvar_size=1.923 GB, temp_buffer_size=0.785 GB, available_memory=19.578 GB)
result[(5, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.032 GB, invar_size=1.560 GB, outvar_size=0.922 GB, temp_buffer_size=0.551 GB, available_memory=19.578 GB)
result[(6, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.383 GB, invar_size=4.431 GB, outvar_size=1.923 GB, temp_buffer_size=0.785 GB, available_memory=19.578 GB)
result[(7, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.610 GB, invar_size=2.686 GB, outvar_size=1.155 GB, temp_buffer_size=0.756 GB, available_memory=19.578 GB)
result[(6, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.399 GB, invar_size=1.178 GB, outvar_size=0.712 GB, temp_buffer_size=0.509 GB, available_memory=19.578 GB)
result[(5, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.032 GB, invar_size=1.560 GB, outvar_size=0.922 GB, temp_buffer_size=0.551 GB, available_memory=19.578 GB)
result[(7, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.610 GB, invar_size=2.686 GB, outvar_size=1.155 GB, temp_buffer_size=0.756 GB, available_memory=19.578 GB)
result[(6, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.399 GB, invar_size=1.178 GB, outvar_size=0.712 GB, temp_buffer_size=0.509 GB, available_memory=19.578 GB)
result[(7, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.370 GB, invar_size=3.446 GB, outvar_size=1.514 GB, temp_buffer_size=0.756 GB, available_memory=19.578 GB)
result[(7, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.370 GB, invar_size=3.446 GB, outvar_size=1.514 GB, temp_buffer_size=0.756 GB, available_memory=19.578 GB)
result[(7, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.143 GB, invar_size=4.219 GB, outvar_size=1.900 GB, temp_buffer_size=0.756 GB, available_memory=19.578 GB)
result[(6, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.842 GB, invar_size=1.537 GB, outvar_size=0.754 GB, temp_buffer_size=0.551 GB, available_memory=19.578 GB)
result[(7, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.143 GB, invar_size=4.219 GB, outvar_size=1.900 GB, temp_buffer_size=0.756 GB, available_memory=19.578 GB)
result[(7, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.209 GB, invar_size=1.156 GB, outvar_size=0.545 GB, temp_buffer_size=0.509 GB, available_memory=19.578 GB)
result[(6, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.842 GB, invar_size=1.537 GB, outvar_size=0.754 GB, temp_buffer_size=0.551 GB, available_memory=19.578 GB)
result[(7, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.209 GB, invar_size=1.156 GB, outvar_size=0.545 GB, temp_buffer_size=0.509 GB, available_memory=19.578 GB)
result[(8, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.896 GB, invar_size=3.063 GB, outvar_size=1.322 GB, temp_buffer_size=0.749 GB, available_memory=19.578 GB)
result[(8, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.896 GB, invar_size=3.063 GB, outvar_size=1.322 GB, temp_buffer_size=0.749 GB, available_memory=19.578 GB)
result[(6, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.193 GB, invar_size=1.924 GB, outvar_size=0.754 GB, temp_buffer_size=0.515 GB, available_memory=19.578 GB)
result[(6, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.193 GB, invar_size=1.924 GB, outvar_size=0.754 GB, temp_buffer_size=0.515 GB, available_memory=19.578 GB)
result[(8, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.669 GB, invar_size=3.836 GB, outvar_size=1.709 GB, temp_buffer_size=0.750 GB, available_memory=19.578 GB)
result[(7, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.652 GB, invar_size=1.515 GB, outvar_size=0.587 GB, temp_buffer_size=0.551 GB, available_memory=19.578 GB)
result[(8, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.669 GB, invar_size=3.836 GB, outvar_size=1.709 GB, temp_buffer_size=0.750 GB, available_memory=19.578 GB)
result[(7, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.652 GB, invar_size=1.515 GB, outvar_size=0.587 GB, temp_buffer_size=0.551 GB, available_memory=19.578 GB)
result[(9, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.406 GB, invar_size=3.573 GB, outvar_size=1.619 GB, temp_buffer_size=0.749 GB, available_memory=19.578 GB)
result[(9, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.406 GB, invar_size=3.573 GB, outvar_size=1.619 GB, temp_buffer_size=0.749 GB, available_memory=19.578 GB)
result[(7, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.007 GB, invar_size=1.901 GB, outvar_size=0.587 GB, temp_buffer_size=0.519 GB, available_memory=19.578 GB)
result[(8, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.293 GB, invar_size=1.323 GB, outvar_size=0.503 GB, temp_buffer_size=0.467 GB, available_memory=19.578 GB)
result[(8, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.293 GB, invar_size=1.323 GB, outvar_size=0.503 GB, temp_buffer_size=0.467 GB, available_memory=19.578 GB)
result[(7, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.007 GB, invar_size=1.901 GB, outvar_size=0.587 GB, temp_buffer_size=0.519 GB, available_memory=19.578 GB)
result[(8, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.648 GB, invar_size=1.710 GB, outvar_size=0.503 GB, temp_buffer_size=0.436 GB, available_memory=19.578 GB)
result[(9, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.386 GB, invar_size=1.620 GB, outvar_size=0.419 GB, temp_buffer_size=0.347 GB, available_memory=19.578 GB)
result[(9, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.386 GB, invar_size=1.620 GB, outvar_size=0.419 GB, temp_buffer_size=0.347 GB, available_memory=19.578 GB)
result[(8, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.648 GB, invar_size=1.710 GB, outvar_size=0.503 GB, temp_buffer_size=0.436 GB, available_memory=19.578 GB)
Profiling for submesh 0 (1, 1) takes 145.91 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-15-20-24-36.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2, 3, 4, 5, 6, 7, 8], [9, 10, 11, 12, 13, 14, 15]]
Result mesh_shapes: [(1, 1), (1, 1)]
Result logical_mesh_shapes: [(1, 1), (1, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {}]
 - Compile (driver): 206.42 s
compilation time breakdown: {'stage-construction': '188.77', 'stage-construction-dp': '1.12', 'stage-construction-compilation': '20.88', 'stage-construction-profiling': '109.62'}
 - Compile (worker): 18.18 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
[E] Meet unexpected error in profiling executables...

[E] Unexpected error occurred in compiling or profiling executables...
[E] Meet unexpected error in compiling and executing model...
[TMP] Current profiling results of key `1_a10_1_n_2_d`: none
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/wide_resnet_500M_512.pkl`...

------------------------------------------------------------------
- (3/3) Profiling wide_resnet_500M with batch size: 1024...
------------------------------------------------------------------
