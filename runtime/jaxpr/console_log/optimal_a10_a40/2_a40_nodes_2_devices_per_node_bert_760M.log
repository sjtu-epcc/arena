
------------------------------------------------------------------
- (1/3) Profiling bert_760M with batch size: 128...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/bert_760M_128.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 2
[I] Loading flax model....
[I] Model 'bert' loads sucessfully. Model Info: 

FlaxBertForMaskedLMModule(
    # attributes
    config = <model.bert_model.BertConfig object at 0x7f2381132e80>
    dtype = float16
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2))
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.446 GB, invar_size=1.221 GB, outvar_size=0.029 GB, temp_buffer_size=0.195 GB, available_memory=35.242 GB)
result[(0, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.100, peak_memory=0.859 GB, invar_size=0.611 GB, outvar_size=0.053 GB, temp_buffer_size=0.195 GB, available_memory=35.242 GB)
result[(0, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.046, peak_memory=1.358 GB, invar_size=1.110 GB, outvar_size=0.029 GB, temp_buffer_size=0.219 GB, available_memory=35.242 GB)
result[(0, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.177, peak_memory=4.726 GB, invar_size=3.160 GB, outvar_size=1.565 GB, temp_buffer_size=1.566 GB, available_memory=35.242 GB)
result[(0, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.335, peak_memory=2.841 GB, invar_size=1.619 GB, outvar_size=0.783 GB, temp_buffer_size=1.222 GB, available_memory=35.242 GB)
result[(0, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.207, peak_memory=4.234 GB, invar_size=2.718 GB, outvar_size=1.345 GB, temp_buffer_size=1.515 GB, available_memory=35.242 GB)
Profiling for submesh 2 (2, 2) takes 134.82 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(1, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=0.858 GB, invar_size=0.663 GB, outvar_size=0.035 GB, temp_buffer_size=0.160 GB, available_memory=35.242 GB)
result[(1, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.114, peak_memory=0.579 GB, invar_size=0.349 GB, outvar_size=0.059 GB, temp_buffer_size=0.172 GB, available_memory=35.242 GB)
result[(1, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.036, peak_memory=1.081 GB, invar_size=0.874 GB, outvar_size=0.047 GB, temp_buffer_size=0.160 GB, available_memory=35.242 GB)
result[(0, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.035, peak_memory=1.174 GB, invar_size=0.725 GB, outvar_size=0.035 GB, temp_buffer_size=0.414 GB, available_memory=35.242 GB)
result[(0, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.122, peak_memory=0.849 GB, invar_size=0.400 GB, outvar_size=0.059 GB, temp_buffer_size=0.391 GB, available_memory=35.242 GB)
result[(1, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=0.858 GB, invar_size=0.663 GB, outvar_size=0.035 GB, temp_buffer_size=0.160 GB, available_memory=35.242 GB)
result[(1, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.151, peak_memory=0.709 GB, invar_size=0.455 GB, outvar_size=0.082 GB, temp_buffer_size=0.172 GB, available_memory=35.242 GB)
result[(0, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.032, peak_memory=1.225 GB, invar_size=0.799 GB, outvar_size=0.035 GB, temp_buffer_size=0.391 GB, available_memory=35.242 GB)
result[(2, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=0.858 GB, invar_size=0.663 GB, outvar_size=0.035 GB, temp_buffer_size=0.160 GB, available_memory=35.242 GB)
result[(1, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.036, peak_memory=1.081 GB, invar_size=0.874 GB, outvar_size=0.047 GB, temp_buffer_size=0.160 GB, available_memory=35.242 GB)
result[(2, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=0.858 GB, invar_size=0.663 GB, outvar_size=0.035 GB, temp_buffer_size=0.160 GB, available_memory=35.242 GB)
result[(2, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.114, peak_memory=0.579 GB, invar_size=0.349 GB, outvar_size=0.059 GB, temp_buffer_size=0.172 GB, available_memory=35.242 GB)
result[(1, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.087, peak_memory=3.444 GB, invar_size=1.349 GB, outvar_size=0.663 GB, temp_buffer_size=2.084 GB, available_memory=35.242 GB)
result[(1, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.087, peak_memory=3.444 GB, invar_size=1.349 GB, outvar_size=0.663 GB, temp_buffer_size=2.084 GB, available_memory=35.242 GB)
result[(3, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.017, peak_memory=0.618 GB, invar_size=0.434 GB, outvar_size=0.023 GB, temp_buffer_size=0.160 GB, available_memory=35.242 GB)
result[(3, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.075, peak_memory=0.453 GB, invar_size=0.235 GB, outvar_size=0.047 GB, temp_buffer_size=0.172 GB, available_memory=35.242 GB)
result[(1, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=0.256, peak_memory=3.456 GB, invar_size=0.745 GB, outvar_size=0.349 GB, temp_buffer_size=2.688 GB, available_memory=35.242 GB)
result[(0, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.097, peak_memory=3.850 GB, invar_size=1.633 GB, outvar_size=0.799 GB, temp_buffer_size=2.217 GB, available_memory=35.242 GB)
result[(0, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=0.265, peak_memory=3.613 GB, invar_size=0.869 GB, outvar_size=0.400 GB, temp_buffer_size=2.744 GB, available_memory=35.242 GB)
result[(3, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.017, peak_memory=0.618 GB, invar_size=0.434 GB, outvar_size=0.023 GB, temp_buffer_size=0.160 GB, available_memory=35.242 GB)
result[(0, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.100, peak_memory=3.726 GB, invar_size=1.497 GB, outvar_size=0.725 GB, temp_buffer_size=2.229 GB, available_memory=35.242 GB)
result[(1, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.114, peak_memory=3.878 GB, invar_size=1.782 GB, outvar_size=0.874 GB, temp_buffer_size=2.084 GB, available_memory=35.242 GB)
result[(2, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.087, peak_memory=3.444 GB, invar_size=1.349 GB, outvar_size=0.663 GB, temp_buffer_size=2.084 GB, available_memory=35.242 GB)
result[(2, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.256, peak_memory=3.556 GB, invar_size=0.745 GB, outvar_size=0.349 GB, temp_buffer_size=2.788 GB, available_memory=35.242 GB)
result[(2, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.087, peak_memory=3.444 GB, invar_size=1.349 GB, outvar_size=0.663 GB, temp_buffer_size=2.084 GB, available_memory=35.242 GB)
result[(1, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.339, peak_memory=3.895 GB, invar_size=0.979 GB, outvar_size=0.455 GB, temp_buffer_size=2.892 GB, available_memory=35.242 GB)
result[(3, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.096, peak_memory=3.804 GB, invar_size=1.568 GB, outvar_size=0.778 GB, temp_buffer_size=2.224 GB, available_memory=35.242 GB)
result[(1, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.114, peak_memory=3.878 GB, invar_size=1.782 GB, outvar_size=0.874 GB, temp_buffer_size=2.084 GB, available_memory=35.242 GB)
result[(3, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=0.262, peak_memory=3.249 GB, invar_size=0.837 GB, outvar_size=0.407 GB, temp_buffer_size=2.388 GB, available_memory=35.242 GB)
result[(3, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.100, peak_memory=3.669 GB, invar_size=1.422 GB, outvar_size=0.705 GB, temp_buffer_size=2.236 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 60.42 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.025, peak_memory=1.172 GB, invar_size=0.359 GB, outvar_size=0.023 GB, temp_buffer_size=0.789 GB, available_memory=35.242 GB)
result[(1, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.033, peak_memory=0.830 GB, invar_size=0.463 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(1, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.033, peak_memory=0.830 GB, invar_size=0.463 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.065, peak_memory=5.151 GB, invar_size=0.742 GB, outvar_size=0.359 GB, temp_buffer_size=4.410 GB, available_memory=35.242 GB)
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.025, peak_memory=1.172 GB, invar_size=0.359 GB, outvar_size=0.023 GB, temp_buffer_size=0.789 GB, available_memory=35.242 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.065, peak_memory=5.151 GB, invar_size=0.742 GB, outvar_size=0.359 GB, temp_buffer_size=4.410 GB, available_memory=35.242 GB)
result[(2, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.033, peak_memory=0.830 GB, invar_size=0.463 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(2, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.033, peak_memory=0.830 GB, invar_size=0.463 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(3, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.031, peak_memory=0.813 GB, invar_size=0.446 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(3, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.031, peak_memory=0.813 GB, invar_size=0.446 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(1, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.099, peak_memory=5.515 GB, invar_size=0.950 GB, outvar_size=0.463 GB, temp_buffer_size=4.542 GB, available_memory=35.242 GB)
result[(1, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.099, peak_memory=5.515 GB, invar_size=0.950 GB, outvar_size=0.463 GB, temp_buffer_size=4.542 GB, available_memory=35.242 GB)
result[(2, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.099, peak_memory=5.920 GB, invar_size=0.950 GB, outvar_size=0.463 GB, temp_buffer_size=4.947 GB, available_memory=35.242 GB)
result[(2, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.099, peak_memory=5.920 GB, invar_size=0.950 GB, outvar_size=0.463 GB, temp_buffer_size=4.947 GB, available_memory=35.242 GB)
result[(3, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.094, peak_memory=5.361 GB, invar_size=0.915 GB, outvar_size=0.446 GB, temp_buffer_size=4.423 GB, available_memory=35.242 GB)
result[(3, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.094, peak_memory=5.361 GB, invar_size=0.915 GB, outvar_size=0.446 GB, temp_buffer_size=4.423 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 21.24 seconds
--------------------------------------------------
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2], [3, 4, 5]]
Result mesh_shapes: [(1, 2), (1, 2)]
Result logical_mesh_shapes: [(2, 1), (2, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 262.64 s
compilation time breakdown: {'stage-construction': '219.99', 'stage-construction-dp': '1.39', 'stage-construction-compilation': '139.17', 'stage-construction-profiling': '38.72'}
 - Compile (worker): 8.77 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 41.82 s

[9.955780506134033, 4.647369623184204, 4.601008415222168, 4.698175430297852, 4.5539021492004395, 4.638498783111572, 4.665703535079956]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 24.748 s.
 - Average e2e iteration time: 4.950000286102295 s.
 - Total local training time: 23.157001495361328 s.
 - Average local iteration time: 4.63100004196167 s.
 - Max allocated memory among devices: 6.632 GB.
 - Compilation times:  {'stage-construction': 219.99418210983276, 'stage-construction-dp': 1.390270709991455, 'stage-construction-compilation': 139.1748058795929, 'stage-construction-profiling': 38.715349435806274}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `2_a40_2_n_2_d`: 4.631457805633545
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/bert_760M_128.pkl`...

------------------------------------------------------------------
- (2/3) Profiling bert_760M with batch size: 256...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/bert_760M_256.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 2
[I] Loading flax model....
[I] Model 'bert' loads sucessfully. Model Info: 

FlaxBertForMaskedLMModule(
    # attributes
    config = <model.bert_model.BertConfig object at 0x7fbb25519e20>
    dtype = float16
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2))
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=1.670 GB, invar_size=1.221 GB, outvar_size=0.059 GB, temp_buffer_size=0.391 GB, available_memory=35.242 GB)
result[(0, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=1.819 GB, invar_size=0.611 GB, outvar_size=0.059 GB, temp_buffer_size=1.150 GB, available_memory=35.242 GB)
result[(0, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.087, peak_memory=1.606 GB, invar_size=1.110 GB, outvar_size=0.059 GB, temp_buffer_size=0.438 GB, available_memory=35.242 GB)
result[(0, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.258, peak_memory=5.425 GB, invar_size=3.190 GB, outvar_size=1.565 GB, temp_buffer_size=2.236 GB, available_memory=35.242 GB)
result[(0, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.603, peak_memory=4.462 GB, invar_size=1.625 GB, outvar_size=0.783 GB, temp_buffer_size=2.837 GB, available_memory=35.242 GB)
result[(0, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.331, peak_memory=5.019 GB, invar_size=2.748 GB, outvar_size=1.345 GB, temp_buffer_size=2.271 GB, available_memory=35.242 GB)
Profiling for submesh 2 (2, 2) takes 130.35 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(1, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=1.065 GB, invar_size=0.674 GB, outvar_size=0.070 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(1, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=1.065 GB, invar_size=0.674 GB, outvar_size=0.070 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(0, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.065, peak_memory=1.623 GB, invar_size=0.725 GB, outvar_size=0.070 GB, temp_buffer_size=0.828 GB, available_memory=35.242 GB)
result[(1, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.222, peak_memory=0.833 GB, invar_size=0.372 GB, outvar_size=0.117 GB, temp_buffer_size=0.344 GB, available_memory=35.242 GB)
result[(1, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.065, peak_memory=1.299 GB, invar_size=0.885 GB, outvar_size=0.094 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(1, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.295, peak_memory=0.986 GB, invar_size=0.478 GB, outvar_size=0.164 GB, temp_buffer_size=0.344 GB, available_memory=35.242 GB)
result[(0, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.058, peak_memory=1.650 GB, invar_size=0.799 GB, outvar_size=0.070 GB, temp_buffer_size=0.781 GB, available_memory=35.242 GB)
result[(0, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.238, peak_memory=1.298 GB, invar_size=0.400 GB, outvar_size=0.117 GB, temp_buffer_size=0.781 GB, available_memory=35.242 GB)
result[(2, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=1.065 GB, invar_size=0.674 GB, outvar_size=0.070 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(1, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.065, peak_memory=1.299 GB, invar_size=0.885 GB, outvar_size=0.094 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(2, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=1.065 GB, invar_size=0.674 GB, outvar_size=0.070 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(2, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.222, peak_memory=0.833 GB, invar_size=0.372 GB, outvar_size=0.117 GB, temp_buffer_size=0.344 GB, available_memory=35.242 GB)
result[(3, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.031, peak_memory=0.813 GB, invar_size=0.446 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(1, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.152, peak_memory=5.587 GB, invar_size=1.395 GB, outvar_size=0.674 GB, temp_buffer_size=4.168 GB, available_memory=35.242 GB)
result[(3, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.145, peak_memory=0.696 GB, invar_size=0.258 GB, outvar_size=0.094 GB, temp_buffer_size=0.344 GB, available_memory=35.242 GB)
result[(0, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=0.512, peak_memory=6.420 GB, invar_size=0.940 GB, outvar_size=0.400 GB, temp_buffer_size=5.480 GB, available_memory=35.242 GB)
result[(1, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.152, peak_memory=5.587 GB, invar_size=1.395 GB, outvar_size=0.674 GB, temp_buffer_size=4.168 GB, available_memory=35.242 GB)
result[(1, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=0.495, peak_memory=6.255 GB, invar_size=0.839 GB, outvar_size=0.372 GB, temp_buffer_size=5.370 GB, available_memory=35.242 GB)
result[(0, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.179, peak_memory=6.000 GB, invar_size=1.544 GB, outvar_size=0.725 GB, temp_buffer_size=4.457 GB, available_memory=35.242 GB)
result[(0, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.171, peak_memory=6.101 GB, invar_size=1.668 GB, outvar_size=0.799 GB, temp_buffer_size=4.433 GB, available_memory=35.242 GB)
result[(3, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.031, peak_memory=0.813 GB, invar_size=0.446 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=35.242 GB)
result[(1, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.202, peak_memory=6.032 GB, invar_size=1.841 GB, outvar_size=0.885 GB, temp_buffer_size=4.168 GB, available_memory=35.242 GB)
result[(2, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.152, peak_memory=5.587 GB, invar_size=1.395 GB, outvar_size=0.674 GB, temp_buffer_size=4.168 GB, available_memory=35.242 GB)
result[(2, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.495, peak_memory=6.454 GB, invar_size=0.839 GB, outvar_size=0.372 GB, temp_buffer_size=5.568 GB, available_memory=35.242 GB)
result[(1, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.656, peak_memory=6.918 GB, invar_size=1.097 GB, outvar_size=0.478 GB, temp_buffer_size=5.775 GB, available_memory=35.242 GB)
result[(2, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.152, peak_memory=5.587 GB, invar_size=1.395 GB, outvar_size=0.674 GB, temp_buffer_size=4.168 GB, available_memory=35.242 GB)
result[(1, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.202, peak_memory=6.032 GB, invar_size=1.841 GB, outvar_size=0.885 GB, temp_buffer_size=4.168 GB, available_memory=35.242 GB)
result[(3, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.173, peak_memory=6.075 GB, invar_size=1.604 GB, outvar_size=0.790 GB, temp_buffer_size=4.448 GB, available_memory=35.242 GB)
result[(3, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=0.509, peak_memory=5.731 GB, invar_size=0.908 GB, outvar_size=0.430 GB, temp_buffer_size=4.777 GB, available_memory=35.242 GB)
result[(3, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.181, peak_memory=5.952 GB, invar_size=1.457 GB, outvar_size=0.717 GB, temp_buffer_size=4.472 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 59.05 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.050, peak_memory=1.984 GB, invar_size=0.359 GB, outvar_size=0.047 GB, temp_buffer_size=1.578 GB, available_memory=35.242 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.050, peak_memory=1.984 GB, invar_size=0.359 GB, outvar_size=0.047 GB, temp_buffer_size=1.578 GB, available_memory=35.242 GB)
result[(1, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.065, peak_memory=1.221 GB, invar_size=0.487 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(1, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.065, peak_memory=1.221 GB, invar_size=0.487 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.128, peak_memory=9.584 GB, invar_size=0.765 GB, outvar_size=0.359 GB, temp_buffer_size=8.819 GB, available_memory=35.242 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.128, peak_memory=9.584 GB, invar_size=0.765 GB, outvar_size=0.359 GB, temp_buffer_size=8.819 GB, available_memory=35.242 GB)
result[(2, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.065, peak_memory=1.221 GB, invar_size=0.487 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(2, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.065, peak_memory=1.221 GB, invar_size=0.487 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(3, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.062, peak_memory=1.204 GB, invar_size=0.469 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(3, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.062, peak_memory=1.204 GB, invar_size=0.469 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(1, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.194, peak_memory=10.146 GB, invar_size=1.020 GB, outvar_size=0.487 GB, temp_buffer_size=9.079 GB, available_memory=35.242 GB)
result[(1, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.194, peak_memory=10.146 GB, invar_size=1.020 GB, outvar_size=0.487 GB, temp_buffer_size=9.079 GB, available_memory=35.242 GB)
result[(2, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.194, peak_memory=10.957 GB, invar_size=1.020 GB, outvar_size=0.487 GB, temp_buffer_size=9.890 GB, available_memory=35.242 GB)
result[(2, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.194, peak_memory=10.957 GB, invar_size=1.020 GB, outvar_size=0.487 GB, temp_buffer_size=9.890 GB, available_memory=35.242 GB)
result[(3, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.185, peak_memory=9.875 GB, invar_size=0.985 GB, outvar_size=0.469 GB, temp_buffer_size=8.843 GB, available_memory=35.242 GB)
result[(3, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.185, peak_memory=9.875 GB, invar_size=0.985 GB, outvar_size=0.469 GB, temp_buffer_size=8.843 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 20.29 seconds
--------------------------------------------------
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2], [3, 4, 5]]
Result mesh_shapes: [(1, 2), (1, 2)]
Result logical_mesh_shapes: [(2, 1), (2, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 253.83 s
compilation time breakdown: {'stage-construction': '213.40', 'stage-construction-dp': '1.40', 'stage-construction-compilation': '135.45', 'stage-construction-profiling': '38.34'}
 - Compile (worker): 9.29 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 68.85 s

[13.519784688949585, 8.47295069694519, 8.368947744369507, 8.378761529922485, 8.563910484313965, 8.607279777526855, 8.628817796707153]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 44.916 s.
 - Average e2e iteration time: 8.983000755310059 s.
 - Total local training time: 42.54800033569336 s.
 - Average local iteration time: 8.510000228881836 s.
 - Max allocated memory among devices: 9.431 GB.
 - Compilation times:  {'stage-construction': 213.40239334106445, 'stage-construction-dp': 1.4001305103302002, 'stage-construction-compilation': 135.45429182052612, 'stage-construction-profiling': 38.33837127685547}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `2_a40_2_n_2_d`: 8.509543418884277
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/bert_760M_256.pkl`...

------------------------------------------------------------------
- (3/3) Profiling bert_760M with batch size: 512...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/bert_760M_512.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 2
[I] Loading flax model....
[I] Model 'bert' loads sucessfully. Model Info: 

FlaxBertForMaskedLMModule(
    # attributes
    config = <model.bert_model.BertConfig object at 0x7ff14b1a1fd0>
    dtype = float16
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2))
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.146, peak_memory=1.967 GB, invar_size=0.611 GB, outvar_size=0.117 GB, temp_buffer_size=1.239 GB, available_memory=35.242 GB)
result[(0, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.090, peak_memory=2.120 GB, invar_size=1.221 GB, outvar_size=0.117 GB, temp_buffer_size=0.781 GB, available_memory=35.242 GB)
result[(0, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.090, peak_memory=2.120 GB, invar_size=1.221 GB, outvar_size=0.117 GB, temp_buffer_size=0.781 GB, available_memory=35.242 GB)
result[(0, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.409, peak_memory=7.720 GB, invar_size=3.248 GB, outvar_size=1.565 GB, temp_buffer_size=4.472 GB, available_memory=35.242 GB)
result[(0, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.409, peak_memory=7.720 GB, invar_size=3.248 GB, outvar_size=1.565 GB, temp_buffer_size=4.472 GB, available_memory=35.242 GB)
result[(0, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=1.055, peak_memory=9.048 GB, invar_size=1.684 GB, outvar_size=0.783 GB, temp_buffer_size=7.365 GB, available_memory=35.242 GB)
Profiling for submesh 2 (2, 2) takes 117.60 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(1, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.096, peak_memory=1.479 GB, invar_size=0.698 GB, outvar_size=0.141 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(1, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.096, peak_memory=1.479 GB, invar_size=0.698 GB, outvar_size=0.141 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(1, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.440, peak_memory=1.341 GB, invar_size=0.419 GB, outvar_size=0.234 GB, temp_buffer_size=0.688 GB, available_memory=35.242 GB)
result[(0, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.114, peak_memory=2.502 GB, invar_size=0.799 GB, outvar_size=0.141 GB, temp_buffer_size=1.563 GB, available_memory=35.242 GB)
result[(0, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.114, peak_memory=2.502 GB, invar_size=0.799 GB, outvar_size=0.141 GB, temp_buffer_size=1.563 GB, available_memory=35.242 GB)
result[(0, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.473, peak_memory=2.197 GB, invar_size=0.400 GB, outvar_size=0.234 GB, temp_buffer_size=1.563 GB, available_memory=35.242 GB)
result[(1, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.127, peak_memory=1.737 GB, invar_size=0.909 GB, outvar_size=0.188 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(1, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.585, peak_memory=1.541 GB, invar_size=0.525 GB, outvar_size=0.328 GB, temp_buffer_size=0.688 GB, available_memory=35.242 GB)
result[(2, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.096, peak_memory=1.479 GB, invar_size=0.698 GB, outvar_size=0.141 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(2, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.096, peak_memory=1.479 GB, invar_size=0.698 GB, outvar_size=0.141 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(2, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.440, peak_memory=1.341 GB, invar_size=0.419 GB, outvar_size=0.234 GB, temp_buffer_size=0.688 GB, available_memory=35.242 GB)
result[(1, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.127, peak_memory=1.737 GB, invar_size=0.909 GB, outvar_size=0.188 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(3, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.062, peak_memory=1.204 GB, invar_size=0.469 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(3, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.289, peak_memory=1.180 GB, invar_size=0.305 GB, outvar_size=0.188 GB, temp_buffer_size=0.688 GB, available_memory=35.242 GB)
result[(1, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=0.981, peak_memory=11.851 GB, invar_size=1.026 GB, outvar_size=0.419 GB, temp_buffer_size=10.731 GB, available_memory=35.242 GB)
result[(0, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.329, peak_memory=10.652 GB, invar_size=1.785 GB, outvar_size=0.799 GB, temp_buffer_size=8.867 GB, available_memory=35.242 GB)
result[(0, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=1.016, peak_memory=12.032 GB, invar_size=1.081 GB, outvar_size=0.400 GB, temp_buffer_size=10.952 GB, available_memory=35.242 GB)
result[(0, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.329, peak_memory=10.605 GB, invar_size=1.738 GB, outvar_size=0.799 GB, temp_buffer_size=8.867 GB, available_memory=35.242 GB)
result[(1, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.293, peak_memory=9.871 GB, invar_size=1.489 GB, outvar_size=0.698 GB, temp_buffer_size=8.335 GB, available_memory=35.242 GB)
result[(1, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.293, peak_memory=9.871 GB, invar_size=1.489 GB, outvar_size=0.698 GB, temp_buffer_size=8.335 GB, available_memory=35.242 GB)
result[(3, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.062, peak_memory=1.204 GB, invar_size=0.469 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=35.242 GB)
result[(1, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.388, peak_memory=10.341 GB, invar_size=1.958 GB, outvar_size=0.909 GB, temp_buffer_size=8.335 GB, available_memory=35.242 GB)
result[(2, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.293, peak_memory=9.872 GB, invar_size=1.489 GB, outvar_size=0.698 GB, temp_buffer_size=8.335 GB, available_memory=35.242 GB)
result[(2, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.981, peak_memory=12.246 GB, invar_size=1.026 GB, outvar_size=0.419 GB, temp_buffer_size=11.126 GB, available_memory=35.242 GB)
result[(1, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=1.301, peak_memory=12.962 GB, invar_size=1.331 GB, outvar_size=0.525 GB, temp_buffer_size=11.537 GB, available_memory=35.242 GB)
result[(2, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.293, peak_memory=9.872 GB, invar_size=1.489 GB, outvar_size=0.698 GB, temp_buffer_size=8.335 GB, available_memory=35.242 GB)
result[(3, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.333, peak_memory=10.617 GB, invar_size=1.674 GB, outvar_size=0.814 GB, temp_buffer_size=8.896 GB, available_memory=35.242 GB)
result[(1, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.388, peak_memory=10.341 GB, invar_size=1.958 GB, outvar_size=0.909 GB, temp_buffer_size=8.335 GB, available_memory=35.242 GB)
result[(3, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=1.010, peak_memory=10.696 GB, invar_size=1.048 GB, outvar_size=0.477 GB, temp_buffer_size=9.553 GB, available_memory=35.242 GB)
result[(3, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.350, peak_memory=10.518 GB, invar_size=1.528 GB, outvar_size=0.740 GB, temp_buffer_size=8.943 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 57.41 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.097, peak_memory=3.609 GB, invar_size=0.359 GB, outvar_size=0.094 GB, temp_buffer_size=3.156 GB, available_memory=35.242 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.097, peak_memory=3.609 GB, invar_size=0.359 GB, outvar_size=0.094 GB, temp_buffer_size=3.156 GB, available_memory=35.242 GB)
result[(1, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.125, peak_memory=2.002 GB, invar_size=0.534 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=35.242 GB)
result[(1, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.125, peak_memory=2.002 GB, invar_size=0.534 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=35.242 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.249, peak_memory=18.451 GB, invar_size=0.812 GB, outvar_size=0.359 GB, temp_buffer_size=17.639 GB, available_memory=35.242 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.249, peak_memory=18.451 GB, invar_size=0.812 GB, outvar_size=0.359 GB, temp_buffer_size=17.639 GB, available_memory=35.242 GB)
result[(2, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.125, peak_memory=2.002 GB, invar_size=0.534 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=35.242 GB)
result[(2, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.125, peak_memory=2.002 GB, invar_size=0.534 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=35.242 GB)
result[(3, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.119, peak_memory=1.985 GB, invar_size=0.516 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=35.242 GB)
result[(3, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.119, peak_memory=1.985 GB, invar_size=0.516 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=35.242 GB)
result[(1, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.375, peak_memory=19.407 GB, invar_size=1.161 GB, outvar_size=0.534 GB, temp_buffer_size=18.153 GB, available_memory=35.242 GB)
result[(1, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.375, peak_memory=19.407 GB, invar_size=1.161 GB, outvar_size=0.534 GB, temp_buffer_size=18.153 GB, available_memory=35.242 GB)
result[(2, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.375, peak_memory=21.030 GB, invar_size=1.161 GB, outvar_size=0.534 GB, temp_buffer_size=19.775 GB, available_memory=35.242 GB)
result[(2, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.375, peak_memory=21.030 GB, invar_size=1.161 GB, outvar_size=0.534 GB, temp_buffer_size=19.775 GB, available_memory=35.242 GB)
result[(3, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.357, peak_memory=18.901 GB, invar_size=1.126 GB, outvar_size=0.516 GB, temp_buffer_size=17.682 GB, available_memory=35.242 GB)
result[(3, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.357, peak_memory=18.901 GB, invar_size=1.126 GB, outvar_size=0.516 GB, temp_buffer_size=17.682 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 21.07 seconds
--------------------------------------------------
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2], [3, 4, 5]]
Result mesh_shapes: [(1, 2), (1, 2)]
Result logical_mesh_shapes: [(2, 1), (2, 1)]
Result autosharding_option_dicts: [{}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 248.05 s
compilation time breakdown: {'stage-construction': '199.27', 'stage-construction-dp': '1.11', 'stage-construction-compilation': '120.15', 'stage-construction-profiling': '40.48'}
 - Compile (worker): 9.72 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 124.25 s

[21.606972455978394, 15.950613737106323, 15.931457281112671, 15.896201848983765, 16.25179958343506, 16.006195545196533, 15.969765663146973]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 84.01 s.
 - Average e2e iteration time: 16.802000045776367 s.
 - Total local training time: 80.05500030517578 s.
 - Average local iteration time: 16.011001586914062 s.
 - Max allocated memory among devices: 15.028 GB.
 - Compilation times:  {'stage-construction': 199.2746114730835, 'stage-construction-dp': 1.108574628829956, 'stage-construction-compilation': 120.15243816375732, 'stage-construction-profiling': 40.48301601409912}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `2_a40_2_n_2_d`: 16.011083602905273
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/bert_760M_512.pkl`...
