
------------------------------------------------------------------
- (1/3) Profiling wide_resnet_500M with batch size: 256...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/wide_resnet_500M_256.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 1
    - Nodes num: 4
[I] Loading flax model....
[I] Model 'wide_resnet' loads sucessfully. Model Info: 

WideResNet(
    # attributes
    stage_sizes = [3, 4, 6, 3]
    block_cls = BottleneckResNetBlock
    num_classes = 1024
    num_filters = 224
    width_factor = 2
    dtype = float32
    act = relu
) 

[I] Compiling and executing model with timeout = 1200 s...
[I] Manually construct dummy batch with the shape of (256, 224, 224, 3).
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (2, 1), (4, 1))
- Profiling for submesh 2 (4, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 15, 2, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=2.513 GB, invar_size=1.847 GB, outvar_size=0.272 GB, temp_buffer_size=0.394 GB, available_memory=35.242 GB)
result[(0, 15, 2, 1), 0] = ModuleProfileResult(compute_cost=0.317, peak_memory=1.531 GB, invar_size=0.965 GB, outvar_size=0.304 GB, temp_buffer_size=0.262 GB, available_memory=35.242 GB)
result[(0, 15, 2, 0), 1] = ModuleProfileResult(compute_cost=0.428, peak_memory=6.354 GB, invar_size=3.963 GB, outvar_size=1.844 GB, temp_buffer_size=2.391 GB, available_memory=35.242 GB)
result[(0, 15, 2, 1), 1] = ModuleProfileResult(compute_cost=0.504, peak_memory=3.044 GB, invar_size=2.230 GB, outvar_size=0.962 GB, temp_buffer_size=0.814 GB, available_memory=35.242 GB)
Profiling for submesh 2 (4, 1) takes 30.50 seconds
--------------------------------------------------
- Profiling for submesh 1 (2, 1):
[TMP] Skip profiling of 2 due to legacy error in tensorflow...
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.965 GB, invar_size=0.053 GB, outvar_size=0.544 GB, temp_buffer_size=0.367 GB, available_memory=35.242 GB)
result[(1, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.952 GB, invar_size=0.166 GB, outvar_size=0.419 GB, temp_buffer_size=0.367 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.965 GB, invar_size=0.053 GB, outvar_size=0.544 GB, temp_buffer_size=0.367 GB, available_memory=35.242 GB)
result[(3, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.711 GB, invar_size=0.240 GB, outvar_size=0.251 GB, temp_buffer_size=0.220 GB, available_memory=35.242 GB)
result[(2, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.943 GB, invar_size=0.223 GB, outvar_size=0.335 GB, temp_buffer_size=0.386 GB, available_memory=35.242 GB)
result[(3, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.711 GB, invar_size=0.240 GB, outvar_size=0.251 GB, temp_buffer_size=0.220 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.833 GB, invar_size=0.262 GB, outvar_size=0.335 GB, temp_buffer_size=0.236 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.807 GB, invar_size=0.259 GB, outvar_size=0.293 GB, temp_buffer_size=0.254 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.059 GB, invar_size=0.245 GB, outvar_size=0.419 GB, temp_buffer_size=0.395 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.833 GB, invar_size=0.262 GB, outvar_size=0.335 GB, temp_buffer_size=0.236 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.059 GB, invar_size=0.245 GB, outvar_size=0.419 GB, temp_buffer_size=0.395 GB, available_memory=35.242 GB)
result[(2, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.705 GB, invar_size=0.612 GB, outvar_size=0.223 GB, temp_buffer_size=0.925 GB, available_memory=35.242 GB)
result[(1, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.011 GB, invar_size=0.625 GB, outvar_size=0.166 GB, temp_buffer_size=1.260 GB, available_memory=35.242 GB)
result[(2, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.943 GB, invar_size=0.223 GB, outvar_size=0.335 GB, temp_buffer_size=0.386 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.807 GB, invar_size=0.259 GB, outvar_size=0.293 GB, temp_buffer_size=0.254 GB, available_memory=35.242 GB)
result[(1, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.952 GB, invar_size=0.166 GB, outvar_size=0.419 GB, temp_buffer_size=0.367 GB, available_memory=35.242 GB)
result[(5, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.760 GB, invar_size=0.326 GB, outvar_size=0.251 GB, temp_buffer_size=0.182 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.081 GB, invar_size=0.189 GB, outvar_size=0.503 GB, temp_buffer_size=0.390 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.081 GB, invar_size=0.189 GB, outvar_size=0.503 GB, temp_buffer_size=0.390 GB, available_memory=35.242 GB)
result[(3, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.423 GB, invar_size=0.562 GB, outvar_size=0.239 GB, temp_buffer_size=0.693 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.027 GB, invar_size=0.642 GB, outvar_size=0.044 GB, temp_buffer_size=1.385 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.027 GB, invar_size=0.642 GB, outvar_size=0.044 GB, temp_buffer_size=1.385 GB, available_memory=35.242 GB)
result[(3, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.423 GB, invar_size=0.562 GB, outvar_size=0.239 GB, temp_buffer_size=0.693 GB, available_memory=35.242 GB)
result[(6, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.804 GB, invar_size=0.394 GB, outvar_size=0.210 GB, temp_buffer_size=0.200 GB, available_memory=35.242 GB)
result[(6, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.804 GB, invar_size=0.394 GB, outvar_size=0.210 GB, temp_buffer_size=0.200 GB, available_memory=35.242 GB)
result[(5, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.760 GB, invar_size=0.326 GB, outvar_size=0.251 GB, temp_buffer_size=0.182 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.834 GB, invar_size=0.741 GB, outvar_size=0.245 GB, temp_buffer_size=0.925 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.834 GB, invar_size=0.741 GB, outvar_size=0.245 GB, temp_buffer_size=0.925 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.552 GB, invar_size=0.691 GB, outvar_size=0.262 GB, temp_buffer_size=0.693 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.286 GB, invar_size=0.727 GB, outvar_size=0.259 GB, temp_buffer_size=0.475 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.552 GB, invar_size=0.691 GB, outvar_size=0.262 GB, temp_buffer_size=0.693 GB, available_memory=35.242 GB)
result[(2, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.705 GB, invar_size=0.612 GB, outvar_size=0.223 GB, temp_buffer_size=0.925 GB, available_memory=35.242 GB)
result[(6, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.925 GB, invar_size=0.484 GB, outvar_size=0.251 GB, temp_buffer_size=0.190 GB, available_memory=35.242 GB)
result[(7, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.819 GB, invar_size=0.461 GB, outvar_size=0.168 GB, temp_buffer_size=0.190 GB, available_memory=35.242 GB)
result[(7, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.819 GB, invar_size=0.461 GB, outvar_size=0.168 GB, temp_buffer_size=0.190 GB, available_memory=35.242 GB)
result[(1, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.011 GB, invar_size=0.625 GB, outvar_size=0.166 GB, temp_buffer_size=1.260 GB, available_memory=35.242 GB)
result[(6, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.925 GB, invar_size=0.484 GB, outvar_size=0.251 GB, temp_buffer_size=0.190 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.286 GB, invar_size=0.727 GB, outvar_size=0.259 GB, temp_buffer_size=0.475 GB, available_memory=35.242 GB)
result[(7, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.950 GB, invar_size=0.551 GB, outvar_size=0.210 GB, temp_buffer_size=0.190 GB, available_memory=35.242 GB)
result[(8, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.685 GB, invar_size=0.401 GB, outvar_size=0.168 GB, temp_buffer_size=0.117 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.139 GB, invar_size=0.754 GB, outvar_size=0.189 GB, temp_buffer_size=1.260 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.139 GB, invar_size=0.754 GB, outvar_size=0.189 GB, temp_buffer_size=1.260 GB, available_memory=35.242 GB)
result[(5, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.378 GB, invar_size=0.820 GB, outvar_size=0.326 GB, temp_buffer_size=0.475 GB, available_memory=35.242 GB)
result[(8, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.685 GB, invar_size=0.401 GB, outvar_size=0.168 GB, temp_buffer_size=0.117 GB, available_memory=35.242 GB)
result[(7, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.950 GB, invar_size=0.551 GB, outvar_size=0.210 GB, temp_buffer_size=0.190 GB, available_memory=35.242 GB)
result[(5, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.378 GB, invar_size=0.820 GB, outvar_size=0.326 GB, temp_buffer_size=0.475 GB, available_memory=35.242 GB)
result[(9, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.675 GB, invar_size=0.401 GB, outvar_size=0.168 GB, temp_buffer_size=0.106 GB, available_memory=35.242 GB)
result[(9, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.675 GB, invar_size=0.401 GB, outvar_size=0.168 GB, temp_buffer_size=0.106 GB, available_memory=35.242 GB)
result[(8, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.817 GB, invar_size=0.491 GB, outvar_size=0.210 GB, temp_buffer_size=0.117 GB, available_memory=35.242 GB)
result[(6, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.416 GB, invar_size=0.913 GB, outvar_size=0.393 GB, temp_buffer_size=0.420 GB, available_memory=35.242 GB)
result[(6, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.416 GB, invar_size=0.913 GB, outvar_size=0.393 GB, temp_buffer_size=0.420 GB, available_memory=35.242 GB)
result[(8, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.817 GB, invar_size=0.491 GB, outvar_size=0.210 GB, temp_buffer_size=0.117 GB, available_memory=35.242 GB)
result[(7, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.509 GB, invar_size=1.005 GB, outvar_size=0.461 GB, temp_buffer_size=0.420 GB, available_memory=35.242 GB)
result[(9, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.281 GB, invar_size=0.832 GB, outvar_size=0.189 GB, temp_buffer_size=0.260 GB, available_memory=35.242 GB)
result[(7, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.509 GB, invar_size=1.005 GB, outvar_size=0.461 GB, temp_buffer_size=0.420 GB, available_memory=35.242 GB)
result[(9, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.281 GB, invar_size=0.832 GB, outvar_size=0.189 GB, temp_buffer_size=0.260 GB, available_memory=35.242 GB)
result[(10, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.149 GB, invar_size=0.743 GB, outvar_size=0.147 GB, temp_buffer_size=0.260 GB, available_memory=35.242 GB)
result[(10, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.149 GB, invar_size=0.743 GB, outvar_size=0.147 GB, temp_buffer_size=0.260 GB, available_memory=35.242 GB)
result[(6, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.638 GB, invar_size=1.134 GB, outvar_size=0.483 GB, temp_buffer_size=0.420 GB, available_memory=35.242 GB)
result[(8, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.255 GB, invar_size=0.927 GB, outvar_size=0.401 GB, temp_buffer_size=0.286 GB, available_memory=35.242 GB)
result[(8, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.255 GB, invar_size=0.927 GB, outvar_size=0.401 GB, temp_buffer_size=0.286 GB, available_memory=35.242 GB)
result[(6, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.638 GB, invar_size=1.134 GB, outvar_size=0.483 GB, temp_buffer_size=0.420 GB, available_memory=35.242 GB)
result[(10, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.550 GB, invar_size=1.102 GB, outvar_size=0.168 GB, temp_buffer_size=0.281 GB, available_memory=35.242 GB)
result[(9, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.255 GB, invar_size=0.927 GB, outvar_size=0.401 GB, temp_buffer_size=0.286 GB, available_memory=35.242 GB)
result[(10, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.550 GB, invar_size=1.102 GB, outvar_size=0.168 GB, temp_buffer_size=0.281 GB, available_memory=35.242 GB)
result[(11, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.419 GB, invar_size=1.012 GB, outvar_size=0.126 GB, temp_buffer_size=0.281 GB, available_memory=35.242 GB)
result[(7, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.731 GB, invar_size=1.227 GB, outvar_size=0.551 GB, temp_buffer_size=0.420 GB, available_memory=35.242 GB)
result[(11, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.419 GB, invar_size=1.012 GB, outvar_size=0.126 GB, temp_buffer_size=0.281 GB, available_memory=35.242 GB)
result[(9, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.255 GB, invar_size=0.927 GB, outvar_size=0.401 GB, temp_buffer_size=0.286 GB, available_memory=35.242 GB)
result[(7, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.731 GB, invar_size=1.227 GB, outvar_size=0.551 GB, temp_buffer_size=0.420 GB, available_memory=35.242 GB)
result[(8, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.477 GB, invar_size=1.149 GB, outvar_size=0.491 GB, temp_buffer_size=0.286 GB, available_memory=35.242 GB)
result[(8, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.477 GB, invar_size=1.149 GB, outvar_size=0.491 GB, temp_buffer_size=0.286 GB, available_memory=35.242 GB)
result[(11, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.784 GB, invar_size=1.398 GB, outvar_size=0.126 GB, temp_buffer_size=0.260 GB, available_memory=35.242 GB)
result[(12, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.653 GB, invar_size=1.309 GB, outvar_size=0.084 GB, temp_buffer_size=0.260 GB, available_memory=35.242 GB)
result[(11, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.784 GB, invar_size=1.398 GB, outvar_size=0.126 GB, temp_buffer_size=0.260 GB, available_memory=35.242 GB)
result[(12, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.653 GB, invar_size=1.309 GB, outvar_size=0.084 GB, temp_buffer_size=0.260 GB, available_memory=35.242 GB)
result[(10, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.166 GB, invar_size=1.589 GB, outvar_size=0.742 GB, temp_buffer_size=0.536 GB, available_memory=35.242 GB)
result[(10, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.166 GB, invar_size=1.589 GB, outvar_size=0.742 GB, temp_buffer_size=0.536 GB, available_memory=35.242 GB)
result[(11, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.779 GB, invar_size=2.106 GB, outvar_size=1.011 GB, temp_buffer_size=0.631 GB, available_memory=35.242 GB)
result[(9, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.388 GB, invar_size=1.810 GB, outvar_size=0.832 GB, temp_buffer_size=0.536 GB, available_memory=35.242 GB)
result[(11, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.779 GB, invar_size=2.106 GB, outvar_size=1.011 GB, temp_buffer_size=0.631 GB, available_memory=35.242 GB)
result[(9, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.388 GB, invar_size=1.810 GB, outvar_size=0.832 GB, temp_buffer_size=0.536 GB, available_memory=35.242 GB)
result[(10, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.927 GB, invar_size=2.327 GB, outvar_size=1.101 GB, temp_buffer_size=0.557 GB, available_memory=35.242 GB)
result[(10, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.927 GB, invar_size=2.327 GB, outvar_size=1.101 GB, temp_buffer_size=0.557 GB, available_memory=35.242 GB)
result[(12, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.405 GB, invar_size=2.657 GB, outvar_size=1.308 GB, temp_buffer_size=0.706 GB, available_memory=35.242 GB)
result[(11, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.626 GB, invar_size=2.879 GB, outvar_size=1.398 GB, temp_buffer_size=0.706 GB, available_memory=35.242 GB)
result[(12, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.405 GB, invar_size=2.657 GB, outvar_size=1.308 GB, temp_buffer_size=0.706 GB, available_memory=35.242 GB)
result[(11, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.626 GB, invar_size=2.879 GB, outvar_size=1.398 GB, temp_buffer_size=0.706 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 41.12 seconds
--------------------------------------------------
----------------------------------------------------------------------
[TMP] Stage (0, 6, 1, 0) has been pruned...
[TMP] Stage (0, 6, 1, 1) has been pruned...
[TMP] Stage (0, 7, 1, 0) has been pruned...
[TMP] Stage (0, 7, 1, 1) has been pruned...
[TMP] Stage (0, 8, 1, 0) has been pruned...
[TMP] Stage (0, 8, 1, 1) has been pruned...
[TMP] Stage (1, 6, 1, 0) has been pruned...
[TMP] Stage (1, 6, 1, 1) has been pruned...
[TMP] Stage (1, 7, 1, 0) has been pruned...
[TMP] Stage (1, 7, 1, 1) has been pruned...
[TMP] Stage (1, 8, 1, 0) has been pruned...
[TMP] Stage (1, 8, 1, 1) has been pruned...
[TMP] Stage (1, 9, 1, 0) has been pruned...
[TMP] Stage (1, 9, 1, 1) has been pruned...
[TMP] Stage (2, 7, 1, 0) has been pruned...
[TMP] Stage (2, 7, 1, 1) has been pruned...
[TMP] Stage (2, 8, 1, 0) has been pruned...
[TMP] Stage (2, 8, 1, 1) has been pruned...
[TMP] Stage (2, 9, 1, 0) has been pruned...
[TMP] Stage (2, 9, 1, 1) has been pruned...
[TMP] Stage (2, 10, 1, 0) has been pruned...
[TMP] Stage (2, 10, 1, 1) has been pruned...
[TMP] Stage (3, 9, 1, 0) has been pruned...
[TMP] Stage (3, 9, 1, 1) has been pruned...
[TMP] Stage (3, 10, 1, 0) has been pruned...
[TMP] Stage (3, 10, 1, 1) has been pruned...
[TMP] Stage (3, 11, 1, 0) has been pruned...
[TMP] Stage (3, 11, 1, 1) has been pruned...
[TMP] Stage (4, 10, 1, 0) has been pruned...
[TMP] Stage (4, 10, 1, 1) has been pruned...
[TMP] Stage (4, 11, 1, 0) has been pruned...
[TMP] Stage (4, 11, 1, 1) has been pruned...
[TMP] Stage (4, 12, 1, 0) has been pruned...
[TMP] Stage (4, 12, 1, 1) has been pruned...
[TMP] Stage (4, 13, 1, 0) has been pruned...
[TMP] Stage (4, 13, 1, 1) has been pruned...
[TMP] Stage (5, 11, 1, 0) has been pruned...
[TMP] Stage (5, 11, 1, 1) has been pruned...
[TMP] Stage (5, 12, 1, 0) has been pruned...
[TMP] Stage (5, 12, 1, 1) has been pruned...
[TMP] Stage (5, 13, 1, 0) has been pruned...
[TMP] Stage (5, 13, 1, 1) has been pruned...
[TMP] Stage (5, 14, 1, 0) has been pruned...
[TMP] Stage (5, 14, 1, 1) has been pruned...
[TMP] Stage (6, 12, 1, 0) has been pruned...
[TMP] Stage (6, 12, 1, 1) has been pruned...
[TMP] Stage (6, 13, 1, 0) has been pruned...
[TMP] Stage (6, 13, 1, 1) has been pruned...
[TMP] Stage (6, 14, 1, 0) has been pruned...
[TMP] Stage (6, 14, 1, 1) has been pruned...
[TMP] Stage (6, 15, 1, 0) has been pruned...
[TMP] Stage (6, 15, 1, 1) has been pruned...
[TMP] Stage (7, 13, 1, 0) has been pruned...
[TMP] Stage (7, 13, 1, 1) has been pruned...
[TMP] Stage (7, 14, 1, 0) has been pruned...
[TMP] Stage (7, 14, 1, 1) has been pruned...
[TMP] Stage (7, 15, 1, 0) has been pruned...
[TMP] Stage (7, 15, 1, 1) has been pruned...
[TMP] Stage (8, 14, 1, 0) has been pruned...
[TMP] Stage (8, 14, 1, 1) has been pruned...
[TMP] Stage (8, 15, 1, 0) has been pruned...
[TMP] Stage (8, 15, 1, 1) has been pruned...
[TMP] Stage (9, 15, 1, 0) has been pruned...
[TMP] Stage (9, 15, 1, 1) has been pruned...
Result forward_stage_layer_ids: [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]]
Result mesh_shapes: [(1, 1), (1, 1), (1, 1), (1, 1)]
Result logical_mesh_shapes: [(1, 1), (1, 1), (1, 1), (1, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {}]
 - Compile (driver): 94.47 s
compilation time breakdown: {'stage-construction': '74.30', 'stage-construction-dp': '1.48', 'stage-construction-compilation': '17.81', 'stage-construction-profiling': '24.94'}
 - Compile (worker): 5.38 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 64.77 s

[13.297248363494873, 8.194153070449829, 8.144219398498535, 8.177770376205444, 8.136136531829834, 8.148517370223999, 8.247109413146973]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 42.343 s.
 - Average e2e iteration time: 8.469000816345215 s.
 - Total local training time: 40.854000091552734 s.
 - Average local iteration time: 8.171000480651855 s.
 - Max allocated memory among devices: 9.198 GB.
 - Compilation times:  {'stage-construction': 74.30236887931824, 'stage-construction-dp': 1.4786088466644287, 'stage-construction-compilation': 17.80679488182068, 'stage-construction-profiling': 24.940197467803955}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `4_a40_4_n_1_d`: 8.170750617980957
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/wide_resnet_500M_256.pkl`...

------------------------------------------------------------------
- (2/3) Profiling wide_resnet_500M with batch size: 512...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/wide_resnet_500M_512.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 1
    - Nodes num: 4
[I] Loading flax model....
[I] Model 'wide_resnet' loads sucessfully. Model Info: 

WideResNet(
    # attributes
    stage_sizes = [3, 4, 6, 3]
    block_cls = BottleneckResNetBlock
    num_classes = 1024
    num_filters = 224
    width_factor = 2
    dtype = float32
    act = relu
) 

[I] Compiling and executing model with timeout = 1200 s...
[I] Manually construct dummy batch with the shape of (512, 224, 224, 3).
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (2, 1), (4, 1))
- Profiling for submesh 2 (4, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 15, 2, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=2.965 GB, invar_size=1.849 GB, outvar_size=0.545 GB, temp_buffer_size=0.572 GB, available_memory=35.242 GB)
result[(0, 15, 2, 0), 1] = ModuleProfileResult(compute_cost=0.428, peak_memory=6.692 GB, invar_size=4.237 GB, outvar_size=1.844 GB, temp_buffer_size=2.455 GB, available_memory=35.242 GB)
result[(0, 15, 2, 1), 0] = ModuleProfileResult(compute_cost=0.614, peak_memory=2.035 GB, invar_size=0.967 GB, outvar_size=0.607 GB, temp_buffer_size=0.461 GB, available_memory=35.242 GB)
result[(0, 15, 2, 1), 1] = ModuleProfileResult(compute_cost=0.727, peak_memory=3.360 GB, invar_size=2.536 GB, outvar_size=0.962 GB, temp_buffer_size=0.824 GB, available_memory=35.242 GB)
Profiling for submesh 2 (4, 1) takes 29.03 seconds
--------------------------------------------------
- Profiling for submesh 1 (2, 1):
[TMP] Skip profiling of 2 due to legacy error in tensorflow...
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(3, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.682 GB, invar_size=0.981 GB, outvar_size=0.407 GB, temp_buffer_size=1.366 GB, available_memory=35.242 GB)
result[(3, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.334 GB, invar_size=0.407 GB, outvar_size=0.503 GB, temp_buffer_size=0.425 GB, available_memory=35.242 GB)
result[(2, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.296 GB, invar_size=1.115 GB, outvar_size=0.390 GB, temp_buffer_size=1.846 GB, available_memory=35.242 GB)
result[(1, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.937 GB, invar_size=1.170 GB, outvar_size=0.292 GB, temp_buffer_size=2.516 GB, available_memory=35.242 GB)
result[(1, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.937 GB, invar_size=1.170 GB, outvar_size=0.292 GB, temp_buffer_size=2.516 GB, available_memory=35.242 GB)
result[(2, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.781 GB, invar_size=0.390 GB, outvar_size=0.670 GB, temp_buffer_size=0.721 GB, available_memory=35.242 GB)
result[(2, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.296 GB, invar_size=1.115 GB, outvar_size=0.390 GB, temp_buffer_size=1.846 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.509 GB, invar_size=1.327 GB, outvar_size=0.412 GB, temp_buffer_size=1.846 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.509 GB, invar_size=1.327 GB, outvar_size=0.412 GB, temp_buffer_size=1.846 GB, available_memory=35.242 GB)
result[(3, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.682 GB, invar_size=0.981 GB, outvar_size=0.407 GB, temp_buffer_size=1.366 GB, available_memory=35.242 GB)
result[(3, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.334 GB, invar_size=0.407 GB, outvar_size=0.503 GB, temp_buffer_size=0.425 GB, available_memory=35.242 GB)
result[(2, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.781 GB, invar_size=0.390 GB, outvar_size=0.670 GB, temp_buffer_size=0.721 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.962 GB, invar_size=1.195 GB, outvar_size=0.044 GB, temp_buffer_size=2.767 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.894 GB, invar_size=1.193 GB, outvar_size=0.429 GB, temp_buffer_size=1.366 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.894 GB, invar_size=1.193 GB, outvar_size=0.429 GB, temp_buffer_size=1.366 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.207 GB, invar_size=1.104 GB, outvar_size=0.343 GB, temp_buffer_size=0.936 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.149 GB, invar_size=1.382 GB, outvar_size=0.314 GB, temp_buffer_size=2.516 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.149 GB, invar_size=1.382 GB, outvar_size=0.314 GB, temp_buffer_size=2.516 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.962 GB, invar_size=1.195 GB, outvar_size=0.044 GB, temp_buffer_size=2.767 GB, available_memory=35.242 GB)
result[(1, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.832 GB, invar_size=0.292 GB, outvar_size=0.837 GB, temp_buffer_size=0.702 GB, available_memory=35.242 GB)
result[(1, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.832 GB, invar_size=0.292 GB, outvar_size=0.837 GB, temp_buffer_size=0.702 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.207 GB, invar_size=1.104 GB, outvar_size=0.343 GB, temp_buffer_size=0.936 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.980 GB, invar_size=0.413 GB, outvar_size=0.837 GB, temp_buffer_size=0.730 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.980 GB, invar_size=0.413 GB, outvar_size=0.837 GB, temp_buffer_size=0.730 GB, available_memory=35.242 GB)
result[(5, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.258 GB, invar_size=1.155 GB, outvar_size=0.410 GB, temp_buffer_size=0.936 GB, available_memory=35.242 GB)
result[(5, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.258 GB, invar_size=1.155 GB, outvar_size=0.410 GB, temp_buffer_size=0.936 GB, available_memory=35.242 GB)
result[(6, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.142 GB, invar_size=1.206 GB, outvar_size=0.477 GB, temp_buffer_size=0.768 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.503 GB, invar_size=0.429 GB, outvar_size=0.670 GB, temp_buffer_size=0.404 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.503 GB, invar_size=0.429 GB, outvar_size=0.670 GB, temp_buffer_size=0.404 GB, available_memory=35.242 GB)
result[(6, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.142 GB, invar_size=1.206 GB, outvar_size=0.477 GB, temp_buffer_size=0.768 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.378 GB, invar_size=0.343 GB, outvar_size=0.586 GB, temp_buffer_size=0.449 GB, available_memory=35.242 GB)
result[(7, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.179 GB, invar_size=1.256 GB, outvar_size=0.545 GB, temp_buffer_size=0.755 GB, available_memory=35.242 GB)
result[(6, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.405 GB, invar_size=1.469 GB, outvar_size=0.567 GB, temp_buffer_size=0.769 GB, available_memory=35.242 GB)
result[(7, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.179 GB, invar_size=1.256 GB, outvar_size=0.545 GB, temp_buffer_size=0.755 GB, available_memory=35.242 GB)
result[(6, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.405 GB, invar_size=1.469 GB, outvar_size=0.567 GB, temp_buffer_size=0.769 GB, available_memory=35.242 GB)
result[(7, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.443 GB, invar_size=1.520 GB, outvar_size=0.634 GB, temp_buffer_size=0.756 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.378 GB, invar_size=0.343 GB, outvar_size=0.586 GB, temp_buffer_size=0.449 GB, available_memory=35.242 GB)
result[(5, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.248 GB, invar_size=0.410 GB, outvar_size=0.503 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.044 GB, invar_size=0.314 GB, outvar_size=1.005 GB, temp_buffer_size=0.725 GB, available_memory=35.242 GB)
result[(8, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.738 GB, invar_size=1.137 GB, outvar_size=0.443 GB, temp_buffer_size=0.517 GB, available_memory=35.242 GB)
result[(5, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.248 GB, invar_size=0.410 GB, outvar_size=0.503 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(6, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.255 GB, invar_size=0.478 GB, outvar_size=0.419 GB, temp_buffer_size=0.359 GB, available_memory=35.242 GB)
result[(8, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.738 GB, invar_size=1.137 GB, outvar_size=0.443 GB, temp_buffer_size=0.517 GB, available_memory=35.242 GB)
result[(7, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.443 GB, invar_size=1.520 GB, outvar_size=0.634 GB, temp_buffer_size=0.756 GB, available_memory=35.242 GB)
result[(6, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.255 GB, invar_size=0.478 GB, outvar_size=0.419 GB, temp_buffer_size=0.359 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.044 GB, invar_size=0.314 GB, outvar_size=1.005 GB, temp_buffer_size=0.725 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.853 GB, invar_size=0.062 GB, outvar_size=1.089 GB, temp_buffer_size=0.702 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.853 GB, invar_size=0.062 GB, outvar_size=1.089 GB, temp_buffer_size=0.702 GB, available_memory=35.242 GB)
result[(7, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.215 GB, invar_size=0.545 GB, outvar_size=0.335 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(9, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.738 GB, invar_size=1.137 GB, outvar_size=0.443 GB, temp_buffer_size=0.517 GB, available_memory=35.242 GB)
result[(9, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.738 GB, invar_size=1.137 GB, outvar_size=0.443 GB, temp_buffer_size=0.517 GB, available_memory=35.242 GB)
result[(8, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.002 GB, invar_size=1.400 GB, outvar_size=0.533 GB, temp_buffer_size=0.518 GB, available_memory=35.242 GB)
result[(8, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.002 GB, invar_size=1.400 GB, outvar_size=0.533 GB, temp_buffer_size=0.518 GB, available_memory=35.242 GB)
result[(7, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.215 GB, invar_size=0.545 GB, outvar_size=0.335 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(8, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.970 GB, invar_size=0.443 GB, outvar_size=0.335 GB, temp_buffer_size=0.192 GB, available_memory=35.242 GB)
result[(8, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.970 GB, invar_size=0.443 GB, outvar_size=0.335 GB, temp_buffer_size=0.192 GB, available_memory=35.242 GB)
result[(9, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.946 GB, invar_size=0.443 GB, outvar_size=0.335 GB, temp_buffer_size=0.168 GB, available_memory=35.242 GB)
result[(9, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.830 GB, invar_size=2.040 GB, outvar_size=0.874 GB, temp_buffer_size=0.706 GB, available_memory=35.242 GB)
result[(10, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.567 GB, invar_size=1.777 GB, outvar_size=0.784 GB, temp_buffer_size=0.706 GB, available_memory=35.242 GB)
result[(9, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.946 GB, invar_size=0.443 GB, outvar_size=0.335 GB, temp_buffer_size=0.168 GB, available_memory=35.242 GB)
result[(10, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.567 GB, invar_size=1.777 GB, outvar_size=0.784 GB, temp_buffer_size=0.706 GB, available_memory=35.242 GB)
result[(9, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.830 GB, invar_size=2.040 GB, outvar_size=0.874 GB, temp_buffer_size=0.706 GB, available_memory=35.242 GB)
result[(11, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.106 GB, invar_size=2.274 GB, outvar_size=1.053 GB, temp_buffer_size=0.749 GB, available_memory=35.242 GB)
result[(11, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.106 GB, invar_size=2.274 GB, outvar_size=1.053 GB, temp_buffer_size=0.749 GB, available_memory=35.242 GB)
result[(10, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.369 GB, invar_size=2.537 GB, outvar_size=1.143 GB, temp_buffer_size=0.749 GB, available_memory=35.242 GB)
result[(12, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.616 GB, invar_size=2.783 GB, outvar_size=1.350 GB, temp_buffer_size=0.750 GB, available_memory=35.242 GB)
result[(10, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.369 GB, invar_size=2.537 GB, outvar_size=1.143 GB, temp_buffer_size=0.749 GB, available_memory=35.242 GB)
result[(11, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.880 GB, invar_size=3.046 GB, outvar_size=1.439 GB, temp_buffer_size=0.750 GB, available_memory=35.242 GB)
result[(11, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.880 GB, invar_size=3.046 GB, outvar_size=1.439 GB, temp_buffer_size=0.750 GB, available_memory=35.242 GB)
result[(12, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.616 GB, invar_size=2.783 GB, outvar_size=1.350 GB, temp_buffer_size=0.750 GB, available_memory=35.242 GB)
result[(10, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.425 GB, invar_size=0.784 GB, outvar_size=0.293 GB, temp_buffer_size=0.347 GB, available_memory=35.242 GB)
result[(6, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.405 GB, invar_size=0.567 GB, outvar_size=0.503 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(10, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.425 GB, invar_size=0.784 GB, outvar_size=0.293 GB, temp_buffer_size=0.347 GB, available_memory=35.242 GB)
result[(6, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.405 GB, invar_size=0.567 GB, outvar_size=0.503 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(7, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.389 GB, invar_size=0.635 GB, outvar_size=0.419 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(8, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.143 GB, invar_size=0.533 GB, outvar_size=0.419 GB, temp_buffer_size=0.192 GB, available_memory=35.242 GB)
result[(7, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.389 GB, invar_size=0.635 GB, outvar_size=0.419 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(11, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.688 GB, invar_size=1.054 GB, outvar_size=0.252 GB, temp_buffer_size=0.383 GB, available_memory=35.242 GB)
result[(8, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.143 GB, invar_size=0.533 GB, outvar_size=0.419 GB, temp_buffer_size=0.192 GB, available_memory=35.242 GB)
result[(11, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.688 GB, invar_size=1.054 GB, outvar_size=0.252 GB, temp_buffer_size=0.383 GB, available_memory=35.242 GB)
result[(12, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.865 GB, invar_size=1.350 GB, outvar_size=0.168 GB, temp_buffer_size=0.347 GB, available_memory=35.242 GB)
result[(12, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.865 GB, invar_size=1.350 GB, outvar_size=0.168 GB, temp_buffer_size=0.347 GB, available_memory=35.242 GB)
result[(9, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.598 GB, invar_size=0.874 GB, outvar_size=0.377 GB, temp_buffer_size=0.347 GB, available_memory=35.242 GB)
result[(9, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.598 GB, invar_size=0.874 GB, outvar_size=0.377 GB, temp_buffer_size=0.347 GB, available_memory=35.242 GB)
result[(10, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.862 GB, invar_size=1.144 GB, outvar_size=0.335 GB, temp_buffer_size=0.383 GB, available_memory=35.242 GB)
result[(10, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.862 GB, invar_size=1.144 GB, outvar_size=0.335 GB, temp_buffer_size=0.383 GB, available_memory=35.242 GB)
result[(11, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.039 GB, invar_size=1.440 GB, outvar_size=0.252 GB, temp_buffer_size=0.347 GB, available_memory=35.242 GB)
result[(11, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.039 GB, invar_size=1.440 GB, outvar_size=0.252 GB, temp_buffer_size=0.347 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 45.84 seconds
--------------------------------------------------
----------------------------------------------------------------------
[TMP] Stage (0, 6, 1, 0) has been pruned...
[TMP] Stage (0, 6, 1, 1) has been pruned...
[TMP] Stage (0, 7, 1, 0) has been pruned...
[TMP] Stage (0, 7, 1, 1) has been pruned...
[TMP] Stage (0, 8, 1, 0) has been pruned...
[TMP] Stage (0, 8, 1, 1) has been pruned...
[TMP] Stage (1, 6, 1, 0) has been pruned...
[TMP] Stage (1, 6, 1, 1) has been pruned...
[TMP] Stage (1, 7, 1, 0) has been pruned...
[TMP] Stage (1, 7, 1, 1) has been pruned...
[TMP] Stage (1, 8, 1, 0) has been pruned...
[TMP] Stage (1, 8, 1, 1) has been pruned...
[TMP] Stage (1, 9, 1, 0) has been pruned...
[TMP] Stage (1, 9, 1, 1) has been pruned...
[TMP] Stage (2, 7, 1, 0) has been pruned...
[TMP] Stage (2, 7, 1, 1) has been pruned...
[TMP] Stage (2, 8, 1, 0) has been pruned...
[TMP] Stage (2, 8, 1, 1) has been pruned...
[TMP] Stage (2, 9, 1, 0) has been pruned...
[TMP] Stage (2, 9, 1, 1) has been pruned...
[TMP] Stage (2, 10, 1, 0) has been pruned...
[TMP] Stage (2, 10, 1, 1) has been pruned...
[TMP] Stage (3, 9, 1, 0) has been pruned...
[TMP] Stage (3, 9, 1, 1) has been pruned...
[TMP] Stage (3, 10, 1, 0) has been pruned...
[TMP] Stage (3, 10, 1, 1) has been pruned...
[TMP] Stage (3, 11, 1, 0) has been pruned...
[TMP] Stage (3, 11, 1, 1) has been pruned...
[TMP] Stage (4, 10, 1, 0) has been pruned...
[TMP] Stage (4, 10, 1, 1) has been pruned...
[TMP] Stage (4, 11, 1, 0) has been pruned...
[TMP] Stage (4, 11, 1, 1) has been pruned...
[TMP] Stage (4, 12, 1, 0) has been pruned...
[TMP] Stage (4, 12, 1, 1) has been pruned...
[TMP] Stage (4, 13, 1, 0) has been pruned...
[TMP] Stage (4, 13, 1, 1) has been pruned...
[TMP] Stage (5, 11, 1, 0) has been pruned...
[TMP] Stage (5, 11, 1, 1) has been pruned...
[TMP] Stage (5, 12, 1, 0) has been pruned...
[TMP] Stage (5, 12, 1, 1) has been pruned...
[TMP] Stage (5, 13, 1, 0) has been pruned...
[TMP] Stage (5, 13, 1, 1) has been pruned...
[TMP] Stage (5, 14, 1, 0) has been pruned...
[TMP] Stage (5, 14, 1, 1) has been pruned...
[TMP] Stage (6, 12, 1, 0) has been pruned...
[TMP] Stage (6, 12, 1, 1) has been pruned...
[TMP] Stage (6, 13, 1, 0) has been pruned...
[TMP] Stage (6, 13, 1, 1) has been pruned...
[TMP] Stage (6, 14, 1, 0) has been pruned...
[TMP] Stage (6, 14, 1, 1) has been pruned...
[TMP] Stage (6, 15, 1, 0) has been pruned...
[TMP] Stage (6, 15, 1, 1) has been pruned...
[TMP] Stage (7, 13, 1, 0) has been pruned...
[TMP] Stage (7, 13, 1, 1) has been pruned...
[TMP] Stage (7, 14, 1, 0) has been pruned...
[TMP] Stage (7, 14, 1, 1) has been pruned...
[TMP] Stage (7, 15, 1, 0) has been pruned...
[TMP] Stage (7, 15, 1, 1) has been pruned...
[TMP] Stage (8, 14, 1, 0) has been pruned...
[TMP] Stage (8, 14, 1, 1) has been pruned...
[TMP] Stage (8, 15, 1, 0) has been pruned...
[TMP] Stage (8, 15, 1, 1) has been pruned...
[TMP] Stage (9, 15, 1, 0) has been pruned...
[TMP] Stage (9, 15, 1, 1) has been pruned...
Result forward_stage_layer_ids: [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]]
Result mesh_shapes: [(1, 1), (1, 1), (1, 1), (1, 1)]
Result logical_mesh_shapes: [(1, 1), (1, 1), (1, 1), (1, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 97.79 s
compilation time breakdown: {'stage-construction': '77.34', 'stage-construction-dp': '1.40', 'stage-construction-compilation': '17.87', 'stage-construction-profiling': '29.29'}
 - Compile (worker): 7.93 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 107.76 s

[18.587801218032837, 14.074866533279419, 14.096751928329468, 14.280889511108398, 14.23383092880249, 13.979194164276123, 14.09506630897522]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 73.627 s.
 - Average e2e iteration time: 14.725000381469727 s.
 - Total local training time: 70.68600463867188 s.
 - Average local iteration time: 14.137001037597656 s.
 - Max allocated memory among devices: 18.26 GB.
 - Compilation times:  {'stage-construction': 77.3375952243805, 'stage-construction-dp': 1.3951160907745361, 'stage-construction-compilation': 17.86568808555603, 'stage-construction-profiling': 29.289470195770264}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `4_a40_4_n_1_d`: 14.137147903442383
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/wide_resnet_500M_512.pkl`...

------------------------------------------------------------------
- (3/3) Profiling wide_resnet_500M with batch size: 1024...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/wide_resnet_500M_1024.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 1
    - Nodes num: 4
[I] Loading flax model....
[I] Model 'wide_resnet' loads sucessfully. Model Info: 

WideResNet(
    # attributes
    stage_sizes = [3, 4, 6, 3]
    block_cls = BottleneckResNetBlock
    num_classes = 1024
    num_filters = 224
    width_factor = 2
    dtype = float32
    act = relu
) 

[I] Compiling and executing model with timeout = 1200 s...
[I] Manually construct dummy batch with the shape of (1024, 224, 224, 3).
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (2, 1), (4, 1))
- Profiling for submesh 2 (4, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 15, 2, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=3.870 GB, invar_size=1.854 GB, outvar_size=1.089 GB, temp_buffer_size=0.928 GB, available_memory=35.242 GB)
result[(0, 15, 2, 0), 1] = ModuleProfileResult(compute_cost=0.428, peak_memory=7.227 GB, invar_size=4.786 GB, outvar_size=1.844 GB, temp_buffer_size=2.441 GB, available_memory=35.242 GB)
result[(0, 15, 2, 1), 0] = ModuleProfileResult(compute_cost=0.594, peak_memory=2.751 GB, invar_size=1.061 GB, outvar_size=1.089 GB, temp_buffer_size=0.601 GB, available_memory=35.242 GB)
result[(0, 15, 2, 1), 1] = ModuleProfileResult(compute_cost=1.293, peak_memory=4.696 GB, invar_size=3.201 GB, outvar_size=1.052 GB, temp_buffer_size=1.494 GB, available_memory=35.242 GB)
Profiling for submesh 2 (4, 1) takes 29.95 seconds
--------------------------------------------------
- Profiling for submesh 1 (2, 1):
[TMP] Skip profiling of 2 due to legacy error in tensorflow...
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(3, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.200 GB, invar_size=1.819 GB, outvar_size=0.742 GB, temp_buffer_size=2.712 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.051 GB, invar_size=1.857 GB, outvar_size=0.510 GB, temp_buffer_size=1.858 GB, available_memory=35.242 GB)
result[(2, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.478 GB, invar_size=2.120 GB, outvar_size=0.725 GB, temp_buffer_size=3.689 GB, available_memory=35.242 GB)
result[(2, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.456 GB, invar_size=0.725 GB, outvar_size=1.340 GB, temp_buffer_size=1.391 GB, available_memory=35.242 GB)
result[(1, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.789 GB, invar_size=2.258 GB, outvar_size=0.543 GB, temp_buffer_size=5.029 GB, available_memory=35.242 GB)
result[(3, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.590 GB, invar_size=0.742 GB, outvar_size=1.005 GB, temp_buffer_size=0.843 GB, available_memory=35.242 GB)
result[(3, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.590 GB, invar_size=0.742 GB, outvar_size=1.005 GB, temp_buffer_size=0.843 GB, available_memory=35.242 GB)
result[(3, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.200 GB, invar_size=1.819 GB, outvar_size=0.742 GB, temp_buffer_size=2.712 GB, available_memory=35.242 GB)
result[(2, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.478 GB, invar_size=2.120 GB, outvar_size=0.725 GB, temp_buffer_size=3.689 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.859 GB, invar_size=2.500 GB, outvar_size=0.747 GB, temp_buffer_size=3.689 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.581 GB, invar_size=2.198 GB, outvar_size=0.764 GB, temp_buffer_size=2.712 GB, available_memory=35.242 GB)
result[(2, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.456 GB, invar_size=0.725 GB, outvar_size=1.340 GB, temp_buffer_size=1.391 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=6.859 GB, invar_size=2.500 GB, outvar_size=0.747 GB, temp_buffer_size=3.689 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=5.581 GB, invar_size=2.198 GB, outvar_size=0.764 GB, temp_buffer_size=2.712 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.833 GB, invar_size=2.301 GB, outvar_size=0.044 GB, temp_buffer_size=5.531 GB, available_memory=35.242 GB)
result[(1, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.789 GB, invar_size=2.258 GB, outvar_size=0.543 GB, temp_buffer_size=5.029 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=7.833 GB, invar_size=2.301 GB, outvar_size=0.044 GB, temp_buffer_size=5.531 GB, available_memory=35.242 GB)
result[(1, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.590 GB, invar_size=0.543 GB, outvar_size=1.675 GB, temp_buffer_size=1.372 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.170 GB, invar_size=2.638 GB, outvar_size=0.565 GB, temp_buffer_size=5.029 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=8.170 GB, invar_size=2.638 GB, outvar_size=0.565 GB, temp_buffer_size=5.029 GB, available_memory=35.242 GB)
result[(1, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.590 GB, invar_size=0.543 GB, outvar_size=1.675 GB, temp_buffer_size=1.372 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.051 GB, invar_size=1.857 GB, outvar_size=0.510 GB, temp_buffer_size=1.858 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.822 GB, invar_size=0.748 GB, outvar_size=1.675 GB, temp_buffer_size=1.400 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.466 GB, invar_size=0.510 GB, outvar_size=1.173 GB, temp_buffer_size=0.784 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.843 GB, invar_size=0.764 GB, outvar_size=1.340 GB, temp_buffer_size=0.739 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.843 GB, invar_size=0.764 GB, outvar_size=1.340 GB, temp_buffer_size=0.739 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.822 GB, invar_size=0.748 GB, outvar_size=1.675 GB, temp_buffer_size=1.400 GB, available_memory=35.242 GB)
result[(6, 9, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.650 GB, invar_size=1.792 GB, outvar_size=0.645 GB, temp_buffer_size=1.523 GB, available_memory=35.242 GB)
result[(5, 8, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.018 GB, invar_size=1.825 GB, outvar_size=0.577 GB, temp_buffer_size=1.858 GB, available_memory=35.242 GB)
result[(5, 8, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.018 GB, invar_size=1.825 GB, outvar_size=0.577 GB, temp_buffer_size=1.858 GB, available_memory=35.242 GB)
result[(6, 9, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.650 GB, invar_size=1.792 GB, outvar_size=0.645 GB, temp_buffer_size=1.523 GB, available_memory=35.242 GB)
result[(7, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.526 GB, invar_size=1.759 GB, outvar_size=0.712 GB, temp_buffer_size=1.432 GB, available_memory=35.242 GB)
result[(6, 10, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.998 GB, invar_size=2.139 GB, outvar_size=0.734 GB, temp_buffer_size=1.524 GB, available_memory=35.242 GB)
result[(6, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.998 GB, invar_size=2.139 GB, outvar_size=0.734 GB, temp_buffer_size=1.524 GB, available_memory=35.242 GB)
result[(7, 10, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.526 GB, invar_size=1.759 GB, outvar_size=0.712 GB, temp_buffer_size=1.432 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.466 GB, invar_size=0.510 GB, outvar_size=1.173 GB, temp_buffer_size=0.784 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.630 GB, invar_size=0.080 GB, outvar_size=2.177 GB, temp_buffer_size=1.372 GB, available_memory=35.242 GB)
result[(8, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.703 GB, invar_size=1.556 GB, outvar_size=0.527 GB, temp_buffer_size=0.980 GB, available_memory=35.242 GB)
result[(7, 11, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.874 GB, invar_size=2.106 GB, outvar_size=0.802 GB, temp_buffer_size=1.433 GB, available_memory=35.242 GB)
result[(5, 8, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.253 GB, invar_size=0.578 GB, outvar_size=1.005 GB, temp_buffer_size=0.670 GB, available_memory=35.242 GB)
result[(5, 8, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.253 GB, invar_size=0.578 GB, outvar_size=1.005 GB, temp_buffer_size=0.670 GB, available_memory=35.242 GB)
result[(8, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.703 GB, invar_size=1.556 GB, outvar_size=0.527 GB, temp_buffer_size=0.980 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.630 GB, invar_size=0.080 GB, outvar_size=2.177 GB, temp_buffer_size=1.372 GB, available_memory=35.242 GB)
result[(6, 9, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.392 GB, invar_size=0.645 GB, outvar_size=0.838 GB, temp_buffer_size=0.909 GB, available_memory=35.242 GB)
result[(7, 11, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.874 GB, invar_size=2.106 GB, outvar_size=0.802 GB, temp_buffer_size=1.433 GB, available_memory=35.242 GB)
result[(6, 9, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.392 GB, invar_size=0.645 GB, outvar_size=0.838 GB, temp_buffer_size=0.909 GB, available_memory=35.242 GB)
result[(7, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.992 GB, invar_size=0.712 GB, outvar_size=0.670 GB, temp_buffer_size=0.610 GB, available_memory=35.242 GB)
result[(9, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.703 GB, invar_size=1.556 GB, outvar_size=0.527 GB, temp_buffer_size=0.980 GB, available_memory=35.242 GB)
result[(7, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.992 GB, invar_size=0.712 GB, outvar_size=0.670 GB, temp_buffer_size=0.610 GB, available_memory=35.242 GB)
result[(8, 12, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.051 GB, invar_size=1.903 GB, outvar_size=0.616 GB, temp_buffer_size=0.981 GB, available_memory=35.242 GB)
result[(8, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.051 GB, invar_size=1.903 GB, outvar_size=0.616 GB, temp_buffer_size=0.981 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.970 GB, invar_size=0.566 GB, outvar_size=2.010 GB, temp_buffer_size=1.395 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.970 GB, invar_size=0.566 GB, outvar_size=2.010 GB, temp_buffer_size=1.395 GB, available_memory=35.242 GB)
result[(9, 12, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.703 GB, invar_size=1.556 GB, outvar_size=0.527 GB, temp_buffer_size=0.980 GB, available_memory=35.242 GB)
result[(8, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.616 GB, invar_size=0.527 GB, outvar_size=0.670 GB, temp_buffer_size=0.419 GB, available_memory=35.242 GB)
result[(8, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.616 GB, invar_size=0.527 GB, outvar_size=0.670 GB, temp_buffer_size=0.419 GB, available_memory=35.242 GB)
result[(9, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.532 GB, invar_size=0.527 GB, outvar_size=0.670 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(10, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.328 GB, invar_size=2.154 GB, outvar_size=0.868 GB, temp_buffer_size=1.007 GB, available_memory=35.242 GB)
result[(10, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.328 GB, invar_size=2.154 GB, outvar_size=0.868 GB, temp_buffer_size=1.007 GB, available_memory=35.242 GB)
result[(9, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.532 GB, invar_size=0.527 GB, outvar_size=0.670 GB, temp_buffer_size=0.335 GB, available_memory=35.242 GB)
result[(9, 13, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.704 GB, invar_size=2.501 GB, outvar_size=0.957 GB, temp_buffer_size=1.035 GB, available_memory=35.242 GB)
result[(9, 13, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.704 GB, invar_size=2.501 GB, outvar_size=0.957 GB, temp_buffer_size=1.035 GB, available_memory=35.242 GB)
result[(11, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.827 GB, invar_size=2.609 GB, outvar_size=1.137 GB, temp_buffer_size=1.051 GB, available_memory=35.242 GB)
result[(11, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=3.827 GB, invar_size=2.609 GB, outvar_size=1.137 GB, temp_buffer_size=1.051 GB, available_memory=35.242 GB)
result[(10, 14, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.132 GB, invar_size=2.956 GB, outvar_size=1.227 GB, temp_buffer_size=1.009 GB, available_memory=35.242 GB)
result[(10, 14, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.132 GB, invar_size=2.956 GB, outvar_size=1.227 GB, temp_buffer_size=1.009 GB, available_memory=35.242 GB)
result[(12, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.239 GB, invar_size=3.034 GB, outvar_size=1.433 GB, temp_buffer_size=1.037 GB, available_memory=35.242 GB)
result[(11, 15, 0, 0), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.602 GB, invar_size=3.381 GB, outvar_size=1.523 GB, temp_buffer_size=1.053 GB, available_memory=35.242 GB)
result[(11, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.602 GB, invar_size=3.381 GB, outvar_size=1.523 GB, temp_buffer_size=1.053 GB, available_memory=35.242 GB)
result[(12, 15, 0, 1), 1] = ModuleProfileResult(compute_cost=0.000, peak_memory=4.239 GB, invar_size=3.034 GB, outvar_size=1.433 GB, temp_buffer_size=1.037 GB, available_memory=35.242 GB)
result[(6, 10, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.715 GB, invar_size=0.735 GB, outvar_size=1.005 GB, temp_buffer_size=0.975 GB, available_memory=35.242 GB)
result[(6, 10, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.715 GB, invar_size=0.735 GB, outvar_size=1.005 GB, temp_buffer_size=0.975 GB, available_memory=35.242 GB)
result[(10, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.957 GB, invar_size=0.868 GB, outvar_size=0.586 GB, temp_buffer_size=0.503 GB, available_memory=35.242 GB)
result[(10, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.957 GB, invar_size=0.868 GB, outvar_size=0.586 GB, temp_buffer_size=0.503 GB, available_memory=35.242 GB)
result[(8, 12, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.873 GB, invar_size=0.617 GB, outvar_size=0.838 GB, temp_buffer_size=0.419 GB, available_memory=35.242 GB)
result[(11, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.190 GB, invar_size=1.137 GB, outvar_size=0.503 GB, temp_buffer_size=0.550 GB, available_memory=35.242 GB)
result[(8, 12, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=1.873 GB, invar_size=0.617 GB, outvar_size=0.838 GB, temp_buffer_size=0.419 GB, available_memory=35.242 GB)
result[(11, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.190 GB, invar_size=1.137 GB, outvar_size=0.503 GB, temp_buffer_size=0.550 GB, available_memory=35.242 GB)
result[(7, 11, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.334 GB, invar_size=0.802 GB, outvar_size=0.838 GB, temp_buffer_size=0.694 GB, available_memory=35.242 GB)
result[(12, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.248 GB, invar_size=1.434 GB, outvar_size=0.335 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(7, 11, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.334 GB, invar_size=0.802 GB, outvar_size=0.838 GB, temp_buffer_size=0.694 GB, available_memory=35.242 GB)
result[(12, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.248 GB, invar_size=1.434 GB, outvar_size=0.335 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(9, 13, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.214 GB, invar_size=0.958 GB, outvar_size=0.754 GB, temp_buffer_size=0.503 GB, available_memory=35.242 GB)
result[(9, 13, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.214 GB, invar_size=0.958 GB, outvar_size=0.754 GB, temp_buffer_size=0.503 GB, available_memory=35.242 GB)
result[(10, 14, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.448 GB, invar_size=1.227 GB, outvar_size=0.670 GB, temp_buffer_size=0.551 GB, available_memory=35.242 GB)
result[(10, 14, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.448 GB, invar_size=1.227 GB, outvar_size=0.670 GB, temp_buffer_size=0.551 GB, available_memory=35.242 GB)
result[(11, 15, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.505 GB, invar_size=1.524 GB, outvar_size=0.503 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
result[(11, 15, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=2.505 GB, invar_size=1.524 GB, outvar_size=0.503 GB, temp_buffer_size=0.479 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 45.65 seconds
--------------------------------------------------
----------------------------------------------------------------------
[TMP] Stage (0, 6, 1, 0) has been pruned...
[TMP] Stage (0, 6, 1, 1) has been pruned...
[TMP] Stage (0, 7, 1, 0) has been pruned...
[TMP] Stage (0, 7, 1, 1) has been pruned...
[TMP] Stage (0, 8, 1, 0) has been pruned...
[TMP] Stage (0, 8, 1, 1) has been pruned...
[TMP] Stage (1, 6, 1, 0) has been pruned...
[TMP] Stage (1, 6, 1, 1) has been pruned...
[TMP] Stage (1, 7, 1, 0) has been pruned...
[TMP] Stage (1, 7, 1, 1) has been pruned...
[TMP] Stage (1, 8, 1, 0) has been pruned...
[TMP] Stage (1, 8, 1, 1) has been pruned...
[TMP] Stage (1, 9, 1, 0) has been pruned...
[TMP] Stage (1, 9, 1, 1) has been pruned...
[TMP] Stage (2, 7, 1, 0) has been pruned...
[TMP] Stage (2, 7, 1, 1) has been pruned...
[TMP] Stage (2, 8, 1, 0) has been pruned...
[TMP] Stage (2, 8, 1, 1) has been pruned...
[TMP] Stage (2, 9, 1, 0) has been pruned...
[TMP] Stage (2, 9, 1, 1) has been pruned...
[TMP] Stage (2, 10, 1, 0) has been pruned...
[TMP] Stage (2, 10, 1, 1) has been pruned...
[TMP] Stage (3, 9, 1, 0) has been pruned...
[TMP] Stage (3, 9, 1, 1) has been pruned...
[TMP] Stage (3, 10, 1, 0) has been pruned...
[TMP] Stage (3, 10, 1, 1) has been pruned...
[TMP] Stage (3, 11, 1, 0) has been pruned...
[TMP] Stage (3, 11, 1, 1) has been pruned...
[TMP] Stage (4, 10, 1, 0) has been pruned...
[TMP] Stage (4, 10, 1, 1) has been pruned...
[TMP] Stage (4, 11, 1, 0) has been pruned...
[TMP] Stage (4, 11, 1, 1) has been pruned...
[TMP] Stage (4, 12, 1, 0) has been pruned...
[TMP] Stage (4, 12, 1, 1) has been pruned...
[TMP] Stage (4, 13, 1, 0) has been pruned...
[TMP] Stage (4, 13, 1, 1) has been pruned...
[TMP] Stage (5, 11, 1, 0) has been pruned...
[TMP] Stage (5, 11, 1, 1) has been pruned...
[TMP] Stage (5, 12, 1, 0) has been pruned...
[TMP] Stage (5, 12, 1, 1) has been pruned...
[TMP] Stage (5, 13, 1, 0) has been pruned...
[TMP] Stage (5, 13, 1, 1) has been pruned...
[TMP] Stage (5, 14, 1, 0) has been pruned...
[TMP] Stage (5, 14, 1, 1) has been pruned...
[TMP] Stage (6, 12, 1, 0) has been pruned...
[TMP] Stage (6, 12, 1, 1) has been pruned...
[TMP] Stage (6, 13, 1, 0) has been pruned...
[TMP] Stage (6, 13, 1, 1) has been pruned...
[TMP] Stage (6, 14, 1, 0) has been pruned...
[TMP] Stage (6, 14, 1, 1) has been pruned...
[TMP] Stage (6, 15, 1, 0) has been pruned...
[TMP] Stage (6, 15, 1, 1) has been pruned...
[TMP] Stage (7, 13, 1, 0) has been pruned...
[TMP] Stage (7, 13, 1, 1) has been pruned...
[TMP] Stage (7, 14, 1, 0) has been pruned...
[TMP] Stage (7, 14, 1, 1) has been pruned...
[TMP] Stage (7, 15, 1, 0) has been pruned...
[TMP] Stage (7, 15, 1, 1) has been pruned...
[TMP] Stage (8, 14, 1, 0) has been pruned...
[TMP] Stage (8, 14, 1, 1) has been pruned...
[TMP] Stage (8, 15, 1, 0) has been pruned...
[TMP] Stage (8, 15, 1, 1) has been pruned...
[TMP] Stage (9, 15, 1, 0) has been pruned...
[TMP] Stage (9, 15, 1, 1) has been pruned...
Result forward_stage_layer_ids: [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]]
Result mesh_shapes: [(1, 1), (1, 1), (1, 1), (1, 1)]
Result logical_mesh_shapes: [(1, 1), (1, 1), (1, 1), (1, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 98.60 s
compilation time breakdown: {'stage-construction': '78.31', 'stage-construction-dp': '1.48', 'stage-construction-compilation': '16.94', 'stage-construction-profiling': '30.73'}
 - Compile (worker): 7.72 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
[E] Meet unexpected error in profiling executables...

[E] Unexpected error occurred in compiling or profiling executables...
