
------------------------------------------------------------------
- (1/3) Profiling moe_2.4B with batch size: 256...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/moe_2.4B_256.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 4
[I] Loading flax model....
[I] Model 'moe' loads sucessfully. Model Info: 

FlaxMoEForLMModule(
    # attributes
    config = <model.moe_model.MoEConfig object at 0x7f37bf8e12b0>
    dtype = float16
    bias_init = zeros
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2), (4, 2))
- Profiling for submesh 3 (4, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 7, 3, 0), 0] = ModuleProfileResult(compute_cost=0.028, peak_memory=4.048 GB, invar_size=3.892 GB, outvar_size=0.027 GB, temp_buffer_size=0.129 GB, available_memory=17.402 GB)
result[(0, 7, 3, 1), 0] = ModuleProfileResult(compute_cost=0.060, peak_memory=2.130 GB, invar_size=1.946 GB, outvar_size=0.055 GB, temp_buffer_size=0.129 GB, available_memory=17.402 GB)
result[(0, 7, 3, 2), 0] = ModuleProfileResult(compute_cost=0.060, peak_memory=0.986 GB, invar_size=0.829 GB, outvar_size=0.027 GB, temp_buffer_size=0.129 GB, available_memory=17.402 GB)
result[(0, 7, 3, 0), 1] = ModuleProfileResult(compute_cost=0.379, peak_memory=13.527 GB, invar_size=9.027 GB, outvar_size=4.500 GB, temp_buffer_size=4.500 GB, available_memory=17.402 GB)
result[(0, 7, 3, 1), 1] = ModuleProfileResult(compute_cost=0.380, peak_memory=6.805 GB, invar_size=4.555 GB, outvar_size=2.250 GB, temp_buffer_size=2.250 GB, available_memory=17.402 GB)
result[(0, 7, 3, 2), 1] = ModuleProfileResult(compute_cost=0.201, peak_memory=2.818 GB, invar_size=2.027 GB, outvar_size=1.000 GB, temp_buffer_size=0.792 GB, available_memory=17.402 GB)
Profiling for submesh 3 (4, 2) takes 82.54 seconds
--------------------------------------------------
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 3, 2, 2), 0] = ModuleProfileResult(compute_cost=0.053, peak_memory=1.009 GB, invar_size=0.720 GB, outvar_size=0.031 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(0, 3, 2, 0), 0] = ModuleProfileResult(compute_cost=0.030, peak_memory=2.509 GB, invar_size=2.220 GB, outvar_size=0.031 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(0, 3, 2, 1), 0] = ModuleProfileResult(compute_cost=0.046, peak_memory=1.540 GB, invar_size=1.110 GB, outvar_size=0.031 GB, temp_buffer_size=0.399 GB, available_memory=17.580 GB)
result[(1, 4, 2, 0), 0] = ModuleProfileResult(compute_cost=0.030, peak_memory=2.516 GB, invar_size=2.227 GB, outvar_size=0.031 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(1, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=3.071 GB, invar_size=2.774 GB, outvar_size=0.039 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(1, 4, 2, 2), 0] = ModuleProfileResult(compute_cost=0.053, peak_memory=1.016 GB, invar_size=0.727 GB, outvar_size=0.031 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(1, 4, 2, 1), 0] = ModuleProfileResult(compute_cost=0.048, peak_memory=1.587 GB, invar_size=1.125 GB, outvar_size=0.031 GB, temp_buffer_size=0.430 GB, available_memory=17.580 GB)
result[(2, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.030, peak_memory=2.516 GB, invar_size=2.227 GB, outvar_size=0.031 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(2, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.048, peak_memory=1.587 GB, invar_size=1.125 GB, outvar_size=0.031 GB, temp_buffer_size=0.430 GB, available_memory=17.580 GB)
result[(1, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.066, peak_memory=1.196 GB, invar_size=0.899 GB, outvar_size=0.039 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(1, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.059, peak_memory=1.915 GB, invar_size=1.399 GB, outvar_size=0.039 GB, temp_buffer_size=0.477 GB, available_memory=17.580 GB)
result[(0, 3, 2, 0), 1] = ModuleProfileResult(compute_cost=0.200, peak_memory=6.690 GB, invar_size=4.470 GB, outvar_size=2.220 GB, temp_buffer_size=2.220 GB, available_memory=17.580 GB)
result[(1, 4, 2, 0), 1] = ModuleProfileResult(compute_cost=0.203, peak_memory=6.704 GB, invar_size=4.477 GB, outvar_size=2.227 GB, temp_buffer_size=2.219 GB, available_memory=17.580 GB)
result[(2, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.053, peak_memory=1.016 GB, invar_size=0.727 GB, outvar_size=0.031 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(0, 3, 2, 2), 1] = ModuleProfileResult(compute_cost=0.143, peak_memory=2.708 GB, invar_size=1.470 GB, outvar_size=0.720 GB, temp_buffer_size=1.238 GB, available_memory=17.580 GB)
result[(0, 3, 2, 1), 1] = ModuleProfileResult(compute_cost=0.233, peak_memory=3.852 GB, invar_size=2.251 GB, outvar_size=1.110 GB, temp_buffer_size=1.601 GB, available_memory=17.580 GB)
result[(1, 4, 2, 2), 1] = ModuleProfileResult(compute_cost=0.145, peak_memory=2.799 GB, invar_size=1.501 GB, outvar_size=0.727 GB, temp_buffer_size=1.290 GB, available_memory=17.580 GB)
result[(1, 4, 2, 1), 1] = ModuleProfileResult(compute_cost=0.244, peak_memory=3.709 GB, invar_size=2.274 GB, outvar_size=1.125 GB, temp_buffer_size=1.419 GB, available_memory=17.580 GB)
result[(2, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.203, peak_memory=6.704 GB, invar_size=4.477 GB, outvar_size=2.227 GB, temp_buffer_size=2.219 GB, available_memory=17.580 GB)
result[(2, 6, 2, 0), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=3.071 GB, invar_size=2.774 GB, outvar_size=0.039 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(3, 6, 2, 0), 0] = ModuleProfileResult(compute_cost=0.030, peak_memory=2.516 GB, invar_size=2.227 GB, outvar_size=0.031 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(2, 6, 2, 1), 0] = ModuleProfileResult(compute_cost=0.059, peak_memory=1.915 GB, invar_size=1.399 GB, outvar_size=0.039 GB, temp_buffer_size=0.477 GB, available_memory=17.580 GB)
result[(2, 6, 2, 2), 0] = ModuleProfileResult(compute_cost=0.066, peak_memory=1.196 GB, invar_size=0.899 GB, outvar_size=0.039 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(1, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.252, peak_memory=8.353 GB, invar_size=5.579 GB, outvar_size=2.774 GB, temp_buffer_size=2.766 GB, available_memory=17.580 GB)
result[(1, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.180, peak_memory=3.127 GB, invar_size=1.829 GB, outvar_size=0.899 GB, temp_buffer_size=1.290 GB, available_memory=17.580 GB)
result[(3, 6, 2, 1), 0] = ModuleProfileResult(compute_cost=0.048, peak_memory=1.587 GB, invar_size=1.125 GB, outvar_size=0.031 GB, temp_buffer_size=0.430 GB, available_memory=17.580 GB)
result[(4, 7, 2, 0), 0] = ModuleProfileResult(compute_cost=0.023, peak_memory=1.961 GB, invar_size=1.680 GB, outvar_size=0.023 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(2, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.145, peak_memory=2.775 GB, invar_size=1.477 GB, outvar_size=0.727 GB, temp_buffer_size=1.290 GB, available_memory=17.580 GB)
result[(4, 7, 2, 1), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=1.274 GB, invar_size=0.852 GB, outvar_size=0.023 GB, temp_buffer_size=0.398 GB, available_memory=17.580 GB)
result[(3, 6, 2, 2), 0] = ModuleProfileResult(compute_cost=0.053, peak_memory=1.016 GB, invar_size=0.727 GB, outvar_size=0.031 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(4, 7, 2, 2), 0] = ModuleProfileResult(compute_cost=0.040, peak_memory=0.836 GB, invar_size=0.555 GB, outvar_size=0.023 GB, temp_buffer_size=0.258 GB, available_memory=17.580 GB)
result[(2, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.242, peak_memory=3.709 GB, invar_size=2.274 GB, outvar_size=1.125 GB, temp_buffer_size=1.419 GB, available_memory=17.580 GB)
result[(1, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.301, peak_memory=4.365 GB, invar_size=2.829 GB, outvar_size=1.399 GB, temp_buffer_size=1.521 GB, available_memory=17.580 GB)
result[(2, 6, 2, 0), 1] = ModuleProfileResult(compute_cost=0.252, peak_memory=8.353 GB, invar_size=5.579 GB, outvar_size=2.774 GB, temp_buffer_size=2.766 GB, available_memory=17.580 GB)
result[(3, 6, 2, 0), 1] = ModuleProfileResult(compute_cost=0.203, peak_memory=6.704 GB, invar_size=4.477 GB, outvar_size=2.227 GB, temp_buffer_size=2.219 GB, available_memory=17.580 GB)
result[(2, 6, 2, 2), 1] = ModuleProfileResult(compute_cost=0.180, peak_memory=3.127 GB, invar_size=1.829 GB, outvar_size=0.899 GB, temp_buffer_size=1.290 GB, available_memory=17.580 GB)
result[(3, 6, 2, 2), 1] = ModuleProfileResult(compute_cost=0.145, peak_memory=2.775 GB, invar_size=1.477 GB, outvar_size=0.727 GB, temp_buffer_size=1.290 GB, available_memory=17.580 GB)
result[(2, 6, 2, 1), 1] = ModuleProfileResult(compute_cost=0.301, peak_memory=4.279 GB, invar_size=2.829 GB, outvar_size=1.399 GB, temp_buffer_size=1.435 GB, available_memory=17.580 GB)
result[(4, 7, 2, 0), 1] = ModuleProfileResult(compute_cost=0.215, peak_memory=6.880 GB, invar_size=4.592 GB, outvar_size=2.288 GB, temp_buffer_size=2.280 GB, available_memory=17.580 GB)
result[(3, 6, 2, 1), 1] = ModuleProfileResult(compute_cost=0.242, peak_memory=3.682 GB, invar_size=2.274 GB, outvar_size=1.125 GB, temp_buffer_size=1.392 GB, available_memory=17.580 GB)
result[(4, 7, 2, 1), 1] = ModuleProfileResult(compute_cost=0.255, peak_memory=3.965 GB, invar_size=2.320 GB, outvar_size=1.156 GB, temp_buffer_size=1.630 GB, available_memory=17.580 GB)
result[(4, 7, 2, 2), 1] = ModuleProfileResult(compute_cost=0.185, peak_memory=3.107 GB, invar_size=1.500 GB, outvar_size=0.742 GB, temp_buffer_size=1.599 GB, available_memory=17.580 GB)
Profiling for submesh 2 (2, 2) takes 75.50 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 1, 1, 0), 0] = ModuleProfileResult(compute_cost=0.031, peak_memory=1.673 GB, invar_size=1.126 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(0, 1, 1, 2), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=1.173 GB, invar_size=0.626 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(0, 1, 1, 1), 0] = ModuleProfileResult(compute_cost=0.064, peak_memory=1.157 GB, invar_size=0.563 GB, outvar_size=0.047 GB, temp_buffer_size=0.547 GB, available_memory=17.580 GB)
result[(3, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=1.188 GB, invar_size=0.594 GB, outvar_size=0.062 GB, temp_buffer_size=0.532 GB, available_memory=17.580 GB)
result[(2, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.034, peak_memory=1.157 GB, invar_size=0.610 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(2, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.061, peak_memory=1.157 GB, invar_size=0.578 GB, outvar_size=0.047 GB, temp_buffer_size=0.532 GB, available_memory=17.580 GB)
result[(1, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.034, peak_memory=1.157 GB, invar_size=0.610 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(3, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.031, peak_memory=1.688 GB, invar_size=1.141 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(2, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.657 GB, invar_size=1.110 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(1, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.061, peak_memory=1.157 GB, invar_size=0.578 GB, outvar_size=0.047 GB, temp_buffer_size=0.532 GB, available_memory=17.580 GB)
result[(1, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.657 GB, invar_size=1.110 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(0, 1, 1, 0), 1] = ModuleProfileResult(compute_cost=0.095, peak_memory=4.758 GB, invar_size=2.283 GB, outvar_size=1.126 GB, temp_buffer_size=2.475 GB, available_memory=17.580 GB)
result[(0, 1, 1, 1), 1] = ModuleProfileResult(compute_cost=0.156, peak_memory=3.917 GB, invar_size=1.188 GB, outvar_size=0.563 GB, temp_buffer_size=2.729 GB, available_memory=17.580 GB)
result[(2, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=0.157, peak_memory=3.821 GB, invar_size=1.188 GB, outvar_size=0.578 GB, temp_buffer_size=2.602 GB, available_memory=17.580 GB)
result[(1, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.094, peak_memory=3.456 GB, invar_size=1.235 GB, outvar_size=0.610 GB, temp_buffer_size=2.205 GB, available_memory=17.580 GB)
result[(2, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.091, peak_memory=4.455 GB, invar_size=2.235 GB, outvar_size=1.110 GB, temp_buffer_size=2.205 GB, available_memory=17.580 GB)
result[(1, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=0.157, peak_memory=3.821 GB, invar_size=1.188 GB, outvar_size=0.578 GB, temp_buffer_size=2.602 GB, available_memory=17.580 GB)
result[(1, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.091, peak_memory=4.455 GB, invar_size=2.235 GB, outvar_size=1.110 GB, temp_buffer_size=2.205 GB, available_memory=17.580 GB)
result[(2, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.094, peak_memory=3.456 GB, invar_size=1.235 GB, outvar_size=0.610 GB, temp_buffer_size=2.205 GB, available_memory=17.580 GB)
result[(3, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=1.188 GB, invar_size=0.641 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(0, 1, 1, 2), 1] = ModuleProfileResult(compute_cost=0.098, peak_memory=3.758 GB, invar_size=1.283 GB, outvar_size=0.626 GB, temp_buffer_size=2.475 GB, available_memory=17.580 GB)
result[(4, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.031, peak_memory=1.688 GB, invar_size=1.141 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(3, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.099, peak_memory=4.878 GB, invar_size=2.297 GB, outvar_size=1.141 GB, temp_buffer_size=2.565 GB, available_memory=17.580 GB)
result[(5, 6, 1, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.657 GB, invar_size=1.110 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(4, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=1.188 GB, invar_size=0.594 GB, outvar_size=0.062 GB, temp_buffer_size=0.532 GB, available_memory=17.580 GB)
result[(4, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=1.188 GB, invar_size=0.641 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(6, 7, 1, 0), 0] = ModuleProfileResult(compute_cost=0.014, peak_memory=1.094 GB, invar_size=0.563 GB, outvar_size=0.016 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(6, 7, 1, 1), 0] = ModuleProfileResult(compute_cost=0.033, peak_memory=0.868 GB, invar_size=0.305 GB, outvar_size=0.031 GB, temp_buffer_size=0.532 GB, available_memory=17.580 GB)
result[(5, 6, 1, 1), 0] = ModuleProfileResult(compute_cost=0.065, peak_memory=1.173 GB, invar_size=0.578 GB, outvar_size=0.062 GB, temp_buffer_size=0.532 GB, available_memory=17.580 GB)
result[(6, 7, 1, 2), 0] = ModuleProfileResult(compute_cost=0.017, peak_memory=0.844 GB, invar_size=0.313 GB, outvar_size=0.016 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(3, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.170, peak_memory=3.975 GB, invar_size=1.219 GB, outvar_size=0.594 GB, temp_buffer_size=2.725 GB, available_memory=17.580 GB)
result[(5, 6, 1, 2), 0] = ModuleProfileResult(compute_cost=0.034, peak_memory=1.157 GB, invar_size=0.610 GB, outvar_size=0.031 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(3, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.102, peak_memory=3.909 GB, invar_size=1.313 GB, outvar_size=0.641 GB, temp_buffer_size=2.580 GB, available_memory=17.580 GB)
result[(4, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.099, peak_memory=4.893 GB, invar_size=2.297 GB, outvar_size=1.141 GB, temp_buffer_size=2.580 GB, available_memory=17.580 GB)
result[(4, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=0.170, peak_memory=4.194 GB, invar_size=1.219 GB, outvar_size=0.594 GB, temp_buffer_size=2.944 GB, available_memory=17.580 GB)
result[(5, 6, 1, 0), 1] = ModuleProfileResult(compute_cost=0.091, peak_memory=4.565 GB, invar_size=2.235 GB, outvar_size=1.110 GB, temp_buffer_size=2.315 GB, available_memory=17.580 GB)
result[(4, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.102, peak_memory=3.893 GB, invar_size=1.297 GB, outvar_size=0.641 GB, temp_buffer_size=2.580 GB, available_memory=17.580 GB)
result[(5, 6, 1, 1), 1] = ModuleProfileResult(compute_cost=0.157, peak_memory=3.916 GB, invar_size=1.188 GB, outvar_size=0.578 GB, temp_buffer_size=2.697 GB, available_memory=17.580 GB)
result[(6, 7, 1, 1), 1] = ModuleProfileResult(compute_cost=0.180, peak_memory=4.542 GB, invar_size=1.218 GB, outvar_size=0.609 GB, temp_buffer_size=3.293 GB, available_memory=17.580 GB)
result[(6, 7, 1, 0), 1] = ModuleProfileResult(compute_cost=0.110, peak_memory=5.508 GB, invar_size=2.341 GB, outvar_size=1.171 GB, temp_buffer_size=3.151 GB, available_memory=17.580 GB)
result[(5, 6, 1, 2), 1] = ModuleProfileResult(compute_cost=0.094, peak_memory=3.565 GB, invar_size=1.235 GB, outvar_size=0.610 GB, temp_buffer_size=2.315 GB, available_memory=17.580 GB)
result[(6, 7, 1, 2), 1] = ModuleProfileResult(compute_cost=0.119, peak_memory=4.462 GB, invar_size=1.280 GB, outvar_size=0.640 GB, temp_buffer_size=3.166 GB, available_memory=17.580 GB)
Profiling for submesh 1 (1, 2) takes 28.17 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(3, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(3, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.032, peak_memory=1.642 GB, invar_size=0.579 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.032, peak_memory=1.642 GB, invar_size=0.579 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(2, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(2, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 1, 0, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 1, 0, 1), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(3, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.568 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.380 GB, available_memory=17.580 GB)
result[(3, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.568 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.380 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.083, peak_memory=6.108 GB, invar_size=1.189 GB, outvar_size=0.579 GB, temp_buffer_size=4.919 GB, available_memory=17.580 GB)
result[(2, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.568 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.380 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.083, peak_memory=6.108 GB, invar_size=1.189 GB, outvar_size=0.579 GB, temp_buffer_size=4.919 GB, available_memory=17.580 GB)
result[(2, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.568 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.380 GB, available_memory=17.580 GB)
result[(7, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.000 GB, invar_size=0.000 GB, outvar_size=0.000 GB, temp_buffer_size=0.000 GB, available_memory=17.580 GB)
result[(7, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.000 GB, invar_size=0.000 GB, outvar_size=0.000 GB, temp_buffer_size=0.000 GB, available_memory=17.580 GB)
result[(1, 1, 0, 0), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.568 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.380 GB, available_memory=17.580 GB)
result[(1, 1, 0, 1), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.568 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.380 GB, available_memory=17.580 GB)
result[(4, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.033, peak_memory=1.673 GB, invar_size=0.610 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(5, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(4, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.033, peak_memory=1.673 GB, invar_size=0.610 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(5, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(6, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(6, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(4, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.094, peak_memory=6.380 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=5.129 GB, available_memory=17.580 GB)
result[(5, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.849 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.661 GB, available_memory=17.580 GB)
result[(5, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.849 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.661 GB, available_memory=17.580 GB)
result[(4, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.094, peak_memory=6.380 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=5.129 GB, available_memory=17.580 GB)
result[(6, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.787 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.599 GB, available_memory=17.580 GB)
result[(6, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.078, peak_memory=5.787 GB, invar_size=1.156 GB, outvar_size=0.578 GB, temp_buffer_size=4.599 GB, available_memory=17.580 GB)
result[(7, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.112, peak_memory=7.580 GB, invar_size=1.247 GB, outvar_size=0.639 GB, temp_buffer_size=6.301 GB, available_memory=17.580 GB)
result[(7, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.112, peak_memory=7.580 GB, invar_size=1.247 GB, outvar_size=0.639 GB, temp_buffer_size=6.301 GB, available_memory=17.580 GB)
Profiling for submesh 0 (1, 1) takes 14.93 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-18-18-24-39.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1], [2, 3], [4, 5], [6, 7]]
Result mesh_shapes: [(1, 2), (1, 2), (1, 2), (1, 2)]
Result logical_mesh_shapes: [(2, 1), (2, 1), (2, 1), (2, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 247.40 s
compilation time breakdown: {'stage-construction': '204.57', 'stage-construction-dp': '1.14', 'stage-construction-compilation': '107.64', 'stage-construction-profiling': '43.28'}
 - Compile (worker): 7.82 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 48.63 s

[11.781649112701416, 5.503413915634155, 5.574110984802246, 5.589591979980469, 5.367887735366821, 5.380352020263672, 5.261886835098267]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 29.253 s.
 - Average e2e iteration time: 5.8510003089904785 s.
 - Total local training time: 27.174001693725586 s.
 - Average local iteration time: 5.435000419616699 s.
 - Max allocated memory among devices: 7.135 GB.
 - Compilation times:  {'stage-construction': 204.56763291358948, 'stage-construction-dp': 1.1431548595428467, 'stage-construction-compilation': 107.6373987197876, 'stage-construction-profiling': 43.28248620033264}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `4_a10_4_n_2_d`: 5.434765815734863
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/moe_2.4B_256.pkl`...

------------------------------------------------------------------
- (2/3) Profiling moe_2.4B with batch size: 512...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/moe_2.4B_512.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 4
[I] Loading flax model....
[I] Model 'moe' loads sucessfully. Model Info: 

FlaxMoEForLMModule(
    # attributes
    config = <model.moe_model.MoEConfig object at 0x7fc7bf2a2f40>
    dtype = float16
    bias_init = zeros
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2), (4, 2))
- Profiling for submesh 3 (4, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 7, 3, 0), 0] = ModuleProfileResult(compute_cost=0.052, peak_memory=4.204 GB, invar_size=3.892 GB, outvar_size=0.055 GB, temp_buffer_size=0.258 GB, available_memory=17.402 GB)
result[(0, 7, 3, 1), 0] = ModuleProfileResult(compute_cost=0.082, peak_memory=2.564 GB, invar_size=1.946 GB, outvar_size=0.055 GB, temp_buffer_size=0.563 GB, available_memory=17.402 GB)
result[(0, 7, 3, 2), 0] = ModuleProfileResult(compute_cost=0.097, peak_memory=1.142 GB, invar_size=0.829 GB, outvar_size=0.055 GB, temp_buffer_size=0.258 GB, available_memory=17.402 GB)
result[(0, 7, 3, 0), 1] = ModuleProfileResult(compute_cost=0.462, peak_memory=13.554 GB, invar_size=9.054 GB, outvar_size=4.500 GB, temp_buffer_size=4.500 GB, available_memory=17.402 GB)
result[(0, 7, 3, 1), 1] = ModuleProfileResult(compute_cost=0.537, peak_memory=6.805 GB, invar_size=4.555 GB, outvar_size=2.250 GB, temp_buffer_size=2.250 GB, available_memory=17.402 GB)
result[(0, 7, 3, 2), 1] = ModuleProfileResult(compute_cost=0.313, peak_memory=3.637 GB, invar_size=2.054 GB, outvar_size=1.000 GB, temp_buffer_size=1.583 GB, available_memory=17.402 GB)
Profiling for submesh 3 (4, 2) takes 83.89 seconds
--------------------------------------------------
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(2, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.080, peak_memory=1.862 GB, invar_size=1.149 GB, outvar_size=0.062 GB, temp_buffer_size=0.651 GB, available_memory=17.580 GB)
result[(0, 3, 2, 2), 0] = ModuleProfileResult(compute_cost=0.104, peak_memory=1.298 GB, invar_size=0.720 GB, outvar_size=0.062 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(0, 3, 2, 0), 0] = ModuleProfileResult(compute_cost=0.058, peak_memory=2.798 GB, invar_size=2.220 GB, outvar_size=0.062 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(0, 3, 2, 1), 0] = ModuleProfileResult(compute_cost=0.082, peak_memory=1.784 GB, invar_size=1.118 GB, outvar_size=0.062 GB, temp_buffer_size=0.604 GB, available_memory=17.580 GB)
result[(1, 4, 2, 0), 0] = ModuleProfileResult(compute_cost=0.058, peak_memory=2.813 GB, invar_size=2.235 GB, outvar_size=0.062 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(1, 4, 2, 1), 0] = ModuleProfileResult(compute_cost=0.080, peak_memory=1.862 GB, invar_size=1.149 GB, outvar_size=0.062 GB, temp_buffer_size=0.651 GB, available_memory=17.580 GB)
result[(1, 4, 2, 2), 0] = ModuleProfileResult(compute_cost=0.104, peak_memory=1.313 GB, invar_size=0.735 GB, outvar_size=0.062 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(2, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.058, peak_memory=2.813 GB, invar_size=2.235 GB, outvar_size=0.062 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(1, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.072, peak_memory=3.376 GB, invar_size=2.782 GB, outvar_size=0.078 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(1, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.129, peak_memory=1.501 GB, invar_size=0.907 GB, outvar_size=0.078 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(1, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.099, peak_memory=2.180 GB, invar_size=1.424 GB, outvar_size=0.078 GB, temp_buffer_size=0.678 GB, available_memory=17.580 GB)
result[(0, 3, 2, 0), 1] = ModuleProfileResult(compute_cost=0.281, peak_memory=6.977 GB, invar_size=4.502 GB, outvar_size=2.220 GB, temp_buffer_size=2.475 GB, available_memory=17.580 GB)
result[(2, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.285, peak_memory=7.112 GB, invar_size=4.516 GB, outvar_size=2.235 GB, temp_buffer_size=2.580 GB, available_memory=17.580 GB)
result[(2, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.104, peak_memory=1.313 GB, invar_size=0.735 GB, outvar_size=0.062 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(1, 4, 2, 0), 1] = ModuleProfileResult(compute_cost=0.285, peak_memory=7.097 GB, invar_size=4.516 GB, outvar_size=2.235 GB, temp_buffer_size=2.565 GB, available_memory=17.580 GB)
result[(0, 3, 2, 1), 1] = ModuleProfileResult(compute_cost=0.350, peak_memory=5.270 GB, invar_size=2.298 GB, outvar_size=1.118 GB, temp_buffer_size=2.972 GB, available_memory=17.580 GB)
result[(0, 3, 2, 2), 1] = ModuleProfileResult(compute_cost=0.268, peak_memory=3.977 GB, invar_size=1.502 GB, outvar_size=0.720 GB, temp_buffer_size=2.475 GB, available_memory=17.580 GB)
result[(2, 6, 2, 0), 0] = ModuleProfileResult(compute_cost=0.072, peak_memory=3.376 GB, invar_size=2.782 GB, outvar_size=0.078 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(1, 4, 2, 2), 1] = ModuleProfileResult(compute_cost=0.272, peak_memory=4.159 GB, invar_size=1.563 GB, outvar_size=0.735 GB, temp_buffer_size=2.580 GB, available_memory=17.580 GB)
result[(2, 6, 2, 2), 0] = ModuleProfileResult(compute_cost=0.129, peak_memory=1.501 GB, invar_size=0.907 GB, outvar_size=0.078 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(2, 6, 2, 1), 0] = ModuleProfileResult(compute_cost=0.099, peak_memory=2.180 GB, invar_size=1.424 GB, outvar_size=0.078 GB, temp_buffer_size=0.678 GB, available_memory=17.580 GB)
result[(1, 4, 2, 1), 1] = ModuleProfileResult(compute_cost=0.371, peak_memory=5.093 GB, invar_size=2.344 GB, outvar_size=1.133 GB, temp_buffer_size=2.733 GB, available_memory=17.580 GB)
result[(3, 6, 2, 0), 0] = ModuleProfileResult(compute_cost=0.058, peak_memory=2.813 GB, invar_size=2.235 GB, outvar_size=0.062 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(1, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.354, peak_memory=8.408 GB, invar_size=5.626 GB, outvar_size=2.782 GB, temp_buffer_size=2.766 GB, available_memory=17.580 GB)
result[(1, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.338, peak_memory=4.472 GB, invar_size=1.876 GB, outvar_size=0.907 GB, temp_buffer_size=2.580 GB, available_memory=17.580 GB)
result[(4, 7, 2, 0), 0] = ModuleProfileResult(compute_cost=0.044, peak_memory=2.251 GB, invar_size=1.688 GB, outvar_size=0.047 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(3, 6, 2, 1), 0] = ModuleProfileResult(compute_cost=0.080, peak_memory=1.862 GB, invar_size=1.149 GB, outvar_size=0.062 GB, temp_buffer_size=0.651 GB, available_memory=17.580 GB)
result[(4, 7, 2, 1), 0] = ModuleProfileResult(compute_cost=0.061, peak_memory=1.544 GB, invar_size=0.873 GB, outvar_size=0.047 GB, temp_buffer_size=0.623 GB, available_memory=17.580 GB)
result[(3, 6, 2, 2), 0] = ModuleProfileResult(compute_cost=0.104, peak_memory=1.313 GB, invar_size=0.735 GB, outvar_size=0.062 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(2, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.272, peak_memory=4.112 GB, invar_size=1.516 GB, outvar_size=0.735 GB, temp_buffer_size=2.580 GB, available_memory=17.580 GB)
result[(1, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.461, peak_memory=5.988 GB, invar_size=2.911 GB, outvar_size=1.409 GB, temp_buffer_size=3.061 GB, available_memory=17.580 GB)
result[(4, 7, 2, 2), 0] = ModuleProfileResult(compute_cost=0.079, peak_memory=1.126 GB, invar_size=0.563 GB, outvar_size=0.047 GB, temp_buffer_size=0.516 GB, available_memory=17.580 GB)
result[(2, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.372, peak_memory=5.109 GB, invar_size=2.344 GB, outvar_size=1.133 GB, temp_buffer_size=2.749 GB, available_memory=17.580 GB)
result[(3, 6, 2, 0), 1] = ModuleProfileResult(compute_cost=0.285, peak_memory=7.112 GB, invar_size=4.516 GB, outvar_size=2.235 GB, temp_buffer_size=2.581 GB, available_memory=17.580 GB)
result[(2, 6, 2, 0), 1] = ModuleProfileResult(compute_cost=0.354, peak_memory=8.408 GB, invar_size=5.626 GB, outvar_size=2.782 GB, temp_buffer_size=2.766 GB, available_memory=17.580 GB)
result[(2, 6, 2, 2), 1] = ModuleProfileResult(compute_cost=0.338, peak_memory=4.472 GB, invar_size=1.876 GB, outvar_size=0.907 GB, temp_buffer_size=2.581 GB, available_memory=17.580 GB)
result[(3, 6, 2, 1), 1] = ModuleProfileResult(compute_cost=0.374, peak_memory=5.265 GB, invar_size=2.344 GB, outvar_size=1.133 GB, temp_buffer_size=2.905 GB, available_memory=17.580 GB)
result[(4, 7, 2, 0), 1] = ModuleProfileResult(compute_cost=0.307, peak_memory=7.789 GB, invar_size=4.623 GB, outvar_size=2.296 GB, temp_buffer_size=3.151 GB, available_memory=17.580 GB)
result[(2, 6, 2, 1), 1] = ModuleProfileResult(compute_cost=0.463, peak_memory=5.831 GB, invar_size=2.911 GB, outvar_size=1.409 GB, temp_buffer_size=2.905 GB, available_memory=17.580 GB)
result[(3, 6, 2, 2), 1] = ModuleProfileResult(compute_cost=0.272, peak_memory=4.112 GB, invar_size=1.516 GB, outvar_size=0.735 GB, temp_buffer_size=2.581 GB, available_memory=17.580 GB)
result[(4, 7, 2, 1), 1] = ModuleProfileResult(compute_cost=0.401, peak_memory=5.646 GB, invar_size=2.374 GB, outvar_size=1.164 GB, temp_buffer_size=3.256 GB, available_memory=17.580 GB)
result[(4, 7, 2, 2), 1] = ModuleProfileResult(compute_cost=0.294, peak_memory=4.789 GB, invar_size=1.623 GB, outvar_size=0.796 GB, temp_buffer_size=3.151 GB, available_memory=17.580 GB)
Profiling for submesh 2 (2, 2) takes 76.02 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 1, 1, 0), 0] = ModuleProfileResult(compute_cost=0.059, peak_memory=2.220 GB, invar_size=1.126 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(0, 1, 1, 2), 0] = ModuleProfileResult(compute_cost=0.071, peak_memory=1.720 GB, invar_size=0.626 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(0, 1, 1, 1), 0] = ModuleProfileResult(compute_cost=0.124, peak_memory=1.752 GB, invar_size=0.563 GB, outvar_size=0.094 GB, temp_buffer_size=1.095 GB, available_memory=17.580 GB)
result[(3, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.144, peak_memory=1.814 GB, invar_size=0.625 GB, outvar_size=0.125 GB, temp_buffer_size=1.064 GB, available_memory=17.580 GB)
result[(2, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.053, peak_memory=2.219 GB, invar_size=1.125 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.066, peak_memory=1.719 GB, invar_size=0.625 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.053, peak_memory=2.219 GB, invar_size=1.125 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.119, peak_memory=1.767 GB, invar_size=0.610 GB, outvar_size=0.094 GB, temp_buffer_size=1.064 GB, available_memory=17.580 GB)
result[(2, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.066, peak_memory=1.719 GB, invar_size=0.625 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(2, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.119, peak_memory=1.767 GB, invar_size=0.610 GB, outvar_size=0.094 GB, temp_buffer_size=1.064 GB, available_memory=17.580 GB)
result[(3, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.059, peak_memory=2.251 GB, invar_size=1.156 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(0, 1, 1, 0), 1] = ModuleProfileResult(compute_cost=0.172, peak_memory=7.264 GB, invar_size=2.314 GB, outvar_size=1.126 GB, temp_buffer_size=4.950 GB, available_memory=17.580 GB)
result[(0, 1, 1, 1), 1] = ModuleProfileResult(compute_cost=0.304, peak_memory=6.707 GB, invar_size=1.251 GB, outvar_size=0.563 GB, temp_buffer_size=5.456 GB, available_memory=17.580 GB)
result[(3, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.182, peak_memory=7.505 GB, invar_size=2.344 GB, outvar_size=1.156 GB, temp_buffer_size=5.129 GB, available_memory=17.580 GB)
result[(1, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.182, peak_memory=5.724 GB, invar_size=1.282 GB, outvar_size=0.625 GB, temp_buffer_size=4.411 GB, available_memory=17.580 GB)
result[(3, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.072, peak_memory=1.751 GB, invar_size=0.656 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=0.308, peak_memory=6.546 GB, invar_size=1.282 GB, outvar_size=0.609 GB, temp_buffer_size=5.202 GB, available_memory=17.580 GB)
result[(0, 1, 1, 2), 1] = ModuleProfileResult(compute_cost=0.187, peak_memory=6.264 GB, invar_size=1.314 GB, outvar_size=0.626 GB, temp_buffer_size=4.950 GB, available_memory=17.580 GB)
result[(1, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.166, peak_memory=6.722 GB, invar_size=2.282 GB, outvar_size=1.125 GB, temp_buffer_size=4.409 GB, available_memory=17.580 GB)
result[(4, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.059, peak_memory=2.251 GB, invar_size=1.156 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(4, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.072, peak_memory=1.751 GB, invar_size=0.656 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(4, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.144, peak_memory=1.814 GB, invar_size=0.625 GB, outvar_size=0.125 GB, temp_buffer_size=1.064 GB, available_memory=17.580 GB)
result[(2, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.166, peak_memory=6.722 GB, invar_size=2.282 GB, outvar_size=1.125 GB, temp_buffer_size=4.409 GB, available_memory=17.580 GB)
result[(2, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.182, peak_memory=5.724 GB, invar_size=1.282 GB, outvar_size=0.625 GB, temp_buffer_size=4.411 GB, available_memory=17.580 GB)
result[(2, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=0.308, peak_memory=6.546 GB, invar_size=1.282 GB, outvar_size=0.609 GB, temp_buffer_size=5.202 GB, available_memory=17.580 GB)
result[(5, 6, 1, 0), 0] = ModuleProfileResult(compute_cost=0.053, peak_memory=2.219 GB, invar_size=1.125 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(5, 6, 1, 1), 0] = ModuleProfileResult(compute_cost=0.128, peak_memory=1.798 GB, invar_size=0.610 GB, outvar_size=0.125 GB, temp_buffer_size=1.064 GB, available_memory=17.580 GB)
result[(6, 7, 1, 0), 0] = ModuleProfileResult(compute_cost=0.027, peak_memory=1.641 GB, invar_size=0.578 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(6, 7, 1, 1), 0] = ModuleProfileResult(compute_cost=0.064, peak_memory=1.462 GB, invar_size=0.336 GB, outvar_size=0.062 GB, temp_buffer_size=1.063 GB, available_memory=17.580 GB)
result[(3, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.333, peak_memory=6.824 GB, invar_size=1.313 GB, outvar_size=0.625 GB, temp_buffer_size=5.449 GB, available_memory=17.580 GB)
result[(6, 7, 1, 2), 0] = ModuleProfileResult(compute_cost=0.033, peak_memory=1.391 GB, invar_size=0.328 GB, outvar_size=0.031 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(5, 6, 1, 2), 0] = ModuleProfileResult(compute_cost=0.066, peak_memory=1.719 GB, invar_size=0.625 GB, outvar_size=0.062 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(3, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.198, peak_memory=6.567 GB, invar_size=1.375 GB, outvar_size=0.656 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(4, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=0.333, peak_memory=7.262 GB, invar_size=1.313 GB, outvar_size=0.625 GB, temp_buffer_size=5.887 GB, available_memory=17.580 GB)
result[(4, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.182, peak_memory=7.536 GB, invar_size=2.344 GB, outvar_size=1.156 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(5, 6, 1, 0), 1] = ModuleProfileResult(compute_cost=0.166, peak_memory=6.942 GB, invar_size=2.282 GB, outvar_size=1.125 GB, temp_buffer_size=4.630 GB, available_memory=17.580 GB)
result[(5, 6, 1, 1), 1] = ModuleProfileResult(compute_cost=0.308, peak_memory=6.734 GB, invar_size=1.282 GB, outvar_size=0.609 GB, temp_buffer_size=5.390 GB, available_memory=17.580 GB)
result[(4, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.198, peak_memory=6.536 GB, invar_size=1.344 GB, outvar_size=0.656 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(6, 7, 1, 0), 1] = ModuleProfileResult(compute_cost=0.201, peak_memory=8.705 GB, invar_size=2.373 GB, outvar_size=1.186 GB, temp_buffer_size=6.301 GB, available_memory=17.580 GB)
result[(6, 7, 1, 1), 1] = ModuleProfileResult(compute_cost=0.352, peak_memory=7.928 GB, invar_size=1.280 GB, outvar_size=0.640 GB, temp_buffer_size=6.585 GB, available_memory=17.580 GB)
result[(5, 6, 1, 2), 1] = ModuleProfileResult(compute_cost=0.182, peak_memory=5.942 GB, invar_size=1.282 GB, outvar_size=0.625 GB, temp_buffer_size=4.630 GB, available_memory=17.580 GB)
result[(6, 7, 1, 2), 1] = ModuleProfileResult(compute_cost=0.217, peak_memory=7.705 GB, invar_size=1.373 GB, outvar_size=0.686 GB, temp_buffer_size=6.301 GB, available_memory=17.580 GB)
Profiling for submesh 1 (1, 2) takes 28.59 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(3, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(3, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(2, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(2, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.062, peak_memory=2.705 GB, invar_size=0.579 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.062, peak_memory=2.705 GB, invar_size=0.579 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(1, 1, 0, 0), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(1, 1, 0, 1), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(3, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.042 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=8.760 GB, available_memory=17.580 GB)
result[(3, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.042 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=8.760 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.161, peak_memory=11.058 GB, invar_size=1.220 GB, outvar_size=0.579 GB, temp_buffer_size=9.838 GB, available_memory=17.580 GB)
result[(2, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.042 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=8.760 GB, available_memory=17.580 GB)
result[(2, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.042 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=8.760 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.161, peak_memory=11.058 GB, invar_size=1.220 GB, outvar_size=0.579 GB, temp_buffer_size=9.838 GB, available_memory=17.580 GB)
result[(7, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.000 GB, invar_size=0.000 GB, outvar_size=0.000 GB, temp_buffer_size=0.000 GB, available_memory=17.580 GB)
result[(1, 1, 0, 1), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.042 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=8.760 GB, available_memory=17.580 GB)
result[(7, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.000 GB, invar_size=0.000 GB, outvar_size=0.000 GB, temp_buffer_size=0.000 GB, available_memory=17.580 GB)
result[(1, 1, 0, 0), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.042 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=8.760 GB, available_memory=17.580 GB)
result[(4, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.064, peak_memory=2.767 GB, invar_size=0.641 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(5, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(4, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.064, peak_memory=2.767 GB, invar_size=0.641 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(5, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(6, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(6, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(4, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.182, peak_memory=11.603 GB, invar_size=1.282 GB, outvar_size=0.641 GB, temp_buffer_size=10.259 GB, available_memory=17.580 GB)
result[(4, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.182, peak_memory=11.603 GB, invar_size=1.282 GB, outvar_size=0.641 GB, temp_buffer_size=10.259 GB, available_memory=17.580 GB)
result[(5, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.603 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=9.322 GB, available_memory=17.580 GB)
result[(5, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.603 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=9.322 GB, available_memory=17.580 GB)
result[(6, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.479 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=9.198 GB, available_memory=17.580 GB)
result[(6, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.151, peak_memory=10.479 GB, invar_size=1.219 GB, outvar_size=0.609 GB, temp_buffer_size=9.198 GB, available_memory=17.580 GB)
result[(7, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.219, peak_memory=13.944 GB, invar_size=1.279 GB, outvar_size=0.671 GB, temp_buffer_size=12.603 GB, available_memory=17.580 GB)
result[(7, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.219, peak_memory=13.944 GB, invar_size=1.279 GB, outvar_size=0.671 GB, temp_buffer_size=12.603 GB, available_memory=17.580 GB)
Profiling for submesh 0 (1, 1) takes 14.92 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-18-18-29-55.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1], [2, 3], [4, 5], [6, 7]]
Result mesh_shapes: [(1, 2), (1, 2), (1, 2), (1, 2)]
Result logical_mesh_shapes: [(2, 1), (2, 1), (2, 1), (2, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 249.68 s
compilation time breakdown: {'stage-construction': '206.79', 'stage-construction-dp': '1.14', 'stage-construction-compilation': '108.43', 'stage-construction-profiling': '44.09'}
 - Compile (worker): 7.82 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 79.63 s

[15.738407135009766, 9.78285264968872, 9.823646545410156, 9.771241903305054, 9.731793880462646, 9.600004196166992, 9.725733995437622]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 51.516 s.
 - Average e2e iteration time: 10.303000450134277 s.
 - Total local training time: 48.652000427246094 s.
 - Average local iteration time: 9.730000495910645 s.
 - Max allocated memory among devices: 10.802 GB.
 - Compilation times:  {'stage-construction': 206.79407906532288, 'stage-construction-dp': 1.136399269104004, 'stage-construction-compilation': 108.43157601356506, 'stage-construction-profiling': 44.09197497367859}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `4_a10_4_n_2_d`: 9.730484008789062
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/moe_2.4B_512.pkl`...

------------------------------------------------------------------
- (3/3) Profiling moe_2.4B with batch size: 1024...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/moe_2.4B_1024.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 4
[I] Loading flax model....
[I] Model 'moe' loads sucessfully. Model Info: 

FlaxMoEForLMModule(
    # attributes
    config = <model.moe_model.MoEConfig object at 0x7f46d5401c70>
    dtype = float16
    bias_init = zeros
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2), (4, 2))
- Profiling for submesh 3 (4, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 7, 3, 0), 0] = ModuleProfileResult(compute_cost=0.102, peak_memory=4.517 GB, invar_size=3.892 GB, outvar_size=0.109 GB, temp_buffer_size=0.516 GB, available_memory=17.402 GB)
result[(0, 7, 3, 1), 0] = ModuleProfileResult(compute_cost=0.145, peak_memory=2.814 GB, invar_size=1.946 GB, outvar_size=0.109 GB, temp_buffer_size=0.758 GB, available_memory=17.402 GB)
result[(0, 7, 3, 2), 0] = ModuleProfileResult(compute_cost=0.165, peak_memory=1.455 GB, invar_size=0.829 GB, outvar_size=0.109 GB, temp_buffer_size=0.516 GB, available_memory=17.402 GB)
result[(0, 7, 3, 0), 1] = ModuleProfileResult(compute_cost=0.635, peak_memory=13.609 GB, invar_size=9.109 GB, outvar_size=4.500 GB, temp_buffer_size=4.500 GB, available_memory=17.402 GB)
result[(0, 7, 3, 1), 1] = ModuleProfileResult(compute_cost=0.837, peak_memory=9.364 GB, invar_size=4.610 GB, outvar_size=2.250 GB, temp_buffer_size=4.754 GB, available_memory=17.402 GB)
result[(0, 7, 3, 2), 1] = ModuleProfileResult(compute_cost=0.527, peak_memory=5.276 GB, invar_size=2.109 GB, outvar_size=1.000 GB, temp_buffer_size=3.166 GB, available_memory=17.402 GB)
Profiling for submesh 3 (4, 2) takes 83.37 seconds
--------------------------------------------------
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(2, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.112, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(0, 3, 2, 2), 0] = ModuleProfileResult(compute_cost=0.184, peak_memory=1.876 GB, invar_size=0.720 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(2, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.141, peak_memory=2.451 GB, invar_size=1.232 GB, outvar_size=0.125 GB, temp_buffer_size=1.094 GB, available_memory=17.580 GB)
result[(0, 3, 2, 1), 0] = ModuleProfileResult(compute_cost=0.146, peak_memory=2.349 GB, invar_size=1.185 GB, outvar_size=0.125 GB, temp_buffer_size=1.039 GB, available_memory=17.580 GB)
result[(0, 3, 2, 0), 0] = ModuleProfileResult(compute_cost=0.112, peak_memory=3.376 GB, invar_size=2.220 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 4, 2, 0), 0] = ModuleProfileResult(compute_cost=0.112, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 4, 2, 2), 0] = ModuleProfileResult(compute_cost=0.185, peak_memory=1.907 GB, invar_size=0.750 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 4, 2, 1), 0] = ModuleProfileResult(compute_cost=0.140, peak_memory=2.435 GB, invar_size=1.247 GB, outvar_size=0.125 GB, temp_buffer_size=1.063 GB, available_memory=17.580 GB)
result[(1, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.139, peak_memory=3.985 GB, invar_size=2.797 GB, outvar_size=0.156 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=2.110 GB, invar_size=0.922 GB, outvar_size=0.156 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.174, peak_memory=2.779 GB, invar_size=1.529 GB, outvar_size=0.156 GB, temp_buffer_size=1.094 GB, available_memory=17.580 GB)
result[(0, 3, 2, 0), 1] = ModuleProfileResult(compute_cost=0.433, peak_memory=9.514 GB, invar_size=4.564 GB, outvar_size=2.220 GB, temp_buffer_size=4.950 GB, available_memory=17.580 GB)
result[(2, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.185, peak_memory=1.907 GB, invar_size=0.750 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(0, 3, 2, 1), 1] = ModuleProfileResult(compute_cost=0.462, peak_memory=7.482 GB, invar_size=2.496 GB, outvar_size=1.185 GB, temp_buffer_size=4.987 GB, available_memory=17.580 GB)
result[(2, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.444, peak_memory=9.787 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(1, 4, 2, 0), 1] = ModuleProfileResult(compute_cost=0.444, peak_memory=9.755 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=5.129 GB, available_memory=17.580 GB)
result[(0, 3, 2, 2), 1] = ModuleProfileResult(compute_cost=0.473, peak_memory=6.514 GB, invar_size=1.564 GB, outvar_size=0.720 GB, temp_buffer_size=4.950 GB, available_memory=17.580 GB)
result[(3, 6, 2, 0), 0] = ModuleProfileResult(compute_cost=0.112, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(2, 6, 2, 0), 0] = ModuleProfileResult(compute_cost=0.139, peak_memory=3.985 GB, invar_size=2.797 GB, outvar_size=0.156 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 4, 2, 2), 1] = ModuleProfileResult(compute_cost=0.484, peak_memory=6.880 GB, invar_size=1.688 GB, outvar_size=0.750 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(1, 4, 2, 1), 1] = ModuleProfileResult(compute_cost=0.503, peak_memory=7.796 GB, invar_size=2.589 GB, outvar_size=1.216 GB, temp_buffer_size=5.176 GB, available_memory=17.580 GB)
result[(2, 6, 2, 1), 0] = ModuleProfileResult(compute_cost=0.174, peak_memory=2.748 GB, invar_size=1.529 GB, outvar_size=0.156 GB, temp_buffer_size=1.063 GB, available_memory=17.580 GB)
result[(2, 6, 2, 2), 0] = ModuleProfileResult(compute_cost=0.229, peak_memory=2.110 GB, invar_size=0.922 GB, outvar_size=0.156 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.550, peak_memory=10.912 GB, invar_size=5.720 GB, outvar_size=2.797 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(1, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.600, peak_memory=7.162 GB, invar_size=1.970 GB, outvar_size=0.922 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(4, 7, 2, 0), 0] = ModuleProfileResult(compute_cost=0.086, peak_memory=2.829 GB, invar_size=1.703 GB, outvar_size=0.094 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(3, 6, 2, 1), 0] = ModuleProfileResult(compute_cost=0.141, peak_memory=2.420 GB, invar_size=1.232 GB, outvar_size=0.125 GB, temp_buffer_size=1.063 GB, available_memory=17.580 GB)
result[(4, 7, 2, 1), 0] = ModuleProfileResult(compute_cost=0.107, peak_memory=2.076 GB, invar_size=0.951 GB, outvar_size=0.094 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(4, 7, 2, 2), 0] = ModuleProfileResult(compute_cost=0.140, peak_memory=1.704 GB, invar_size=0.578 GB, outvar_size=0.094 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(1, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.646, peak_memory=8.437 GB, invar_size=3.183 GB, outvar_size=1.497 GB, temp_buffer_size=5.223 GB, available_memory=17.580 GB)
result[(3, 6, 2, 2), 0] = ModuleProfileResult(compute_cost=0.185, peak_memory=1.907 GB, invar_size=0.750 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=17.580 GB)
result[(2, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.484, peak_memory=6.787 GB, invar_size=1.594 GB, outvar_size=0.750 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(2, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.536, peak_memory=7.812 GB, invar_size=2.557 GB, outvar_size=1.201 GB, temp_buffer_size=5.223 GB, available_memory=17.580 GB)
result[(3, 6, 2, 0), 1] = ModuleProfileResult(compute_cost=0.444, peak_memory=9.787 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(2, 6, 2, 0), 1] = ModuleProfileResult(compute_cost=0.550, peak_memory=10.912 GB, invar_size=5.720 GB, outvar_size=2.797 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(2, 6, 2, 2), 1] = ModuleProfileResult(compute_cost=0.600, peak_memory=7.162 GB, invar_size=1.970 GB, outvar_size=0.922 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(2, 6, 2, 1), 1] = ModuleProfileResult(compute_cost=0.646, peak_memory=8.437 GB, invar_size=3.183 GB, outvar_size=1.497 GB, temp_buffer_size=5.223 GB, available_memory=17.580 GB)
result[(3, 6, 2, 2), 1] = ModuleProfileResult(compute_cost=0.484, peak_memory=6.787 GB, invar_size=1.594 GB, outvar_size=0.750 GB, temp_buffer_size=5.161 GB, available_memory=17.580 GB)
result[(4, 7, 2, 0), 1] = ModuleProfileResult(compute_cost=0.481, peak_memory=11.018 GB, invar_size=4.685 GB, outvar_size=2.311 GB, temp_buffer_size=6.301 GB, available_memory=17.580 GB)
result[(3, 6, 2, 1), 1] = ModuleProfileResult(compute_cost=0.536, peak_memory=7.812 GB, invar_size=2.557 GB, outvar_size=1.201 GB, temp_buffer_size=5.223 GB, available_memory=17.580 GB)
result[(4, 7, 2, 2), 1] = ModuleProfileResult(compute_cost=0.521, peak_memory=8.018 GB, invar_size=1.685 GB, outvar_size=0.811 GB, temp_buffer_size=6.301 GB, available_memory=17.580 GB)
result[(4, 7, 2, 1), 1] = ModuleProfileResult(compute_cost=0.582, peak_memory=8.998 GB, invar_size=2.556 GB, outvar_size=1.231 GB, temp_buffer_size=6.411 GB, available_memory=17.580 GB)
Profiling for submesh 2 (2, 2) takes 76.03 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(2, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.103, peak_memory=3.345 GB, invar_size=1.157 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(1, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.127, peak_memory=2.845 GB, invar_size=0.657 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(3, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=3.065 GB, invar_size=0.688 GB, outvar_size=0.250 GB, temp_buffer_size=2.127 GB, available_memory=17.580 GB)
result[(0, 1, 1, 0), 0] = ModuleProfileResult(compute_cost=0.114, peak_memory=3.315 GB, invar_size=1.126 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(1, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.103, peak_memory=3.345 GB, invar_size=1.157 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(0, 1, 1, 2), 0] = ModuleProfileResult(compute_cost=0.138, peak_memory=2.815 GB, invar_size=0.626 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(1, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.232, peak_memory=2.987 GB, invar_size=0.672 GB, outvar_size=0.188 GB, temp_buffer_size=2.127 GB, available_memory=17.580 GB)
result[(0, 1, 1, 1), 0] = ModuleProfileResult(compute_cost=0.244, peak_memory=2.941 GB, invar_size=0.564 GB, outvar_size=0.188 GB, temp_buffer_size=2.190 GB, available_memory=17.580 GB)
result[(2, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.127, peak_memory=2.845 GB, invar_size=0.657 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(2, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.232, peak_memory=2.987 GB, invar_size=0.672 GB, outvar_size=0.188 GB, temp_buffer_size=2.127 GB, available_memory=17.580 GB)
result[(3, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.115, peak_memory=3.376 GB, invar_size=1.188 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(2, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=0.605, peak_memory=11.993 GB, invar_size=1.469 GB, outvar_size=0.672 GB, temp_buffer_size=10.399 GB, available_memory=17.580 GB)
result[(3, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.343, peak_memory=12.759 GB, invar_size=2.438 GB, outvar_size=1.188 GB, temp_buffer_size=10.259 GB, available_memory=17.580 GB)
result[(0, 1, 1, 0), 1] = ModuleProfileResult(compute_cost=0.322, peak_memory=12.276 GB, invar_size=2.377 GB, outvar_size=1.126 GB, temp_buffer_size=9.900 GB, available_memory=17.580 GB)
result[(1, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.351, peak_memory=10.259 GB, invar_size=1.375 GB, outvar_size=0.656 GB, temp_buffer_size=8.821 GB, available_memory=17.580 GB)
result[(0, 1, 1, 1), 1] = ModuleProfileResult(compute_cost=0.596, peak_memory=12.287 GB, invar_size=1.376 GB, outvar_size=0.563 GB, temp_buffer_size=10.910 GB, available_memory=17.580 GB)
result[(1, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=0.605, peak_memory=11.993 GB, invar_size=1.469 GB, outvar_size=0.672 GB, temp_buffer_size=10.399 GB, available_memory=17.580 GB)
result[(1, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.312, peak_memory=11.256 GB, invar_size=2.375 GB, outvar_size=1.156 GB, temp_buffer_size=8.818 GB, available_memory=17.580 GB)
result[(4, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.115, peak_memory=3.376 GB, invar_size=1.188 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(0, 1, 1, 2), 1] = ModuleProfileResult(compute_cost=0.361, peak_memory=11.276 GB, invar_size=1.377 GB, outvar_size=0.626 GB, temp_buffer_size=9.900 GB, available_memory=17.580 GB)
result[(3, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.139, peak_memory=2.876 GB, invar_size=0.688 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(4, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=3.065 GB, invar_size=0.688 GB, outvar_size=0.250 GB, temp_buffer_size=2.127 GB, available_memory=17.580 GB)
result[(4, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.139, peak_memory=2.876 GB, invar_size=0.688 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(2, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.351, peak_memory=10.259 GB, invar_size=1.375 GB, outvar_size=0.656 GB, temp_buffer_size=8.821 GB, available_memory=17.580 GB)
result[(2, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.312, peak_memory=11.256 GB, invar_size=2.375 GB, outvar_size=1.156 GB, temp_buffer_size=8.818 GB, available_memory=17.580 GB)
result[(6, 7, 1, 0), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=2.736 GB, invar_size=0.610 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(5, 6, 1, 0), 0] = ModuleProfileResult(compute_cost=0.103, peak_memory=3.345 GB, invar_size=1.157 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(6, 7, 1, 1), 0] = ModuleProfileResult(compute_cost=0.126, peak_memory=2.651 GB, invar_size=0.399 GB, outvar_size=0.125 GB, temp_buffer_size=2.127 GB, available_memory=17.580 GB)
result[(5, 6, 1, 1), 0] = ModuleProfileResult(compute_cost=0.251, peak_memory=3.049 GB, invar_size=0.672 GB, outvar_size=0.250 GB, temp_buffer_size=2.127 GB, available_memory=17.580 GB)
result[(6, 7, 1, 2), 0] = ModuleProfileResult(compute_cost=0.063, peak_memory=2.486 GB, invar_size=0.360 GB, outvar_size=0.062 GB, temp_buffer_size=2.063 GB, available_memory=17.580 GB)
result[(5, 6, 1, 2), 0] = ModuleProfileResult(compute_cost=0.127, peak_memory=2.845 GB, invar_size=0.657 GB, outvar_size=0.125 GB, temp_buffer_size=2.064 GB, available_memory=17.580 GB)
result[(3, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.654, peak_memory=12.520 GB, invar_size=1.500 GB, outvar_size=0.688 GB, temp_buffer_size=10.895 GB, available_memory=17.580 GB)
result[(3, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.382, peak_memory=11.884 GB, invar_size=1.500 GB, outvar_size=0.688 GB, temp_buffer_size=10.321 GB, available_memory=17.580 GB)
result[(4, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=0.654, peak_memory=13.396 GB, invar_size=1.500 GB, outvar_size=0.688 GB, temp_buffer_size=11.770 GB, available_memory=17.580 GB)
result[(4, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.343, peak_memory=12.822 GB, invar_size=2.438 GB, outvar_size=1.188 GB, temp_buffer_size=10.321 GB, available_memory=17.580 GB)
result[(4, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.382, peak_memory=11.822 GB, invar_size=1.438 GB, outvar_size=0.688 GB, temp_buffer_size=10.321 GB, available_memory=17.580 GB)
result[(5, 6, 1, 0), 1] = ModuleProfileResult(compute_cost=0.312, peak_memory=11.697 GB, invar_size=2.375 GB, outvar_size=1.156 GB, temp_buffer_size=9.259 GB, available_memory=17.580 GB)
result[(5, 6, 1, 1), 1] = ModuleProfileResult(compute_cost=0.605, peak_memory=12.369 GB, invar_size=1.469 GB, outvar_size=0.672 GB, temp_buffer_size=10.775 GB, available_memory=17.580 GB)
result[(6, 7, 1, 1), 1] = ModuleProfileResult(compute_cost=0.692, peak_memory=14.700 GB, invar_size=1.406 GB, outvar_size=0.703 GB, temp_buffer_size=13.170 GB, available_memory=17.580 GB)
result[(5, 6, 1, 2), 1] = ModuleProfileResult(compute_cost=0.351, peak_memory=10.697 GB, invar_size=1.375 GB, outvar_size=0.656 GB, temp_buffer_size=9.259 GB, available_memory=17.580 GB)
result[(6, 7, 1, 0), 1] = ModuleProfileResult(compute_cost=0.381, peak_memory=15.101 GB, invar_size=2.435 GB, outvar_size=1.218 GB, temp_buffer_size=12.603 GB, available_memory=17.580 GB)
result[(6, 7, 1, 2), 1] = ModuleProfileResult(compute_cost=0.420, peak_memory=14.101 GB, invar_size=1.435 GB, outvar_size=0.718 GB, temp_buffer_size=12.603 GB, available_memory=17.580 GB)
Profiling for submesh 1 (1, 2) takes 28.43 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.125, peak_memory=4.831 GB, invar_size=0.579 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.125, peak_memory=4.831 GB, invar_size=0.579 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(3, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(3, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(2, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(2, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(1, 1, 0, 1), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(1, 1, 0, 0), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.321, peak_memory=20.959 GB, invar_size=1.283 GB, outvar_size=0.579 GB, temp_buffer_size=19.676 GB, available_memory=17.580 GB)
result[(3, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=18.988 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=17.519 GB, available_memory=17.580 GB)
result[(3, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=18.988 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=17.519 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.321, peak_memory=20.959 GB, invar_size=1.283 GB, outvar_size=0.579 GB, temp_buffer_size=19.676 GB, available_memory=17.580 GB)
result[(1, 1, 0, 1), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=18.988 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=17.519 GB, available_memory=17.580 GB)
result[(2, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=18.988 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=17.519 GB, available_memory=17.580 GB)
result[(7, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.000 GB, invar_size=0.000 GB, outvar_size=0.000 GB, temp_buffer_size=0.000 GB, available_memory=17.580 GB)
result[(2, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=18.988 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=17.519 GB, available_memory=17.580 GB)
result[(7, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.000, peak_memory=0.000 GB, invar_size=0.000 GB, outvar_size=0.000 GB, temp_buffer_size=0.000 GB, available_memory=17.580 GB)
result[(1, 1, 0, 0), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=18.988 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=17.519 GB, available_memory=17.580 GB)
result[(4, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.124, peak_memory=4.955 GB, invar_size=0.703 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(4, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.124, peak_memory=4.955 GB, invar_size=0.703 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(5, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(5, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(6, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(6, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.101, peak_memory=4.924 GB, invar_size=0.672 GB, outvar_size=0.125 GB, temp_buffer_size=4.127 GB, available_memory=17.580 GB)
result[(4, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.355, peak_memory=22.050 GB, invar_size=1.407 GB, outvar_size=0.703 GB, temp_buffer_size=20.518 GB, available_memory=17.580 GB)
result[(4, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.355, peak_memory=22.050 GB, invar_size=1.407 GB, outvar_size=0.703 GB, temp_buffer_size=20.518 GB, available_memory=17.580 GB)
result[(5, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=20.112 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=18.643 GB, available_memory=17.580 GB)
result[(5, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=20.112 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=18.643 GB, available_memory=17.580 GB)
result[(6, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=19.863 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=18.394 GB, available_memory=17.580 GB)
result[(6, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=19.863 GB, invar_size=1.344 GB, outvar_size=0.672 GB, temp_buffer_size=18.394 GB, available_memory=17.580 GB)
result[(7, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.434, peak_memory=26.672 GB, invar_size=1.342 GB, outvar_size=0.733 GB, temp_buffer_size=25.206 GB, available_memory=17.580 GB)
