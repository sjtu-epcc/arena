
------------------------------------------------------------------
- (1/3) Profiling bert_760M with batch size: 128...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/bert_760M_128.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 2
[I] Loading flax model....
[I] Model 'bert' loads sucessfully. Model Info: 

FlaxBertForMaskedLMModule(
    # attributes
    config = <model.bert_model.BertConfig object at 0x7f46b9768d00>
    dtype = float16
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2))
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=1.446 GB, invar_size=1.221 GB, outvar_size=0.029 GB, temp_buffer_size=0.195 GB, available_memory=17.402 GB)
result[(0, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.110, peak_memory=0.859 GB, invar_size=0.611 GB, outvar_size=0.053 GB, temp_buffer_size=0.195 GB, available_memory=17.402 GB)
result[(0, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.056, peak_memory=1.358 GB, invar_size=1.110 GB, outvar_size=0.029 GB, temp_buffer_size=0.219 GB, available_memory=17.402 GB)
result[(0, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.213, peak_memory=4.726 GB, invar_size=3.160 GB, outvar_size=1.565 GB, temp_buffer_size=1.566 GB, available_memory=17.402 GB)
result[(0, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.374, peak_memory=2.841 GB, invar_size=1.619 GB, outvar_size=0.783 GB, temp_buffer_size=1.222 GB, available_memory=17.402 GB)
result[(0, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.240, peak_memory=4.234 GB, invar_size=2.718 GB, outvar_size=1.345 GB, temp_buffer_size=1.515 GB, available_memory=17.402 GB)
Profiling for submesh 2 (2, 2) takes 125.82 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(1, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.039, peak_memory=0.858 GB, invar_size=0.663 GB, outvar_size=0.035 GB, temp_buffer_size=0.160 GB, available_memory=17.580 GB)
result[(0, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.046, peak_memory=1.225 GB, invar_size=0.799 GB, outvar_size=0.035 GB, temp_buffer_size=0.391 GB, available_memory=17.580 GB)
result[(0, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=1.174 GB, invar_size=0.725 GB, outvar_size=0.035 GB, temp_buffer_size=0.414 GB, available_memory=17.580 GB)
result[(1, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=1.081 GB, invar_size=0.874 GB, outvar_size=0.047 GB, temp_buffer_size=0.160 GB, available_memory=17.580 GB)
result[(1, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.126, peak_memory=0.579 GB, invar_size=0.349 GB, outvar_size=0.059 GB, temp_buffer_size=0.172 GB, available_memory=17.580 GB)
result[(1, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.039, peak_memory=0.858 GB, invar_size=0.663 GB, outvar_size=0.035 GB, temp_buffer_size=0.160 GB, available_memory=17.580 GB)
result[(1, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.167, peak_memory=0.709 GB, invar_size=0.455 GB, outvar_size=0.082 GB, temp_buffer_size=0.172 GB, available_memory=17.580 GB)
result[(0, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.136, peak_memory=0.849 GB, invar_size=0.400 GB, outvar_size=0.059 GB, temp_buffer_size=0.391 GB, available_memory=17.580 GB)
result[(2, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.039, peak_memory=0.858 GB, invar_size=0.663 GB, outvar_size=0.035 GB, temp_buffer_size=0.160 GB, available_memory=17.580 GB)
result[(2, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.039, peak_memory=0.858 GB, invar_size=0.663 GB, outvar_size=0.035 GB, temp_buffer_size=0.160 GB, available_memory=17.580 GB)
result[(2, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.126, peak_memory=0.579 GB, invar_size=0.349 GB, outvar_size=0.059 GB, temp_buffer_size=0.172 GB, available_memory=17.580 GB)
result[(1, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.051, peak_memory=1.081 GB, invar_size=0.874 GB, outvar_size=0.047 GB, temp_buffer_size=0.160 GB, available_memory=17.580 GB)
result[(3, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.025, peak_memory=0.618 GB, invar_size=0.434 GB, outvar_size=0.023 GB, temp_buffer_size=0.160 GB, available_memory=17.580 GB)
result[(3, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.082, peak_memory=0.453 GB, invar_size=0.235 GB, outvar_size=0.047 GB, temp_buffer_size=0.172 GB, available_memory=17.580 GB)
result[(1, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.122, peak_memory=3.444 GB, invar_size=1.349 GB, outvar_size=0.663 GB, temp_buffer_size=2.084 GB, available_memory=17.580 GB)
result[(0, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.139, peak_memory=3.726 GB, invar_size=1.497 GB, outvar_size=0.725 GB, temp_buffer_size=2.229 GB, available_memory=17.580 GB)
result[(1, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.122, peak_memory=3.444 GB, invar_size=1.349 GB, outvar_size=0.663 GB, temp_buffer_size=2.084 GB, available_memory=17.580 GB)
result[(0, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.136, peak_memory=3.850 GB, invar_size=1.633 GB, outvar_size=0.799 GB, temp_buffer_size=2.217 GB, available_memory=17.580 GB)
result[(1, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=0.291, peak_memory=3.456 GB, invar_size=0.745 GB, outvar_size=0.349 GB, temp_buffer_size=2.688 GB, available_memory=17.580 GB)
result[(0, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=0.304, peak_memory=3.613 GB, invar_size=0.869 GB, outvar_size=0.400 GB, temp_buffer_size=2.744 GB, available_memory=17.580 GB)
result[(3, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.025, peak_memory=0.618 GB, invar_size=0.434 GB, outvar_size=0.023 GB, temp_buffer_size=0.160 GB, available_memory=17.580 GB)
result[(1, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.161, peak_memory=3.878 GB, invar_size=1.782 GB, outvar_size=0.874 GB, temp_buffer_size=2.084 GB, available_memory=17.580 GB)
result[(2, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.122, peak_memory=3.444 GB, invar_size=1.349 GB, outvar_size=0.663 GB, temp_buffer_size=2.084 GB, available_memory=17.580 GB)
result[(2, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.291, peak_memory=3.556 GB, invar_size=0.745 GB, outvar_size=0.349 GB, temp_buffer_size=2.788 GB, available_memory=17.580 GB)
result[(2, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.122, peak_memory=3.444 GB, invar_size=1.349 GB, outvar_size=0.663 GB, temp_buffer_size=2.084 GB, available_memory=17.580 GB)
result[(3, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.136, peak_memory=3.804 GB, invar_size=1.568 GB, outvar_size=0.778 GB, temp_buffer_size=2.224 GB, available_memory=17.580 GB)
result[(1, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.161, peak_memory=3.878 GB, invar_size=1.782 GB, outvar_size=0.874 GB, temp_buffer_size=2.084 GB, available_memory=17.580 GB)
result[(1, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.386, peak_memory=3.895 GB, invar_size=0.979 GB, outvar_size=0.455 GB, temp_buffer_size=2.892 GB, available_memory=17.580 GB)
result[(3, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=0.302, peak_memory=3.249 GB, invar_size=0.837 GB, outvar_size=0.407 GB, temp_buffer_size=2.388 GB, available_memory=17.580 GB)
result[(3, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.140, peak_memory=3.669 GB, invar_size=1.422 GB, outvar_size=0.705 GB, temp_buffer_size=2.236 GB, available_memory=17.580 GB)
Profiling for submesh 1 (1, 2) takes 55.32 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(1, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=0.830 GB, invar_size=0.463 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(1, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=0.830 GB, invar_size=0.463 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=1.172 GB, invar_size=0.359 GB, outvar_size=0.023 GB, temp_buffer_size=0.789 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.037, peak_memory=1.172 GB, invar_size=0.359 GB, outvar_size=0.023 GB, temp_buffer_size=0.789 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.096, peak_memory=5.151 GB, invar_size=0.742 GB, outvar_size=0.359 GB, temp_buffer_size=4.410 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.096, peak_memory=5.151 GB, invar_size=0.742 GB, outvar_size=0.359 GB, temp_buffer_size=4.410 GB, available_memory=17.580 GB)
result[(2, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=0.830 GB, invar_size=0.463 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(2, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.049, peak_memory=0.830 GB, invar_size=0.463 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(3, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.047, peak_memory=0.813 GB, invar_size=0.446 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(3, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.047, peak_memory=0.813 GB, invar_size=0.446 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(1, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.148, peak_memory=5.515 GB, invar_size=0.950 GB, outvar_size=0.463 GB, temp_buffer_size=4.542 GB, available_memory=17.580 GB)
result[(1, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.148, peak_memory=5.515 GB, invar_size=0.950 GB, outvar_size=0.463 GB, temp_buffer_size=4.542 GB, available_memory=17.580 GB)
result[(2, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.148, peak_memory=5.920 GB, invar_size=0.950 GB, outvar_size=0.463 GB, temp_buffer_size=4.947 GB, available_memory=17.580 GB)
result[(2, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.148, peak_memory=5.920 GB, invar_size=0.950 GB, outvar_size=0.463 GB, temp_buffer_size=4.947 GB, available_memory=17.580 GB)
result[(3, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.141, peak_memory=5.361 GB, invar_size=0.915 GB, outvar_size=0.446 GB, temp_buffer_size=4.423 GB, available_memory=17.580 GB)
result[(3, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.141, peak_memory=5.361 GB, invar_size=0.915 GB, outvar_size=0.446 GB, temp_buffer_size=4.423 GB, available_memory=17.580 GB)
Profiling for submesh 0 (1, 1) takes 17.54 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-17-01-28-56.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2], [3, 4, 5]]
Result mesh_shapes: [(1, 2), (1, 2)]
Result logical_mesh_shapes: [(2, 1), (2, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 239.42 s
compilation time breakdown: {'stage-construction': '201.90', 'stage-construction-dp': '1.11', 'stage-construction-compilation': '132.96', 'stage-construction-profiling': '32.95'}
 - Compile (worker): 7.58 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 51.47 s

[10.921857833862305, 5.762877941131592, 5.768280744552612, 5.576769113540649, 5.66996431350708, 5.481027841567993, 5.560687303543091]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 29.857 s.
 - Average e2e iteration time: 5.9710001945495605 s.
 - Total local training time: 28.0570011138916 s.
 - Average local iteration time: 5.611000061035156 s.
 - Max allocated memory among devices: 6.632 GB.
 - Compilation times:  {'stage-construction': 201.89856553077698, 'stage-construction-dp': 1.1134910583496094, 'stage-construction-compilation': 132.96484327316284, 'stage-construction-profiling': 32.94937539100647}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `2_a10_2_n_2_d`: 5.6113457679748535
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/bert_760M_128.pkl`...

------------------------------------------------------------------
- (2/3) Profiling bert_760M with batch size: 256...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/bert_760M_256.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 2
[I] Loading flax model....
[I] Model 'bert' loads sucessfully. Model Info: 

FlaxBertForMaskedLMModule(
    # attributes
    config = <model.bert_model.BertConfig object at 0x7f57b7c12cd0>
    dtype = float16
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2))
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.070, peak_memory=1.670 GB, invar_size=1.221 GB, outvar_size=0.059 GB, temp_buffer_size=0.391 GB, available_memory=17.402 GB)
result[(0, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.123, peak_memory=1.819 GB, invar_size=0.611 GB, outvar_size=0.059 GB, temp_buffer_size=1.150 GB, available_memory=17.402 GB)
result[(0, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.107, peak_memory=1.606 GB, invar_size=1.110 GB, outvar_size=0.059 GB, temp_buffer_size=0.438 GB, available_memory=17.402 GB)
result[(0, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.334, peak_memory=5.425 GB, invar_size=3.190 GB, outvar_size=1.565 GB, temp_buffer_size=2.236 GB, available_memory=17.402 GB)
result[(0, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=0.683, peak_memory=4.462 GB, invar_size=1.625 GB, outvar_size=0.783 GB, temp_buffer_size=2.837 GB, available_memory=17.402 GB)
result[(0, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.402, peak_memory=5.019 GB, invar_size=2.748 GB, outvar_size=1.345 GB, temp_buffer_size=2.271 GB, available_memory=17.402 GB)
Profiling for submesh 2 (2, 2) takes 119.11 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.094, peak_memory=1.623 GB, invar_size=0.725 GB, outvar_size=0.070 GB, temp_buffer_size=0.828 GB, available_memory=17.580 GB)
result[(1, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=1.065 GB, invar_size=0.674 GB, outvar_size=0.070 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(1, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.327, peak_memory=0.986 GB, invar_size=0.478 GB, outvar_size=0.164 GB, temp_buffer_size=0.344 GB, available_memory=17.580 GB)
result[(0, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.087, peak_memory=1.650 GB, invar_size=0.799 GB, outvar_size=0.070 GB, temp_buffer_size=0.781 GB, available_memory=17.580 GB)
result[(1, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=1.065 GB, invar_size=0.674 GB, outvar_size=0.070 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(0, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.267, peak_memory=1.298 GB, invar_size=0.400 GB, outvar_size=0.117 GB, temp_buffer_size=0.781 GB, available_memory=17.580 GB)
result[(1, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.246, peak_memory=0.833 GB, invar_size=0.372 GB, outvar_size=0.117 GB, temp_buffer_size=0.344 GB, available_memory=17.580 GB)
result[(1, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.096, peak_memory=1.299 GB, invar_size=0.885 GB, outvar_size=0.094 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(2, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=1.065 GB, invar_size=0.674 GB, outvar_size=0.070 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(2, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.246, peak_memory=0.833 GB, invar_size=0.372 GB, outvar_size=0.117 GB, temp_buffer_size=0.344 GB, available_memory=17.580 GB)
result[(1, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.096, peak_memory=1.299 GB, invar_size=0.885 GB, outvar_size=0.094 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(2, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=1.065 GB, invar_size=0.674 GB, outvar_size=0.070 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(3, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.047, peak_memory=0.813 GB, invar_size=0.446 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(3, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.161, peak_memory=0.696 GB, invar_size=0.258 GB, outvar_size=0.094 GB, temp_buffer_size=0.344 GB, available_memory=17.580 GB)
result[(0, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=0.593, peak_memory=6.420 GB, invar_size=0.940 GB, outvar_size=0.400 GB, temp_buffer_size=5.480 GB, available_memory=17.580 GB)
result[(1, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=0.567, peak_memory=6.255 GB, invar_size=0.839 GB, outvar_size=0.372 GB, temp_buffer_size=5.370 GB, available_memory=17.580 GB)
result[(1, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.225, peak_memory=5.587 GB, invar_size=1.395 GB, outvar_size=0.674 GB, temp_buffer_size=4.168 GB, available_memory=17.580 GB)
result[(0, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.252, peak_memory=6.101 GB, invar_size=1.668 GB, outvar_size=0.799 GB, temp_buffer_size=4.433 GB, available_memory=17.580 GB)
result[(1, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.225, peak_memory=5.587 GB, invar_size=1.395 GB, outvar_size=0.674 GB, temp_buffer_size=4.168 GB, available_memory=17.580 GB)
result[(0, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.259, peak_memory=6.000 GB, invar_size=1.544 GB, outvar_size=0.725 GB, temp_buffer_size=4.457 GB, available_memory=17.580 GB)
result[(3, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.047, peak_memory=0.813 GB, invar_size=0.446 GB, outvar_size=0.047 GB, temp_buffer_size=0.320 GB, available_memory=17.580 GB)
result[(2, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.567, peak_memory=6.454 GB, invar_size=0.839 GB, outvar_size=0.372 GB, temp_buffer_size=5.568 GB, available_memory=17.580 GB)
result[(2, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.225, peak_memory=5.587 GB, invar_size=1.395 GB, outvar_size=0.674 GB, temp_buffer_size=4.168 GB, available_memory=17.580 GB)
result[(1, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=6.032 GB, invar_size=1.841 GB, outvar_size=0.885 GB, temp_buffer_size=4.168 GB, available_memory=17.580 GB)
result[(1, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=0.752, peak_memory=6.918 GB, invar_size=1.097 GB, outvar_size=0.478 GB, temp_buffer_size=5.775 GB, available_memory=17.580 GB)
result[(2, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.225, peak_memory=5.587 GB, invar_size=1.395 GB, outvar_size=0.674 GB, temp_buffer_size=4.168 GB, available_memory=17.580 GB)
result[(3, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.254, peak_memory=6.075 GB, invar_size=1.604 GB, outvar_size=0.790 GB, temp_buffer_size=4.448 GB, available_memory=17.580 GB)
result[(1, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.297, peak_memory=6.032 GB, invar_size=1.841 GB, outvar_size=0.885 GB, temp_buffer_size=4.168 GB, available_memory=17.580 GB)
result[(3, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=0.590, peak_memory=5.731 GB, invar_size=0.908 GB, outvar_size=0.430 GB, temp_buffer_size=4.777 GB, available_memory=17.580 GB)
result[(3, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.261, peak_memory=5.952 GB, invar_size=1.457 GB, outvar_size=0.717 GB, temp_buffer_size=4.472 GB, available_memory=17.580 GB)
Profiling for submesh 1 (1, 2) takes 49.71 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=1.984 GB, invar_size=0.359 GB, outvar_size=0.047 GB, temp_buffer_size=1.578 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=1.984 GB, invar_size=0.359 GB, outvar_size=0.047 GB, temp_buffer_size=1.578 GB, available_memory=17.580 GB)
result[(1, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.097, peak_memory=1.221 GB, invar_size=0.487 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(1, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.097, peak_memory=1.221 GB, invar_size=0.487 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.189, peak_memory=9.584 GB, invar_size=0.765 GB, outvar_size=0.359 GB, temp_buffer_size=8.819 GB, available_memory=17.580 GB)
result[(2, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.097, peak_memory=1.221 GB, invar_size=0.487 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(2, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.097, peak_memory=1.221 GB, invar_size=0.487 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.189, peak_memory=9.584 GB, invar_size=0.765 GB, outvar_size=0.359 GB, temp_buffer_size=8.819 GB, available_memory=17.580 GB)
result[(3, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.092, peak_memory=1.204 GB, invar_size=0.469 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(3, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.092, peak_memory=1.204 GB, invar_size=0.469 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(1, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.289, peak_memory=10.146 GB, invar_size=1.020 GB, outvar_size=0.487 GB, temp_buffer_size=9.079 GB, available_memory=17.580 GB)
result[(1, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.289, peak_memory=10.146 GB, invar_size=1.020 GB, outvar_size=0.487 GB, temp_buffer_size=9.079 GB, available_memory=17.580 GB)
result[(2, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.289, peak_memory=10.957 GB, invar_size=1.020 GB, outvar_size=0.487 GB, temp_buffer_size=9.890 GB, available_memory=17.580 GB)
result[(2, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.289, peak_memory=10.957 GB, invar_size=1.020 GB, outvar_size=0.487 GB, temp_buffer_size=9.890 GB, available_memory=17.580 GB)
result[(3, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.276, peak_memory=9.875 GB, invar_size=0.985 GB, outvar_size=0.469 GB, temp_buffer_size=8.843 GB, available_memory=17.580 GB)
result[(3, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.276, peak_memory=9.875 GB, invar_size=0.985 GB, outvar_size=0.469 GB, temp_buffer_size=8.843 GB, available_memory=17.580 GB)
Profiling for submesh 0 (1, 1) takes 17.77 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-17-01-33-53.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2], [3, 4, 5]]
Result mesh_shapes: [(1, 2), (1, 2)]
Result logical_mesh_shapes: [(2, 1), (2, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 228.13 s
compilation time breakdown: {'stage-construction': '189.88', 'stage-construction-dp': '1.12', 'stage-construction-compilation': '119.93', 'stage-construction-profiling': '33.13'}
 - Compile (worker): 7.96 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 84.57 s

[15.071995496749878, 10.445066690444946, 10.359557867050171, 10.444233894348145, 10.547809600830078, 10.537150144577026, 10.623560905456543]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 55.467 s.
 - Average e2e iteration time: 11.093000411987305 s.
 - Total local training time: 52.512001037597656 s.
 - Average local iteration time: 10.50200080871582 s.
 - Max allocated memory among devices: 9.431 GB.
 - Compilation times:  {'stage-construction': 189.88457107543945, 'stage-construction-dp': 1.1176111698150635, 'stage-construction-compilation': 119.93095135688782, 'stage-construction-profiling': 33.1289439201355}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `2_a10_2_n_2_d`: 10.502463340759277
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/bert_760M_256.pkl`...

------------------------------------------------------------------
- (3/3) Profiling bert_760M with batch size: 512...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/bert_760M_512.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 2
[I] Loading flax model....
[I] Model 'bert' loads sucessfully. Model Info: 

FlaxBertForMaskedLMModule(
    # attributes
    config = <model.bert_model.BertConfig object at 0x7f9302b12220>
    dtype = float16
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (2, 2))
- Profiling for submesh 2 (2, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 5, 2, 0), 0] = ModuleProfileResult(compute_cost=0.134, peak_memory=2.120 GB, invar_size=1.221 GB, outvar_size=0.117 GB, temp_buffer_size=0.781 GB, available_memory=17.402 GB)
result[(0, 5, 2, 1), 0] = ModuleProfileResult(compute_cost=0.190, peak_memory=1.967 GB, invar_size=0.611 GB, outvar_size=0.117 GB, temp_buffer_size=1.239 GB, available_memory=17.402 GB)
result[(0, 5, 2, 2), 0] = ModuleProfileResult(compute_cost=0.134, peak_memory=2.120 GB, invar_size=1.221 GB, outvar_size=0.117 GB, temp_buffer_size=0.781 GB, available_memory=17.402 GB)
result[(0, 5, 2, 0), 1] = ModuleProfileResult(compute_cost=0.566, peak_memory=7.720 GB, invar_size=3.248 GB, outvar_size=1.565 GB, temp_buffer_size=4.472 GB, available_memory=17.402 GB)
result[(0, 5, 2, 2), 1] = ModuleProfileResult(compute_cost=0.566, peak_memory=7.720 GB, invar_size=3.248 GB, outvar_size=1.565 GB, temp_buffer_size=4.472 GB, available_memory=17.402 GB)
result[(0, 5, 2, 1), 1] = ModuleProfileResult(compute_cost=1.225, peak_memory=9.048 GB, invar_size=1.684 GB, outvar_size=0.783 GB, temp_buffer_size=7.365 GB, available_memory=17.402 GB)
Profiling for submesh 2 (2, 2) takes 112.64 seconds
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(1, 3, 1, 2), 0] = ModuleProfileResult(compute_cost=0.143, peak_memory=1.479 GB, invar_size=0.698 GB, outvar_size=0.141 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(0, 2, 1, 2), 0] = ModuleProfileResult(compute_cost=0.170, peak_memory=2.502 GB, invar_size=0.799 GB, outvar_size=0.141 GB, temp_buffer_size=1.563 GB, available_memory=17.580 GB)
result[(0, 2, 1, 0), 0] = ModuleProfileResult(compute_cost=0.170, peak_memory=2.502 GB, invar_size=0.799 GB, outvar_size=0.141 GB, temp_buffer_size=1.563 GB, available_memory=17.580 GB)
result[(0, 2, 1, 1), 0] = ModuleProfileResult(compute_cost=0.529, peak_memory=2.197 GB, invar_size=0.400 GB, outvar_size=0.234 GB, temp_buffer_size=1.563 GB, available_memory=17.580 GB)
result[(1, 3, 1, 1), 0] = ModuleProfileResult(compute_cost=0.488, peak_memory=1.341 GB, invar_size=0.419 GB, outvar_size=0.234 GB, temp_buffer_size=0.688 GB, available_memory=17.580 GB)
result[(1, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.189, peak_memory=1.737 GB, invar_size=0.909 GB, outvar_size=0.188 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(1, 3, 1, 0), 0] = ModuleProfileResult(compute_cost=0.143, peak_memory=1.479 GB, invar_size=0.698 GB, outvar_size=0.141 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(1, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.647, peak_memory=1.541 GB, invar_size=0.525 GB, outvar_size=0.328 GB, temp_buffer_size=0.688 GB, available_memory=17.580 GB)
result[(2, 4, 1, 0), 0] = ModuleProfileResult(compute_cost=0.143, peak_memory=1.479 GB, invar_size=0.698 GB, outvar_size=0.141 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(2, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.143, peak_memory=1.479 GB, invar_size=0.698 GB, outvar_size=0.141 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(2, 4, 1, 1), 0] = ModuleProfileResult(compute_cost=0.488, peak_memory=1.341 GB, invar_size=0.419 GB, outvar_size=0.234 GB, temp_buffer_size=0.688 GB, available_memory=17.580 GB)
result[(1, 4, 1, 2), 0] = ModuleProfileResult(compute_cost=0.189, peak_memory=1.737 GB, invar_size=0.909 GB, outvar_size=0.188 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(3, 5, 1, 0), 0] = ModuleProfileResult(compute_cost=0.092, peak_memory=1.204 GB, invar_size=0.469 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(3, 5, 1, 1), 0] = ModuleProfileResult(compute_cost=0.319, peak_memory=1.180 GB, invar_size=0.305 GB, outvar_size=0.188 GB, temp_buffer_size=0.688 GB, available_memory=17.580 GB)
result[(0, 2, 1, 1), 1] = ModuleProfileResult(compute_cost=1.174, peak_memory=12.032 GB, invar_size=1.081 GB, outvar_size=0.400 GB, temp_buffer_size=10.952 GB, available_memory=17.580 GB)
result[(1, 3, 1, 1), 1] = ModuleProfileResult(compute_cost=1.123, peak_memory=11.851 GB, invar_size=1.026 GB, outvar_size=0.419 GB, temp_buffer_size=10.731 GB, available_memory=17.580 GB)
result[(0, 2, 1, 0), 1] = ModuleProfileResult(compute_cost=0.486, peak_memory=10.605 GB, invar_size=1.738 GB, outvar_size=0.799 GB, temp_buffer_size=8.867 GB, available_memory=17.580 GB)
result[(0, 2, 1, 2), 1] = ModuleProfileResult(compute_cost=0.486, peak_memory=10.652 GB, invar_size=1.785 GB, outvar_size=0.799 GB, temp_buffer_size=8.867 GB, available_memory=17.580 GB)
result[(1, 3, 1, 0), 1] = ModuleProfileResult(compute_cost=0.434, peak_memory=9.871 GB, invar_size=1.489 GB, outvar_size=0.698 GB, temp_buffer_size=8.335 GB, available_memory=17.580 GB)
result[(1, 3, 1, 2), 1] = ModuleProfileResult(compute_cost=0.434, peak_memory=9.871 GB, invar_size=1.489 GB, outvar_size=0.698 GB, temp_buffer_size=8.335 GB, available_memory=17.580 GB)
result[(3, 5, 1, 2), 0] = ModuleProfileResult(compute_cost=0.092, peak_memory=1.204 GB, invar_size=0.469 GB, outvar_size=0.094 GB, temp_buffer_size=0.641 GB, available_memory=17.580 GB)
result[(2, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=1.123, peak_memory=12.246 GB, invar_size=1.026 GB, outvar_size=0.419 GB, temp_buffer_size=11.126 GB, available_memory=17.580 GB)
result[(1, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.574, peak_memory=10.341 GB, invar_size=1.958 GB, outvar_size=0.909 GB, temp_buffer_size=8.335 GB, available_memory=17.580 GB)
result[(2, 4, 1, 0), 1] = ModuleProfileResult(compute_cost=0.434, peak_memory=9.872 GB, invar_size=1.489 GB, outvar_size=0.698 GB, temp_buffer_size=8.335 GB, available_memory=17.580 GB)
result[(2, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.434, peak_memory=9.872 GB, invar_size=1.489 GB, outvar_size=0.698 GB, temp_buffer_size=8.335 GB, available_memory=17.580 GB)
result[(1, 4, 1, 1), 1] = ModuleProfileResult(compute_cost=1.488, peak_memory=12.962 GB, invar_size=1.331 GB, outvar_size=0.525 GB, temp_buffer_size=11.537 GB, available_memory=17.580 GB)
result[(3, 5, 1, 0), 1] = ModuleProfileResult(compute_cost=0.491, peak_memory=10.617 GB, invar_size=1.674 GB, outvar_size=0.814 GB, temp_buffer_size=8.896 GB, available_memory=17.580 GB)
result[(1, 4, 1, 2), 1] = ModuleProfileResult(compute_cost=0.574, peak_memory=10.341 GB, invar_size=1.958 GB, outvar_size=0.909 GB, temp_buffer_size=8.335 GB, available_memory=17.580 GB)
result[(3, 5, 1, 1), 1] = ModuleProfileResult(compute_cost=1.169, peak_memory=10.696 GB, invar_size=1.048 GB, outvar_size=0.477 GB, temp_buffer_size=9.553 GB, available_memory=17.580 GB)
result[(3, 5, 1, 2), 1] = ModuleProfileResult(compute_cost=0.508, peak_memory=10.518 GB, invar_size=1.528 GB, outvar_size=0.740 GB, temp_buffer_size=8.943 GB, available_memory=17.580 GB)
Profiling for submesh 1 (1, 2) takes 53.45 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 0, 0, 0), 0] = ModuleProfileResult(compute_cost=0.143, peak_memory=3.609 GB, invar_size=0.359 GB, outvar_size=0.094 GB, temp_buffer_size=3.156 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 0] = ModuleProfileResult(compute_cost=0.143, peak_memory=3.609 GB, invar_size=0.359 GB, outvar_size=0.094 GB, temp_buffer_size=3.156 GB, available_memory=17.580 GB)
result[(1, 2, 0, 1), 0] = ModuleProfileResult(compute_cost=0.186, peak_memory=2.002 GB, invar_size=0.534 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=17.580 GB)
result[(1, 2, 0, 0), 0] = ModuleProfileResult(compute_cost=0.186, peak_memory=2.002 GB, invar_size=0.534 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=17.580 GB)
result[(0, 0, 0, 1), 1] = ModuleProfileResult(compute_cost=0.368, peak_memory=18.451 GB, invar_size=0.812 GB, outvar_size=0.359 GB, temp_buffer_size=17.639 GB, available_memory=17.580 GB)
result[(0, 0, 0, 0), 1] = ModuleProfileResult(compute_cost=0.368, peak_memory=18.451 GB, invar_size=0.812 GB, outvar_size=0.359 GB, temp_buffer_size=17.639 GB, available_memory=17.580 GB)
result[(2, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.186, peak_memory=2.002 GB, invar_size=0.534 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=17.580 GB)
result[(2, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.186, peak_memory=2.002 GB, invar_size=0.534 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=17.580 GB)
result[(3, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.177, peak_memory=1.985 GB, invar_size=0.516 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=17.580 GB)
result[(3, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.177, peak_memory=1.985 GB, invar_size=0.516 GB, outvar_size=0.188 GB, temp_buffer_size=1.281 GB, available_memory=17.580 GB)
result[(1, 2, 0, 1), 1] = ModuleProfileResult(compute_cost=0.557, peak_memory=19.407 GB, invar_size=1.161 GB, outvar_size=0.534 GB, temp_buffer_size=18.153 GB, available_memory=17.580 GB)
result[(1, 2, 0, 0), 1] = ModuleProfileResult(compute_cost=0.557, peak_memory=19.407 GB, invar_size=1.161 GB, outvar_size=0.534 GB, temp_buffer_size=18.153 GB, available_memory=17.580 GB)
result[(2, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.557, peak_memory=21.030 GB, invar_size=1.161 GB, outvar_size=0.534 GB, temp_buffer_size=19.775 GB, available_memory=17.580 GB)
result[(2, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.557, peak_memory=21.030 GB, invar_size=1.161 GB, outvar_size=0.534 GB, temp_buffer_size=19.775 GB, available_memory=17.580 GB)
result[(3, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.532, peak_memory=18.901 GB, invar_size=1.126 GB, outvar_size=0.516 GB, temp_buffer_size=17.682 GB, available_memory=17.580 GB)
result[(3, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.532, peak_memory=18.901 GB, invar_size=1.126 GB, outvar_size=0.516 GB, temp_buffer_size=17.682 GB, available_memory=17.580 GB)
Profiling for submesh 0 (1, 1) takes 18.16 seconds
--------------------------------------------------
Profile result saved to: profile-results-2023-11-17-01-39-20.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1, 2], [3, 4, 5]]
Result mesh_shapes: [(1, 2), (1, 2)]
Result logical_mesh_shapes: [(2, 1), (2, 1)]
Result autosharding_option_dicts: [{}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 234.67 s
compilation time breakdown: {'stage-construction': '187.57', 'stage-construction-dp': '1.14', 'stage-construction-compilation': '117.27', 'stage-construction-profiling': '33.77'}
 - Compile (worker): 8.03 s
[I] Training process warmup (2 rounds) with dummy input batch...
    - Warmup iteration: 1/2
    - Warmup iteration: 2/2
[I] Ready to perform training process.
[I] Benchmark the training process with entire dataset and profile with driver overhead...
    - Iteration 1 / 5 is performed...
    - Iteration 2 / 5 is performed...
    - Iteration 3 / 5 is performed...
    - Iteration 4 / 5 is performed...
 - Benchmark: 153.08 s

[24.88499402999878, 19.9308602809906, 20.20660948753357, 20.11770749092102, 20.02819275856018, 19.909340381622314, 19.88513946533203]


[I] Performance metrics:
 - Iteration count: 5.
 - Total e2e training time : 105.181 s.
 - Average e2e iteration time: 21.036001205444336 s.
 - Total local training time: 100.14700317382812 s.
 - Average local iteration time: 20.029001235961914 s.
 - Max allocated memory among devices: 15.028 GB.
 - Compilation times:  {'stage-construction': 187.57199692726135, 'stage-construction-dp': 1.1446919441223145, 'stage-construction-compilation': 117.27009510993958, 'stage-construction-profiling': 33.767828702926636}
 - Metadata:  []
 - Is need save result:  True

[TMP] Current profiling results of key `2_a10_2_n_2_d`: 20.02939796447754
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/bert_760M_512.pkl`...
