
------------------------------------------------------------------
- (1/3) Profiling moe_2.4B with batch size: 256...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/moe_2.4B_256.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 1
[I] Loading flax model....
[I] Model 'moe' loads sucessfully. Model Info: 

FlaxMoEForLMModule(
    # attributes
    config = <model.moe_model.MoEConfig object at 0x7fdb6b724370>
    dtype = float16
    bias_init = zeros
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2))
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 7, 1, 0), 0] = ModuleProfileResult(compute_cost=0.069, peak_memory=4.517 GB, invar_size=3.892 GB, outvar_size=0.109 GB, temp_buffer_size=0.516 GB, available_memory=35.242 GB)
result[(0, 7, 1, 1), 0] = ModuleProfileResult(compute_cost=0.207, peak_memory=2.697 GB, invar_size=1.946 GB, outvar_size=0.219 GB, temp_buffer_size=0.532 GB, available_memory=35.242 GB)
result[(0, 7, 1, 2), 0] = ModuleProfileResult(compute_cost=0.091, peak_memory=2.767 GB, invar_size=2.142 GB, outvar_size=0.109 GB, temp_buffer_size=0.516 GB, available_memory=35.242 GB)
result[(0, 7, 1, 0), 1] = ModuleProfileResult(compute_cost=0.281, peak_memory=13.609 GB, invar_size=9.109 GB, outvar_size=4.500 GB, temp_buffer_size=4.500 GB, available_memory=35.242 GB)
result[(0, 7, 1, 1), 1] = ModuleProfileResult(compute_cost=0.548, peak_memory=8.595 GB, invar_size=4.719 GB, outvar_size=2.250 GB, temp_buffer_size=3.877 GB, available_memory=35.242 GB)
result[(0, 7, 1, 2), 1] = ModuleProfileResult(compute_cost=0.292, peak_memory=8.275 GB, invar_size=5.109 GB, outvar_size=2.500 GB, temp_buffer_size=3.166 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 60.76 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(1, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=3.376 GB, invar_size=2.220 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=3.376 GB, invar_size=2.220 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.213, peak_memory=10.820 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=6.195 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.206, peak_memory=10.256 GB, invar_size=4.564 GB, outvar_size=2.220 GB, temp_buffer_size=5.691 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.206, peak_memory=10.256 GB, invar_size=4.564 GB, outvar_size=2.220 GB, temp_buffer_size=5.691 GB, available_memory=35.242 GB)
result[(1, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.090, peak_memory=3.985 GB, invar_size=2.797 GB, outvar_size=0.156 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(1, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.090, peak_memory=3.985 GB, invar_size=2.797 GB, outvar_size=0.156 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.213, peak_memory=10.820 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=6.195 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(1, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.263, peak_memory=12.355 GB, invar_size=5.720 GB, outvar_size=2.797 GB, temp_buffer_size=6.604 GB, available_memory=35.242 GB)
result[(2, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.090, peak_memory=3.985 GB, invar_size=2.797 GB, outvar_size=0.156 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.213, peak_memory=10.729 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=6.103 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.213, peak_memory=10.729 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=6.103 GB, available_memory=35.242 GB)
result[(2, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.090, peak_memory=3.985 GB, invar_size=2.797 GB, outvar_size=0.156 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(1, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.263, peak_memory=12.355 GB, invar_size=5.720 GB, outvar_size=2.797 GB, temp_buffer_size=6.604 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.056, peak_memory=2.829 GB, invar_size=1.703 GB, outvar_size=0.094 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.073, peak_memory=3.407 GB, invar_size=2.250 GB, outvar_size=0.125 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(2, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.263, peak_memory=12.509 GB, invar_size=5.720 GB, outvar_size=2.797 GB, temp_buffer_size=6.758 GB, available_memory=35.242 GB)
result[(2, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.263, peak_memory=12.509 GB, invar_size=5.720 GB, outvar_size=2.797 GB, temp_buffer_size=6.758 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.056, peak_memory=2.829 GB, invar_size=1.703 GB, outvar_size=0.094 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.213, peak_memory=11.010 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=6.384 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.213, peak_memory=11.010 GB, invar_size=4.594 GB, outvar_size=2.250 GB, temp_buffer_size=6.384 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.235, peak_memory=11.327 GB, invar_size=4.685 GB, outvar_size=2.311 GB, temp_buffer_size=6.610 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.235, peak_memory=11.327 GB, invar_size=4.685 GB, outvar_size=2.311 GB, temp_buffer_size=6.610 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 57.11 seconds
--------------------------------------------------
[E] Meet unexpected error in compiling executables...

[E] Unexpected error occurred in compiling or profiling executables...
[TMP] Current profiling results of key `1_a40_1_n_2_d`: none
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/moe_2.4B_256.pkl`...

------------------------------------------------------------------
- (2/3) Profiling moe_2.4B with batch size: 512...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/moe_2.4B_512.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 1
[I] Loading flax model....
[I] Model 'moe' loads sucessfully. Model Info: 

FlaxMoEForLMModule(
    # attributes
    config = <model.moe_model.MoEConfig object at 0x7f3046b98d60>
    dtype = float16
    bias_init = zeros
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2))
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 7, 1, 0), 0] = ModuleProfileResult(compute_cost=0.128, peak_memory=5.142 GB, invar_size=3.892 GB, outvar_size=0.219 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(0, 7, 1, 1), 0] = ModuleProfileResult(compute_cost=0.399, peak_memory=3.447 GB, invar_size=1.946 GB, outvar_size=0.438 GB, temp_buffer_size=1.064 GB, available_memory=35.242 GB)
result[(0, 7, 1, 2), 0] = ModuleProfileResult(compute_cost=0.170, peak_memory=3.392 GB, invar_size=2.142 GB, outvar_size=0.219 GB, temp_buffer_size=1.032 GB, available_memory=35.242 GB)
result[(0, 7, 1, 0), 1] = ModuleProfileResult(compute_cost=0.483, peak_memory=15.551 GB, invar_size=9.218 GB, outvar_size=4.500 GB, temp_buffer_size=6.333 GB, available_memory=35.242 GB)
result[(0, 7, 1, 1), 1] = ModuleProfileResult(compute_cost=1.054, peak_memory=12.746 GB, invar_size=4.938 GB, outvar_size=2.250 GB, temp_buffer_size=7.808 GB, available_memory=35.242 GB)
result[(0, 7, 1, 2), 1] = ModuleProfileResult(compute_cost=0.541, peak_memory=11.551 GB, invar_size=5.218 GB, outvar_size=2.500 GB, temp_buffer_size=6.333 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 57.87 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(1, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.142, peak_memory=4.595 GB, invar_size=2.282 GB, outvar_size=0.250 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.142, peak_memory=4.595 GB, invar_size=2.282 GB, outvar_size=0.250 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.142, peak_memory=4.533 GB, invar_size=2.220 GB, outvar_size=0.250 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.142, peak_memory=4.533 GB, invar_size=2.220 GB, outvar_size=0.250 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.403, peak_memory=16.070 GB, invar_size=4.689 GB, outvar_size=2.220 GB, temp_buffer_size=11.381 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.403, peak_memory=16.070 GB, invar_size=4.689 GB, outvar_size=2.220 GB, temp_buffer_size=11.381 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.414, peak_memory=17.201 GB, invar_size=4.751 GB, outvar_size=2.282 GB, temp_buffer_size=12.388 GB, available_memory=35.242 GB)
result[(1, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.176, peak_memory=5.205 GB, invar_size=2.829 GB, outvar_size=0.312 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(1, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.176, peak_memory=5.205 GB, invar_size=2.829 GB, outvar_size=0.312 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.414, peak_memory=17.201 GB, invar_size=4.751 GB, outvar_size=2.282 GB, temp_buffer_size=12.388 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.142, peak_memory=4.595 GB, invar_size=2.282 GB, outvar_size=0.250 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.142, peak_memory=4.595 GB, invar_size=2.282 GB, outvar_size=0.250 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(1, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.513, peak_memory=19.174 GB, invar_size=5.907 GB, outvar_size=2.829 GB, temp_buffer_size=13.204 GB, available_memory=35.242 GB)
result[(2, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.176, peak_memory=5.205 GB, invar_size=2.829 GB, outvar_size=0.312 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.414, peak_memory=17.016 GB, invar_size=4.751 GB, outvar_size=2.282 GB, temp_buffer_size=12.203 GB, available_memory=35.242 GB)
result[(1, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.513, peak_memory=19.174 GB, invar_size=5.907 GB, outvar_size=2.829 GB, temp_buffer_size=13.204 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.414, peak_memory=17.016 GB, invar_size=4.751 GB, outvar_size=2.282 GB, temp_buffer_size=12.203 GB, available_memory=35.242 GB)
result[(2, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.176, peak_memory=5.205 GB, invar_size=2.829 GB, outvar_size=0.312 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.142, peak_memory=4.595 GB, invar_size=2.282 GB, outvar_size=0.250 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.108, peak_memory=3.986 GB, invar_size=1.735 GB, outvar_size=0.188 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.142, peak_memory=4.595 GB, invar_size=2.282 GB, outvar_size=0.250 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(2, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.513, peak_memory=19.484 GB, invar_size=5.907 GB, outvar_size=2.829 GB, temp_buffer_size=13.515 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.108, peak_memory=3.986 GB, invar_size=1.735 GB, outvar_size=0.188 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(2, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.513, peak_memory=19.484 GB, invar_size=5.907 GB, outvar_size=2.829 GB, temp_buffer_size=13.515 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.414, peak_memory=17.579 GB, invar_size=4.751 GB, outvar_size=2.282 GB, temp_buffer_size=12.766 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.414, peak_memory=17.579 GB, invar_size=4.751 GB, outvar_size=2.282 GB, temp_buffer_size=12.766 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.460, peak_memory=18.093 GB, invar_size=4.811 GB, outvar_size=2.343 GB, temp_buffer_size=13.220 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.460, peak_memory=18.093 GB, invar_size=4.811 GB, outvar_size=2.343 GB, temp_buffer_size=13.220 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 56.88 seconds
--------------------------------------------------
[E] Meet unexpected error in compiling executables...

[E] Unexpected error occurred in compiling or profiling executables...
[TMP] Current profiling results of key `1_a40_1_n_2_d`: none
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/moe_2.4B_512.pkl`...

------------------------------------------------------------------
- (3/3) Profiling moe_2.4B with batch size: 1024...
------------------------------------------------------------------
[TMP] Existed profiling results in `./jaxpr/prof_log/optimal/moe_2.4B_1024.pkl`, updating/rewriting it...
[I] Ray Cluster & Alpa backend initialization is completed.
[I] Device Info:
    - Devices num per node: 2
    - Nodes num: 1
[I] Loading flax model....
[I] Model 'moe' loads sucessfully. Model Info: 

FlaxMoEForLMModule(
    # attributes
    config = <model.moe_model.MoEConfig object at 0x7f04ae72dd30>
    dtype = float16
    bias_init = zeros
) 

[I] Manually constructing dummy batch...
[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing Alpa parallelized train step func...
[I] Alpa parallelized train step func construction is completed.
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2))
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 7, 1, 0), 0] = ModuleProfileResult(compute_cost=0.251, peak_memory=6.393 GB, invar_size=3.892 GB, outvar_size=0.438 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(0, 7, 1, 1), 0] = ModuleProfileResult(compute_cost=0.788, peak_memory=4.949 GB, invar_size=1.947 GB, outvar_size=0.875 GB, temp_buffer_size=2.127 GB, available_memory=35.242 GB)
result[(0, 7, 1, 2), 0] = ModuleProfileResult(compute_cost=0.334, peak_memory=4.643 GB, invar_size=2.142 GB, outvar_size=0.438 GB, temp_buffer_size=2.064 GB, available_memory=35.242 GB)
result[(0, 7, 1, 0), 1] = ModuleProfileResult(compute_cost=0.905, peak_memory=22.103 GB, invar_size=9.437 GB, outvar_size=4.500 GB, temp_buffer_size=12.665 GB, available_memory=35.242 GB)
result[(0, 7, 1, 1), 1] = ModuleProfileResult(compute_cost=2.083, peak_memory=20.982 GB, invar_size=5.376 GB, outvar_size=2.250 GB, temp_buffer_size=15.606 GB, available_memory=35.242 GB)
result[(0, 7, 1, 2), 1] = ModuleProfileResult(compute_cost=1.058, peak_memory=18.103 GB, invar_size=5.437 GB, outvar_size=2.500 GB, temp_buffer_size=12.665 GB, available_memory=35.242 GB)
Profiling for submesh 1 (1, 2) takes 57.70 seconds
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
result[(0, 3, 0, 1), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=6.847 GB, invar_size=2.220 GB, outvar_size=0.500 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=6.847 GB, invar_size=2.220 GB, outvar_size=0.500 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=6.971 GB, invar_size=2.344 GB, outvar_size=0.500 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=6.971 GB, invar_size=2.344 GB, outvar_size=0.500 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(0, 3, 0, 0), 1] = ModuleProfileResult(compute_cost=0.800, peak_memory=27.698 GB, invar_size=4.940 GB, outvar_size=2.220 GB, temp_buffer_size=22.758 GB, available_memory=35.242 GB)
result[(0, 3, 0, 1), 1] = ModuleProfileResult(compute_cost=0.800, peak_memory=27.698 GB, invar_size=4.940 GB, outvar_size=2.220 GB, temp_buffer_size=22.758 GB, available_memory=35.242 GB)
result[(1, 4, 0, 0), 1] = ModuleProfileResult(compute_cost=0.822, peak_memory=29.962 GB, invar_size=5.063 GB, outvar_size=2.344 GB, temp_buffer_size=24.774 GB, available_memory=35.242 GB)
result[(1, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.348, peak_memory=7.643 GB, invar_size=2.891 GB, outvar_size=0.625 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(1, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.348, peak_memory=7.643 GB, invar_size=2.891 GB, outvar_size=0.625 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(1, 4, 0, 1), 1] = ModuleProfileResult(compute_cost=0.822, peak_memory=29.962 GB, invar_size=5.063 GB, outvar_size=2.344 GB, temp_buffer_size=24.774 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=6.971 GB, invar_size=2.344 GB, outvar_size=0.500 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=6.971 GB, invar_size=2.344 GB, outvar_size=0.500 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(1, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=1.018, peak_memory=32.811 GB, invar_size=6.282 GB, outvar_size=2.891 GB, temp_buffer_size=26.404 GB, available_memory=35.242 GB)
result[(2, 5, 0, 0), 1] = ModuleProfileResult(compute_cost=0.822, peak_memory=29.591 GB, invar_size=5.063 GB, outvar_size=2.344 GB, temp_buffer_size=24.402 GB, available_memory=35.242 GB)
result[(2, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.348, peak_memory=7.643 GB, invar_size=2.891 GB, outvar_size=0.625 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(1, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=1.018, peak_memory=32.811 GB, invar_size=6.282 GB, outvar_size=2.891 GB, temp_buffer_size=26.404 GB, available_memory=35.242 GB)
result[(2, 5, 0, 1), 1] = ModuleProfileResult(compute_cost=0.822, peak_memory=29.591 GB, invar_size=5.063 GB, outvar_size=2.344 GB, temp_buffer_size=24.402 GB, available_memory=35.242 GB)
result[(2, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.348, peak_memory=7.643 GB, invar_size=2.891 GB, outvar_size=0.625 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=6.971 GB, invar_size=2.344 GB, outvar_size=0.500 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 0] = ModuleProfileResult(compute_cost=0.282, peak_memory=6.971 GB, invar_size=2.344 GB, outvar_size=0.500 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(2, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=1.018, peak_memory=33.434 GB, invar_size=6.282 GB, outvar_size=2.891 GB, temp_buffer_size=27.026 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 0] = ModuleProfileResult(compute_cost=0.215, peak_memory=6.299 GB, invar_size=1.797 GB, outvar_size=0.375 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 0] = ModuleProfileResult(compute_cost=0.215, peak_memory=6.299 GB, invar_size=1.797 GB, outvar_size=0.375 GB, temp_buffer_size=4.127 GB, available_memory=35.242 GB)
result[(2, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=1.018, peak_memory=33.434 GB, invar_size=6.282 GB, outvar_size=2.891 GB, temp_buffer_size=27.026 GB, available_memory=35.242 GB)
result[(3, 6, 0, 0), 1] = ModuleProfileResult(compute_cost=0.822, peak_memory=30.716 GB, invar_size=5.063 GB, outvar_size=2.344 GB, temp_buffer_size=25.528 GB, available_memory=35.242 GB)
result[(3, 6, 0, 1), 1] = ModuleProfileResult(compute_cost=0.822, peak_memory=30.716 GB, invar_size=5.063 GB, outvar_size=2.344 GB, temp_buffer_size=25.528 GB, available_memory=35.242 GB)
result[(4, 7, 0, 0), 1] = ModuleProfileResult(compute_cost=0.913, peak_memory=31.624 GB, invar_size=5.061 GB, outvar_size=2.405 GB, temp_buffer_size=26.439 GB, available_memory=35.242 GB)
result[(4, 7, 0, 1), 1] = ModuleProfileResult(compute_cost=0.913, peak_memory=31.624 GB, invar_size=5.061 GB, outvar_size=2.405 GB, temp_buffer_size=26.439 GB, available_memory=35.242 GB)
Profiling for submesh 0 (1, 1) takes 57.51 seconds
--------------------------------------------------
[E] Meet unexpected error in compiling executables...

[E] Unexpected error occurred in compiling or profiling executables...
[TMP] Current profiling results of key `1_a40_1_n_2_d`: none
[TMP] Updated profiling results stored in `./jaxpr/prof_log/optimal/moe_2.4B_1024.pkl`...
