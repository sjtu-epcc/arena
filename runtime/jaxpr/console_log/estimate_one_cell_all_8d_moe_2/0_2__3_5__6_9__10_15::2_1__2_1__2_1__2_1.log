
[I] Loading Crius kernel-level profiler...
[TMP] Profiling results not found in `None`, creating it...

[I] Loading model and generating sharded HLO module...
[I] Initializing XLA devices takes 0.6027359962463379 s.
[I] Loading flax model....
[I] Model 'moe' loads sucessfully. Model Info: 

FlaxMoEForLMModule(
    # attributes
    config = <model.moe_model.MoEConfig object at 0x7f9715a14820>
    dtype = float16
    bias_init = zeros
) 

[I] Initialize training state...
[I] Training state initialization is completed.
[I] Constructing general train step func...
[I] General train step func construction is completed.
[I] Model has been loaded, begin Jaxpr transformation...


Layer 0:
Eqn 5 in layer 0: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 10 in layer 0: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 36 in layer 0: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 56 in layer 0: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 68 in layer 0: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 71 in layer 0: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 100 in layer 0: Primitive: remat2 | FLOPs (GB): 6448.0 | Memory access (GB): 10.178710952401161 | Attainable performance: 37400 | Computation load: 0.17240641711229945
Layer computation load: 0.25689839572192513

Layer 1:
Eqn 2 in layer 1: Primitive: dot_general | FLOPs (GB): 0.5 | Memory access (GB): 0.0317688062787056 | Attainable performance: 10954.141523197928 | Computation load: 4.5644836607335626e-05
Eqn 69 in layer 1: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 82 in layer 1: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 86 in layer 1: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 88 in layer 1: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 89 in layer 1: Primitive: custom_jvp_call | FLOPs (GB): 0.25 | Memory access (GB): 2.0 | Attainable performance: 87.0 | Computation load: 0.0028735632183908046
Eqn 90 in layer 1: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 92 in layer 1: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 118 in layer 1: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 138 in layer 1: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 150 in layer 1: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 153 in layer 1: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 180 in layer 1: Primitive: dot_general | FLOPs (GB): 256.0 | Memory access (GB): 0.296875 | Attainable performance: 37400 | Computation load: 0.006844919786096256
Eqn 189 in layer 1: Primitive: remat2 | FLOPs (GB): 8642.2529296875 | Memory access (GB): 17.17562873661518 | Attainable performance: 37400 | Computation load: 0.23107628154244653
Layer computation load: 0.3064640993167536

Layer 2:
Eqn 2 in layer 2: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 29 in layer 2: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 49 in layer 2: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 61 in layer 2: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 64 in layer 2: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 92 in layer 2: Primitive: dot_general | FLOPs (GB): 0.5 | Memory access (GB): 0.0317688062787056 | Attainable performance: 10954.141523197928 | Computation load: 4.5644836607335626e-05
Eqn 159 in layer 2: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 172 in layer 2: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 176 in layer 2: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 178 in layer 2: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 179 in layer 2: Primitive: custom_jvp_call | FLOPs (GB): 0.25 | Memory access (GB): 2.0 | Attainable performance: 87.0 | Computation load: 0.0028735632183908046
Eqn 180 in layer 2: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 182 in layer 2: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 187 in layer 2: Primitive: remat2 | FLOPs (GB): 8514.2529296875 | Memory access (GB): 16.95687873661518 | Attainable performance: 37400 | Computation load: 0.2276538216493984
Layer computation load: 0.32293468755204774

Layer 3:
Eqn 24 in layer 3: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 44 in layer 3: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 56 in layer 3: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 59 in layer 3: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 86 in layer 3: Primitive: dot_general | FLOPs (GB): 256.0 | Memory access (GB): 0.296875 | Attainable performance: 37400 | Computation load: 0.006844919786096256
Eqn 94 in layer 3: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 121 in layer 3: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 141 in layer 3: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 153 in layer 3: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 156 in layer 3: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 162 in layer 3: Primitive: remat2 | FLOPs (GB): 8856.0 | Memory access (GB): 16.07177735865116 | Attainable performance: 37400 | Computation load: 0.23679144385026737
Layer computation load: 0.33240641711229946

Layer 4:
Eqn 25 in layer 4: Primitive: dot_general | FLOPs (GB): 0.5 | Memory access (GB): 0.0317688062787056 | Attainable performance: 10954.141523197928 | Computation load: 4.5644836607335626e-05
Eqn 92 in layer 4: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 105 in layer 4: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 109 in layer 4: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 111 in layer 4: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 112 in layer 4: Primitive: custom_jvp_call | FLOPs (GB): 0.25 | Memory access (GB): 2.0 | Attainable performance: 87.0 | Computation load: 0.0028735632183908046
Eqn 113 in layer 4: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 115 in layer 4: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 143 in layer 4: Primitive: remat2 | FLOPs (GB): 3714.2529296875 | Memory access (GB): 8.6053162291646 | Attainable performance: 37400 | Computation load: 0.09931157566009358
Layer computation load: 0.13683843086755576

Layer 5:
Eqn 1 in layer 5: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 21 in layer 5: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 33 in layer 5: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 36 in layer 5: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 63 in layer 5: Primitive: dot_general | FLOPs (GB): 256.0 | Memory access (GB): 0.296875 | Attainable performance: 37400 | Computation load: 0.006844919786096256
Eqn 71 in layer 5: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 98 in layer 5: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 118 in layer 5: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 130 in layer 5: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 133 in layer 5: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 139 in layer 5: Primitive: remat2 | FLOPs (GB): 8856.0 | Memory access (GB): 16.07177735865116 | Attainable performance: 37400 | Computation load: 0.23679144385026737
Layer computation load: 0.33240641711229946

Layer 6:
Eqn 25 in layer 6: Primitive: dot_general | FLOPs (GB): 0.5 | Memory access (GB): 0.0317688062787056 | Attainable performance: 10954.141523197928 | Computation load: 4.5644836607335626e-05
Eqn 92 in layer 6: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 105 in layer 6: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 109 in layer 6: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 111 in layer 6: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 112 in layer 6: Primitive: custom_jvp_call | FLOPs (GB): 0.25 | Memory access (GB): 2.0 | Attainable performance: 87.0 | Computation load: 0.0028735632183908046
Eqn 113 in layer 6: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 115 in layer 6: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 143 in layer 6: Primitive: remat2 | FLOPs (GB): 3714.2529296875 | Memory access (GB): 8.6053162291646 | Attainable performance: 37400 | Computation load: 0.09931157566009358
Layer computation load: 0.13683843086755576

Layer 7:
Eqn 1 in layer 7: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 21 in layer 7: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 33 in layer 7: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 36 in layer 7: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 63 in layer 7: Primitive: dot_general | FLOPs (GB): 256.0 | Memory access (GB): 0.296875 | Attainable performance: 37400 | Computation load: 0.006844919786096256
Eqn 71 in layer 7: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 98 in layer 7: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 118 in layer 7: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 130 in layer 7: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 133 in layer 7: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 139 in layer 7: Primitive: remat2 | FLOPs (GB): 8856.0 | Memory access (GB): 16.07177735865116 | Attainable performance: 37400 | Computation load: 0.23679144385026737
Layer computation load: 0.33240641711229946

Layer 8:
Eqn 25 in layer 8: Primitive: dot_general | FLOPs (GB): 0.5 | Memory access (GB): 0.0317688062787056 | Attainable performance: 10954.141523197928 | Computation load: 4.5644836607335626e-05
Eqn 92 in layer 8: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 105 in layer 8: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 109 in layer 8: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 111 in layer 8: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 112 in layer 8: Primitive: custom_jvp_call | FLOPs (GB): 0.25 | Memory access (GB): 2.0 | Attainable performance: 87.0 | Computation load: 0.0028735632183908046
Eqn 113 in layer 8: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 115 in layer 8: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 143 in layer 8: Primitive: remat2 | FLOPs (GB): 3714.2529296875 | Memory access (GB): 8.6053162291646 | Attainable performance: 37400 | Computation load: 0.09931157566009358
Layer computation load: 0.13683843086755576

Layer 9:
Eqn 1 in layer 9: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 21 in layer 9: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 33 in layer 9: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 36 in layer 9: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 63 in layer 9: Primitive: dot_general | FLOPs (GB): 256.0 | Memory access (GB): 0.296875 | Attainable performance: 37400 | Computation load: 0.006844919786096256
Eqn 71 in layer 9: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 98 in layer 9: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 118 in layer 9: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 130 in layer 9: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 133 in layer 9: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 139 in layer 9: Primitive: remat2 | FLOPs (GB): 8856.0 | Memory access (GB): 16.07177735865116 | Attainable performance: 37400 | Computation load: 0.23679144385026737
Layer computation load: 0.33240641711229946

Layer 10:
Eqn 25 in layer 10: Primitive: dot_general | FLOPs (GB): 0.5 | Memory access (GB): 0.0317688062787056 | Attainable performance: 10954.141523197928 | Computation load: 4.5644836607335626e-05
Eqn 92 in layer 10: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 105 in layer 10: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 109 in layer 10: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 111 in layer 10: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 112 in layer 10: Primitive: custom_jvp_call | FLOPs (GB): 0.25 | Memory access (GB): 2.0 | Attainable performance: 87.0 | Computation load: 0.0028735632183908046
Eqn 113 in layer 10: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 115 in layer 10: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 143 in layer 10: Primitive: remat2 | FLOPs (GB): 3714.2529296875 | Memory access (GB): 8.6053162291646 | Attainable performance: 37400 | Computation load: 0.09931157566009358
Layer computation load: 0.13683843086755576

Layer 11:
Eqn 1 in layer 11: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 21 in layer 11: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 33 in layer 11: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 36 in layer 11: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 63 in layer 11: Primitive: dot_general | FLOPs (GB): 256.0 | Memory access (GB): 0.296875 | Attainable performance: 37400 | Computation load: 0.006844919786096256
Eqn 71 in layer 11: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 98 in layer 11: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 118 in layer 11: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 130 in layer 11: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 133 in layer 11: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 139 in layer 11: Primitive: remat2 | FLOPs (GB): 8856.0 | Memory access (GB): 16.07177735865116 | Attainable performance: 37400 | Computation load: 0.23679144385026737
Layer computation load: 0.33240641711229946

Layer 12:
Eqn 25 in layer 12: Primitive: dot_general | FLOPs (GB): 0.5 | Memory access (GB): 0.0317688062787056 | Attainable performance: 10954.141523197928 | Computation load: 4.5644836607335626e-05
Eqn 92 in layer 12: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 105 in layer 12: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 109 in layer 12: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 111 in layer 12: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 112 in layer 12: Primitive: custom_jvp_call | FLOPs (GB): 0.25 | Memory access (GB): 2.0 | Attainable performance: 87.0 | Computation load: 0.0028735632183908046
Eqn 113 in layer 12: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 115 in layer 12: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 143 in layer 12: Primitive: remat2 | FLOPs (GB): 3714.2529296875 | Memory access (GB): 8.6053162291646 | Attainable performance: 37400 | Computation load: 0.09931157566009358
Layer computation load: 0.13683843086755576

Layer 13:
Eqn 1 in layer 13: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 21 in layer 13: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 33 in layer 13: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 36 in layer 13: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 63 in layer 13: Primitive: dot_general | FLOPs (GB): 256.0 | Memory access (GB): 0.296875 | Attainable performance: 37400 | Computation load: 0.006844919786096256
Eqn 71 in layer 13: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 98 in layer 13: Primitive: dot_general | FLOPs (GB): 96.0 | Memory access (GB): 0.130859375 | Attainable performance: 37400 | Computation load: 0.0025668449197860962
Eqn 118 in layer 13: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 130 in layer 13: Primitive: dot_general | FLOPs (GB): 32.0 | Memory access (GB): 0.5625 | Attainable performance: 37400 | Computation load: 0.000855614973262032
Eqn 133 in layer 13: Primitive: dot_general | FLOPs (GB): 1000.0 | Memory access (GB): 1.06884765625 | Attainable performance: 37400 | Computation load: 0.026737967914438502
Eqn 139 in layer 13: Primitive: remat2 | FLOPs (GB): 8856.0 | Memory access (GB): 16.07177735865116 | Attainable performance: 37400 | Computation load: 0.23679144385026737
Layer computation load: 0.33240641711229946

Layer 14:
Eqn 25 in layer 14: Primitive: dot_general | FLOPs (GB): 0.5 | Memory access (GB): 0.0317688062787056 | Attainable performance: 10954.141523197928 | Computation load: 4.5644836607335626e-05
Eqn 92 in layer 14: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 105 in layer 14: Primitive: dot_general | FLOPs (GB): 0.125 | Memory access (GB): 0.13330078125 | Attainable performance: 652.6593406593406 | Computation load: 0.00019152411099137933
Eqn 109 in layer 14: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 111 in layer 14: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 112 in layer 14: Primitive: custom_jvp_call | FLOPs (GB): 0.25 | Memory access (GB): 2.0 | Attainable performance: 87.0 | Computation load: 0.0028735632183908046
Eqn 113 in layer 14: Primitive: dot_general | FLOPs (GB): 512.0 | Memory access (GB): 0.8125 | Attainable performance: 37400 | Computation load: 0.013689839572192513
Eqn 115 in layer 14: Primitive: dot_general | FLOPs (GB): 128.0 | Memory access (GB): 0.21875 | Attainable performance: 37400 | Computation load: 0.003422459893048128
Eqn 143 in layer 14: Primitive: remat2 | FLOPs (GB): 3714.2529296875 | Memory access (GB): 8.6053162291646 | Attainable performance: 37400 | Computation load: 0.09931157566009358
Layer computation load: 0.13683843086755576

Layer 15:
Eqn 3 in layer 15: Primitive: remat2 | FLOPs (GB): 9440.0 | Memory access (GB): 13.43945313245058 | Attainable performance: 37400 | Computation load: 0.25240641711229944
Layer computation load: 0.25240641711229944
Layer memory access: [14.641113296151161, 20.16412364691496, 20.71734630316496, 22.08691407740116, 8.972229108214378, 22.08691407740116, 8.972229108214378, 22.08691407740116, 8.972229108214378, 22.08691407740116, 8.972229108214378, 22.08691407740116, 8.972229108214378, 22.08691407740116, 8.972229108214378, 13.43945313245058]

Layer GPU fractions:
[0.52, 0.62, 0.653, 0.673, 0.277, 0.673, 0.277, 0.673, 0.277, 0.673, 0.277, 0.673, 0.277, 0.673, 0.277, 0.511]

Layer GPU fractions:
[0.52, 0.62, 0.653, 0.673, 0.277, 0.673, 0.277, 0.673, 0.277, 0.673, 0.277, 0.673, 0.277, 0.673, 0.277, 0.511]

[[[0, 1, 2], [3, 4, 5], [6, 7, 8, 9], [10, 11, 12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6], [7, 8, 9], [10, 11, 12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6], [7, 8, 9, 10], [11, 12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6], [7, 8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3, 4], [5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6, 7, 8], [9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3], [4, 5, 6, 7, 8], [9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6], [7, 8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6, 7], [8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2, 3, 4], [5, 6, 7], [8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2, 3], [4, 5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15]]]

[[[0, 1, 2], [3, 4, 5, 6], [7, 8, 9, 10], [11, 12, 13, 14, 15]], [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6], [7, 8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3], [4, 5, 6, 7, 8], [9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2, 3], [4, 5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9], [10, 11, 12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6], [7, 8, 9], [10, 11, 12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6, 7], [8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2, 3, 4], [5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6, 7, 8], [9, 10, 11], [12, 13, 14, 15]], [[0, 1, 2, 3, 4], [5, 6, 7], [8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6], [7, 8, 9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2], [3, 4, 5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15]], [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9, 10, 11, 12], [13, 14, 15]]]

[[0, 1, 2], [3, 4, 5], [6, 7, 8, 9, 10, 11, 12], [13, 14, 15]]
1815371776.0
1.1855918353295118
([2, 1, 4, 1], 1.1855918353295118)

{'0_2__3_6__7_10__11_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 2: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 3: {'1_2': (2.4110000000000005, 2, 1.1909134766072718, 2685075456.0, 0, 0), '2_1': (2.4110000000000005, 2, 1.1909134766072718, 0, 584964096.0, 0)}}, '0_3__4_7__8_11__12_15': {0: {'1_2': (2.466, 2, 1.2187209632382876, 3070951424.0, 0, 0), '2_1': (2.466, 2, 1.2187209632382876, 0, 627267584.0, 0)}, 1: {'1_2': (1.9000000000000001, 2, 0.9385070594949722, 2685075456.0, 0, 0), '2_1': (1.9000000000000001, 2, 0.9385070594949722, 0, 519051264.0, 0)}, 2: {'1_2': (1.9000000000000001, 2, 0.9385070594949722, 2685075456.0, 0, 0), '2_1': (1.9000000000000001, 2, 0.9385070594949722, 0, 519051264.0, 0)}, 3: {'1_2': (1.738, 2, 0.8585070594949722, 1829437440.0, 0, 0), '2_1': (1.738, 2, 0.8585070594949722, 0, 437344256.0, 0)}}, '0_2__3_5__6_10__11_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 2: {'1_2': (2.177, 2, 1.0753541721301587, 3171975168.0, 0, 0), '2_1': (2.177, 2, 1.0753541721301587, 0, 630957056.0, 0)}, 3: {'1_2': (2.4110000000000005, 2, 1.1909134766072718, 2685075456.0, 0, 0), '2_1': (2.4110000000000005, 2, 1.1909134766072718, 0, 584964096.0, 0)}}, '0_2__3_6__7_11__12_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 2: {'1_2': (2.5730000000000004, 2, 1.2709134766072716, 3540713472.0, 0, 0), '2_1': (2.5730000000000004, 2, 1.2709134766072716, 0, 666671104.0, 0)}, 3: {'1_2': (1.738, 2, 0.8585070594949722, 1829437440.0, 0, 0), '2_1': (1.738, 2, 0.8585070594949722, 0, 437344256.0, 0)}}, '0_2__3_7__8_11__12_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (2.5730000000000004, 2, 1.2709134766072716, 3540713472.0, 0, 0), '2_1': (2.5730000000000004, 2, 1.2709134766072716, 0, 666671104.0, 0)}, 2: {'1_2': (1.9000000000000001, 2, 0.9385070594949722, 2685075456.0, 0, 0), '2_1': (1.9000000000000001, 2, 0.9385070594949722, 0, 519051264.0, 0)}, 3: {'1_2': (1.738, 2, 0.8585070594949722, 1829437440.0, 0, 0), '2_1': (1.738, 2, 0.8585070594949722, 0, 437344256.0, 0)}}, '0_3__4_8__9_11__12_15': {0: {'1_2': (2.466, 2, 1.2187209632382876, 3070951424.0, 0, 0), '2_1': (2.466, 2, 1.2187209632382876, 0, 627267584.0, 0)}, 1: {'1_2': (2.177, 2, 1.0753541721301587, 3171975168.0, 0, 0), '2_1': (2.177, 2, 1.0753541721301587, 0, 630957056.0, 0)}, 2: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 3: {'1_2': (1.738, 2, 0.8585070594949722, 1829437440.0, 0, 0), '2_1': (1.738, 2, 0.8585070594949722, 0, 437344256.0, 0)}}, '0_3__4_7__8_12__13_15': {0: {'1_2': (2.466, 2, 1.2187209632382876, 3070951424.0, 0, 0), '2_1': (2.466, 2, 1.2187209632382876, 0, 627267584.0, 0)}, 1: {'1_2': (1.9000000000000001, 2, 0.9385070594949722, 2685075456.0, 0, 0), '2_1': (1.9000000000000001, 2, 0.9385070594949722, 0, 519051264.0, 0)}, 2: {'1_2': (2.177, 2, 1.0753541721301587, 3171975168.0, 0, 0), '2_1': (2.177, 2, 1.0753541721301587, 0, 630957056.0, 0)}, 3: {'1_2': (1.461, 2, 0.7216599468597855, 1342537728.0, 0, 0), '2_1': (1.461, 2, 0.7216599468597855, 0, 325438464.0, 0)}}, '0_3__4_8__9_12__13_15': {0: {'1_2': (2.466, 2, 1.2187209632382876, 3070951424.0, 0, 0), '2_1': (2.466, 2, 1.2187209632382876, 0, 627267584.0, 0)}, 1: {'1_2': (2.177, 2, 1.0753541721301587, 3171975168.0, 0, 0), '2_1': (2.177, 2, 1.0753541721301587, 0, 630957056.0, 0)}, 2: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 3: {'1_2': (1.461, 2, 0.7216599468597855, 1342537728.0, 0, 0), '2_1': (1.461, 2, 0.7216599468597855, 0, 325438464.0, 0)}}, '0_2__3_5__6_9__10_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 2: {'1_2': (1.9000000000000001, 2, 0.9385070594949722, 2685075456.0, 0, 0), '2_1': (1.9000000000000001, 2, 0.9385070594949722, 0, 519051264.0, 0)}, 3: {'1_2': (2.688, 2, 1.3277605892424582, 3171975168.0, 0, 0), '2_1': (2.688, 2, 1.3277605892424582, 0, 696869888.0, 0)}}, '0_2__3_6__7_9__10_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 2: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 3: {'1_2': (2.688, 2, 1.3277605892424582, 3171975168.0, 0, 0), '2_1': (2.688, 2, 1.3277605892424582, 0, 696869888.0, 0)}}, '0_2__3_7__8_12__13_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (2.5730000000000004, 2, 1.2709134766072716, 3540713472.0, 0, 0), '2_1': (2.5730000000000004, 2, 1.2709134766072716, 0, 666671104.0, 0)}, 2: {'1_2': (2.177, 2, 1.0753541721301587, 3171975168.0, 0, 0), '2_1': (2.177, 2, 1.0753541721301587, 0, 630957056.0, 0)}, 3: {'1_2': (1.461, 2, 0.7216599468597855, 1342537728.0, 0, 0), '2_1': (1.461, 2, 0.7216599468597855, 0, 325438464.0, 0)}}, '0_4__5_7__8_11__12_15': {0: {'1_2': (2.7430000000000003, 2, 1.3555680758734743, 3557851136.0, 0, 0), '2_1': (2.7430000000000003, 2, 1.3555680758734743, 0, 739173376.0, 0)}, 1: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 2: {'1_2': (1.9000000000000001, 2, 0.9385070594949722, 2685075456.0, 0, 0), '2_1': (1.9000000000000001, 2, 0.9385070594949722, 0, 519051264.0, 0)}, 3: {'1_2': (1.738, 2, 0.8585070594949722, 1829437440.0, 0, 0), '2_1': (1.738, 2, 0.8585070594949722, 0, 437344256.0, 0)}}, '0_4__5_8__9_11__12_15': {0: {'1_2': (2.7430000000000003, 2, 1.3555680758734743, 3557851136.0, 0, 0), '2_1': (2.7430000000000003, 2, 1.3555680758734743, 0, 739173376.0, 0)}, 1: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 2: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 3: {'1_2': (1.738, 2, 0.8585070594949722, 1829437440.0, 0, 0), '2_1': (1.738, 2, 0.8585070594949722, 0, 437344256.0, 0)}}, '0_4__5_8__9_12__13_15': {0: {'1_2': (2.7430000000000003, 2, 1.3555680758734743, 3557851136.0, 0, 0), '2_1': (2.7430000000000003, 2, 1.3555680758734743, 0, 739173376.0, 0)}, 1: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 2: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 3: {'1_2': (1.461, 2, 0.7216599468597855, 1342537728.0, 0, 0), '2_1': (1.461, 2, 0.7216599468597855, 0, 325438464.0, 0)}}, '0_2__3_5__6_11__12_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 2: {'1_2': (2.85, 2, 1.407760589242458, 4027613184.0, 0, 0), '2_1': (2.85, 2, 1.407760589242458, 0, 778576896.0, 0)}, 3: {'1_2': (1.738, 2, 0.8585070594949722, 1829437440.0, 0, 0), '2_1': (1.738, 2, 0.8585070594949722, 0, 437344256.0, 0)}}, '0_2__3_8__9_11__12_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (2.8500000000000005, 2, 1.4077605892424583, 4027613184.0, 0, 0), '2_1': (2.8500000000000005, 2, 1.4077605892424583, 0, 778576896.0, 0)}, 2: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 3: {'1_2': (1.738, 2, 0.8585070594949722, 1829437440.0, 0, 0), '2_1': (1.738, 2, 0.8585070594949722, 0, 437344256.0, 0)}}, '0_4__5_7__8_12__13_15': {0: {'1_2': (2.7430000000000003, 2, 1.3555680758734743, 3557851136.0, 0, 0), '2_1': (2.7430000000000003, 2, 1.3555680758734743, 0, 739173376.0, 0)}, 1: {'1_2': (1.6230000000000002, 2, 0.8016599468597856, 2198175744.0, 0, 0), '2_1': (1.6230000000000002, 2, 0.8016599468597856, 0, 407145472.0, 0)}, 2: {'1_2': (2.177, 2, 1.0753541721301587, 3171975168.0, 0, 0), '2_1': (2.177, 2, 1.0753541721301587, 0, 630957056.0, 0)}, 3: {'1_2': (1.461, 2, 0.7216599468597855, 1342537728.0, 0, 0), '2_1': (1.461, 2, 0.7216599468597855, 0, 325438464.0, 0)}}, '0_2__3_6__7_12__13_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 2: {'1_2': (2.8500000000000005, 2, 1.4077605892424583, 4027613184.0, 0, 0), '2_1': (2.8500000000000005, 2, 1.4077605892424583, 0, 778576896.0, 0)}, 3: {'1_2': (1.461, 2, 0.7216599468597855, 1342537728.0, 0, 0), '2_1': (1.461, 2, 0.7216599468597855, 0, 325438464.0, 0)}}, '0_2__3_8__9_12__13_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_2': (2.8500000000000005, 2, 1.4077605892424583, 4027613184.0, 0, 0), '2_1': (2.8500000000000005, 2, 1.4077605892424583, 0, 778576896.0, 0)}, 2: {'1_2': (1.9000000000000004, 2, 0.9385070594949723, 2685075456.0, 0, 0), '2_1': (1.9000000000000004, 2, 0.9385070594949723, 0, 519051264.0, 0)}, 3: {'1_2': (1.461, 2, 0.7216599468597855, 1342537728.0, 0, 0), '2_1': (1.461, 2, 0.7216599468597855, 0, 325438464.0, 0)}}, '0_2__3_5__6_12__13_15': {0: {'1_2': (1.7930000000000001, 2, 0.8863145461259883, 2215313408.0, 0, 0), '2_1': (1.7930000000000001, 2, 0.8863145461259883, 0, 479647744.0, 0)}, 1: {'1_1': (1.6230000000000002, 1, 0.8016599468597856, 0, 0, 0)}, 2: {'1_4': (3.1270000000000002, 4, 1.5446077018776447, 6771769344.0, 0, 0), '2_2': (3.1270000000000002, 4, 1.5446077018776447, 4514512896.0, 890482688.0, 0), '4_1': (3.1270000000000002, 4, 1.5446077018776447, 0, 1335724032.0, 0)}, 3: {'1_1': (1.461, 1, 0.7216599468597855, 0, 0, 0)}}}
[I] Pipeline partition mode: auto | Layer-to-stage partition: [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9], [10, 11, 12, 13, 14, 15]]
[I] Pipeline partition mode: auto | Cell-generated physical mesh shapes: [(1, 2), (1, 2), (1, 2), (1, 2)]
[I] Loading model and transform to Jaxpr stages takes 29.952520608901978 s.
[I] The GPU sharding of pipeline stages is: [2, 2, 2, 2]
[I] Pipeline partition mode: auto | Parallel enum mode: auto | Parallel plans: [[StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None), StageShape(type='single', stage_shape=(2, 1), layer_shape=None)]]

[I] (Parallel plan idx: 0) Sharding stages...
[I] Sharding stages takes 19.804535150527954 s.
[I] (Parallel plan idx: 0) SPMD partitioning and compiling (kernel fusing) HLO stages...
[I] SPMD partitioning and pre-compiling HLO modules concurrently takes 14.317891359329224 s.

[I] All parallel plans in the cell have been sharded and compiled.
[TMP] Writing only-sharded HLO text to '/home/cyxue/Projects/crius/Crius/runtime/jaxpr/tmp/moe_2.4B_256_sharded_stages.pkl'...
[TMP] Writing optimized HLO text to '/home/cyxue/Projects/crius/Crius/runtime/jaxpr/tmp/moe_2.4B_256_optimized_stages.pkl'...
[TMP] Writing inter-stages communicated vars to '/home/cyxue/Projects/crius/Crius/runtime/jaxpr/tmp/moe_2.4B_256_inter_stages_comm_vars.pkl'

[I] Parallel plan idx: 0 | Parallelism: [(2, 1), (2, 1), (2, 1), (2, 1)]

[I] (Parallel plan idx: 0) Parsing HLO texts and profiling XLA operators...
[I] Pipeline partition mode: auto | Preset physical mesh shapes: [(1, 2), (1, 2), (1, 2), (1, 2)]
[TMP] Loading offline profiled communication data: `1_a40_1_n_2_d_ib.pkl`...
[TMP] Loading offline profiled communication data: `2_a40_2_n_1_d_ib.pkl`...
\Time of module 0 (stage 0):
Intra-stage comm time: 0
Grad sync time: 0

[I] Optimized module 0 for stage 0, comm time has been statically analyzed.
\Time of module 1 (stage 1):
Intra-stage comm time: 0
Grad sync time: 0

[I] Optimized module 1 for stage 1, comm time has been statically analyzed.
\Time of module 2 (stage 2):
Intra-stage comm time: 0
Grad sync time: 0

[I] Optimized module 2 for stage 2, comm time has been statically analyzed.
\Time of module 3 (stage 3):
Intra-stage comm time: 0
Grad sync time: 0

[I] Optimized module 3 for stage 3, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 454765696.0 | Estimated comm time: 0.15380100525903984
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 4 (stage 3):
Intra-stage comm time: 0.0001004397869110163
Grad sync time: 0.15380100525903984

[I] Optimized module 4 for stage 3, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 293643264.0 | Estimated comm time: 0.10025625045388005
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 5 (stage 2):
Intra-stage comm time: 0.0
Grad sync time: 0.10025625045388005

[I] Optimized module 5 for stage 2, comm time has been statically analyzed.
\Time of module 6 (stage 1):
Intra-stage comm time: 0.0
Grad sync time: 0.04906514336665471

[I] Optimized module 6 for stage 1, comm time has been statically analyzed.
[WARN] Communication size of 'all-reduce' excceeds the maximum profiled size. Linear scaling is applied.
       - Communication size of the operator: 300057088.0 | Estimated comm time: 0.10214247802729369
       - Max profiled communication size: 267386880 | Comm time: 0.08228549003601074
\Time of module 7 (stage 0):
Intra-stage comm time: 0.0
Grad sync time: 0.10214247802729369

[I] Optimized module 7 for stage 0, comm time has been statically analyzed.
\Time of module 8 (stage 0):
Intra-stage comm time: 0.05705197541614097
Grad sync time: 0

[I] Optimized module 8 for stage 0, comm time has been statically analyzed.
\Time of module 9 (stage 1):
Intra-stage comm time: 0.03441986857246774
Grad sync time: 0

[I] Optimized module 9 for stage 1, comm time has been statically analyzed.
\Time of module 10 (stage 2):
Intra-stage comm time: 0.057837508836416876
Grad sync time: 0

[I] Optimized module 10 for stage 2, comm time has been statically analyzed.
\Time of module 11 (stage 3):
Intra-stage comm time: 0.0884607855572881
Grad sync time: 0

[I] Optimized module 11 for stage 3, comm time has been statically analyzed.
[TMP] Memory footprint of the stage 0 is 6.881445150822401 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 1 is 3.6428623236715794 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 2 is 6.659824375063181 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[TMP] Memory footprint of the stage 3 is 10.178098682314157 GB, while the available memory of the XLA device is 35.33237304631621 GB.
[I] Only-sharded module 0 for stage 0, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.039487461 s.
    - Iteration 1/5: Kernel execution time: 0.03943913500000001 s.
    - Iteration 2/5: Kernel execution time: 0.03948464100000001 s.
    - Iteration 3/5: Kernel execution time: 0.039589761000000015 s.
    - Iteration 4/5: Kernel execution time: 0.039384099 s.
[I] Only-sharded module 1 for stage 1, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.033703903 s.
    - Iteration 1/5: Kernel execution time: 0.033638725999999994 s.
    - Iteration 2/5: Kernel execution time: 0.03373846900000001 s.
    - Iteration 3/5: Kernel execution time: 0.03365657600000002 s.
    - Iteration 4/5: Kernel execution time: 0.033743519 s.
[I] Only-sharded module 2 for stage 2, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.04199993500000001 s.
    - Iteration 1/5: Kernel execution time: 0.042008250999999996 s.
    - Iteration 2/5: Kernel execution time: 0.042106083 s.
    - Iteration 3/5: Kernel execution time: 0.04198377599999999 s.
    - Iteration 4/5: Kernel execution time: 0.04197321700000001 s.
[I] Only-sharded module 3 for stage 3, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.05028661900000001 s.
    - Iteration 1/5: Kernel execution time: 0.050411749000000027 s.
    - Iteration 2/5: Kernel execution time: 0.05042860400000002 s.
    - Iteration 3/5: Kernel execution time: 0.05046282599999999 s.
    - Iteration 4/5: Kernel execution time: 0.0502777 s.
[I] Only-sharded module 4 for stage 3, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.18827206500000002 s.
    - Iteration 1/5: Kernel execution time: 0.1875883429999999 s.
    - Iteration 2/5: Kernel execution time: 0.18758066100000004 s.
    - Iteration 3/5: Kernel execution time: 0.18771043899999987 s.
    - Iteration 4/5: Kernel execution time: 0.18773595900000023 s.
[I] Only-sharded module 5 for stage 2, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.11613010500000008 s.
    - Iteration 1/5: Kernel execution time: 0.11604565399999997 s.
    - Iteration 2/5: Kernel execution time: 0.11582094499999998 s.
    - Iteration 3/5: Kernel execution time: 0.11589798100000002 s.
    - Iteration 4/5: Kernel execution time: 0.115817384 s.
[I] Only-sharded module 6 for stage 1, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.08855890900000002 s.
    - Iteration 1/5: Kernel execution time: 0.08861944700000005 s.
    - Iteration 2/5: Kernel execution time: 0.08822416000000002 s.
    - Iteration 3/5: Kernel execution time: 0.08828554300000001 s.
    - Iteration 4/5: Kernel execution time: 0.088505729 s.
[I] Only-sharded module 7 for stage 0, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.10525315199999997 s.
    - Iteration 1/5: Kernel execution time: 0.10520349199999997 s.
    - Iteration 2/5: Kernel execution time: 0.10543773700000002 s.
    - Iteration 3/5: Kernel execution time: 0.10530707900000001 s.
    - Iteration 4/5: Kernel execution time: 0.105436969 s.
[I] Only-sharded module 8 for stage 0, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.018797923999999997 s.
    - Iteration 1/5: Kernel execution time: 0.018795310000000003 s.
    - Iteration 2/5: Kernel execution time: 0.018785862999999996 s.
    - Iteration 3/5: Kernel execution time: 0.01879818 s.
    - Iteration 4/5: Kernel execution time: 0.018795231000000003 s.
[I] Only-sharded module 9 for stage 1, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.010336154999999998 s.
    - Iteration 1/5: Kernel execution time: 0.010463075000000002 s.
    - Iteration 2/5: Kernel execution time: 0.010323456 s.
    - Iteration 3/5: Kernel execution time: 0.010310389 s.
    - Iteration 4/5: Kernel execution time: 0.010329438000000002 s.
[I] Only-sharded module 10 for stage 2, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.018467936 s.
    - Iteration 1/5: Kernel execution time: 0.018458110999999996 s.
    - Iteration 2/5: Kernel execution time: 0.018470944000000003 s.
    - Iteration 3/5: Kernel execution time: 0.018474056000000003 s.
    - Iteration 4/5: Kernel execution time: 0.018440774 s.
[I] Only-sharded module 11 for stage 3, constructing entry XLA computation...
[I] Compiling HLO module...
[I] Profiling HLO modules...
    - Iteration 0/5: Kernel execution time: 0.02856877500000001 s.
    - Iteration 1/5: Kernel execution time: 0.028552960000000006 s.
    - Iteration 2/5: Kernel execution time: 0.028567810000000003 s.
    - Iteration 3/5: Kernel execution time: 0.028572336 s.
    - Iteration 4/5: Kernel execution time: 0.028548508999999996 s.
[I] Constructing single-device HLO modules concurrently takes 0.16558527946472168 s.
[I] Compile single-device HLO modules concurrently takes 9.637952327728271 s.
[I] Profile all compiled sequentially on one GPU takes 14.805264711380005 s.
[I] Estimated e2e pipeline iteration time is: 5.132522462542232 s.
    - Kernel computation time is: -1.0 s.
    - Communication time is: -1.0 s.
    - Cross-stages communication time is: -1.0 s.
