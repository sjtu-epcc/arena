# Structure of Tuning Database

The tuning database is organized as a `Dict` object with multi-levels key-value mapping. The stored data is divided in two parts: `"plan_set"` and `"selected_cell_num_stages"`, where are also the level-1 keys in the tuning database.

In `"plan_set"` category, the data is organized as a key-value mapping as follows:

 - Key: `f"{model_name}__{param_num}::{batch_size}__{num_micro_batches}::{num_stages}::{gpu_type}__{num_hosts}__{num_devices_per_host}"`

 - Value: Non-dominated plan set generated by the pipeline planner, which stores all `plan_shape_hashkey` in the format of `f"{plan_hashkey}::{shape_hashkey_stage_1}__{shape_hashkey_stage_2}"` (if the model is sliced into 2 stages). Furthermore, the `plan_hashkey` is in the format of `f"{start_layer_idx_1}_{end_layer_idx_1}__{start_layer_idx_2}_{end_layer_idx_2}"` (if the layers are clustered into 2 stages), and the `shape_hashkey` is in the format of `f"{dp_rank}_{tp_rank}"`.

In `"selected_cell_num_stages"` category, the data is also organized as a key-value mapping as follows:

 - Key: `f"{model_name}__{param_num}::{batch_size}__{num_micro_batches}::{gpu_type}__{num_hosts}__{num_devices_per_host}"`

 - Value: The number of stages corresponding to the selected cell.
