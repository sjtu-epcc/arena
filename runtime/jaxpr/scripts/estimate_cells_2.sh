
LOG_PATH=runtime/jaxpr/console_log/estimate_one_cell_all_2


# Model configs
model_name=moe
param_num=2.4B
batch_size=256
num_pipeline_stages=4
# Hardware configs
num_hosts=4
num_devices_per_host=2
gpu_type=a40
# Plan shape hashkeys
plan_shape_hashkeys=(
    # For 4-GPU
    # "0_1__2_15::2_1__2_1" "0_1__2_15::2_1__1_2" "0_1__2_15::1_2__2_1" "0_1__2_15::1_2__1_2"
    # "0_2__3_15::2_1__2_1" "0_2__3_15::2_1__1_2" "0_2__3_15::1_2__2_1" "0_2__3_15::1_2__1_2" 
    # "0_3__4_15::2_1__2_1" "0_3__4_15::2_1__1_2" "0_3__4_15::1_2__2_1" "0_3__4_15::1_2__1_2" 
    # "0_4__5_15::2_1__2_1" "0_4__5_15::2_1__1_2" "0_4__5_15::1_2__2_1" "0_4__5_15::1_2__1_2" 
    # "0_5__6_15::2_1__2_1" "0_5__6_15::2_1__1_2" "0_5__6_15::1_2__2_1" "0_5__6_15::1_2__1_2" 
    # "0_6__7_15::2_1__2_1" "0_6__7_15::2_1__1_2" "0_6__7_15::1_2__2_1" "0_6__7_15::1_2__1_2" 
    # "0_7__8_15::2_1__2_1" "0_7__8_15::2_1__1_2" "0_7__8_15::1_2__2_1" "0_7__8_15::1_2__1_2" 
    # "0_8__9_15::2_1__2_1" "0_8__9_15::2_1__1_2" "0_8__9_15::1_2__2_1" "0_8__9_15::1_2__1_2" 
    # "0_9__10_15::2_1__2_1" "0_9__10_15::2_1__1_2" "0_9__10_15::1_2__2_1" "0_9__10_15::1_2__1_2" 
    # "0_10__11_15::2_1__2_1" "0_10__11_15::2_1__1_2" "0_10__11_15::1_2__2_1" "0_10__11_15::1_2__1_2" 
    # "0_11__12_15::2_1__2_1" "0_11__12_15::2_1__1_2" "0_11__12_15::1_2__2_1" "0_11__12_15::1_2__1_2" 
    # "0_12__13_15::2_1__2_1" "0_12__13_15::2_1__1_2" "0_12__13_15::1_2__2_1" "0_12__13_15::1_2__1_2" 
    # "0_13__14_15::2_1__2_1" "0_13__14_15::2_1__1_2" "0_13__14_15::1_2__2_1" "0_13__14_15::1_2__1_2" 

    # For 8-GPU
    # "0_1__2_7__8_11__12_15::1_2__1_2__1_2__1_2" "0_1__2_7__8_11__12_15::2_1__2_1__2_1__2_1"
    # "0_2__3_7__8_11__12_15::1_2__1_2__1_2__1_2" "0_2__3_7__8_11__12_15::2_1__2_1__2_1__2_1"
    # "0_3__4_7__8_11__12_15::1_2__1_2__1_2__1_2" "0_3__4_7__8_11__12_15::2_1__2_1__2_1__2_1"
    # "0_4__5_7__8_11__12_15::1_2__1_2__1_2__1_2" "0_4__5_7__8_11__12_15::2_1__2_1__2_1__2_1"
    # "0_5__6_7__8_11__12_15::1_2__1_2__1_2__1_2" "0_5__6_7__8_11__12_15::2_1__2_1__2_1__2_1"
    # "0_3__4_8__9_11__12_15::1_2__1_2__1_2__1_2" "0_3__4_8__9_11__12_15::2_1__2_1__2_1__2_1"
    # "0_4__5_8__9_11__12_15::1_2__1_2__1_2__1_2" "0_4__5_8__9_11__12_15::2_1__2_1__2_1__2_1"
    # "0_5__6_8__9_11__12_15::1_2__1_2__1_2__1_2" "0_5__6_8__9_11__12_15::2_1__2_1__2_1__2_1"
    # "0_6__7_8__9_11__12_15::1_2__1_2__1_2__1_2" "0_6__7_8__9_11__12_15::2_1__2_1__2_1__2_1"
    # "0_4__5_9__10_11__12_15::1_2__1_2__1_2__1_2" "0_4__5_9__10_11__12_15::2_1__2_1__2_1__2_1"
    # "0_5__6_9__10_11__12_15::1_2__1_2__1_2__1_2" "0_5__6_9__10_11__12_15::2_1__2_1__2_1__2_1"
    # "0_6__7_9__10_11__12_15::1_2__1_2__1_2__1_2" "0_6__7_9__10_11__12_15::2_1__2_1__2_1__2_1"
    # "0_1__2_7__8_12__13_15::1_2__1_2__1_2__1_2" "0_1__2_7__8_12__13_15::2_1__2_1__2_1__2_1"
    # "0_2__3_7__8_12__13_15::1_2__1_2__1_2__1_2" "0_2__3_7__8_12__13_15::2_1__2_1__2_1__2_1"
    # "0_3__4_7__8_12__13_15::1_2__1_2__1_2__1_2" "0_3__4_7__8_12__13_15::2_1__2_1__2_1__2_1"
    # "0_4__5_7__8_12__13_15::1_2__1_2__1_2__1_2" "0_4__5_7__8_12__13_15::2_1__2_1__2_1__2_1"
    # "0_5__6_7__8_12__13_15::1_2__1_2__1_2__1_2" "0_5__6_7__8_12__13_15::2_1__2_1__2_1__2_1"
    # "0_2__3_8__9_12__13_15::1_2__1_2__1_2__1_2" "0_2__3_8__9_12__13_15::2_1__2_1__2_1__2_1"
    # "0_3__4_8__9_12__13_15::1_2__1_2__1_2__1_2" "0_3__4_8__9_12__13_15::2_1__2_1__2_1__2_1"
    # "0_4__5_8__9_12__13_15::1_2__1_2__1_2__1_2" "0_4__5_8__9_12__13_15::2_1__2_1__2_1__2_1"
    # "0_5__6_8__9_12__13_15::1_2__1_2__1_2__1_2" "0_5__6_8__9_12__13_15::2_1__2_1__2_1__2_1"
    # "0_6__7_8__9_12__13_15::1_2__1_2__1_2__1_2" "0_6__7_8__9_12__13_15::2_1__2_1__2_1__2_1"
    # "0_3__4_9__10_12__13_15::1_2__1_2__1_2__1_2" "0_3__4_9__10_12__13_15::2_1__2_1__2_1__2_1"
    # "0_4__5_9__10_12__13_15::1_2__1_2__1_2__1_2" "0_4__5_9__10_12__13_15::2_1__2_1__2_1__2_1"
    # "0_5__6_9__10_12__13_15::1_2__1_2__1_2__1_2" "0_5__6_9__10_12__13_15::2_1__2_1__2_1__2_1"
    # "0_6__7_9__10_12__13_15::1_2__1_2__1_2__1_2" "0_6__7_9__10_12__13_15::2_1__2_1__2_1__2_1"
    # "0_5__6_10__11_12__13_15::1_2__1_2__1_2__1_2" "0_5__6_10__11_12__13_15::2_1__2_1__2_1__2_1"
    # "0_6__7_10__11_12__13_15::1_2__1_2__1_2__1_2" "0_6__7_10__11_12__13_15::2_1__2_1__2_1__2_1"
    # "0_4__5_9__10_13__14_15::1_2__1_2__1_2__1_2" "0_4__5_9__10_13__14_15::2_1__2_1__2_1__2_1"
    # "0_5__6_9__10_13__14_15::1_2__1_2__1_2__1_2" "0_5__6_9__10_13__14_15::2_1__2_1__2_1__2_1"
    # "0_6__7_9__10_13__14_15::1_2__1_2__1_2__1_2" "0_6__7_9__10_13__14_15::2_1__2_1__2_1__2_1"
    # "0_5__6_10__11_13__14_15::1_2__1_2__1_2__1_2" "0_5__6_10__11_13__14_15::2_1__2_1__2_1__2_1"
    # "0_6__7_10__11_13__14_15::1_2__1_2__1_2__1_2" "0_6__7_10__11_13__14_15::2_1__2_1__2_1__2_1"
    # "0_6__7_11__12_13__14_15::1_2__1_2__1_2__1_2" "0_6__7_11__12_13__14_15::2_1__2_1__2_1__2_1"
    # 0_5__6_8__9_12__13_15::1_2__1_2__2_1__2_1
    # 0_5__6_8__9_12__13_15::1_2__2_1__1_2__2_1
    # 0_5__6_8__9_12__13_15::1_2__2_1__2_1__1_2
    # 0_5__6_8__9_12__13_15::2_1__1_2__1_2__2_1
    # 0_5__6_8__9_12__13_15::2_1__1_2__2_1__1_2
    # 0_5__6_8__9_12__13_15::2_1__2_1__1_2__1_2
    # 0_5__6_9__10_12__13_15::1_2__1_2__2_1__2_1
    # 0_5__6_9__10_12__13_15::1_2__2_1__1_2__2_1
    # 0_5__6_9__10_12__13_15::1_2__2_1__2_1__1_2
    # 0_5__6_9__10_12__13_15::2_1__1_2__1_2__2_1
    # 0_5__6_9__10_12__13_15::2_1__1_2__2_1__1_2
    # 0_5__6_9__10_12__13_15::2_1__2_1__1_2__1_2
    # 0_6__7_9__10_12__13_15::1_2__1_2__2_1__2_1
    # 0_6__7_9__10_12__13_15::1_2__2_1__1_2__2_1
    # 0_6__7_9__10_12__13_15::1_2__2_1__2_1__1_2
    # 0_6__7_9__10_12__13_15::2_1__1_2__1_2__2_1
    # 0_6__7_9__10_12__13_15::2_1__1_2__2_1__1_2
    # 0_6__7_9__10_12__13_15::2_1__2_1__1_2__1_2
    # 0_5__6_9__10_13__14_15::1_2__1_2__2_1__2_1
    # 0_5__6_9__10_13__14_15::1_2__2_1__1_2__2_1
    # 0_5__6_9__10_13__14_15::1_2__2_1__2_1__1_2
    # 0_5__6_9__10_13__14_15::2_1__1_2__1_2__2_1
    # 0_5__6_9__10_13__14_15::2_1__1_2__2_1__1_2
    # 0_5__6_9__10_13__14_15::2_1__2_1__1_2__1_2
    # 0_6__7_9__10_13__14_15::1_2__1_2__2_1__2_1
    # 0_6__7_9__10_13__14_15::1_2__2_1__1_2__2_1
    # 0_6__7_9__10_13__14_15::1_2__2_1__2_1__1_2
    # 0_6__7_9__10_13__14_15::2_1__1_2__1_2__2_1
    # 0_6__7_9__10_13__14_15::2_1__1_2__2_1__1_2
    # 0_6__7_9__10_13__14_15::2_1__2_1__1_2__1_2
    # 0_5__6_10__11_13__14_15::1_2__1_2__2_1__2_1
    # 0_5__6_10__11_13__14_15::1_2__2_1__1_2__2_1
    # 0_5__6_10__11_13__14_15::1_2__2_1__2_1__1_2
    # 0_5__6_10__11_13__14_15::2_1__1_2__1_2__2_1
    # 0_5__6_10__11_13__14_15::2_1__1_2__2_1__1_2
    # 0_5__6_10__11_13__14_15::2_1__2_1__1_2__1_2
    # 0_6__7_10__11_13__14_15::1_2__1_2__2_1__2_1
    # 0_6__7_10__11_13__14_15::1_2__2_1__1_2__2_1
    # 0_6__7_10__11_13__14_15::1_2__2_1__2_1__1_2
    # 0_6__7_10__11_13__14_15::2_1__1_2__1_2__2_1
    # 0_6__7_10__11_13__14_15::2_1__1_2__2_1__1_2
    # 0_6__7_10__11_13__14_15::2_1__2_1__1_2__1_2
    # 0_7__8_10__11_13__14_15::1_2__1_2__2_1__2_1
    # 0_7__8_10__11_13__14_15::1_2__2_1__1_2__2_1
    # 0_7__8_10__11_13__14_15::1_2__2_1__2_1__1_2
    # 0_7__8_10__11_13__14_15::2_1__1_2__1_2__2_1
    # 0_7__8_10__11_13__14_15::2_1__1_2__2_1__1_2
    # 0_7__8_10__11_13__14_15::2_1__2_1__1_2__1_2
    # 0_6__7_11__12_13__14_15::1_2__1_2__2_1__2_1
    # 0_6__7_11__12_13__14_15::1_2__2_1__1_2__2_1
    # 0_6__7_11__12_13__14_15::1_2__2_1__2_1__1_2
    # 0_6__7_11__12_13__14_15::2_1__1_2__1_2__2_1
    # 0_6__7_11__12_13__14_15::2_1__1_2__2_1__1_2
    # 0_6__7_11__12_13__14_15::2_1__2_1__1_2__1_2
    # 0_7__8_11__12_13__14_15::1_2__1_2__2_1__2_1
    # 0_7__8_11__12_13__14_15::1_2__2_1__1_2__2_1
    # 0_7__8_11__12_13__14_15::1_2__2_1__2_1__1_2
    # 0_7__8_11__12_13__14_15::2_1__1_2__1_2__2_1
    # 0_7__8_11__12_13__14_15::2_1__1_2__2_1__1_2
    # 0_7__8_11__12_13__14_15::2_1__2_1__1_2__1_2
    # 0_8__9_11__12_13__14_15::1_2__1_2__2_1__2_1
    # 0_8__9_11__12_13__14_15::1_2__2_1__1_2__2_1
    # 0_8__9_11__12_13__14_15::1_2__2_1__2_1__1_2
    # 0_8__9_11__12_13__14_15::2_1__1_2__1_2__2_1
    # 0_8__9_11__12_13__14_15::2_1__1_2__2_1__1_2
    # 0_8__9_11__12_13__14_15::2_1__2_1__1_2__1_2
    0_2__3_5__6_9__10_15::1_2__1_2__1_2__1_2
    0_2__3_5__6_9__10_15::2_1__2_1__2_1__2_1
    0_2__3_6__7_9__10_15::1_2__1_2__1_2__1_2
    0_2__3_6__7_9__10_15::2_1__2_1__2_1__2_1
    0_3__4_6__7_9__10_15::1_2__1_2__1_2__1_2
    0_3__4_6__7_9__10_15::2_1__2_1__2_1__2_1
    0_2__3_5__6_10__11_15::1_2__1_2__1_2__1_2
    0_2__3_5__6_10__11_15::2_1__2_1__2_1__2_1
    0_2__3_6__7_10__11_15::1_2__1_2__1_2__1_2
    0_2__3_6__7_10__11_15::2_1__2_1__2_1__2_1
    0_3__4_6__7_10__11_15::1_2__1_2__1_2__1_2
    0_3__4_6__7_10__11_15::2_1__2_1__2_1__2_1
    0_2__3_7__8_10__11_15::1_2__1_2__1_2__1_2
    0_2__3_7__8_10__11_15::2_1__2_1__2_1__2_1
    0_3__4_7__8_10__11_15::1_2__1_2__1_2__1_2
    0_3__4_7__8_10__11_15::2_1__2_1__2_1__2_1
    0_4__5_7__8_10__11_15::1_2__1_2__1_2__1_2
    0_4__5_7__8_10__11_15::2_1__2_1__2_1__2_1
    0_2__3_5__6_11__12_15::1_2__1_2__1_2__1_2
    0_2__3_5__6_11__12_15::2_1__2_1__2_1__2_1
    0_2__3_6__7_11__12_15::1_2__1_2__1_2__1_2
    0_2__3_6__7_11__12_15::2_1__2_1__2_1__2_1
    0_3__4_6__7_11__12_15::1_2__1_2__1_2__1_2
    0_3__4_6__7_11__12_15::2_1__2_1__2_1__2_1
    0_2__3_7__8_11__12_15::1_2__1_2__1_2__1_2
    0_2__3_7__8_11__12_15::2_1__2_1__2_1__2_1
    0_3__4_7__8_11__12_15::1_2__1_2__1_2__1_2
    0_3__4_7__8_11__12_15::2_1__2_1__2_1__2_1
    0_4__5_7__8_11__12_15::1_2__1_2__1_2__1_2
    0_4__5_7__8_11__12_15::2_1__2_1__2_1__2_1
    0_3__4_8__9_11__12_15::1_2__1_2__1_2__1_2
    0_3__4_8__9_11__12_15::2_1__2_1__2_1__2_1
    0_4__5_8__9_11__12_15::1_2__1_2__1_2__1_2
    0_4__5_8__9_11__12_15::2_1__2_1__2_1__2_1

    # For 16-GPU
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__1_2__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__1_2__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__2_1__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__2_1__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__2_1__1_2__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__2_1__1_2__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__2_1__2_1__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__2_1__2_1__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__1_2__1_2__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__1_2__1_2__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__1_2__2_1__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__1_2__2_1__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__2_1__1_2__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__2_1__1_2__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__2_1__2_1__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__2_1__2_1__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__1_2__1_2__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__1_2__1_2__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__1_2__2_1__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__1_2__2_1__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__2_1__1_2__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__2_1__1_2__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__2_1__2_1__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__2_1__2_1__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__1_2__1_2__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__1_2__1_2__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__1_2__2_1__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__1_2__2_1__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__1_2__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__1_2__2_1
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__1_2
    # 0_3__4_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__1_2__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__1_2__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__2_1__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__1_2__2_1__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__2_1__1_2__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__2_1__1_2__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__2_1__2_1__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__1_2__2_1__2_1__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__1_2__1_2__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__1_2__1_2__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__1_2__2_1__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__1_2__2_1__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__2_1__1_2__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__2_1__1_2__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__2_1__2_1__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::1_2__1_2__1_2__1_2__2_1__2_1__2_1__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__1_2__1_2__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__1_2__1_2__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__1_2__2_1__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__1_2__2_1__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__2_1__1_2__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__2_1__1_2__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__2_1__2_1__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__1_2__2_1__2_1__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__1_2__1_2__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__1_2__1_2__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__1_2__2_1__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__1_2__2_1__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__1_2__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__1_2__2_1
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__1_2
    # 0_4__5_6__7_8__9_10__11_12__13_13__14_14__15_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__2_1

    # For 16-GPU (Bert & MoE)
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__1_2__1_2__1_2__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__1_2__1_2__1_2__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__1_2__1_2__2_1__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__1_2__1_2__2_1__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__1_2__2_1__1_2__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__1_2__2_1__1_2__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__1_2__2_1__2_1__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__1_2__2_1__2_1__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__2_1__1_2__1_2__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__2_1__1_2__1_2__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__2_1__1_2__2_1__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__2_1__1_2__2_1__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__2_1__2_1__1_2__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__2_1__2_1__1_2__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__2_1__2_1__2_1__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::1_2__1_2__1_2__1_2__2_1__2_1__2_1__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__1_2__1_2__1_2__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__1_2__1_2__1_2__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__1_2__1_2__2_1__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__1_2__1_2__2_1__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__1_2__2_1__1_2__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__1_2__2_1__1_2__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__1_2__2_1__2_1__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__1_2__2_1__2_1__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__2_1__1_2__1_2__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__2_1__1_2__1_2__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__2_1__1_2__2_1__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__2_1__1_2__2_1__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__2_1__2_1__1_2__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__2_1__2_1__1_2__2_1
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__1_2
    # 0_1__2_3__4_5__6_7__8_9__10_11__12_13__14_15::2_1__2_1__2_1__2_1__2_1__2_1__2_1__2_1
)
num_keys=34

for((i=0;i<${num_keys};i++))
do
    plan_shape_hashkey=${plan_shape_hashkeys[${i}]}
    echo ""
    echo "-------------------- Plan Shape Hashkey: ${plan_shape_hashkey} --------------------"

    python runtime/jaxpr/runtime_profiler.py --estimate_e2e --num_hosts ${num_hosts} --num_devices_per_host ${num_devices_per_host} \
                                             --devices_name ${num_hosts}_${gpu_type} --model_name ${model_name} --param_num ${param_num} \
                                             --batch_size ${batch_size} --niter 5 --warmup_num 2 --enable_cell_profile \
                                             --num_pipeline_stages ${num_pipeline_stages} --cell_prof_strategy=auto --use_ib_comm_data \
                                             --only_symmetric_sharding --disable_plan_set \
                                             --force_plan_shape_hashkey ${plan_shape_hashkey} | tee ${LOG_PATH}/${plan_shape_hashkey}.log
done
