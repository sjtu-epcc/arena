HloModule train_step_func_pipeshard_parallel_mesh_1-1_apply_grad, input_output_alias={ {0}: (0, {}, may-alias), {1}: (1, {}, may-alias), {2}: (2, {}, may-alias), {3}: (3, {}, may-alias), {4}: (4, {}, may-alias), {5}: (5, {}, may-alias), {6}: (6, {}, may-alias), {7}: (7, {}, may-alias), {8}: (8, {}, may-alias), {9}: (9, {}, may-alias), {10}: (10, {}, may-alias), {11}: (11, {}, may-alias), {12}: (12, {}, may-alias), {13}: (13, {}, may-alias), {14}: (14, {}, may-alias), {15}: (15, {}, may-alias), {16}: (16, {}, may-alias), {17}: (17, {}, may-alias), {18}: (18, {}, may-alias), {19}: (19, {}, may-alias), {20}: (20, {}, may-alias), {21}: (21, {}, may-alias), {22}: (22, {}, may-alias), {23}: (23, {}, may-alias), {24}: (24, {}, may-alias), {25}: (25, {}, may-alias), {26}: (26, {}, may-alias), {27}: (27, {}, may-alias), {28}: (28, {}, may-alias), {29}: (29, {}, may-alias), {30}: (30, {}, may-alias), {31}: (31, {}, may-alias), {32}: (32, {}, may-alias), {33}: (33, {}, may-alias), {34}: (34, {}, may-alias), {35}: (35, {}, may-alias), {36}: (36, {}, may-alias), {37}: (37, {}, may-alias), {38}: (38, {}, may-alias), {39}: (39, {}, may-alias), {40}: (40, {}, may-alias), {41}: (41, {}, may-alias), {42}: (42, {}, may-alias), {43}: (43, {}, may-alias), {44}: (44, {}, may-alias), {45}: (45, {}, may-alias), {46}: (46, {}, may-alias), {47}: (47, {}, may-alias), {48}: (48, {}, may-alias), {49}: (49, {}, may-alias), {50}: (50, {}, may-alias), {51}: (51, {}, may-alias), {52}: (52, {}, may-alias), {53}: (53, {}, may-alias), {54}: (54, {}, may-alias), {55}: (55, {}, may-alias), {56}: (56, {}, may-alias), {57}: (57, {}, may-alias), {58}: (58, {}, may-alias), {59}: (59, {}, may-alias), {60}: (60, {}, may-alias), {61}: (61, {}, may-alias), {62}: (62, {}, may-alias), {63}: (63, {}, may-alias), {64}: (64, {}, may-alias), {65}: (65, {}, may-alias), {66}: (66, {}, may-alias), {67}: (67, {}, may-alias), {68}: (68, {}, may-alias), {69}: (69, {}, may-alias), {70}: (70, {}, may-alias), {71}: (71, {}, may-alias), {72}: (72, {}, may-alias), {73}: (73, {}, may-alias), {74}: (74, {}, may-alias), {75}: (75, {}, may-alias), {76}: (76, {}, may-alias), {77}: (77, {}, may-alias), {78}: (78, {}, may-alias), {79}: (79, {}, may-alias), {80}: (80, {}, may-alias), {81}: (81, {}, may-alias), {82}: (82, {}, may-alias), {83}: (83, {}, may-alias), {84}: (84, {}, may-alias), {85}: (85, {}, may-alias), {86}: (86, {}, may-alias), {87}: (87, {}, may-alias), {88}: (88, {}, may-alias), {89}: (89, {}, may-alias), {90}: (90, {}, may-alias), {91}: (91, {}, may-alias), {92}: (92, {}, may-alias), {93}: (93, {}, may-alias), {94}: (94, {}, may-alias), {95}: (95, {}, may-alias), {96}: (96, {}, may-alias), {97}: (97, {}, may-alias), {98}: (98, {}, may-alias), {99}: (99, {}, may-alias), {100}: (100, {}, may-alias), {101}: (101, {}, may-alias), {102}: (102, {}, may-alias), {103}: (103, {}, may-alias), {104}: (104, {}, may-alias), {105}: (105, {}, may-alias), {106}: (106, {}, may-alias), {107}: (107, {}, may-alias), {108}: (108, {}, may-alias), {109}: (109, {}, may-alias), {110}: (110, {}, may-alias), {111}: (111, {}, may-alias), {112}: (112, {}, may-alias), {113}: (113, {}, may-alias), {114}: (114, {}, may-alias), {115}: (115, {}, may-alias), {116}: (116, {}, may-alias), {117}: (117, {}, may-alias), {118}: (118, {}, may-alias), {119}: (119, {}, may-alias), {120}: (120, {}, may-alias), {121}: (121, {}, may-alias), {122}: (122, {}, may-alias), {123}: (123, {}, may-alias), {124}: (124, {}, may-alias), {125}: (125, {}, may-alias), {126}: (126, {}, may-alias), {127}: (127, {}, may-alias), {128}: (128, {}, may-alias), {129}: (129, {}, may-alias), {130}: (130, {}, may-alias), {131}: (131, {}, may-alias), {132}: (132, {}, may-alias), {133}: (133, {}, may-alias), {134}: (134, {}, may-alias), {135}: (135, {}, may-alias), {136}: (136, {}, may-alias), {137}: (137, {}, may-alias), {138}: (138, {}, may-alias), {139}: (139, {}, may-alias), {140}: (140, {}, may-alias), {141}: (141, {}, may-alias), {142}: (142, {}, may-alias), {143}: (143, {}, may-alias), {144}: (144, {}, may-alias), {145}: (145, {}, may-alias), {146}: (146, {}, may-alias), {147}: (147, {}, may-alias), {148}: (148, {}, may-alias), {149}: (149, {}, may-alias), {150}: (150, {}, may-alias), {151}: (151, {}, may-alias), {152}: (152, {}, may-alias), {153}: (153, {}, may-alias), {154}: (154, {}, may-alias), {155}: (155, {}, may-alias), {156}: (156, {}, may-alias), {157}: (157, {}, may-alias), {158}: (158, {}, may-alias), {159}: (159, {}, may-alias), {160}: (160, {}, may-alias), {161}: (161, {}, may-alias), {162}: (162, {}, may-alias), {163}: (163, {}, may-alias), {164}: (164, {}, may-alias), {165}: (165, {}, may-alias), {166}: (166, {}, may-alias), {167}: (167, {}, may-alias), {168}: (168, {}, may-alias), {169}: (169, {}, may-alias), {170}: (170, {}, may-alias), {171}: (171, {}, may-alias), {172}: (172, {}, may-alias), {173}: (173, {}, may-alias), {174}: (174, {}, may-alias), {175}: (175, {}, may-alias), {176}: (176, {}, may-alias), {177}: (177, {}, may-alias), {178}: (178, {}, may-alias), {179}: (179, {}, may-alias), {180}: (180, {}, may-alias), {181}: (181, {}, may-alias), {182}: (182, {}, may-alias), {183}: (183, {}, may-alias), {184}: (184, {}, may-alias), {185}: (185, {}, may-alias), {186}: (186, {}, may-alias), {187}: (187, {}, may-alias), {188}: (188, {}, may-alias), {189}: (189, {}, may-alias), {190}: (190, {}, may-alias), {191}: (191, {}, may-alias), {192}: (192, {}, may-alias), {193}: (193, {}, may-alias), {194}: (194, {}, may-alias), {195}: (195, {}, may-alias), {196}: (196, {}, may-alias), {197}: (197, {}, may-alias), {198}: (198, {}, may-alias), {199}: (199, {}, may-alias), {200}: (200, {}, may-alias), {201}: (201, {}, may-alias), {202}: (202, {}, may-alias), {203}: (203, {}, may-alias), {204}: (204, {}, may-alias), {205}: (205, {}, may-alias) }, entry_computation_layout={(f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,3584,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[7168]{0},f32[7168]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,7168,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,7168,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[1024]{0},f32[7168,1024]{1,0},s32[],f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,3584,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[7168]{0},f32[7168]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,7168,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,7168,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[1024]{0},f32[7168,1024]{1,0},s32[],f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[7168]{0},f32[7168]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,3584,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[7168]{0},f32[7168]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,7168,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1,1,7168,1792]{3,2,1,0},f32[3,3,1792,3584]{3,2,1,0},f32[1,1,3584,7168]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1,1,3584,896]{3,2,1,0},f32[3,3,896,1792]{3,2,1,0},f32[1,1,1792,3584]{3,2,1,0},f32[1024]{0},f32[7168,1024]{1,0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[7168]{0},f32[7168]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[7168]{0},f32[7168]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[896]{0},f32[896]{0},f32[1792]{0},f32[1792]{0},f32[3584]{0},f32[3584]{0},f32[],f32[],f32[])->(f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, /*index=25*/f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[1,1,3584,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=35*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, /*index=40*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, /*index=45*/f32[1,1,7168,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1792]{0}, f32[1792]{0}, /*index=50*/f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[1,1,7168,1792]{3,2,1,0}, /*index=55*/f32[3,3,1792,3584]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, /*index=60*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=65*/f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, /*index=70*/f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=75*/f32[1024]{0}, f32[7168,1024]{1,0}, s32[], f32[896]{0}, f32[896]{0}, /*index=80*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, /*index=85*/f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, /*index=90*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=95*/f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, /*index=100*/f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=105*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, /*index=110*/f32[7168]{0}, f32[1,1,3584,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=115*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=120*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[1,1,7168,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=125*/f32[1,1,3584,7168]{3,2,1,0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=130*/f32[7168]{0}, f32[7168]{0}, f32[1,1,7168,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=135*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=140*/f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, /*index=145*/f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=150*/f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1024]{0}, f32[7168,1024]{1,0}, /*index=155*/s32[], f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, /*index=160*/f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, /*index=165*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=170*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1792]{0}, /*index=175*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, /*index=180*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=185*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, /*index=190*/f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, /*index=195*/f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=200*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=205*/f32[3584]{0}, f32[], f32[], f32[])}

%fused_computation.50 (param_0.51: f32[7168,1024], param_1.805: f32[7168,1024], param_2.705: s32[], param_3.710: f32[7168,1024]) -> (f32[7168,1024], f32[7168,1024]) {
  %param_0.51 = f32[7168,1024]{1,0} parameter(0)
  %param_2.705 = s32[] parameter(2)
  %convert.9 = f32[] convert(s32[] %param_2.705), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_974 = f32[] constant(50000)
  %compare.5 = pred[] compare(f32[] %convert.9, f32[] %constant_974), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_973 = f32[] constant(1)
  %constant_972 = s32[] constant(0)
  %maximum.4 = s32[] maximum(s32[] %param_2.705, s32[] %constant_972), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.8 = f32[] convert(s32[] %maximum.4), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.9 = f32[] minimum(f32[] %convert.8, f32[] %constant_974), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_971 = f32[] constant(2e-05)
  %multiply.826 = f32[] multiply(f32[] %minimum.9, f32[] %constant_971), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.4 = f32[] subtract(f32[] %constant_973, f32[] %multiply.826), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_970 = f32[] constant(-0.1)
  %multiply.825 = f32[] multiply(f32[] %subtract.4, f32[] %constant_970), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_969 = f32[] constant(0.1)
  %add.247 = f32[] add(f32[] %multiply.825, f32[] %constant_969), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_968 = f32[] constant(-50000)
  %add.246 = f32[] add(f32[] %convert.9, f32[] %constant_968), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_967 = f32[] constant(950000)
  %minimum.8 = f32[] minimum(f32[] %add.246, f32[] %constant_967), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_966 = f32[] constant(3.30693956e-06)
  %multiply.824 = f32[] multiply(f32[] %minimum.8, f32[] %constant_966), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.4 = f32[] cosine(f32[] %multiply.824), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.245 = f32[] add(f32[] %cosine.4, f32[] %constant_973), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_965 = f32[] constant(0.05)
  %multiply.823 = f32[] multiply(f32[] %add.245, f32[] %constant_965), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.5 = f32[] select(pred[] %compare.5, f32[] %add.247, f32[] %multiply.823), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_964 = f32[] constant(-1)
  %multiply.822 = f32[] multiply(f32[] %select.5, f32[] %constant_964), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.177 = f32[7168,1024]{1,0} broadcast(f32[] %multiply.822), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.805 = f32[7168,1024]{1,0} parameter(1)
  %constant_928 = f32[] constant(0.0625)
  %broadcast.818 = f32[7168,1024]{1,0} broadcast(f32[] %constant_928), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.806 = f32[7168,1024]{1,0} multiply(f32[7168,1024]{1,0} %param_1.805, f32[7168,1024]{1,0} %broadcast.818), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3.710 = f32[7168,1024]{1,0} parameter(3)
  %constant_197 = f32[] constant(0.9)
  %broadcast.331.clone.1 = f32[7168,1024]{1,0} broadcast(f32[] %constant_197), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.345.clone.1 = f32[7168,1024]{1,0} multiply(f32[7168,1024]{1,0} %param_3.710, f32[7168,1024]{1,0} %broadcast.331.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.159.clone.1 = f32[7168,1024]{1,0} add(f32[7168,1024]{1,0} %multiply.806, f32[7168,1024]{1,0} %multiply.345.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.187 = f32[7168,1024]{1,0} multiply(f32[7168,1024]{1,0} %add.159.clone.1, f32[7168,1024]{1,0} %broadcast.331.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.2 = f32[7168,1024]{1,0} add(f32[7168,1024]{1,0} %multiply.806, f32[7168,1024]{1,0} %multiply.187), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.186 = f32[7168,1024]{1,0} multiply(f32[7168,1024]{1,0} %broadcast.177, f32[7168,1024]{1,0} %add.2), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.1 = f32[7168,1024]{1,0} add(f32[7168,1024]{1,0} %param_0.51, f32[7168,1024]{1,0} %multiply.186), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.62 = (f32[7168,1024]{1,0}, f32[7168,1024]{1,0}) tuple(f32[7168,1024]{1,0} %add.1, f32[7168,1024]{1,0} %add.159.clone.1)
}

%fused_computation.51 (param_0.52: f32[1024], param_1.806: f32[1024], param_2.706: s32[], param_3.712: f32[1024]) -> (f32[1024], f32[1024]) {
  %param_0.52 = f32[1024]{0} parameter(0)
  %param_2.706 = s32[] parameter(2)
  %convert.17 = f32[] convert(s32[] %param_2.706), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1020 = f32[] constant(50000)
  %compare.9 = pred[] compare(f32[] %convert.17, f32[] %constant_1020), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1019 = f32[] constant(1)
  %constant_1018 = s32[] constant(0)
  %maximum.8 = s32[] maximum(s32[] %param_2.706, s32[] %constant_1018), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.16 = f32[] convert(s32[] %maximum.8), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.17 = f32[] minimum(f32[] %convert.16, f32[] %constant_1020), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1017 = f32[] constant(2e-05)
  %multiply.846 = f32[] multiply(f32[] %minimum.17, f32[] %constant_1017), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.8 = f32[] subtract(f32[] %constant_1019, f32[] %multiply.846), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1016 = f32[] constant(-0.1)
  %multiply.845 = f32[] multiply(f32[] %subtract.8, f32[] %constant_1016), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1015 = f32[] constant(0.1)
  %add.259 = f32[] add(f32[] %multiply.845, f32[] %constant_1015), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1014 = f32[] constant(-50000)
  %add.258 = f32[] add(f32[] %convert.17, f32[] %constant_1014), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1013 = f32[] constant(950000)
  %minimum.16 = f32[] minimum(f32[] %add.258, f32[] %constant_1013), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1012 = f32[] constant(3.30693956e-06)
  %multiply.844 = f32[] multiply(f32[] %minimum.16, f32[] %constant_1012), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.8 = f32[] cosine(f32[] %multiply.844), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.257 = f32[] add(f32[] %cosine.8, f32[] %constant_1019), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1011 = f32[] constant(0.05)
  %multiply.843 = f32[] multiply(f32[] %add.257, f32[] %constant_1011), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.9 = f32[] select(pred[] %compare.9, f32[] %add.259, f32[] %multiply.843), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1010 = f32[] constant(-1)
  %multiply.842 = f32[] multiply(f32[] %select.9, f32[] %constant_1010), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.179 = f32[1024]{0} broadcast(f32[] %multiply.842), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.806 = f32[1024]{0} parameter(1)
  %constant_922 = f32[] constant(0.0625)
  %broadcast.814 = f32[1024]{0} broadcast(f32[] %constant_922), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.802 = f32[1024]{0} multiply(f32[1024]{0} %param_1.806, f32[1024]{0} %broadcast.814), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3.712 = f32[1024]{0} parameter(3)
  %constant_198 = f32[] constant(0.9)
  %broadcast.333.clone.1 = f32[1024]{0} broadcast(f32[] %constant_198), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.347.clone.1 = f32[1024]{0} multiply(f32[1024]{0} %param_3.712, f32[1024]{0} %broadcast.333.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.160.clone.1 = f32[1024]{0} add(f32[1024]{0} %multiply.802, f32[1024]{0} %multiply.347.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.189 = f32[1024]{0} multiply(f32[1024]{0} %add.160.clone.1, f32[1024]{0} %broadcast.333.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.4 = f32[1024]{0} add(f32[1024]{0} %multiply.802, f32[1024]{0} %multiply.189), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.188 = f32[1024]{0} multiply(f32[1024]{0} %broadcast.179, f32[1024]{0} %add.4), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.3 = f32[1024]{0} add(f32[1024]{0} %param_0.52, f32[1024]{0} %multiply.188), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.63 = (f32[1024]{0}, f32[1024]{0}) tuple(f32[1024]{0} %add.3, f32[1024]{0} %add.160.clone.1)
}

%fused_computation.81 (param_0.82: f32[1,1,7168,1792], param_1.807: f32[1,1,7168,1792], param_2.707: s32[], param_3.713: f32[1,1,7168,1792], param_4.875: f32[1,1,7168,1792], param_5.584: f32[1,1,7168,1792], param_6.1053: f32[1,1,7168,1792]) -> (f32[1,1,7168,1792], f32[1,1,7168,1792], f32[1,1,7168,1792], f32[1,1,7168,1792]) {
  %param_0.82 = f32[1,1,7168,1792]{3,2,1,0} parameter(0)
  %param_2.707 = s32[] parameter(2)
  %convert.53 = f32[] convert(s32[] %param_2.707), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1227 = f32[] constant(50000)
  %compare.27 = pred[] compare(f32[] %convert.53, f32[] %constant_1227), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1226 = f32[] constant(1)
  %constant_1225 = s32[] constant(0)
  %maximum.26 = s32[] maximum(s32[] %param_2.707, s32[] %constant_1225), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.52 = f32[] convert(s32[] %maximum.26), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.53 = f32[] minimum(f32[] %convert.52, f32[] %constant_1227), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1224 = f32[] constant(2e-05)
  %multiply.936 = f32[] multiply(f32[] %minimum.53, f32[] %constant_1224), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.26 = f32[] subtract(f32[] %constant_1226, f32[] %multiply.936), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1223 = f32[] constant(-0.1)
  %multiply.935 = f32[] multiply(f32[] %subtract.26, f32[] %constant_1223), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1222 = f32[] constant(0.1)
  %add.313 = f32[] add(f32[] %multiply.935, f32[] %constant_1222), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1221 = f32[] constant(-50000)
  %add.312 = f32[] add(f32[] %convert.53, f32[] %constant_1221), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1220 = f32[] constant(950000)
  %minimum.52 = f32[] minimum(f32[] %add.312, f32[] %constant_1220), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1219 = f32[] constant(3.30693956e-06)
  %multiply.934 = f32[] multiply(f32[] %minimum.52, f32[] %constant_1219), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.26 = f32[] cosine(f32[] %multiply.934), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.311 = f32[] add(f32[] %cosine.26, f32[] %constant_1226), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1218 = f32[] constant(0.05)
  %multiply.933 = f32[] multiply(f32[] %add.311, f32[] %constant_1218), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.27 = f32[] select(pred[] %compare.27, f32[] %add.313, f32[] %multiply.933), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1217 = f32[] constant(-1)
  %multiply.932 = f32[] multiply(f32[] %select.27, f32[] %constant_1217), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.239 = f32[1,1,7168,1792]{3,2,1,0} broadcast(f32[] %multiply.932), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.807 = f32[1,1,7168,1792]{3,2,1,0} parameter(1)
  %constant_742 = f32[] constant(0.0625)
  %broadcast.694 = f32[1,1,7168,1792]{3,2,1,0} broadcast(f32[] %constant_742), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.682 = f32[1,1,7168,1792]{3,2,1,0} multiply(f32[1,1,7168,1792]{3,2,1,0} %param_1.807, f32[1,1,7168,1792]{3,2,1,0} %broadcast.694), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_6.1053 = f32[1,1,7168,1792]{3,2,1,0} parameter(6)
  %constant_228 = f32[] constant(0.9)
  %broadcast.419.clone.1 = f32[1,1,7168,1792]{3,2,1,0} broadcast(f32[] %constant_228), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.407.clone.1 = f32[1,1,7168,1792]{3,2,1,0} multiply(f32[1,1,7168,1792]{3,2,1,0} %param_6.1053, f32[1,1,7168,1792]{3,2,1,0} %broadcast.419.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.190.clone.1 = f32[1,1,7168,1792]{3,2,1,0} add(f32[1,1,7168,1792]{3,2,1,0} %multiply.682, f32[1,1,7168,1792]{3,2,1,0} %multiply.407.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.249 = f32[1,1,7168,1792]{3,2,1,0} multiply(f32[1,1,7168,1792]{3,2,1,0} %add.190.clone.1, f32[1,1,7168,1792]{3,2,1,0} %broadcast.419.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.64 = f32[1,1,7168,1792]{3,2,1,0} add(f32[1,1,7168,1792]{3,2,1,0} %multiply.682, f32[1,1,7168,1792]{3,2,1,0} %multiply.249), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.248 = f32[1,1,7168,1792]{3,2,1,0} multiply(f32[1,1,7168,1792]{3,2,1,0} %broadcast.239, f32[1,1,7168,1792]{3,2,1,0} %add.64), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.63 = f32[1,1,7168,1792]{3,2,1,0} add(f32[1,1,7168,1792]{3,2,1,0} %param_0.82, f32[1,1,7168,1792]{3,2,1,0} %multiply.248), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_3.713 = f32[1,1,7168,1792]{3,2,1,0} parameter(3)
  %param_4.875 = f32[1,1,7168,1792]{3,2,1,0} parameter(4)
  %multiply.718.clone.1 = f32[1,1,7168,1792]{3,2,1,0} multiply(f32[1,1,7168,1792]{3,2,1,0} %param_4.875, f32[1,1,7168,1792]{3,2,1,0} %broadcast.694), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_5.584 = f32[1,1,7168,1792]{3,2,1,0} parameter(5)
  %multiply.389.clone.1 = f32[1,1,7168,1792]{3,2,1,0} multiply(f32[1,1,7168,1792]{3,2,1,0} %param_5.584, f32[1,1,7168,1792]{3,2,1,0} %broadcast.419.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.181.clone.1 = f32[1,1,7168,1792]{3,2,1,0} add(f32[1,1,7168,1792]{3,2,1,0} %multiply.718.clone.1, f32[1,1,7168,1792]{3,2,1,0} %multiply.389.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.231.clone.1 = f32[1,1,7168,1792]{3,2,1,0} multiply(f32[1,1,7168,1792]{3,2,1,0} %add.181.clone.1, f32[1,1,7168,1792]{3,2,1,0} %broadcast.419.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.46.clone.1 = f32[1,1,7168,1792]{3,2,1,0} add(f32[1,1,7168,1792]{3,2,1,0} %multiply.718.clone.1, f32[1,1,7168,1792]{3,2,1,0} %multiply.231.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.230.clone.1 = f32[1,1,7168,1792]{3,2,1,0} multiply(f32[1,1,7168,1792]{3,2,1,0} %broadcast.239, f32[1,1,7168,1792]{3,2,1,0} %add.46.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.45.clone.1 = f32[1,1,7168,1792]{3,2,1,0} add(f32[1,1,7168,1792]{3,2,1,0} %param_3.713, f32[1,1,7168,1792]{3,2,1,0} %multiply.230.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.87 = (f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}) tuple(f32[1,1,7168,1792]{3,2,1,0} %add.63, f32[1,1,7168,1792]{3,2,1,0} %add.45.clone.1, f32[1,1,7168,1792]{3,2,1,0} %add.181.clone.1, f32[1,1,7168,1792]{3,2,1,0} %add.190.clone.1)
}

%fused_computation.91 (param_0.92: f32[1,1,3584,7168], param_1.808: f32[1,1,3584,7168], param_2.708: s32[], param_3.714: f32[1,1,3584,7168], param_4.876: f32[1,1,3584,7168], param_5.585: f32[1,1,3584,7168], param_6.1054: f32[1,1,3584,7168], param_7.797: f32[1,1,3584,7168], param_8.216: f32[1,1,3584,7168], param_9.118: f32[1,1,3584,7168], param_10.218: f32[1,1,3584,7168], param_11.219: f32[1,1,3584,7168], param_12.111: f32[1,1,3584,7168]) -> (f32[1,1,3584,7168], f32[1,1,3584,7168], f32[1,1,3584,7168], f32[1,1,3584,7168], f32[1,1,3584,7168], /*index=5*/f32[1,1,3584,7168], f32[1,1,3584,7168], f32[1,1,3584,7168]) {
  %param_0.92 = f32[1,1,3584,7168]{3,2,1,0} parameter(0)
  %param_2.708 = s32[] parameter(2)
  %convert.45 = f32[] convert(s32[] %param_2.708), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1181 = f32[] constant(50000)
  %compare.23 = pred[] compare(f32[] %convert.45, f32[] %constant_1181), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1180 = f32[] constant(1)
  %constant_1179 = s32[] constant(0)
  %maximum.22 = s32[] maximum(s32[] %param_2.708, s32[] %constant_1179), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.44 = f32[] convert(s32[] %maximum.22), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.45 = f32[] minimum(f32[] %convert.44, f32[] %constant_1181), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1178 = f32[] constant(2e-05)
  %multiply.916 = f32[] multiply(f32[] %minimum.45, f32[] %constant_1178), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.22 = f32[] subtract(f32[] %constant_1180, f32[] %multiply.916), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1177 = f32[] constant(-0.1)
  %multiply.915 = f32[] multiply(f32[] %subtract.22, f32[] %constant_1177), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1176 = f32[] constant(0.1)
  %add.301 = f32[] add(f32[] %multiply.915, f32[] %constant_1176), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1175 = f32[] constant(-50000)
  %add.300 = f32[] add(f32[] %convert.45, f32[] %constant_1175), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1174 = f32[] constant(950000)
  %minimum.44 = f32[] minimum(f32[] %add.300, f32[] %constant_1174), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1173 = f32[] constant(3.30693956e-06)
  %multiply.914 = f32[] multiply(f32[] %minimum.44, f32[] %constant_1173), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.22 = f32[] cosine(f32[] %multiply.914), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.299 = f32[] add(f32[] %cosine.22, f32[] %constant_1180), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1172 = f32[] constant(0.05)
  %multiply.913 = f32[] multiply(f32[] %add.299, f32[] %constant_1172), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.23 = f32[] select(pred[] %compare.23, f32[] %add.301, f32[] %multiply.913), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1171 = f32[] constant(-1)
  %multiply.912 = f32[] multiply(f32[] %select.23, f32[] %constant_1171), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.259 = f32[1,1,3584,7168]{3,2,1,0} broadcast(f32[] %multiply.912), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.808 = f32[1,1,3584,7168]{3,2,1,0} parameter(1)
  %constant_682 = f32[] constant(0.0625)
  %broadcast.654 = f32[1,1,3584,7168]{3,2,1,0} broadcast(f32[] %constant_682), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.642 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %param_1.808, f32[1,1,3584,7168]{3,2,1,0} %broadcast.654), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12.111 = f32[1,1,3584,7168]{3,2,1,0} parameter(12)
  %constant_238 = f32[] constant(0.9)
  %broadcast.439.clone.1 = f32[1,1,3584,7168]{3,2,1,0} broadcast(f32[] %constant_238), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.427.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %param_12.111, f32[1,1,3584,7168]{3,2,1,0} %broadcast.439.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.200.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %multiply.642, f32[1,1,3584,7168]{3,2,1,0} %multiply.427.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.269 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %add.200.clone.1, f32[1,1,3584,7168]{3,2,1,0} %broadcast.439.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.84 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %multiply.642, f32[1,1,3584,7168]{3,2,1,0} %multiply.269), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.268 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %broadcast.259, f32[1,1,3584,7168]{3,2,1,0} %add.84), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.83 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %param_0.92, f32[1,1,3584,7168]{3,2,1,0} %multiply.268), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_3.714 = f32[1,1,3584,7168]{3,2,1,0} parameter(3)
  %param_4.876 = f32[1,1,3584,7168]{3,2,1,0} parameter(4)
  %multiply.726.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %param_4.876, f32[1,1,3584,7168]{3,2,1,0} %broadcast.654), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_9.118 = f32[1,1,3584,7168]{3,2,1,0} parameter(9)
  %multiply.385.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %param_9.118, f32[1,1,3584,7168]{3,2,1,0} %broadcast.439.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.179.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %multiply.726.clone.1, f32[1,1,3584,7168]{3,2,1,0} %multiply.385.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.227.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %add.179.clone.1, f32[1,1,3584,7168]{3,2,1,0} %broadcast.439.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.42.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %multiply.726.clone.1, f32[1,1,3584,7168]{3,2,1,0} %multiply.227.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.226.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %broadcast.259, f32[1,1,3584,7168]{3,2,1,0} %add.42.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.41.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %param_3.714, f32[1,1,3584,7168]{3,2,1,0} %multiply.226.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_5.585 = f32[1,1,3584,7168]{3,2,1,0} parameter(5)
  %param_6.1054 = f32[1,1,3584,7168]{3,2,1,0} parameter(6)
  %multiply.690.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %param_6.1054, f32[1,1,3584,7168]{3,2,1,0} %broadcast.654), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_10.218 = f32[1,1,3584,7168]{3,2,1,0} parameter(10)
  %multiply.403.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %param_10.218, f32[1,1,3584,7168]{3,2,1,0} %broadcast.439.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.188.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %multiply.690.clone.1, f32[1,1,3584,7168]{3,2,1,0} %multiply.403.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.245.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %add.188.clone.1, f32[1,1,3584,7168]{3,2,1,0} %broadcast.439.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.60.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %multiply.690.clone.1, f32[1,1,3584,7168]{3,2,1,0} %multiply.245.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.244.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %broadcast.259, f32[1,1,3584,7168]{3,2,1,0} %add.60.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.59.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %param_5.585, f32[1,1,3584,7168]{3,2,1,0} %multiply.244.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_7.797 = f32[1,1,3584,7168]{3,2,1,0} parameter(7)
  %param_8.216 = f32[1,1,3584,7168]{3,2,1,0} parameter(8)
  %multiply.646.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %param_8.216, f32[1,1,3584,7168]{3,2,1,0} %broadcast.654), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_11.219 = f32[1,1,3584,7168]{3,2,1,0} parameter(11)
  %multiply.425.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %param_11.219, f32[1,1,3584,7168]{3,2,1,0} %broadcast.439.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.199.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %multiply.646.clone.1, f32[1,1,3584,7168]{3,2,1,0} %multiply.425.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.267.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %add.199.clone.1, f32[1,1,3584,7168]{3,2,1,0} %broadcast.439.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.82.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %multiply.646.clone.1, f32[1,1,3584,7168]{3,2,1,0} %multiply.267.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.266.clone.1 = f32[1,1,3584,7168]{3,2,1,0} multiply(f32[1,1,3584,7168]{3,2,1,0} %broadcast.259, f32[1,1,3584,7168]{3,2,1,0} %add.82.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.81.clone.1 = f32[1,1,3584,7168]{3,2,1,0} add(f32[1,1,3584,7168]{3,2,1,0} %param_7.797, f32[1,1,3584,7168]{3,2,1,0} %multiply.266.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.93 = (f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) tuple(f32[1,1,3584,7168]{3,2,1,0} %add.83, f32[1,1,3584,7168]{3,2,1,0} %add.41.clone.1, f32[1,1,3584,7168]{3,2,1,0} %add.59.clone.1, f32[1,1,3584,7168]{3,2,1,0} %add.81.clone.1, f32[1,1,3584,7168]{3,2,1,0} %add.179.clone.1, /*index=5*/f32[1,1,3584,7168]{3,2,1,0} %add.188.clone.1, f32[1,1,3584,7168]{3,2,1,0} %add.199.clone.1, f32[1,1,3584,7168]{3,2,1,0} %add.200.clone.1)
}

%fused_computation.92 (param_0.93: f32[3,3,1792,3584], param_1.809: f32[3,3,1792,3584], param_2.709: s32[], param_3.715: f32[3,3,1792,3584], param_4.877: f32[3,3,1792,3584], param_5.586: f32[3,3,1792,3584], param_6.1055: f32[3,3,1792,3584], param_7.798: f32[3,3,1792,3584], param_8.217: f32[3,3,1792,3584], param_9.120: f32[3,3,1792,3584]) -> (f32[3,3,1792,3584], f32[3,3,1792,3584], f32[3,3,1792,3584], f32[3,3,1792,3584], f32[3,3,1792,3584], /*index=5*/f32[3,3,1792,3584]) {
  %param_0.93 = f32[3,3,1792,3584]{3,2,1,0} parameter(0)
  %param_2.709 = s32[] parameter(2)
  %convert.41 = f32[] convert(s32[] %param_2.709), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1158 = f32[] constant(50000)
  %compare.21 = pred[] compare(f32[] %convert.41, f32[] %constant_1158), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1157 = f32[] constant(1)
  %constant_1156 = s32[] constant(0)
  %maximum.20 = s32[] maximum(s32[] %param_2.709, s32[] %constant_1156), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.40 = f32[] convert(s32[] %maximum.20), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.41 = f32[] minimum(f32[] %convert.40, f32[] %constant_1158), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1155 = f32[] constant(2e-05)
  %multiply.906 = f32[] multiply(f32[] %minimum.41, f32[] %constant_1155), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.20 = f32[] subtract(f32[] %constant_1157, f32[] %multiply.906), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1154 = f32[] constant(-0.1)
  %multiply.905 = f32[] multiply(f32[] %subtract.20, f32[] %constant_1154), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1153 = f32[] constant(0.1)
  %add.295 = f32[] add(f32[] %multiply.905, f32[] %constant_1153), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1152 = f32[] constant(-50000)
  %add.294 = f32[] add(f32[] %convert.41, f32[] %constant_1152), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1151 = f32[] constant(950000)
  %minimum.40 = f32[] minimum(f32[] %add.294, f32[] %constant_1151), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1150 = f32[] constant(3.30693956e-06)
  %multiply.904 = f32[] multiply(f32[] %minimum.40, f32[] %constant_1150), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.20 = f32[] cosine(f32[] %multiply.904), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.293 = f32[] add(f32[] %cosine.20, f32[] %constant_1157), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1149 = f32[] constant(0.05)
  %multiply.903 = f32[] multiply(f32[] %add.293, f32[] %constant_1149), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.21 = f32[] select(pred[] %compare.21, f32[] %add.295, f32[] %multiply.903), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1148 = f32[] constant(-1)
  %multiply.902 = f32[] multiply(f32[] %select.21, f32[] %constant_1148), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.261 = f32[3,3,1792,3584]{3,2,1,0} broadcast(f32[] %multiply.902), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.809 = f32[3,3,1792,3584]{3,2,1,0} parameter(1)
  %constant_676 = f32[] constant(0.0625)
  %broadcast.650 = f32[3,3,1792,3584]{3,2,1,0} broadcast(f32[] %constant_676), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.638 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %param_1.809, f32[3,3,1792,3584]{3,2,1,0} %broadcast.650), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_9.120 = f32[3,3,1792,3584]{3,2,1,0} parameter(9)
  %constant_239 = f32[] constant(0.9)
  %broadcast.441.clone.1 = f32[3,3,1792,3584]{3,2,1,0} broadcast(f32[] %constant_239), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.429.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %param_9.120, f32[3,3,1792,3584]{3,2,1,0} %broadcast.441.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.201.clone.1 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %multiply.638, f32[3,3,1792,3584]{3,2,1,0} %multiply.429.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.271 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %add.201.clone.1, f32[3,3,1792,3584]{3,2,1,0} %broadcast.441.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.86 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %multiply.638, f32[3,3,1792,3584]{3,2,1,0} %multiply.271), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.270 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %broadcast.261, f32[3,3,1792,3584]{3,2,1,0} %add.86), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.85 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %param_0.93, f32[3,3,1792,3584]{3,2,1,0} %multiply.270), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_3.715 = f32[3,3,1792,3584]{3,2,1,0} parameter(3)
  %param_4.877 = f32[3,3,1792,3584]{3,2,1,0} parameter(4)
  %multiply.722.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %param_4.877, f32[3,3,1792,3584]{3,2,1,0} %broadcast.650), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_7.798 = f32[3,3,1792,3584]{3,2,1,0} parameter(7)
  %multiply.387.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %param_7.798, f32[3,3,1792,3584]{3,2,1,0} %broadcast.441.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.180.clone.1 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %multiply.722.clone.1, f32[3,3,1792,3584]{3,2,1,0} %multiply.387.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.229.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %add.180.clone.1, f32[3,3,1792,3584]{3,2,1,0} %broadcast.441.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.44.clone.1 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %multiply.722.clone.1, f32[3,3,1792,3584]{3,2,1,0} %multiply.229.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.228.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %broadcast.261, f32[3,3,1792,3584]{3,2,1,0} %add.44.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.43.clone.1 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %param_3.715, f32[3,3,1792,3584]{3,2,1,0} %multiply.228.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_5.586 = f32[3,3,1792,3584]{3,2,1,0} parameter(5)
  %param_6.1055 = f32[3,3,1792,3584]{3,2,1,0} parameter(6)
  %multiply.686.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %param_6.1055, f32[3,3,1792,3584]{3,2,1,0} %broadcast.650), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_8.217 = f32[3,3,1792,3584]{3,2,1,0} parameter(8)
  %multiply.405.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %param_8.217, f32[3,3,1792,3584]{3,2,1,0} %broadcast.441.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.189.clone.1 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %multiply.686.clone.1, f32[3,3,1792,3584]{3,2,1,0} %multiply.405.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.247.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %add.189.clone.1, f32[3,3,1792,3584]{3,2,1,0} %broadcast.441.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.62.clone.1 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %multiply.686.clone.1, f32[3,3,1792,3584]{3,2,1,0} %multiply.247.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.246.clone.1 = f32[3,3,1792,3584]{3,2,1,0} multiply(f32[3,3,1792,3584]{3,2,1,0} %broadcast.261, f32[3,3,1792,3584]{3,2,1,0} %add.62.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.61.clone.1 = f32[3,3,1792,3584]{3,2,1,0} add(f32[3,3,1792,3584]{3,2,1,0} %param_5.586, f32[3,3,1792,3584]{3,2,1,0} %multiply.246.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.94 = (f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=5*/f32[3,3,1792,3584]{3,2,1,0}) tuple(f32[3,3,1792,3584]{3,2,1,0} %add.85, f32[3,3,1792,3584]{3,2,1,0} %add.43.clone.1, f32[3,3,1792,3584]{3,2,1,0} %add.61.clone.1, f32[3,3,1792,3584]{3,2,1,0} %add.180.clone.1, f32[3,3,1792,3584]{3,2,1,0} %add.189.clone.1, /*index=5*/f32[3,3,1792,3584]{3,2,1,0} %add.201.clone.1)
}

%fused_computation.93 (param_0.94: f32[1,1,3584,1792], param_1.810: f32[1,1,3584,1792], param_2.710: s32[], param_3.717: f32[1,1,3584,1792]) -> (f32[1,1,3584,1792], f32[1,1,3584,1792]) {
  %param_0.94 = f32[1,1,3584,1792]{3,2,1,0} parameter(0)
  %param_2.710 = s32[] parameter(2)
  %convert.25 = f32[] convert(s32[] %param_2.710), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1066 = f32[] constant(50000)
  %compare.13 = pred[] compare(f32[] %convert.25, f32[] %constant_1066), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1065 = f32[] constant(1)
  %constant_1064 = s32[] constant(0)
  %maximum.12 = s32[] maximum(s32[] %param_2.710, s32[] %constant_1064), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.24 = f32[] convert(s32[] %maximum.12), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.25 = f32[] minimum(f32[] %convert.24, f32[] %constant_1066), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1063 = f32[] constant(2e-05)
  %multiply.866 = f32[] multiply(f32[] %minimum.25, f32[] %constant_1063), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.12 = f32[] subtract(f32[] %constant_1065, f32[] %multiply.866), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1062 = f32[] constant(-0.1)
  %multiply.865 = f32[] multiply(f32[] %subtract.12, f32[] %constant_1062), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1061 = f32[] constant(0.1)
  %add.271 = f32[] add(f32[] %multiply.865, f32[] %constant_1061), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1060 = f32[] constant(-50000)
  %add.270 = f32[] add(f32[] %convert.25, f32[] %constant_1060), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1059 = f32[] constant(950000)
  %minimum.24 = f32[] minimum(f32[] %add.270, f32[] %constant_1059), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1058 = f32[] constant(3.30693956e-06)
  %multiply.864 = f32[] multiply(f32[] %minimum.24, f32[] %constant_1058), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.12 = f32[] cosine(f32[] %multiply.864), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.269 = f32[] add(f32[] %cosine.12, f32[] %constant_1065), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1057 = f32[] constant(0.05)
  %multiply.863 = f32[] multiply(f32[] %add.269, f32[] %constant_1057), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.13 = f32[] select(pred[] %compare.13, f32[] %add.271, f32[] %multiply.863), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1056 = f32[] constant(-1)
  %multiply.862 = f32[] multiply(f32[] %select.13, f32[] %constant_1056), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.263 = f32[1,1,3584,1792]{3,2,1,0} broadcast(f32[] %multiply.862), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.810 = f32[1,1,3584,1792]{3,2,1,0} parameter(1)
  %constant_670 = f32[] constant(0.0625)
  %broadcast.646 = f32[1,1,3584,1792]{3,2,1,0} broadcast(f32[] %constant_670), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.634 = f32[1,1,3584,1792]{3,2,1,0} multiply(f32[1,1,3584,1792]{3,2,1,0} %param_1.810, f32[1,1,3584,1792]{3,2,1,0} %broadcast.646), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3.717 = f32[1,1,3584,1792]{3,2,1,0} parameter(3)
  %constant_240 = f32[] constant(0.9)
  %broadcast.443.clone.1 = f32[1,1,3584,1792]{3,2,1,0} broadcast(f32[] %constant_240), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.431.clone.1 = f32[1,1,3584,1792]{3,2,1,0} multiply(f32[1,1,3584,1792]{3,2,1,0} %param_3.717, f32[1,1,3584,1792]{3,2,1,0} %broadcast.443.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.202.clone.1 = f32[1,1,3584,1792]{3,2,1,0} add(f32[1,1,3584,1792]{3,2,1,0} %multiply.634, f32[1,1,3584,1792]{3,2,1,0} %multiply.431.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.273 = f32[1,1,3584,1792]{3,2,1,0} multiply(f32[1,1,3584,1792]{3,2,1,0} %add.202.clone.1, f32[1,1,3584,1792]{3,2,1,0} %broadcast.443.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.88 = f32[1,1,3584,1792]{3,2,1,0} add(f32[1,1,3584,1792]{3,2,1,0} %multiply.634, f32[1,1,3584,1792]{3,2,1,0} %multiply.273), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.272 = f32[1,1,3584,1792]{3,2,1,0} multiply(f32[1,1,3584,1792]{3,2,1,0} %broadcast.263, f32[1,1,3584,1792]{3,2,1,0} %add.88), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.87 = f32[1,1,3584,1792]{3,2,1,0} add(f32[1,1,3584,1792]{3,2,1,0} %param_0.94, f32[1,1,3584,1792]{3,2,1,0} %multiply.272), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.95 = (f32[1,1,3584,1792]{3,2,1,0}, f32[1,1,3584,1792]{3,2,1,0}) tuple(f32[1,1,3584,1792]{3,2,1,0} %add.87, f32[1,1,3584,1792]{3,2,1,0} %add.202.clone.1)
}

%fused_computation.95 (param_0.96: f32[7168], param_1.811: f32[7168], param_2.711: s32[], param_3.718: f32[7168], param_4.882: f32[7168], param_5.589: f32[7168], param_6.1056: f32[7168], param_7.799: f32[7168], param_8.218: f32[7168], param_9.121: f32[7168], param_10.223: f32[7168], param_11.222: f32[7168], param_12.112: f32[7168], param_13.206: f32[7168], param_14.202: f32[7168], param_15.103: f32[7168], param_16.188: f32[7168], param_17.175: f32[7168], param_18.74: f32[7168], param_19.132: f32[7168], param_20.127: f32[7168], param_21.56: f32[7168], param_22.96: f32[7168], param_23.100: f32[7168], param_24.64: f32[7168]) -> (f32[7168], f32[7168], f32[7168], f32[7168], f32[7168], /*index=5*/f32[7168], f32[7168], f32[7168], f32[7168], f32[7168], /*index=10*/f32[7168], f32[7168], f32[7168], f32[7168], f32[7168], /*index=15*/f32[7168]) {
  %param_0.96 = f32[7168]{0} parameter(0)
  %param_2.711 = s32[] parameter(2)
  %convert.49 = f32[] convert(s32[] %param_2.711), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1204 = f32[] constant(50000)
  %compare.25 = pred[] compare(f32[] %convert.49, f32[] %constant_1204), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1203 = f32[] constant(1)
  %constant_1202 = s32[] constant(0)
  %maximum.24 = s32[] maximum(s32[] %param_2.711, s32[] %constant_1202), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.48 = f32[] convert(s32[] %maximum.24), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.49 = f32[] minimum(f32[] %convert.48, f32[] %constant_1204), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1201 = f32[] constant(2e-05)
  %multiply.926 = f32[] multiply(f32[] %minimum.49, f32[] %constant_1201), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.24 = f32[] subtract(f32[] %constant_1203, f32[] %multiply.926), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1200 = f32[] constant(-0.1)
  %multiply.925 = f32[] multiply(f32[] %subtract.24, f32[] %constant_1200), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1199 = f32[] constant(0.1)
  %add.307 = f32[] add(f32[] %multiply.925, f32[] %constant_1199), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1198 = f32[] constant(-50000)
  %add.306 = f32[] add(f32[] %convert.49, f32[] %constant_1198), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1197 = f32[] constant(950000)
  %minimum.48 = f32[] minimum(f32[] %add.306, f32[] %constant_1197), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1196 = f32[] constant(3.30693956e-06)
  %multiply.924 = f32[] multiply(f32[] %minimum.48, f32[] %constant_1196), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.24 = f32[] cosine(f32[] %multiply.924), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.305 = f32[] add(f32[] %cosine.24, f32[] %constant_1203), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1195 = f32[] constant(0.05)
  %multiply.923 = f32[] multiply(f32[] %add.305, f32[] %constant_1195), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.25 = f32[] select(pred[] %compare.25, f32[] %add.307, f32[] %multiply.923), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1194 = f32[] constant(-1)
  %multiply.922 = f32[] multiply(f32[] %select.25, f32[] %constant_1194), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.267 = f32[7168]{0} broadcast(f32[] %multiply.922), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.811 = f32[7168]{0} parameter(1)
  %constant_658 = f32[] constant(0.0625)
  %broadcast.638 = f32[7168]{0} broadcast(f32[] %constant_658), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.626 = f32[7168]{0} multiply(f32[7168]{0} %param_1.811, f32[7168]{0} %broadcast.638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_24.64 = f32[7168]{0} parameter(24)
  %constant_242 = f32[] constant(0.9)
  %broadcast.447.clone.1 = f32[7168]{0} broadcast(f32[] %constant_242), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.435.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_24.64, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.204.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.626, f32[7168]{0} %multiply.435.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.277 = f32[7168]{0} multiply(f32[7168]{0} %add.204.clone.1, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.92 = f32[7168]{0} add(f32[7168]{0} %multiply.626, f32[7168]{0} %multiply.277), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.276 = f32[7168]{0} multiply(f32[7168]{0} %broadcast.267, f32[7168]{0} %add.92), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.91 = f32[7168]{0} add(f32[7168]{0} %param_0.96, f32[7168]{0} %multiply.276), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_3.718 = f32[7168]{0} parameter(3)
  %param_4.882 = f32[7168]{0} parameter(4)
  %multiply.714.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_4.882, f32[7168]{0} %broadcast.638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_17.175 = f32[7168]{0} parameter(17)
  %multiply.391.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_17.175, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.182.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.714.clone.1, f32[7168]{0} %multiply.391.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.233.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %add.182.clone.1, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.48.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.714.clone.1, f32[7168]{0} %multiply.233.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.232.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %broadcast.267, f32[7168]{0} %add.48.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.47.clone.1 = f32[7168]{0} add(f32[7168]{0} %param_3.718, f32[7168]{0} %multiply.232.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_5.589 = f32[7168]{0} parameter(5)
  %param_6.1056 = f32[7168]{0} parameter(6)
  %multiply.710.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_6.1056, f32[7168]{0} %broadcast.638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_18.74 = f32[7168]{0} parameter(18)
  %multiply.393.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_18.74, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.183.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.710.clone.1, f32[7168]{0} %multiply.393.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.235.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %add.183.clone.1, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.50.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.710.clone.1, f32[7168]{0} %multiply.235.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.234.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %broadcast.267, f32[7168]{0} %add.50.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.49.clone.1 = f32[7168]{0} add(f32[7168]{0} %param_5.589, f32[7168]{0} %multiply.234.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_7.799 = f32[7168]{0} parameter(7)
  %param_8.218 = f32[7168]{0} parameter(8)
  %multiply.678.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_8.218, f32[7168]{0} %broadcast.638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_19.132 = f32[7168]{0} parameter(19)
  %multiply.409.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_19.132, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.191.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.678.clone.1, f32[7168]{0} %multiply.409.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.251.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %add.191.clone.1, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.66.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.678.clone.1, f32[7168]{0} %multiply.251.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.250.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %broadcast.267, f32[7168]{0} %add.66.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.65.clone.1 = f32[7168]{0} add(f32[7168]{0} %param_7.799, f32[7168]{0} %multiply.250.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_9.121 = f32[7168]{0} parameter(9)
  %param_10.223 = f32[7168]{0} parameter(10)
  %multiply.674.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_10.223, f32[7168]{0} %broadcast.638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_20.127 = f32[7168]{0} parameter(20)
  %multiply.411.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_20.127, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.192.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.674.clone.1, f32[7168]{0} %multiply.411.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.253.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %add.192.clone.1, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.68.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.674.clone.1, f32[7168]{0} %multiply.253.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.252.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %broadcast.267, f32[7168]{0} %add.68.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.67.clone.1 = f32[7168]{0} add(f32[7168]{0} %param_9.121, f32[7168]{0} %multiply.252.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_11.222 = f32[7168]{0} parameter(11)
  %param_12.112 = f32[7168]{0} parameter(12)
  %multiply.654.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_12.112, f32[7168]{0} %broadcast.638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_21.56 = f32[7168]{0} parameter(21)
  %multiply.421.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_21.56, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.197.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.654.clone.1, f32[7168]{0} %multiply.421.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.263.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %add.197.clone.1, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.78.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.654.clone.1, f32[7168]{0} %multiply.263.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.262.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %broadcast.267, f32[7168]{0} %add.78.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.77.clone.1 = f32[7168]{0} add(f32[7168]{0} %param_11.222, f32[7168]{0} %multiply.262.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_13.206 = f32[7168]{0} parameter(13)
  %param_14.202 = f32[7168]{0} parameter(14)
  %multiply.650.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_14.202, f32[7168]{0} %broadcast.638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_22.96 = f32[7168]{0} parameter(22)
  %multiply.423.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_22.96, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.198.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.650.clone.1, f32[7168]{0} %multiply.423.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.265.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %add.198.clone.1, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.80.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.650.clone.1, f32[7168]{0} %multiply.265.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.264.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %broadcast.267, f32[7168]{0} %add.80.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.79.clone.1 = f32[7168]{0} add(f32[7168]{0} %param_13.206, f32[7168]{0} %multiply.264.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_15.103 = f32[7168]{0} parameter(15)
  %param_16.188 = f32[7168]{0} parameter(16)
  %multiply.630.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_16.188, f32[7168]{0} %broadcast.638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_23.100 = f32[7168]{0} parameter(23)
  %multiply.433.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %param_23.100, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.203.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.630.clone.1, f32[7168]{0} %multiply.433.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.275.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %add.203.clone.1, f32[7168]{0} %broadcast.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.90.clone.1 = f32[7168]{0} add(f32[7168]{0} %multiply.630.clone.1, f32[7168]{0} %multiply.275.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.274.clone.1 = f32[7168]{0} multiply(f32[7168]{0} %broadcast.267, f32[7168]{0} %add.90.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.89.clone.1 = f32[7168]{0} add(f32[7168]{0} %param_15.103, f32[7168]{0} %multiply.274.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.97 = (f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) tuple(f32[7168]{0} %add.91, f32[7168]{0} %add.47.clone.1, f32[7168]{0} %add.49.clone.1, f32[7168]{0} %add.65.clone.1, f32[7168]{0} %add.67.clone.1, /*index=5*/f32[7168]{0} %add.77.clone.1, f32[7168]{0} %add.79.clone.1, f32[7168]{0} %add.89.clone.1, f32[7168]{0} %add.182.clone.1, f32[7168]{0} %add.183.clone.1, /*index=10*/f32[7168]{0} %add.191.clone.1, f32[7168]{0} %add.192.clone.1, f32[7168]{0} %add.197.clone.1, f32[7168]{0} %add.198.clone.1, f32[7168]{0} %add.203.clone.1, /*index=15*/f32[7168]{0} %add.204.clone.1)
}

%fused_computation.118 (param_0.119: f32[1,1,1792,3584], param_1.812: f32[1,1,1792,3584], param_2.712: s32[], param_3.719: f32[1,1,1792,3584], param_4.883: f32[1,1,1792,3584], param_5.590: f32[1,1,1792,3584], param_6.1057: f32[1,1,1792,3584], param_7.800: f32[1,1,1792,3584], param_8.219: f32[1,1,1792,3584], param_9.125: f32[1,1,1792,3584], param_10.227: f32[1,1,1792,3584], param_11.229: f32[1,1,1792,3584], param_12.119: f32[1,1,1792,3584], param_13.213: f32[1,1,1792,3584], param_14.209: f32[1,1,1792,3584], param_15.117: f32[1,1,1792,3584]) -> (f32[1,1,1792,3584], f32[1,1,1792,3584], f32[1,1,1792,3584], f32[1,1,1792,3584], f32[1,1,1792,3584], /*index=5*/f32[1,1,1792,3584], f32[1,1,1792,3584], f32[1,1,1792,3584], f32[1,1,1792,3584], f32[1,1,1792,3584]) {
  %param_0.119 = f32[1,1,1792,3584]{3,2,1,0} parameter(0)
  %param_2.712 = s32[] parameter(2)
  %convert.37 = f32[] convert(s32[] %param_2.712), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1135 = f32[] constant(50000)
  %compare.19 = pred[] compare(f32[] %convert.37, f32[] %constant_1135), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1134 = f32[] constant(1)
  %constant_1133 = s32[] constant(0)
  %maximum.18 = s32[] maximum(s32[] %param_2.712, s32[] %constant_1133), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.36 = f32[] convert(s32[] %maximum.18), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.37 = f32[] minimum(f32[] %convert.36, f32[] %constant_1135), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1132 = f32[] constant(2e-05)
  %multiply.896 = f32[] multiply(f32[] %minimum.37, f32[] %constant_1132), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.18 = f32[] subtract(f32[] %constant_1134, f32[] %multiply.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1131 = f32[] constant(-0.1)
  %multiply.895 = f32[] multiply(f32[] %subtract.18, f32[] %constant_1131), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1130 = f32[] constant(0.1)
  %add.289 = f32[] add(f32[] %multiply.895, f32[] %constant_1130), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1129 = f32[] constant(-50000)
  %add.288 = f32[] add(f32[] %convert.37, f32[] %constant_1129), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1128 = f32[] constant(950000)
  %minimum.36 = f32[] minimum(f32[] %add.288, f32[] %constant_1128), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1127 = f32[] constant(3.30693956e-06)
  %multiply.894 = f32[] multiply(f32[] %minimum.36, f32[] %constant_1127), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.18 = f32[] cosine(f32[] %multiply.894), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.287 = f32[] add(f32[] %cosine.18, f32[] %constant_1134), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1126 = f32[] constant(0.05)
  %multiply.893 = f32[] multiply(f32[] %add.287, f32[] %constant_1126), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.19 = f32[] select(pred[] %compare.19, f32[] %add.289, f32[] %multiply.893), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1125 = f32[] constant(-1)
  %multiply.892 = f32[] multiply(f32[] %select.19, f32[] %constant_1125), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.313 = f32[1,1,1792,3584]{3,2,1,0} broadcast(f32[] %multiply.892), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.812 = f32[1,1,1792,3584]{3,2,1,0} parameter(1)
  %constant_520 = f32[] constant(0.0625)
  %broadcast.546 = f32[1,1,1792,3584]{3,2,1,0} broadcast(f32[] %constant_520), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.534 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_1.812, f32[1,1,1792,3584]{3,2,1,0} %broadcast.546), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_15.117 = f32[1,1,1792,3584]{3,2,1,0} parameter(15)
  %constant_265 = f32[] constant(0.9)
  %broadcast.493.clone.1 = f32[1,1,1792,3584]{3,2,1,0} broadcast(f32[] %constant_265), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.481.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_15.117, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.227.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.534, f32[1,1,1792,3584]{3,2,1,0} %multiply.481.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.323 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %add.227.clone.1, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.138 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.534, f32[1,1,1792,3584]{3,2,1,0} %multiply.323), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.322 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %broadcast.313, f32[1,1,1792,3584]{3,2,1,0} %add.138), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.137 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %param_0.119, f32[1,1,1792,3584]{3,2,1,0} %multiply.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_3.719 = f32[1,1,1792,3584]{3,2,1,0} parameter(3)
  %param_4.883 = f32[1,1,1792,3584]{3,2,1,0} parameter(4)
  %multiply.798.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_4.883, f32[1,1,1792,3584]{3,2,1,0} %broadcast.546), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_11.229 = f32[1,1,1792,3584]{3,2,1,0} parameter(11)
  %multiply.349.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_11.229, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.161.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.798.clone.1, f32[1,1,1792,3584]{3,2,1,0} %multiply.349.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.191.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %add.161.clone.1, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.6.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.798.clone.1, f32[1,1,1792,3584]{3,2,1,0} %multiply.191.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.190.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %broadcast.313, f32[1,1,1792,3584]{3,2,1,0} %add.6.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.5.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %param_3.719, f32[1,1,1792,3584]{3,2,1,0} %multiply.190.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_5.590 = f32[1,1,1792,3584]{3,2,1,0} parameter(5)
  %param_6.1057 = f32[1,1,1792,3584]{3,2,1,0} parameter(6)
  %multiply.762.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_6.1057, f32[1,1,1792,3584]{3,2,1,0} %broadcast.546), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12.119 = f32[1,1,1792,3584]{3,2,1,0} parameter(12)
  %multiply.367.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_12.119, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.170.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.762.clone.1, f32[1,1,1792,3584]{3,2,1,0} %multiply.367.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.209.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %add.170.clone.1, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.24.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.762.clone.1, f32[1,1,1792,3584]{3,2,1,0} %multiply.209.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.208.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %broadcast.313, f32[1,1,1792,3584]{3,2,1,0} %add.24.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.23.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %param_5.590, f32[1,1,1792,3584]{3,2,1,0} %multiply.208.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_7.800 = f32[1,1,1792,3584]{3,2,1,0} parameter(7)
  %param_8.219 = f32[1,1,1792,3584]{3,2,1,0} parameter(8)
  %multiply.606.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_8.219, f32[1,1,1792,3584]{3,2,1,0} %broadcast.546), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_13.213 = f32[1,1,1792,3584]{3,2,1,0} parameter(13)
  %multiply.445.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_13.213, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.209.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.606.clone.1, f32[1,1,1792,3584]{3,2,1,0} %multiply.445.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.287.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %add.209.clone.1, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.102.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.606.clone.1, f32[1,1,1792,3584]{3,2,1,0} %multiply.287.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.286.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %broadcast.313, f32[1,1,1792,3584]{3,2,1,0} %add.102.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.101.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %param_7.800, f32[1,1,1792,3584]{3,2,1,0} %multiply.286.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_9.125 = f32[1,1,1792,3584]{3,2,1,0} parameter(9)
  %param_10.227 = f32[1,1,1792,3584]{3,2,1,0} parameter(10)
  %multiply.570.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_10.227, f32[1,1,1792,3584]{3,2,1,0} %broadcast.546), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_14.209 = f32[1,1,1792,3584]{3,2,1,0} parameter(14)
  %multiply.463.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %param_14.209, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.218.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.570.clone.1, f32[1,1,1792,3584]{3,2,1,0} %multiply.463.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.305.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %add.218.clone.1, f32[1,1,1792,3584]{3,2,1,0} %broadcast.493.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.120.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %multiply.570.clone.1, f32[1,1,1792,3584]{3,2,1,0} %multiply.305.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.304.clone.1 = f32[1,1,1792,3584]{3,2,1,0} multiply(f32[1,1,1792,3584]{3,2,1,0} %broadcast.313, f32[1,1,1792,3584]{3,2,1,0} %add.120.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.119.clone.1 = f32[1,1,1792,3584]{3,2,1,0} add(f32[1,1,1792,3584]{3,2,1,0} %param_9.125, f32[1,1,1792,3584]{3,2,1,0} %multiply.304.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.108 = (f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) tuple(f32[1,1,1792,3584]{3,2,1,0} %add.137, f32[1,1,1792,3584]{3,2,1,0} %add.5.clone.1, f32[1,1,1792,3584]{3,2,1,0} %add.23.clone.1, f32[1,1,1792,3584]{3,2,1,0} %add.101.clone.1, f32[1,1,1792,3584]{3,2,1,0} %add.119.clone.1, /*index=5*/f32[1,1,1792,3584]{3,2,1,0} %add.161.clone.1, f32[1,1,1792,3584]{3,2,1,0} %add.170.clone.1, f32[1,1,1792,3584]{3,2,1,0} %add.209.clone.1, f32[1,1,1792,3584]{3,2,1,0} %add.218.clone.1, f32[1,1,1792,3584]{3,2,1,0} %add.227.clone.1)
}

%fused_computation.119 (param_0.120: f32[3,3,896,1792], param_1.813: f32[3,3,896,1792], param_2.713: s32[], param_3.720: f32[3,3,896,1792], param_4.884: f32[3,3,896,1792], param_5.591: f32[3,3,896,1792], param_6.1058: f32[3,3,896,1792], param_7.801: f32[3,3,896,1792], param_8.220: f32[3,3,896,1792], param_9.126: f32[3,3,896,1792], param_10.228: f32[3,3,896,1792], param_11.230: f32[3,3,896,1792], param_12.120: f32[3,3,896,1792], param_13.214: f32[3,3,896,1792], param_14.210: f32[3,3,896,1792], param_15.119: f32[3,3,896,1792]) -> (f32[3,3,896,1792], f32[3,3,896,1792], f32[3,3,896,1792], f32[3,3,896,1792], f32[3,3,896,1792], /*index=5*/f32[3,3,896,1792], f32[3,3,896,1792], f32[3,3,896,1792], f32[3,3,896,1792], f32[3,3,896,1792]) {
  %param_0.120 = f32[3,3,896,1792]{3,2,1,0} parameter(0)
  %param_2.713 = s32[] parameter(2)
  %convert.33 = f32[] convert(s32[] %param_2.713), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1112 = f32[] constant(50000)
  %compare.17 = pred[] compare(f32[] %convert.33, f32[] %constant_1112), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1111 = f32[] constant(1)
  %constant_1110 = s32[] constant(0)
  %maximum.16 = s32[] maximum(s32[] %param_2.713, s32[] %constant_1110), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.32 = f32[] convert(s32[] %maximum.16), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.33 = f32[] minimum(f32[] %convert.32, f32[] %constant_1112), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1109 = f32[] constant(2e-05)
  %multiply.886 = f32[] multiply(f32[] %minimum.33, f32[] %constant_1109), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.16 = f32[] subtract(f32[] %constant_1111, f32[] %multiply.886), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1108 = f32[] constant(-0.1)
  %multiply.885 = f32[] multiply(f32[] %subtract.16, f32[] %constant_1108), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1107 = f32[] constant(0.1)
  %add.283 = f32[] add(f32[] %multiply.885, f32[] %constant_1107), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1106 = f32[] constant(-50000)
  %add.282 = f32[] add(f32[] %convert.33, f32[] %constant_1106), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1105 = f32[] constant(950000)
  %minimum.32 = f32[] minimum(f32[] %add.282, f32[] %constant_1105), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1104 = f32[] constant(3.30693956e-06)
  %multiply.884 = f32[] multiply(f32[] %minimum.32, f32[] %constant_1104), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.16 = f32[] cosine(f32[] %multiply.884), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.281 = f32[] add(f32[] %cosine.16, f32[] %constant_1111), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1103 = f32[] constant(0.05)
  %multiply.883 = f32[] multiply(f32[] %add.281, f32[] %constant_1103), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.17 = f32[] select(pred[] %compare.17, f32[] %add.283, f32[] %multiply.883), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1102 = f32[] constant(-1)
  %multiply.882 = f32[] multiply(f32[] %select.17, f32[] %constant_1102), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.315 = f32[3,3,896,1792]{3,2,1,0} broadcast(f32[] %multiply.882), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.813 = f32[3,3,896,1792]{3,2,1,0} parameter(1)
  %constant_514 = f32[] constant(0.0625)
  %broadcast.542 = f32[3,3,896,1792]{3,2,1,0} broadcast(f32[] %constant_514), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.530 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_1.813, f32[3,3,896,1792]{3,2,1,0} %broadcast.542), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_15.119 = f32[3,3,896,1792]{3,2,1,0} parameter(15)
  %constant_266 = f32[] constant(0.9)
  %broadcast.495.clone.1 = f32[3,3,896,1792]{3,2,1,0} broadcast(f32[] %constant_266), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.483.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_15.119, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.228.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.530, f32[3,3,896,1792]{3,2,1,0} %multiply.483.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.325 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %add.228.clone.1, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.140 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.530, f32[3,3,896,1792]{3,2,1,0} %multiply.325), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.324 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %broadcast.315, f32[3,3,896,1792]{3,2,1,0} %add.140), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.139 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %param_0.120, f32[3,3,896,1792]{3,2,1,0} %multiply.324), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_3.720 = f32[3,3,896,1792]{3,2,1,0} parameter(3)
  %param_4.884 = f32[3,3,896,1792]{3,2,1,0} parameter(4)
  %multiply.794.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_4.884, f32[3,3,896,1792]{3,2,1,0} %broadcast.542), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_11.230 = f32[3,3,896,1792]{3,2,1,0} parameter(11)
  %multiply.351.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_11.230, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.162.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.794.clone.1, f32[3,3,896,1792]{3,2,1,0} %multiply.351.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.193.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %add.162.clone.1, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.8.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.794.clone.1, f32[3,3,896,1792]{3,2,1,0} %multiply.193.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.192.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %broadcast.315, f32[3,3,896,1792]{3,2,1,0} %add.8.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.7.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %param_3.720, f32[3,3,896,1792]{3,2,1,0} %multiply.192.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_5.591 = f32[3,3,896,1792]{3,2,1,0} parameter(5)
  %param_6.1058 = f32[3,3,896,1792]{3,2,1,0} parameter(6)
  %multiply.758.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_6.1058, f32[3,3,896,1792]{3,2,1,0} %broadcast.542), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12.120 = f32[3,3,896,1792]{3,2,1,0} parameter(12)
  %multiply.369.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_12.120, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.171.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.758.clone.1, f32[3,3,896,1792]{3,2,1,0} %multiply.369.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.211.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %add.171.clone.1, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.26.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.758.clone.1, f32[3,3,896,1792]{3,2,1,0} %multiply.211.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.210.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %broadcast.315, f32[3,3,896,1792]{3,2,1,0} %add.26.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.25.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %param_5.591, f32[3,3,896,1792]{3,2,1,0} %multiply.210.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_7.801 = f32[3,3,896,1792]{3,2,1,0} parameter(7)
  %param_8.220 = f32[3,3,896,1792]{3,2,1,0} parameter(8)
  %multiply.602.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_8.220, f32[3,3,896,1792]{3,2,1,0} %broadcast.542), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_13.214 = f32[3,3,896,1792]{3,2,1,0} parameter(13)
  %multiply.447.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_13.214, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.210.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.602.clone.1, f32[3,3,896,1792]{3,2,1,0} %multiply.447.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.289.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %add.210.clone.1, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.104.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.602.clone.1, f32[3,3,896,1792]{3,2,1,0} %multiply.289.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.288.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %broadcast.315, f32[3,3,896,1792]{3,2,1,0} %add.104.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.103.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %param_7.801, f32[3,3,896,1792]{3,2,1,0} %multiply.288.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_9.126 = f32[3,3,896,1792]{3,2,1,0} parameter(9)
  %param_10.228 = f32[3,3,896,1792]{3,2,1,0} parameter(10)
  %multiply.566.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_10.228, f32[3,3,896,1792]{3,2,1,0} %broadcast.542), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_14.210 = f32[3,3,896,1792]{3,2,1,0} parameter(14)
  %multiply.465.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %param_14.210, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.219.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.566.clone.1, f32[3,3,896,1792]{3,2,1,0} %multiply.465.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.307.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %add.219.clone.1, f32[3,3,896,1792]{3,2,1,0} %broadcast.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.122.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %multiply.566.clone.1, f32[3,3,896,1792]{3,2,1,0} %multiply.307.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.306.clone.1 = f32[3,3,896,1792]{3,2,1,0} multiply(f32[3,3,896,1792]{3,2,1,0} %broadcast.315, f32[3,3,896,1792]{3,2,1,0} %add.122.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.121.clone.1 = f32[3,3,896,1792]{3,2,1,0} add(f32[3,3,896,1792]{3,2,1,0} %param_9.126, f32[3,3,896,1792]{3,2,1,0} %multiply.306.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.109 = (f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) tuple(f32[3,3,896,1792]{3,2,1,0} %add.139, f32[3,3,896,1792]{3,2,1,0} %add.7.clone.1, f32[3,3,896,1792]{3,2,1,0} %add.25.clone.1, f32[3,3,896,1792]{3,2,1,0} %add.103.clone.1, f32[3,3,896,1792]{3,2,1,0} %add.121.clone.1, /*index=5*/f32[3,3,896,1792]{3,2,1,0} %add.162.clone.1, f32[3,3,896,1792]{3,2,1,0} %add.171.clone.1, f32[3,3,896,1792]{3,2,1,0} %add.210.clone.1, f32[3,3,896,1792]{3,2,1,0} %add.219.clone.1, f32[3,3,896,1792]{3,2,1,0} %add.228.clone.1)
}

%fused_computation.120 (param_0.121: f32[1,1,3584,896], param_1.814: f32[1,1,3584,896], param_2.714: s32[], param_3.721: f32[1,1,3584,896], param_4.885: f32[1,1,3584,896], param_5.592: f32[1,1,3584,896], param_6.1059: f32[1,1,3584,896], param_7.802: f32[1,1,3584,896], param_8.221: f32[1,1,3584,896], param_9.127: f32[1,1,3584,896], param_10.229: f32[1,1,3584,896], param_11.231: f32[1,1,3584,896], param_12.121: f32[1,1,3584,896], param_13.215: f32[1,1,3584,896], param_14.211: f32[1,1,3584,896], param_15.121: f32[1,1,3584,896]) -> (f32[1,1,3584,896], f32[1,1,3584,896], f32[1,1,3584,896], f32[1,1,3584,896], f32[1,1,3584,896], /*index=5*/f32[1,1,3584,896], f32[1,1,3584,896], f32[1,1,3584,896], f32[1,1,3584,896], f32[1,1,3584,896]) {
  %param_0.121 = f32[1,1,3584,896]{3,2,1,0} parameter(0)
  %param_2.714 = s32[] parameter(2)
  %convert.29 = f32[] convert(s32[] %param_2.714), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1089 = f32[] constant(50000)
  %compare.15 = pred[] compare(f32[] %convert.29, f32[] %constant_1089), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1088 = f32[] constant(1)
  %constant_1087 = s32[] constant(0)
  %maximum.14 = s32[] maximum(s32[] %param_2.714, s32[] %constant_1087), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.28 = f32[] convert(s32[] %maximum.14), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.29 = f32[] minimum(f32[] %convert.28, f32[] %constant_1089), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1086 = f32[] constant(2e-05)
  %multiply.876 = f32[] multiply(f32[] %minimum.29, f32[] %constant_1086), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.14 = f32[] subtract(f32[] %constant_1088, f32[] %multiply.876), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1085 = f32[] constant(-0.1)
  %multiply.875 = f32[] multiply(f32[] %subtract.14, f32[] %constant_1085), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1084 = f32[] constant(0.1)
  %add.277 = f32[] add(f32[] %multiply.875, f32[] %constant_1084), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1083 = f32[] constant(-50000)
  %add.276 = f32[] add(f32[] %convert.29, f32[] %constant_1083), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1082 = f32[] constant(950000)
  %minimum.28 = f32[] minimum(f32[] %add.276, f32[] %constant_1082), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1081 = f32[] constant(3.30693956e-06)
  %multiply.874 = f32[] multiply(f32[] %minimum.28, f32[] %constant_1081), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.14 = f32[] cosine(f32[] %multiply.874), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.275 = f32[] add(f32[] %cosine.14, f32[] %constant_1088), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1080 = f32[] constant(0.05)
  %multiply.873 = f32[] multiply(f32[] %add.275, f32[] %constant_1080), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.15 = f32[] select(pred[] %compare.15, f32[] %add.277, f32[] %multiply.873), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1079 = f32[] constant(-1)
  %multiply.872 = f32[] multiply(f32[] %select.15, f32[] %constant_1079), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.317 = f32[1,1,3584,896]{3,2,1,0} broadcast(f32[] %multiply.872), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.814 = f32[1,1,3584,896]{3,2,1,0} parameter(1)
  %constant_508 = f32[] constant(0.0625)
  %broadcast.538 = f32[1,1,3584,896]{3,2,1,0} broadcast(f32[] %constant_508), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.526 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_1.814, f32[1,1,3584,896]{3,2,1,0} %broadcast.538), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_15.121 = f32[1,1,3584,896]{3,2,1,0} parameter(15)
  %constant_267 = f32[] constant(0.9)
  %broadcast.497.clone.1 = f32[1,1,3584,896]{3,2,1,0} broadcast(f32[] %constant_267), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.485.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_15.121, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.229.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.526, f32[1,1,3584,896]{3,2,1,0} %multiply.485.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.327 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %add.229.clone.1, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.142 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.526, f32[1,1,3584,896]{3,2,1,0} %multiply.327), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.326 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %broadcast.317, f32[1,1,3584,896]{3,2,1,0} %add.142), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.141 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %param_0.121, f32[1,1,3584,896]{3,2,1,0} %multiply.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_3.721 = f32[1,1,3584,896]{3,2,1,0} parameter(3)
  %param_4.885 = f32[1,1,3584,896]{3,2,1,0} parameter(4)
  %multiply.790.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_4.885, f32[1,1,3584,896]{3,2,1,0} %broadcast.538), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_11.231 = f32[1,1,3584,896]{3,2,1,0} parameter(11)
  %multiply.353.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_11.231, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.163.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.790.clone.1, f32[1,1,3584,896]{3,2,1,0} %multiply.353.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.195.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %add.163.clone.1, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.10.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.790.clone.1, f32[1,1,3584,896]{3,2,1,0} %multiply.195.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.194.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %broadcast.317, f32[1,1,3584,896]{3,2,1,0} %add.10.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.9.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %param_3.721, f32[1,1,3584,896]{3,2,1,0} %multiply.194.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_5.592 = f32[1,1,3584,896]{3,2,1,0} parameter(5)
  %param_6.1059 = f32[1,1,3584,896]{3,2,1,0} parameter(6)
  %multiply.754.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_6.1059, f32[1,1,3584,896]{3,2,1,0} %broadcast.538), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12.121 = f32[1,1,3584,896]{3,2,1,0} parameter(12)
  %multiply.371.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_12.121, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.172.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.754.clone.1, f32[1,1,3584,896]{3,2,1,0} %multiply.371.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.213.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %add.172.clone.1, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.28.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.754.clone.1, f32[1,1,3584,896]{3,2,1,0} %multiply.213.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.212.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %broadcast.317, f32[1,1,3584,896]{3,2,1,0} %add.28.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.27.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %param_5.592, f32[1,1,3584,896]{3,2,1,0} %multiply.212.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_7.802 = f32[1,1,3584,896]{3,2,1,0} parameter(7)
  %param_8.221 = f32[1,1,3584,896]{3,2,1,0} parameter(8)
  %multiply.598.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_8.221, f32[1,1,3584,896]{3,2,1,0} %broadcast.538), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_13.215 = f32[1,1,3584,896]{3,2,1,0} parameter(13)
  %multiply.449.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_13.215, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.211.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.598.clone.1, f32[1,1,3584,896]{3,2,1,0} %multiply.449.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.291.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %add.211.clone.1, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.106.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.598.clone.1, f32[1,1,3584,896]{3,2,1,0} %multiply.291.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.290.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %broadcast.317, f32[1,1,3584,896]{3,2,1,0} %add.106.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.105.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %param_7.802, f32[1,1,3584,896]{3,2,1,0} %multiply.290.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_9.127 = f32[1,1,3584,896]{3,2,1,0} parameter(9)
  %param_10.229 = f32[1,1,3584,896]{3,2,1,0} parameter(10)
  %multiply.562.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_10.229, f32[1,1,3584,896]{3,2,1,0} %broadcast.538), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_14.211 = f32[1,1,3584,896]{3,2,1,0} parameter(14)
  %multiply.467.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %param_14.211, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.220.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.562.clone.1, f32[1,1,3584,896]{3,2,1,0} %multiply.467.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.309.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %add.220.clone.1, f32[1,1,3584,896]{3,2,1,0} %broadcast.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.124.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %multiply.562.clone.1, f32[1,1,3584,896]{3,2,1,0} %multiply.309.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.308.clone.1 = f32[1,1,3584,896]{3,2,1,0} multiply(f32[1,1,3584,896]{3,2,1,0} %broadcast.317, f32[1,1,3584,896]{3,2,1,0} %add.124.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.123.clone.1 = f32[1,1,3584,896]{3,2,1,0} add(f32[1,1,3584,896]{3,2,1,0} %param_9.127, f32[1,1,3584,896]{3,2,1,0} %multiply.308.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.110 = (f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) tuple(f32[1,1,3584,896]{3,2,1,0} %add.141, f32[1,1,3584,896]{3,2,1,0} %add.9.clone.1, f32[1,1,3584,896]{3,2,1,0} %add.27.clone.1, f32[1,1,3584,896]{3,2,1,0} %add.105.clone.1, f32[1,1,3584,896]{3,2,1,0} %add.123.clone.1, /*index=5*/f32[1,1,3584,896]{3,2,1,0} %add.163.clone.1, f32[1,1,3584,896]{3,2,1,0} %add.172.clone.1, f32[1,1,3584,896]{3,2,1,0} %add.211.clone.1, f32[1,1,3584,896]{3,2,1,0} %add.220.clone.1, f32[1,1,3584,896]{3,2,1,0} %add.229.clone.1)
}

%fused_computation.121 (param_0.122: f32[3584], param_1.815: f32[3584], param_2.715: s32[], param_3.723: f32[3584]) -> (f32[3584], f32[3584]) {
  %param_0.122 = f32[3584]{0} parameter(0)
  %param_2.715 = s32[] parameter(2)
  %convert.301 = f32[] convert(s32[] %param_2.715), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2653 = f32[] constant(50000)
  %compare.151 = pred[] compare(f32[] %convert.301, f32[] %constant_2653), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2652 = f32[] constant(1)
  %constant_2651 = s32[] constant(0)
  %maximum.150 = s32[] maximum(s32[] %param_2.715, s32[] %constant_2651), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.300 = f32[] convert(s32[] %maximum.150), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.301 = f32[] minimum(f32[] %convert.300, f32[] %constant_2653), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_2650 = f32[] constant(2e-05)
  %multiply.1556 = f32[] multiply(f32[] %minimum.301, f32[] %constant_2650), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.150 = f32[] subtract(f32[] %constant_2652, f32[] %multiply.1556), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_2649 = f32[] constant(-0.1)
  %multiply.1555 = f32[] multiply(f32[] %subtract.150, f32[] %constant_2649), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_2648 = f32[] constant(0.1)
  %add.685 = f32[] add(f32[] %multiply.1555, f32[] %constant_2648), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_2647 = f32[] constant(-50000)
  %add.684 = f32[] add(f32[] %convert.301, f32[] %constant_2647), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2646 = f32[] constant(950000)
  %minimum.300 = f32[] minimum(f32[] %add.684, f32[] %constant_2646), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_2645 = f32[] constant(3.30693956e-06)
  %multiply.1554 = f32[] multiply(f32[] %minimum.300, f32[] %constant_2645), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.150 = f32[] cosine(f32[] %multiply.1554), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.683 = f32[] add(f32[] %cosine.150, f32[] %constant_2652), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_2644 = f32[] constant(0.05)
  %multiply.1553 = f32[] multiply(f32[] %add.683, f32[] %constant_2644), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.151 = f32[] select(pred[] %compare.151, f32[] %add.685, f32[] %multiply.1553), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2643 = f32[] constant(-1)
  %multiply.1552 = f32[] multiply(f32[] %select.151, f32[] %constant_2643), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.319 = f32[3584]{0} broadcast(f32[] %multiply.1552), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.815 = f32[3584]{0} parameter(1)
  %constant_502 = f32[] constant(0.0625)
  %broadcast.534 = f32[3584]{0} broadcast(f32[] %constant_502), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.522 = f32[3584]{0} multiply(f32[3584]{0} %param_1.815, f32[3584]{0} %broadcast.534), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3.723 = f32[3584]{0} parameter(3)
  %constant_268 = f32[] constant(0.9)
  %broadcast.499.clone.1 = f32[3584]{0} broadcast(f32[] %constant_268), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.487.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_3.723, f32[3584]{0} %broadcast.499.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.230.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.522, f32[3584]{0} %multiply.487.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.329 = f32[3584]{0} multiply(f32[3584]{0} %add.230.clone.1, f32[3584]{0} %broadcast.499.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.144 = f32[3584]{0} add(f32[3584]{0} %multiply.522, f32[3584]{0} %multiply.329), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.328 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.319, f32[3584]{0} %add.144), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.143 = f32[3584]{0} add(f32[3584]{0} %param_0.122, f32[3584]{0} %multiply.328), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.111 = (f32[3584]{0}, f32[3584]{0}) tuple(f32[3584]{0} %add.143, f32[3584]{0} %add.230.clone.1)
}

%fused_computation.122 (param_0.123: f32[3584], param_1.660: f32[3584], param_2.632: f32[3584], param_3.420: s32[], param_4.859: f32[3584], param_5.578: f32[3584], param_6.1045: f32[3584], param_7.777: f32[3584], param_8.199: f32[3584], param_9.101: f32[3584], param_10.196: f32[3584], param_11.200: f32[3584], param_12.91: f32[3584], param_13.176: f32[3584], param_14.179: f32[3584], param_15.84: f32[3584], param_16.163: f32[3584], param_17.155: f32[3584], param_18.60: f32[3584], param_19.118: f32[3584], param_20.113: f32[3584], param_21.42: f32[3584], param_22.82: f32[3584], param_23.86: f32[3584], param_24.42: f32[3584], param_25.81: f32[3584], param_26.83: f32[3584], param_27.38: f32[3584], param_28.74: f32[3584], param_29.74: f32[3584], param_30.32: f32[3584], param_31.61: f32[3584], param_32.62: f32[3584], param_33.28: f32[3584], param_34.54: f32[3584], param_35.53: f32[3584], param_36.22: f32[3584], param_37.42: f32[3584], param_38.44: f32[3584], param_39.22: f32[3584], param_40.42: f32[3584], param_41.44: f32[3584], param_42.22: f32[3584], param_43.42: f32[3584], param_44.44: f32[3584], param_45.24: f32[3584]) -> (f32[3584], f32[3584], f32[3584], f32[3584], f32[3584], /*index=5*/f32[3584], f32[3584], f32[3584], f32[3584], f32[3584], /*index=10*/f32[3584], f32[3584], f32[3584], f32[3584], f32[3584], /*index=15*/f32[3584], f32[3584]) {
  %param_0.123 = f32[3584]{0} parameter(0)
  %param_3.420 = s32[] parameter(3)
  %convert.21 = f32[] convert(s32[] %param_3.420), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1043 = f32[] constant(50000)
  %compare.11 = pred[] compare(f32[] %convert.21, f32[] %constant_1043), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1042 = f32[] constant(1)
  %constant_1041 = s32[] constant(0)
  %maximum.10 = s32[] maximum(s32[] %param_3.420, s32[] %constant_1041), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.20 = f32[] convert(s32[] %maximum.10), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.21 = f32[] minimum(f32[] %convert.20, f32[] %constant_1043), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_1040 = f32[] constant(2e-05)
  %multiply.856 = f32[] multiply(f32[] %minimum.21, f32[] %constant_1040), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.10 = f32[] subtract(f32[] %constant_1042, f32[] %multiply.856), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_1039 = f32[] constant(-0.1)
  %multiply.855 = f32[] multiply(f32[] %subtract.10, f32[] %constant_1039), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1038 = f32[] constant(0.1)
  %add.265 = f32[] add(f32[] %multiply.855, f32[] %constant_1038), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_1037 = f32[] constant(-50000)
  %add.264 = f32[] add(f32[] %convert.21, f32[] %constant_1037), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1036 = f32[] constant(950000)
  %minimum.20 = f32[] minimum(f32[] %add.264, f32[] %constant_1036), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_1035 = f32[] constant(3.30693956e-06)
  %multiply.854 = f32[] multiply(f32[] %minimum.20, f32[] %constant_1035), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.10 = f32[] cosine(f32[] %multiply.854), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.263 = f32[] add(f32[] %cosine.10, f32[] %constant_1042), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_1034 = f32[] constant(0.05)
  %multiply.853 = f32[] multiply(f32[] %add.263, f32[] %constant_1034), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.11 = f32[] select(pred[] %compare.11, f32[] %add.265, f32[] %multiply.853), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_1033 = f32[] constant(-1)
  %multiply.852 = f32[] multiply(f32[] %select.11, f32[] %constant_1033), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.321 = f32[3584]{0} broadcast(f32[] %multiply.852), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_2.632 = f32[3584]{0} parameter(2)
  %constant_496 = f32[] constant(0.0625)
  %broadcast.530 = f32[3584]{0} broadcast(f32[] %constant_496), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.518 = f32[3584]{0} multiply(f32[3584]{0} %param_2.632, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_1.660 = f32[3584]{0} parameter(1)
  %constant_269 = f32[] constant(0.9)
  %broadcast.322 = f32[3584]{0} broadcast(f32[] %constant_269), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.331 = f32[3584]{0} multiply(f32[3584]{0} %param_1.660, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.146 = f32[3584]{0} add(f32[3584]{0} %multiply.518, f32[3584]{0} %multiply.331), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.330 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.146), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.145 = f32[3584]{0} add(f32[3584]{0} %param_0.123, f32[3584]{0} %multiply.330), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_4.859 = f32[3584]{0} parameter(4)
  %param_5.578 = f32[3584]{0} parameter(5)
  %multiply.786.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_5.578, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_44.44 = f32[3584]{0} parameter(44)
  %multiply.355.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_44.44, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.164.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.786.clone.1, f32[3584]{0} %multiply.355.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.197.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %add.164.clone.1, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.12.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.786.clone.1, f32[3584]{0} %multiply.197.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.196.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.12.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.11.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_4.859, f32[3584]{0} %multiply.196.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_6.1045 = f32[3584]{0} parameter(6)
  %param_7.777 = f32[3584]{0} parameter(7)
  %multiply.782.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_7.777, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_45.24 = f32[3584]{0} parameter(45)
  %multiply.357.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_45.24, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.165.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.782.clone.1, f32[3584]{0} %multiply.357.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.199.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %add.165.clone.1, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.14.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.782.clone.1, f32[3584]{0} %multiply.199.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.198.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.14.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.13.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_6.1045, f32[3584]{0} %multiply.198.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_8.199 = f32[3584]{0} parameter(8)
  %param_10.196 = f32[3584]{0} parameter(10)
  %multiply.750.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_10.196, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_9.101 = f32[3584]{0} parameter(9)
  %multiply.215.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_9.101, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.30.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.750.clone.1, f32[3584]{0} %multiply.215.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.214.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.30.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.29.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_8.199, f32[3584]{0} %multiply.214.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_11.200 = f32[3584]{0} parameter(11)
  %param_13.176 = f32[3584]{0} parameter(13)
  %multiply.746.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_13.176, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12.91 = f32[3584]{0} parameter(12)
  %multiply.217.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_12.91, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.32.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.746.clone.1, f32[3584]{0} %multiply.217.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.216.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.32.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.31.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_11.200, f32[3584]{0} %multiply.216.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_14.179 = f32[3584]{0} parameter(14)
  %param_16.163 = f32[3584]{0} parameter(16)
  %multiply.706.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_16.163, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_15.84 = f32[3584]{0} parameter(15)
  %multiply.237.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_15.84, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.52.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.706.clone.1, f32[3584]{0} %multiply.237.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.236.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.52.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.51.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_14.179, f32[3584]{0} %multiply.236.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_17.155 = f32[3584]{0} parameter(17)
  %param_19.118 = f32[3584]{0} parameter(19)
  %multiply.702.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_19.118, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_18.60 = f32[3584]{0} parameter(18)
  %multiply.239.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_18.60, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.54.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.702.clone.1, f32[3584]{0} %multiply.239.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.238.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.54.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.53.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_17.155, f32[3584]{0} %multiply.238.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_20.113 = f32[3584]{0} parameter(20)
  %param_22.82 = f32[3584]{0} parameter(22)
  %multiply.670.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_22.82, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_21.42 = f32[3584]{0} parameter(21)
  %multiply.255.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_21.42, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.70.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.670.clone.1, f32[3584]{0} %multiply.255.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.254.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.70.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.69.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_20.113, f32[3584]{0} %multiply.254.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_23.86 = f32[3584]{0} parameter(23)
  %param_25.81 = f32[3584]{0} parameter(25)
  %multiply.666.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_25.81, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_24.42 = f32[3584]{0} parameter(24)
  %multiply.257.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_24.42, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.72.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.666.clone.1, f32[3584]{0} %multiply.257.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.256.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.72.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.71.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_23.86, f32[3584]{0} %multiply.256.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_26.83 = f32[3584]{0} parameter(26)
  %param_28.74 = f32[3584]{0} parameter(28)
  %multiply.622.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_28.74, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_27.38 = f32[3584]{0} parameter(27)
  %multiply.279.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_27.38, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.94.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.622.clone.1, f32[3584]{0} %multiply.279.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.278.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.94.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.93.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_26.83, f32[3584]{0} %multiply.278.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_29.74 = f32[3584]{0} parameter(29)
  %param_31.61 = f32[3584]{0} parameter(31)
  %multiply.618.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_31.61, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_30.32 = f32[3584]{0} parameter(30)
  %multiply.281.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_30.32, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.96.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.618.clone.1, f32[3584]{0} %multiply.281.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.280.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.96.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.95.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_29.74, f32[3584]{0} %multiply.280.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_32.62 = f32[3584]{0} parameter(32)
  %param_34.54 = f32[3584]{0} parameter(34)
  %multiply.594.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_34.54, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_33.28 = f32[3584]{0} parameter(33)
  %multiply.293.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_33.28, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.108.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.594.clone.1, f32[3584]{0} %multiply.293.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.292.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.108.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.107.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_32.62, f32[3584]{0} %multiply.292.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_35.53 = f32[3584]{0} parameter(35)
  %param_37.42 = f32[3584]{0} parameter(37)
  %multiply.590.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_37.42, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_36.22 = f32[3584]{0} parameter(36)
  %multiply.295.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_36.22, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.110.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.590.clone.1, f32[3584]{0} %multiply.295.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.294.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.110.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.109.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_35.53, f32[3584]{0} %multiply.294.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_38.44 = f32[3584]{0} parameter(38)
  %param_40.42 = f32[3584]{0} parameter(40)
  %multiply.558.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_40.42, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_39.22 = f32[3584]{0} parameter(39)
  %multiply.311.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_39.22, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.126.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.558.clone.1, f32[3584]{0} %multiply.311.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.310.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.126.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.125.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_38.44, f32[3584]{0} %multiply.310.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_41.44 = f32[3584]{0} parameter(41)
  %param_43.42 = f32[3584]{0} parameter(43)
  %multiply.554.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_43.42, f32[3584]{0} %broadcast.530), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_42.22 = f32[3584]{0} parameter(42)
  %multiply.313.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %param_42.22, f32[3584]{0} %broadcast.322), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.128.clone.1 = f32[3584]{0} add(f32[3584]{0} %multiply.554.clone.1, f32[3584]{0} %multiply.313.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.312.clone.1 = f32[3584]{0} multiply(f32[3584]{0} %broadcast.321, f32[3584]{0} %add.128.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.127.clone.1 = f32[3584]{0} add(f32[3584]{0} %param_41.44, f32[3584]{0} %multiply.312.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.70 = (f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) tuple(f32[3584]{0} %add.145, f32[3584]{0} %add.11.clone.1, f32[3584]{0} %add.13.clone.1, f32[3584]{0} %add.29.clone.1, f32[3584]{0} %add.31.clone.1, /*index=5*/f32[3584]{0} %add.51.clone.1, f32[3584]{0} %add.53.clone.1, f32[3584]{0} %add.69.clone.1, f32[3584]{0} %add.71.clone.1, f32[3584]{0} %add.93.clone.1, /*index=10*/f32[3584]{0} %add.95.clone.1, f32[3584]{0} %add.107.clone.1, f32[3584]{0} %add.109.clone.1, f32[3584]{0} %add.125.clone.1, f32[3584]{0} %add.127.clone.1, /*index=15*/f32[3584]{0} %add.164.clone.1, f32[3584]{0} %add.165.clone.1)
}

%fused_computation.123 (param_0.124: f32[1792], param_1.816: f32[1792], param_2.716: s32[], param_3.725: f32[1792]) -> (f32[1792], f32[1792]) {
  %param_0.124 = f32[1792]{0} parameter(0)
  %param_2.716 = s32[] parameter(2)
  %convert.305 = f32[] convert(s32[] %param_2.716), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2676 = f32[] constant(50000)
  %compare.153 = pred[] compare(f32[] %convert.305, f32[] %constant_2676), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2675 = f32[] constant(1)
  %constant_2674 = s32[] constant(0)
  %maximum.152 = s32[] maximum(s32[] %param_2.716, s32[] %constant_2674), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.304 = f32[] convert(s32[] %maximum.152), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.305 = f32[] minimum(f32[] %convert.304, f32[] %constant_2676), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_2673 = f32[] constant(2e-05)
  %multiply.1566 = f32[] multiply(f32[] %minimum.305, f32[] %constant_2673), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.152 = f32[] subtract(f32[] %constant_2675, f32[] %multiply.1566), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_2672 = f32[] constant(-0.1)
  %multiply.1565 = f32[] multiply(f32[] %subtract.152, f32[] %constant_2672), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_2671 = f32[] constant(0.1)
  %add.691 = f32[] add(f32[] %multiply.1565, f32[] %constant_2671), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_2670 = f32[] constant(-50000)
  %add.690 = f32[] add(f32[] %convert.305, f32[] %constant_2670), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2669 = f32[] constant(950000)
  %minimum.304 = f32[] minimum(f32[] %add.690, f32[] %constant_2669), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_2668 = f32[] constant(3.30693956e-06)
  %multiply.1564 = f32[] multiply(f32[] %minimum.304, f32[] %constant_2668), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.152 = f32[] cosine(f32[] %multiply.1564), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.689 = f32[] add(f32[] %cosine.152, f32[] %constant_2675), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_2667 = f32[] constant(0.05)
  %multiply.1563 = f32[] multiply(f32[] %add.689, f32[] %constant_2667), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.153 = f32[] select(pred[] %compare.153, f32[] %add.691, f32[] %multiply.1563), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2666 = f32[] constant(-1)
  %multiply.1562 = f32[] multiply(f32[] %select.153, f32[] %constant_2666), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.323 = f32[1792]{0} broadcast(f32[] %multiply.1562), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.816 = f32[1792]{0} parameter(1)
  %constant_490 = f32[] constant(0.0625)
  %broadcast.526 = f32[1792]{0} broadcast(f32[] %constant_490), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.514 = f32[1792]{0} multiply(f32[1792]{0} %param_1.816, f32[1792]{0} %broadcast.526), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3.725 = f32[1792]{0} parameter(3)
  %constant_270 = f32[] constant(0.9)
  %broadcast.503.clone.1 = f32[1792]{0} broadcast(f32[] %constant_270), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.491.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_3.725, f32[1792]{0} %broadcast.503.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.232.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.514, f32[1792]{0} %multiply.491.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.333 = f32[1792]{0} multiply(f32[1792]{0} %add.232.clone.1, f32[1792]{0} %broadcast.503.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.148 = f32[1792]{0} add(f32[1792]{0} %multiply.514, f32[1792]{0} %multiply.333), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.332 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.323, f32[1792]{0} %add.148), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.147 = f32[1792]{0} add(f32[1792]{0} %param_0.124, f32[1792]{0} %multiply.332), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.112 = (f32[1792]{0}, f32[1792]{0}) tuple(f32[1792]{0} %add.147, f32[1792]{0} %add.232.clone.1)
}

%fused_computation.124 (param_0.125: f32[1792], param_1.656: f32[1792], param_2.630: f32[1792], param_3.412: s32[], param_4.858: f32[1792], param_5.579: f32[1792], param_6.1046: f32[1792], param_7.779: f32[1792], param_8.201: f32[1792], param_9.103: f32[1792], param_10.198: f32[1792], param_11.202: f32[1792], param_12.93: f32[1792], param_13.178: f32[1792], param_14.181: f32[1792], param_15.86: f32[1792], param_16.165: f32[1792], param_17.157: f32[1792], param_18.62: f32[1792], param_19.120: f32[1792], param_20.115: f32[1792], param_21.44: f32[1792], param_22.84: f32[1792], param_23.88: f32[1792], param_24.44: f32[1792], param_25.83: f32[1792], param_26.85: f32[1792], param_27.40: f32[1792], param_28.76: f32[1792], param_29.76: f32[1792], param_30.34: f32[1792], param_31.63: f32[1792], param_32.64: f32[1792], param_33.30: f32[1792], param_34.56: f32[1792], param_35.55: f32[1792], param_36.24: f32[1792], param_37.44: f32[1792], param_38.46: f32[1792], param_39.24: f32[1792], param_40.44: f32[1792], param_41.46: f32[1792], param_42.24: f32[1792], param_43.44: f32[1792], param_44.46: f32[1792], param_45.28: f32[1792]) -> (f32[1792], f32[1792], f32[1792], f32[1792], f32[1792], /*index=5*/f32[1792], f32[1792], f32[1792], f32[1792], f32[1792], /*index=10*/f32[1792], f32[1792], f32[1792], f32[1792], f32[1792], /*index=15*/f32[1792], f32[1792]) {
  %param_0.125 = f32[1792]{0} parameter(0)
  %param_3.412 = s32[] parameter(3)
  %convert.13 = f32[] convert(s32[] %param_3.412), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_997 = f32[] constant(50000)
  %compare.7 = pred[] compare(f32[] %convert.13, f32[] %constant_997), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_996 = f32[] constant(1)
  %constant_995 = s32[] constant(0)
  %maximum.6 = s32[] maximum(s32[] %param_3.412, s32[] %constant_995), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.12 = f32[] convert(s32[] %maximum.6), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.13 = f32[] minimum(f32[] %convert.12, f32[] %constant_997), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_994 = f32[] constant(2e-05)
  %multiply.836 = f32[] multiply(f32[] %minimum.13, f32[] %constant_994), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.6 = f32[] subtract(f32[] %constant_996, f32[] %multiply.836), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_993 = f32[] constant(-0.1)
  %multiply.835 = f32[] multiply(f32[] %subtract.6, f32[] %constant_993), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_992 = f32[] constant(0.1)
  %add.253 = f32[] add(f32[] %multiply.835, f32[] %constant_992), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_991 = f32[] constant(-50000)
  %add.252 = f32[] add(f32[] %convert.13, f32[] %constant_991), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_990 = f32[] constant(950000)
  %minimum.12 = f32[] minimum(f32[] %add.252, f32[] %constant_990), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_989 = f32[] constant(3.30693956e-06)
  %multiply.834 = f32[] multiply(f32[] %minimum.12, f32[] %constant_989), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.6 = f32[] cosine(f32[] %multiply.834), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.251 = f32[] add(f32[] %cosine.6, f32[] %constant_996), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_988 = f32[] constant(0.05)
  %multiply.833 = f32[] multiply(f32[] %add.251, f32[] %constant_988), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.7 = f32[] select(pred[] %compare.7, f32[] %add.253, f32[] %multiply.833), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_987 = f32[] constant(-1)
  %multiply.832 = f32[] multiply(f32[] %select.7, f32[] %constant_987), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.325 = f32[1792]{0} broadcast(f32[] %multiply.832), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_2.630 = f32[1792]{0} parameter(2)
  %constant_484 = f32[] constant(0.0625)
  %broadcast.522 = f32[1792]{0} broadcast(f32[] %constant_484), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.510 = f32[1792]{0} multiply(f32[1792]{0} %param_2.630, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_1.656 = f32[1792]{0} parameter(1)
  %constant_271 = f32[] constant(0.9)
  %broadcast.326 = f32[1792]{0} broadcast(f32[] %constant_271), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.335 = f32[1792]{0} multiply(f32[1792]{0} %param_1.656, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.150 = f32[1792]{0} add(f32[1792]{0} %multiply.510, f32[1792]{0} %multiply.335), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.334 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.150), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.149 = f32[1792]{0} add(f32[1792]{0} %param_0.125, f32[1792]{0} %multiply.334), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_4.858 = f32[1792]{0} parameter(4)
  %param_5.579 = f32[1792]{0} parameter(5)
  %multiply.778.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_5.579, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_44.46 = f32[1792]{0} parameter(44)
  %multiply.359.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_44.46, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.166.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.778.clone.1, f32[1792]{0} %multiply.359.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.201.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %add.166.clone.1, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.16.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.778.clone.1, f32[1792]{0} %multiply.201.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.200.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.16.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.15.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_4.858, f32[1792]{0} %multiply.200.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_6.1046 = f32[1792]{0} parameter(6)
  %param_7.779 = f32[1792]{0} parameter(7)
  %multiply.774.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_7.779, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_45.28 = f32[1792]{0} parameter(45)
  %multiply.361.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_45.28, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.167.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.774.clone.1, f32[1792]{0} %multiply.361.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.203.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %add.167.clone.1, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.18.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.774.clone.1, f32[1792]{0} %multiply.203.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.202.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.18.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.17.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_6.1046, f32[1792]{0} %multiply.202.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_8.201 = f32[1792]{0} parameter(8)
  %param_10.198 = f32[1792]{0} parameter(10)
  %multiply.742.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_10.198, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_9.103 = f32[1792]{0} parameter(9)
  %multiply.219.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_9.103, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.34.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.742.clone.1, f32[1792]{0} %multiply.219.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.218.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.34.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.33.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_8.201, f32[1792]{0} %multiply.218.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_11.202 = f32[1792]{0} parameter(11)
  %param_13.178 = f32[1792]{0} parameter(13)
  %multiply.738.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_13.178, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12.93 = f32[1792]{0} parameter(12)
  %multiply.221.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_12.93, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.36.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.738.clone.1, f32[1792]{0} %multiply.221.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.220.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.36.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.35.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_11.202, f32[1792]{0} %multiply.220.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_14.181 = f32[1792]{0} parameter(14)
  %param_16.165 = f32[1792]{0} parameter(16)
  %multiply.698.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_16.165, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_15.86 = f32[1792]{0} parameter(15)
  %multiply.241.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_15.86, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.56.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.698.clone.1, f32[1792]{0} %multiply.241.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.240.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.56.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.55.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_14.181, f32[1792]{0} %multiply.240.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_17.157 = f32[1792]{0} parameter(17)
  %param_19.120 = f32[1792]{0} parameter(19)
  %multiply.694.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_19.120, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_18.62 = f32[1792]{0} parameter(18)
  %multiply.243.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_18.62, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.58.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.694.clone.1, f32[1792]{0} %multiply.243.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.242.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.58.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.57.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_17.157, f32[1792]{0} %multiply.242.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_20.115 = f32[1792]{0} parameter(20)
  %param_22.84 = f32[1792]{0} parameter(22)
  %multiply.662.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_22.84, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_21.44 = f32[1792]{0} parameter(21)
  %multiply.259.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_21.44, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.74.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.662.clone.1, f32[1792]{0} %multiply.259.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.258.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.74.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.73.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_20.115, f32[1792]{0} %multiply.258.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_23.88 = f32[1792]{0} parameter(23)
  %param_25.83 = f32[1792]{0} parameter(25)
  %multiply.658.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_25.83, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_24.44 = f32[1792]{0} parameter(24)
  %multiply.261.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_24.44, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.76.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.658.clone.1, f32[1792]{0} %multiply.261.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.260.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.76.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.75.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_23.88, f32[1792]{0} %multiply.260.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_26.85 = f32[1792]{0} parameter(26)
  %param_28.76 = f32[1792]{0} parameter(28)
  %multiply.614.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_28.76, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_27.40 = f32[1792]{0} parameter(27)
  %multiply.283.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_27.40, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.98.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.614.clone.1, f32[1792]{0} %multiply.283.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.282.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.98.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.97.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_26.85, f32[1792]{0} %multiply.282.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_29.76 = f32[1792]{0} parameter(29)
  %param_31.63 = f32[1792]{0} parameter(31)
  %multiply.610.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_31.63, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_30.34 = f32[1792]{0} parameter(30)
  %multiply.285.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_30.34, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.100.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.610.clone.1, f32[1792]{0} %multiply.285.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.284.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.100.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.99.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_29.76, f32[1792]{0} %multiply.284.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_32.64 = f32[1792]{0} parameter(32)
  %param_34.56 = f32[1792]{0} parameter(34)
  %multiply.586.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_34.56, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_33.30 = f32[1792]{0} parameter(33)
  %multiply.297.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_33.30, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.112.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.586.clone.1, f32[1792]{0} %multiply.297.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.296.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.112.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.111.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_32.64, f32[1792]{0} %multiply.296.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_35.55 = f32[1792]{0} parameter(35)
  %param_37.44 = f32[1792]{0} parameter(37)
  %multiply.582.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_37.44, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_36.24 = f32[1792]{0} parameter(36)
  %multiply.299.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_36.24, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.114.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.582.clone.1, f32[1792]{0} %multiply.299.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.298.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.114.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.113.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_35.55, f32[1792]{0} %multiply.298.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_38.46 = f32[1792]{0} parameter(38)
  %param_40.44 = f32[1792]{0} parameter(40)
  %multiply.550.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_40.44, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_39.24 = f32[1792]{0} parameter(39)
  %multiply.315.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_39.24, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.130.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.550.clone.1, f32[1792]{0} %multiply.315.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.314.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.130.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.129.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_38.46, f32[1792]{0} %multiply.314.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_41.46 = f32[1792]{0} parameter(41)
  %param_43.44 = f32[1792]{0} parameter(43)
  %multiply.546.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_43.44, f32[1792]{0} %broadcast.522), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_42.24 = f32[1792]{0} parameter(42)
  %multiply.317.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %param_42.24, f32[1792]{0} %broadcast.326), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.132.clone.1 = f32[1792]{0} add(f32[1792]{0} %multiply.546.clone.1, f32[1792]{0} %multiply.317.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.316.clone.1 = f32[1792]{0} multiply(f32[1792]{0} %broadcast.325, f32[1792]{0} %add.132.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.131.clone.1 = f32[1792]{0} add(f32[1792]{0} %param_41.46, f32[1792]{0} %multiply.316.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.72 = (f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) tuple(f32[1792]{0} %add.149, f32[1792]{0} %add.15.clone.1, f32[1792]{0} %add.17.clone.1, f32[1792]{0} %add.33.clone.1, f32[1792]{0} %add.35.clone.1, /*index=5*/f32[1792]{0} %add.55.clone.1, f32[1792]{0} %add.57.clone.1, f32[1792]{0} %add.73.clone.1, f32[1792]{0} %add.75.clone.1, f32[1792]{0} %add.97.clone.1, /*index=10*/f32[1792]{0} %add.99.clone.1, f32[1792]{0} %add.111.clone.1, f32[1792]{0} %add.113.clone.1, f32[1792]{0} %add.129.clone.1, f32[1792]{0} %add.131.clone.1, /*index=15*/f32[1792]{0} %add.166.clone.1, f32[1792]{0} %add.167.clone.1)
}

%fused_computation.125 (param_0.126: f32[896], param_1.817: f32[896], param_2.717: s32[], param_3.726: f32[896], param_4.895: f32[896], param_5.598: f32[896], param_6.1061: f32[896], param_7.804: f32[896], param_8.223: f32[896], param_9.129: f32[896], param_10.231: f32[896], param_11.233: f32[896], param_12.123: f32[896], param_13.217: f32[896], param_14.213: f32[896], param_15.123: f32[896], param_16.227: f32[896], param_17.196: f32[896], param_18.78: f32[896], param_19.136: f32[896], param_20.132: f32[896], param_21.61: f32[896], param_22.102: f32[896], param_23.106: f32[896], param_24.70: f32[896], param_25.125: f32[896], param_26.111: f32[896], param_27.50: f32[896], param_28.86: f32[896], param_29.86: f32[896], param_30.54: f32[896]) -> (f32[896], f32[896], f32[896], f32[896], f32[896], /*index=5*/f32[896], f32[896], f32[896], f32[896], f32[896], /*index=10*/f32[896], f32[896], f32[896], f32[896], f32[896], /*index=15*/f32[896], f32[896], f32[896], f32[896], f32[896]) {
  %param_0.126 = f32[896]{0} parameter(0)
  %param_2.717 = s32[] parameter(2)
  %convert.309 = f32[] convert(s32[] %param_2.717), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2699 = f32[] constant(50000)
  %compare.155 = pred[] compare(f32[] %convert.309, f32[] %constant_2699), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2698 = f32[] constant(1)
  %constant_2697 = s32[] constant(0)
  %maximum.154 = s32[] maximum(s32[] %param_2.717, s32[] %constant_2697), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/max" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %convert.308 = f32[] convert(s32[] %maximum.154), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/convert_element_type[new_dtype=float32 weak_type=True]" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %minimum.309 = f32[] minimum(f32[] %convert.308, f32[] %constant_2699), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=86}
  %constant_2696 = f32[] constant(2e-05)
  %multiply.1576 = f32[] multiply(f32[] %minimum.309, f32[] %constant_2696), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %subtract.154 = f32[] subtract(f32[] %constant_2698, f32[] %multiply.1576), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=87}
  %constant_2695 = f32[] constant(-0.1)
  %multiply.1575 = f32[] multiply(f32[] %subtract.154, f32[] %constant_2695), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_2694 = f32[] constant(0.1)
  %add.697 = f32[] add(f32[] %multiply.1575, f32[] %constant_2694), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=88}
  %constant_2693 = f32[] constant(-50000)
  %add.696 = f32[] add(f32[] %convert.309, f32[] %constant_2693), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/sub" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2692 = f32[] constant(950000)
  %minimum.308 = f32[] minimum(f32[] %add.696, f32[] %constant_2692), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/min" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=235}
  %constant_2691 = f32[] constant(3.30693956e-06)
  %multiply.1574 = f32[] multiply(f32[] %minimum.308, f32[] %constant_2691), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %cosine.154 = f32[] cosine(f32[] %multiply.1574), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/cos" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %add.695 = f32[] add(f32[] %cosine.154, f32[] %constant_2698), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=236}
  %constant_2690 = f32[] constant(0.05)
  %multiply.1573 = f32[] multiply(f32[] %add.695, f32[] %constant_2690), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=238}
  %select.155 = f32[] select(pred[] %compare.155, f32[] %add.697, f32[] %multiply.1573), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/schedule.py" source_line=394}
  %constant_2689 = f32[] constant(-1)
  %multiply.1572 = f32[] multiply(f32[] %select.155, f32[] %constant_2689), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/alias.py" source_line=37}
  %broadcast.327 = f32[896]{0} broadcast(f32[] %multiply.1572), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %param_1.817 = f32[896]{0} parameter(1)
  %constant_478 = f32[] constant(0.0625)
  %broadcast.518 = f32[896]{0} broadcast(f32[] %constant_478), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.506 = f32[896]{0} multiply(f32[896]{0} %param_1.817, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_29.86 = f32[896]{0} parameter(29)
  %constant_272 = f32[] constant(0.9)
  %broadcast.507.clone.1 = f32[896]{0} broadcast(f32[] %constant_272), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.495.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_29.86, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.234.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.506, f32[896]{0} %multiply.495.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.337 = f32[896]{0} multiply(f32[896]{0} %add.234.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.152 = f32[896]{0} add(f32[896]{0} %multiply.506, f32[896]{0} %multiply.337), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.336 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.152), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.151 = f32[896]{0} add(f32[896]{0} %param_0.126, f32[896]{0} %multiply.336), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_3.726 = f32[896]{0} parameter(3)
  %param_4.895 = f32[896]{0} parameter(4)
  %multiply.502.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_4.895, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_30.54 = f32[896]{0} parameter(30)
  %multiply.497.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_30.54, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.235.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.502.clone.1, f32[896]{0} %multiply.497.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.339.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.235.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.154.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.502.clone.1, f32[896]{0} %multiply.339.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.338.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.154.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.153.clone.1 = f32[896]{0} add(f32[896]{0} %param_3.726, f32[896]{0} %multiply.338.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_5.598 = f32[896]{0} parameter(5)
  %param_6.1061 = f32[896]{0} parameter(6)
  %multiply.770.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_6.1061, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_21.61 = f32[896]{0} parameter(21)
  %multiply.363.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_21.61, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.168.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.770.clone.1, f32[896]{0} %multiply.363.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.205.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.168.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.20.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.770.clone.1, f32[896]{0} %multiply.205.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.204.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.20.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.19.clone.1 = f32[896]{0} add(f32[896]{0} %param_5.598, f32[896]{0} %multiply.204.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_7.804 = f32[896]{0} parameter(7)
  %param_8.223 = f32[896]{0} parameter(8)
  %multiply.766.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_8.223, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_22.102 = f32[896]{0} parameter(22)
  %multiply.365.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_22.102, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.169.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.766.clone.1, f32[896]{0} %multiply.365.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.207.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.169.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.22.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.766.clone.1, f32[896]{0} %multiply.207.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.206.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.22.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.21.clone.1 = f32[896]{0} add(f32[896]{0} %param_7.804, f32[896]{0} %multiply.206.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_9.129 = f32[896]{0} parameter(9)
  %param_10.231 = f32[896]{0} parameter(10)
  %multiply.734.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_10.231, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_23.106 = f32[896]{0} parameter(23)
  %multiply.381.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_23.106, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.177.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.734.clone.1, f32[896]{0} %multiply.381.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.223.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.177.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.38.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.734.clone.1, f32[896]{0} %multiply.223.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.222.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.38.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.37.clone.1 = f32[896]{0} add(f32[896]{0} %param_9.129, f32[896]{0} %multiply.222.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_11.233 = f32[896]{0} parameter(11)
  %param_12.123 = f32[896]{0} parameter(12)
  %multiply.730.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_12.123, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_24.70 = f32[896]{0} parameter(24)
  %multiply.383.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_24.70, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.178.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.730.clone.1, f32[896]{0} %multiply.383.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.225.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.178.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.40.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.730.clone.1, f32[896]{0} %multiply.225.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.224.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.40.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.39.clone.1 = f32[896]{0} add(f32[896]{0} %param_11.233, f32[896]{0} %multiply.224.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_13.217 = f32[896]{0} parameter(13)
  %param_14.213 = f32[896]{0} parameter(14)
  %multiply.578.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_14.213, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_25.125 = f32[896]{0} parameter(25)
  %multiply.459.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_25.125, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.216.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.578.clone.1, f32[896]{0} %multiply.459.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.301.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.216.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.116.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.578.clone.1, f32[896]{0} %multiply.301.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.300.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.116.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.115.clone.1 = f32[896]{0} add(f32[896]{0} %param_13.217, f32[896]{0} %multiply.300.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_15.123 = f32[896]{0} parameter(15)
  %param_16.227 = f32[896]{0} parameter(16)
  %multiply.574.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_16.227, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_26.111 = f32[896]{0} parameter(26)
  %multiply.461.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_26.111, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.217.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.574.clone.1, f32[896]{0} %multiply.461.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.303.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.217.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.118.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.574.clone.1, f32[896]{0} %multiply.303.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.302.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.118.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.117.clone.1 = f32[896]{0} add(f32[896]{0} %param_15.123, f32[896]{0} %multiply.302.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_17.196 = f32[896]{0} parameter(17)
  %param_18.78 = f32[896]{0} parameter(18)
  %multiply.542.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_18.78, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_27.50 = f32[896]{0} parameter(27)
  %multiply.477.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_27.50, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.225.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.542.clone.1, f32[896]{0} %multiply.477.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.319.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.225.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.134.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.542.clone.1, f32[896]{0} %multiply.319.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.318.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.134.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.133.clone.1 = f32[896]{0} add(f32[896]{0} %param_17.196, f32[896]{0} %multiply.318.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %param_19.136 = f32[896]{0} parameter(19)
  %param_20.132 = f32[896]{0} parameter(20)
  %multiply.538.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_20.132, f32[896]{0} %broadcast.518), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_28.86 = f32[896]{0} parameter(28)
  %multiply.479.clone.1 = f32[896]{0} multiply(f32[896]{0} %param_28.86, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.226.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.538.clone.1, f32[896]{0} %multiply.479.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.321.clone.1 = f32[896]{0} multiply(f32[896]{0} %add.226.clone.1, f32[896]{0} %broadcast.507.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.136.clone.1 = f32[896]{0} add(f32[896]{0} %multiply.538.clone.1, f32[896]{0} %multiply.321.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.320.clone.1 = f32[896]{0} multiply(f32[896]{0} %broadcast.327, f32[896]{0} %add.136.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=694}
  %add.135.clone.1 = f32[896]{0} add(f32[896]{0} %param_19.136, f32[896]{0} %multiply.320.clone.1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  ROOT %tuple.114 = (f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) tuple(f32[896]{0} %add.151, f32[896]{0} %add.153.clone.1, f32[896]{0} %add.19.clone.1, f32[896]{0} %add.21.clone.1, f32[896]{0} %add.37.clone.1, /*index=5*/f32[896]{0} %add.39.clone.1, f32[896]{0} %add.115.clone.1, f32[896]{0} %add.117.clone.1, f32[896]{0} %add.133.clone.1, f32[896]{0} %add.135.clone.1, /*index=10*/f32[896]{0} %add.168.clone.1, f32[896]{0} %add.169.clone.1, f32[896]{0} %add.177.clone.1, f32[896]{0} %add.178.clone.1, f32[896]{0} %add.216.clone.1, /*index=15*/f32[896]{0} %add.217.clone.1, f32[896]{0} %add.225.clone.1, f32[896]{0} %add.226.clone.1, f32[896]{0} %add.234.clone.1, f32[896]{0} %add.235.clone.1)
}

%fused_computation.128 (param_0.135: s32[]) -> s32[] {
  %param_0.135 = s32[] parameter(0)
  %constant_146 = s32[] constant(2147483647)
  %compare.1 = pred[] compare(s32[] %param_0.135, s32[] %constant_146), direction=LT, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/lt" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/numerics.py" source_line=118}
  %constant_274 = s32[] constant(1)
  %add.158 = s32[] add(s32[] %param_0.135, s32[] %constant_274), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/numerics.py" source_line=118}
  ROOT %select.1 = s32[] select(pred[] %compare.1, s32[] %add.158, s32[] %constant_146), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/numerics.py" source_line=118}
}

%horizontally_fused_computation (param_0_0: f32[], param_0_1: f32[], param_1_0: f32[], param_3.727: f32[]) -> (f32[1], f32[1], f32[1]) {
  %param_0_0 = f32[] parameter(0)
  %param_0_1 = f32[] parameter(1)
  %multiply.1580 = f32[] multiply(f32[] %param_0_0, f32[] %param_0_1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %reshape = f32[1]{0} reshape(f32[] %multiply.1580), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_1_0 = f32[] parameter(2)
  %multiply.1581 = f32[] multiply(f32[] %param_1_0, f32[] %param_0_1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %reshape.1 = f32[1]{0} reshape(f32[] %multiply.1581), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3.727 = f32[] parameter(3)
  %multiply.1582 = f32[] multiply(f32[] %param_3.727, f32[] %param_0_1), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %reshape.2 = f32[1]{0} reshape(f32[] %multiply.1582), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %concatenate = f32[3]{0} concatenate(f32[1]{0} %reshape, f32[1]{0} %reshape.1, f32[1]{0} %reshape.2), dimensions={0}
  %slice = f32[1]{0} slice(f32[3]{0} %concatenate), slice={[0:1]}
  %slice.1 = f32[1]{0} slice(f32[3]{0} %concatenate), slice={[1:2]}
  %slice.2 = f32[1]{0} slice(f32[3]{0} %concatenate), slice={[2:3]}
  ROOT %tuple.115 = (f32[1]{0}, f32[1]{0}, f32[1]{0}) tuple(f32[1]{0} %slice, f32[1]{0} %slice.1, f32[1]{0} %slice.2), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
}

%horizontally_fused_computation.1 (param_0_0.1: f32[896], param_1_0.1: f32[1792], param_2_0.1: f32[1792], param_3_0: f32[3584], param_4_0: f32[3584], param_5_0: f32[7168], param_6_0: f32[7168], param_7_0: f32[1792], param_8_0: f32[1792], param_9_0: f32[3584], param_10_0: f32[3584], param_11_0: f32[7168], param_12_0: f32[7168], param_13_0: f32[896], param_14_0: f32[1792], param_15_0: f32[1792], param_16_0: f32[3584], param_17_0: f32[3584], param_18_0: f32[896], param_19_0: f32[896], param_20_0: f32[1792], param_21_0: f32[1792], param_22_0: f32[3584], param_23_0: f32[3584], param_24_0: f32[896], param_25_0: f32[896], param_26_0: f32[896], param_27_0: f32[1792], param_28_0: f32[1792], param_29_0: f32[3584], param_30_0: f32[3584], param_31_0: f32[896]) -> (f32[896], f32[1792], f32[1792], f32[3584], f32[3584], /*index=5*/f32[7168], f32[7168], f32[1792], f32[1792], f32[3584], /*index=10*/f32[3584], f32[7168], f32[7168], f32[896], f32[1792], /*index=15*/f32[1792], f32[3584], f32[3584], f32[896], f32[896], /*index=20*/f32[1792], f32[1792], f32[3584], f32[3584], f32[896], /*index=25*/f32[896], f32[896], f32[1792], f32[1792], f32[3584], /*index=30*/f32[3584], f32[896]) {
  %param_0_0.1 = f32[896]{0} parameter(0)
  %constant_2700 = f32[] constant(0.0625)
  %broadcast.819 = f32[896]{0} broadcast(f32[] %constant_2700), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1583 = f32[896]{0} multiply(f32[896]{0} %param_0_0.1, f32[896]{0} %broadcast.819), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_1_0.1 = f32[1792]{0} parameter(1)
  %broadcast.820 = f32[1792]{0} broadcast(f32[] %constant_2700), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1584 = f32[1792]{0} multiply(f32[1792]{0} %param_1_0.1, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_2_0.1 = f32[1792]{0} parameter(2)
  %multiply.1585 = f32[1792]{0} multiply(f32[1792]{0} %param_2_0.1, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3_0 = f32[3584]{0} parameter(3)
  %broadcast.822 = f32[3584]{0} broadcast(f32[] %constant_2700), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1586 = f32[3584]{0} multiply(f32[3584]{0} %param_3_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_4_0 = f32[3584]{0} parameter(4)
  %multiply.1587 = f32[3584]{0} multiply(f32[3584]{0} %param_4_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_5_0 = f32[7168]{0} parameter(5)
  %broadcast.824 = f32[7168]{0} broadcast(f32[] %constant_2700), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1588 = f32[7168]{0} multiply(f32[7168]{0} %param_5_0, f32[7168]{0} %broadcast.824), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_6_0 = f32[7168]{0} parameter(6)
  %multiply.1589 = f32[7168]{0} multiply(f32[7168]{0} %param_6_0, f32[7168]{0} %broadcast.824), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_7_0 = f32[1792]{0} parameter(7)
  %multiply.1590 = f32[1792]{0} multiply(f32[1792]{0} %param_7_0, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_8_0 = f32[1792]{0} parameter(8)
  %multiply.1591 = f32[1792]{0} multiply(f32[1792]{0} %param_8_0, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_9_0 = f32[3584]{0} parameter(9)
  %multiply.1592 = f32[3584]{0} multiply(f32[3584]{0} %param_9_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_10_0 = f32[3584]{0} parameter(10)
  %multiply.1593 = f32[3584]{0} multiply(f32[3584]{0} %param_10_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_11_0 = f32[7168]{0} parameter(11)
  %multiply.1594 = f32[7168]{0} multiply(f32[7168]{0} %param_11_0, f32[7168]{0} %broadcast.824), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12_0 = f32[7168]{0} parameter(12)
  %multiply.1595 = f32[7168]{0} multiply(f32[7168]{0} %param_12_0, f32[7168]{0} %broadcast.824), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_13_0 = f32[896]{0} parameter(13)
  %multiply.1596 = f32[896]{0} multiply(f32[896]{0} %param_13_0, f32[896]{0} %broadcast.819), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_14_0 = f32[1792]{0} parameter(14)
  %multiply.1597 = f32[1792]{0} multiply(f32[1792]{0} %param_14_0, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_15_0 = f32[1792]{0} parameter(15)
  %multiply.1598 = f32[1792]{0} multiply(f32[1792]{0} %param_15_0, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_16_0 = f32[3584]{0} parameter(16)
  %multiply.1599 = f32[3584]{0} multiply(f32[3584]{0} %param_16_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_17_0 = f32[3584]{0} parameter(17)
  %multiply.1600 = f32[3584]{0} multiply(f32[3584]{0} %param_17_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_18_0 = f32[896]{0} parameter(18)
  %multiply.1601 = f32[896]{0} multiply(f32[896]{0} %param_18_0, f32[896]{0} %broadcast.819), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_19_0 = f32[896]{0} parameter(19)
  %multiply.1602 = f32[896]{0} multiply(f32[896]{0} %param_19_0, f32[896]{0} %broadcast.819), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_20_0 = f32[1792]{0} parameter(20)
  %multiply.1603 = f32[1792]{0} multiply(f32[1792]{0} %param_20_0, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_21_0 = f32[1792]{0} parameter(21)
  %multiply.1604 = f32[1792]{0} multiply(f32[1792]{0} %param_21_0, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_22_0 = f32[3584]{0} parameter(22)
  %multiply.1605 = f32[3584]{0} multiply(f32[3584]{0} %param_22_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_23_0 = f32[3584]{0} parameter(23)
  %multiply.1606 = f32[3584]{0} multiply(f32[3584]{0} %param_23_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_24_0 = f32[896]{0} parameter(24)
  %multiply.1607 = f32[896]{0} multiply(f32[896]{0} %param_24_0, f32[896]{0} %broadcast.819), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_25_0 = f32[896]{0} parameter(25)
  %multiply.1608 = f32[896]{0} multiply(f32[896]{0} %param_25_0, f32[896]{0} %broadcast.819), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_26_0 = f32[896]{0} parameter(26)
  %multiply.1609 = f32[896]{0} multiply(f32[896]{0} %param_26_0, f32[896]{0} %broadcast.819), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_27_0 = f32[1792]{0} parameter(27)
  %multiply.1610 = f32[1792]{0} multiply(f32[1792]{0} %param_27_0, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_28_0 = f32[1792]{0} parameter(28)
  %multiply.1611 = f32[1792]{0} multiply(f32[1792]{0} %param_28_0, f32[1792]{0} %broadcast.820), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_29_0 = f32[3584]{0} parameter(29)
  %multiply.1612 = f32[3584]{0} multiply(f32[3584]{0} %param_29_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_30_0 = f32[3584]{0} parameter(30)
  %multiply.1613 = f32[3584]{0} multiply(f32[3584]{0} %param_30_0, f32[3584]{0} %broadcast.822), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_31_0 = f32[896]{0} parameter(31)
  %multiply.1614 = f32[896]{0} multiply(f32[896]{0} %param_31_0, f32[896]{0} %broadcast.819), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %concatenate.1 = f32[89600]{0} concatenate(f32[896]{0} %multiply.1583, f32[1792]{0} %multiply.1584, f32[1792]{0} %multiply.1585, f32[3584]{0} %multiply.1586, f32[3584]{0} %multiply.1587, /*index=5*/f32[7168]{0} %multiply.1588, f32[7168]{0} %multiply.1589, f32[1792]{0} %multiply.1590, f32[1792]{0} %multiply.1591, f32[3584]{0} %multiply.1592, /*index=10*/f32[3584]{0} %multiply.1593, f32[7168]{0} %multiply.1594, f32[7168]{0} %multiply.1595, f32[896]{0} %multiply.1596, f32[1792]{0} %multiply.1597, /*index=15*/f32[1792]{0} %multiply.1598, f32[3584]{0} %multiply.1599, f32[3584]{0} %multiply.1600, f32[896]{0} %multiply.1601, f32[896]{0} %multiply.1602, /*index=20*/f32[1792]{0} %multiply.1603, f32[1792]{0} %multiply.1604, f32[3584]{0} %multiply.1605, f32[3584]{0} %multiply.1606, f32[896]{0} %multiply.1607, /*index=25*/f32[896]{0} %multiply.1608, f32[896]{0} %multiply.1609, f32[1792]{0} %multiply.1610, f32[1792]{0} %multiply.1611, f32[3584]{0} %multiply.1612, /*index=30*/f32[3584]{0} %multiply.1613, f32[896]{0} %multiply.1614), dimensions={0}
  %slice.3 = f32[896]{0} slice(f32[89600]{0} %concatenate.1), slice={[0:896]}
  %slice.4 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[896:2688]}
  %slice.5 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[2688:4480]}
  %slice.6 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[4480:8064]}
  %slice.7 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[8064:11648]}
  %slice.8 = f32[7168]{0} slice(f32[89600]{0} %concatenate.1), slice={[11648:18816]}
  %slice.9 = f32[7168]{0} slice(f32[89600]{0} %concatenate.1), slice={[18816:25984]}
  %slice.10 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[25984:27776]}
  %slice.11 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[27776:29568]}
  %slice.12 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[29568:33152]}
  %slice.13 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[33152:36736]}
  %slice.14 = f32[7168]{0} slice(f32[89600]{0} %concatenate.1), slice={[36736:43904]}
  %slice.15 = f32[7168]{0} slice(f32[89600]{0} %concatenate.1), slice={[43904:51072]}
  %slice.16 = f32[896]{0} slice(f32[89600]{0} %concatenate.1), slice={[51072:51968]}
  %slice.17 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[51968:53760]}
  %slice.18 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[53760:55552]}
  %slice.19 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[55552:59136]}
  %slice.20 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[59136:62720]}
  %slice.21 = f32[896]{0} slice(f32[89600]{0} %concatenate.1), slice={[62720:63616]}
  %slice.22 = f32[896]{0} slice(f32[89600]{0} %concatenate.1), slice={[63616:64512]}
  %slice.23 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[64512:66304]}
  %slice.24 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[66304:68096]}
  %slice.25 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[68096:71680]}
  %slice.26 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[71680:75264]}
  %slice.27 = f32[896]{0} slice(f32[89600]{0} %concatenate.1), slice={[75264:76160]}
  %slice.28 = f32[896]{0} slice(f32[89600]{0} %concatenate.1), slice={[76160:77056]}
  %slice.29 = f32[896]{0} slice(f32[89600]{0} %concatenate.1), slice={[77056:77952]}
  %slice.30 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[77952:79744]}
  %slice.31 = f32[1792]{0} slice(f32[89600]{0} %concatenate.1), slice={[79744:81536]}
  %slice.32 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[81536:85120]}
  %slice.33 = f32[3584]{0} slice(f32[89600]{0} %concatenate.1), slice={[85120:88704]}
  %slice.34 = f32[896]{0} slice(f32[89600]{0} %concatenate.1), slice={[88704:89600]}
  ROOT %tuple.116 = (f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) tuple(f32[896]{0} %slice.3, f32[1792]{0} %slice.4, f32[1792]{0} %slice.5, f32[3584]{0} %slice.6, f32[3584]{0} %slice.7, /*index=5*/f32[7168]{0} %slice.8, f32[7168]{0} %slice.9, f32[1792]{0} %slice.10, f32[1792]{0} %slice.11, f32[3584]{0} %slice.12, /*index=10*/f32[3584]{0} %slice.13, f32[7168]{0} %slice.14, f32[7168]{0} %slice.15, f32[896]{0} %slice.16, f32[1792]{0} %slice.17, /*index=15*/f32[1792]{0} %slice.18, f32[3584]{0} %slice.19, f32[3584]{0} %slice.20, f32[896]{0} %slice.21, f32[896]{0} %slice.22, /*index=20*/f32[1792]{0} %slice.23, f32[1792]{0} %slice.24, f32[3584]{0} %slice.25, f32[3584]{0} %slice.26, f32[896]{0} %slice.27, /*index=25*/f32[896]{0} %slice.28, f32[896]{0} %slice.29, f32[1792]{0} %slice.30, f32[1792]{0} %slice.31, f32[3584]{0} %slice.32, /*index=30*/f32[3584]{0} %slice.33, f32[896]{0} %slice.34), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
}

%horizontally_fused_computation.2 (param_0_0.2: f32[896], param_1_0.2: f32[1792], param_2_0.2: f32[1792], param_3_0.1: f32[3584], param_4_0.1: f32[3584], param_5_0.1: f32[7168], param_6_0.1: f32[896], param_7_0.1: f32[1792], param_8_0.1: f32[1792], param_9_0.1: f32[3584], param_10_0.1: f32[3584], param_11_0.1: f32[1792], param_12_0.1: f32[1792], param_13_0.1: f32[3584], param_14_0.1: f32[3584], param_15_0.1: f32[7168], param_16_0.1: f32[7168], param_17_0.1: f32[7168]) -> (f32[896], f32[1792], f32[1792], f32[3584], f32[3584], /*index=5*/f32[7168], f32[896], f32[1792], f32[1792], f32[3584], /*index=10*/f32[3584], f32[1792], f32[1792], f32[3584], f32[3584], /*index=15*/f32[7168], f32[7168], f32[7168]) {
  %param_0_0.2 = f32[896]{0} parameter(0)
  %constant_2732 = f32[] constant(0.0625)
  %broadcast.851 = f32[896]{0} broadcast(f32[] %constant_2732), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1615 = f32[896]{0} multiply(f32[896]{0} %param_0_0.2, f32[896]{0} %broadcast.851), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_1_0.2 = f32[1792]{0} parameter(1)
  %broadcast.852 = f32[1792]{0} broadcast(f32[] %constant_2732), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1616 = f32[1792]{0} multiply(f32[1792]{0} %param_1_0.2, f32[1792]{0} %broadcast.852), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_2_0.2 = f32[1792]{0} parameter(2)
  %multiply.1617 = f32[1792]{0} multiply(f32[1792]{0} %param_2_0.2, f32[1792]{0} %broadcast.852), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3_0.1 = f32[3584]{0} parameter(3)
  %broadcast.854 = f32[3584]{0} broadcast(f32[] %constant_2732), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1618 = f32[3584]{0} multiply(f32[3584]{0} %param_3_0.1, f32[3584]{0} %broadcast.854), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_4_0.1 = f32[3584]{0} parameter(4)
  %multiply.1619 = f32[3584]{0} multiply(f32[3584]{0} %param_4_0.1, f32[3584]{0} %broadcast.854), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_5_0.1 = f32[7168]{0} parameter(5)
  %broadcast.856 = f32[7168]{0} broadcast(f32[] %constant_2732), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1620 = f32[7168]{0} multiply(f32[7168]{0} %param_5_0.1, f32[7168]{0} %broadcast.856), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_6_0.1 = f32[896]{0} parameter(6)
  %multiply.1621 = f32[896]{0} multiply(f32[896]{0} %param_6_0.1, f32[896]{0} %broadcast.851), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_7_0.1 = f32[1792]{0} parameter(7)
  %multiply.1622 = f32[1792]{0} multiply(f32[1792]{0} %param_7_0.1, f32[1792]{0} %broadcast.852), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_8_0.1 = f32[1792]{0} parameter(8)
  %multiply.1623 = f32[1792]{0} multiply(f32[1792]{0} %param_8_0.1, f32[1792]{0} %broadcast.852), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_9_0.1 = f32[3584]{0} parameter(9)
  %multiply.1624 = f32[3584]{0} multiply(f32[3584]{0} %param_9_0.1, f32[3584]{0} %broadcast.854), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_10_0.1 = f32[3584]{0} parameter(10)
  %multiply.1625 = f32[3584]{0} multiply(f32[3584]{0} %param_10_0.1, f32[3584]{0} %broadcast.854), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_11_0.1 = f32[1792]{0} parameter(11)
  %multiply.1626 = f32[1792]{0} multiply(f32[1792]{0} %param_11_0.1, f32[1792]{0} %broadcast.852), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12_0.1 = f32[1792]{0} parameter(12)
  %multiply.1627 = f32[1792]{0} multiply(f32[1792]{0} %param_12_0.1, f32[1792]{0} %broadcast.852), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_13_0.1 = f32[3584]{0} parameter(13)
  %multiply.1628 = f32[3584]{0} multiply(f32[3584]{0} %param_13_0.1, f32[3584]{0} %broadcast.854), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_14_0.1 = f32[3584]{0} parameter(14)
  %multiply.1629 = f32[3584]{0} multiply(f32[3584]{0} %param_14_0.1, f32[3584]{0} %broadcast.854), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_15_0.1 = f32[7168]{0} parameter(15)
  %multiply.1630 = f32[7168]{0} multiply(f32[7168]{0} %param_15_0.1, f32[7168]{0} %broadcast.856), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_16_0.1 = f32[7168]{0} parameter(16)
  %multiply.1631 = f32[7168]{0} multiply(f32[7168]{0} %param_16_0.1, f32[7168]{0} %broadcast.856), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_17_0.1 = f32[7168]{0} parameter(17)
  %multiply.1632 = f32[7168]{0} multiply(f32[7168]{0} %param_17_0.1, f32[7168]{0} %broadcast.856), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %concatenate.2 = f32[62720]{0} concatenate(f32[896]{0} %multiply.1615, f32[1792]{0} %multiply.1616, f32[1792]{0} %multiply.1617, f32[3584]{0} %multiply.1618, f32[3584]{0} %multiply.1619, /*index=5*/f32[7168]{0} %multiply.1620, f32[896]{0} %multiply.1621, f32[1792]{0} %multiply.1622, f32[1792]{0} %multiply.1623, f32[3584]{0} %multiply.1624, /*index=10*/f32[3584]{0} %multiply.1625, f32[1792]{0} %multiply.1626, f32[1792]{0} %multiply.1627, f32[3584]{0} %multiply.1628, f32[3584]{0} %multiply.1629, /*index=15*/f32[7168]{0} %multiply.1630, f32[7168]{0} %multiply.1631, f32[7168]{0} %multiply.1632), dimensions={0}
  %slice.35 = f32[896]{0} slice(f32[62720]{0} %concatenate.2), slice={[0:896]}
  %slice.36 = f32[1792]{0} slice(f32[62720]{0} %concatenate.2), slice={[896:2688]}
  %slice.37 = f32[1792]{0} slice(f32[62720]{0} %concatenate.2), slice={[2688:4480]}
  %slice.38 = f32[3584]{0} slice(f32[62720]{0} %concatenate.2), slice={[4480:8064]}
  %slice.39 = f32[3584]{0} slice(f32[62720]{0} %concatenate.2), slice={[8064:11648]}
  %slice.40 = f32[7168]{0} slice(f32[62720]{0} %concatenate.2), slice={[11648:18816]}
  %slice.41 = f32[896]{0} slice(f32[62720]{0} %concatenate.2), slice={[18816:19712]}
  %slice.42 = f32[1792]{0} slice(f32[62720]{0} %concatenate.2), slice={[19712:21504]}
  %slice.43 = f32[1792]{0} slice(f32[62720]{0} %concatenate.2), slice={[21504:23296]}
  %slice.44 = f32[3584]{0} slice(f32[62720]{0} %concatenate.2), slice={[23296:26880]}
  %slice.45 = f32[3584]{0} slice(f32[62720]{0} %concatenate.2), slice={[26880:30464]}
  %slice.46 = f32[1792]{0} slice(f32[62720]{0} %concatenate.2), slice={[30464:32256]}
  %slice.47 = f32[1792]{0} slice(f32[62720]{0} %concatenate.2), slice={[32256:34048]}
  %slice.48 = f32[3584]{0} slice(f32[62720]{0} %concatenate.2), slice={[34048:37632]}
  %slice.49 = f32[3584]{0} slice(f32[62720]{0} %concatenate.2), slice={[37632:41216]}
  %slice.50 = f32[7168]{0} slice(f32[62720]{0} %concatenate.2), slice={[41216:48384]}
  %slice.51 = f32[7168]{0} slice(f32[62720]{0} %concatenate.2), slice={[48384:55552]}
  %slice.52 = f32[7168]{0} slice(f32[62720]{0} %concatenate.2), slice={[55552:62720]}
  ROOT %tuple.117 = (f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) tuple(f32[896]{0} %slice.35, f32[1792]{0} %slice.36, f32[1792]{0} %slice.37, f32[3584]{0} %slice.38, f32[3584]{0} %slice.39, /*index=5*/f32[7168]{0} %slice.40, f32[896]{0} %slice.41, f32[1792]{0} %slice.42, f32[1792]{0} %slice.43, f32[3584]{0} %slice.44, /*index=10*/f32[3584]{0} %slice.45, f32[1792]{0} %slice.46, f32[1792]{0} %slice.47, f32[3584]{0} %slice.48, f32[3584]{0} %slice.49, /*index=15*/f32[7168]{0} %slice.50, f32[7168]{0} %slice.51, f32[7168]{0} %slice.52), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
}

%horizontally_fused_computation.3 (param_0_0.3: f32[3584], param_0_1.1: f32[3584], param_1_0.3: f32[3584], param_1_1.1: f32[3584], param_2_0.3: f32[3584], param_2_1.1: f32[3584], param_3_0.2: f32[3584], param_3_1: f32[3584], param_4_0.2: f32[3584], param_4_1: f32[3584], param_5_0.2: f32[3584], param_5_1: f32[3584], param_6_0.2: f32[3584], param_6_1: f32[3584], param_7_0.2: f32[3584], param_7_1: f32[3584], param_8_0.2: f32[3584], param_8_1: f32[3584], param_9_0.2: f32[3584], param_9_1: f32[3584], param_10_0.2: f32[3584], param_10_1: f32[3584], param_11_0.2: f32[3584], param_11_1: f32[3584], param_12_0.2: f32[3584], param_12_1: f32[3584]) -> (f32[3584], f32[3584], f32[3584], f32[3584], f32[3584], /*index=5*/f32[3584], f32[3584], f32[3584], f32[3584], f32[3584], /*index=10*/f32[3584], f32[3584], f32[3584]) {
  %param_0_1.1 = f32[3584]{0} parameter(1)
  %constant_2750 = f32[] constant(0.0625)
  %broadcast.869 = f32[3584]{0} broadcast(f32[] %constant_2750), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1633 = f32[3584]{0} multiply(f32[3584]{0} %param_0_1.1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_0_0.3 = f32[3584]{0} parameter(0)
  %constant_2751 = f32[] constant(0.9)
  %broadcast.870 = f32[3584]{0} broadcast(f32[] %constant_2751), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.1634 = f32[3584]{0} multiply(f32[3584]{0} %param_0_0.3, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.698 = f32[3584]{0} add(f32[3584]{0} %multiply.1633, f32[3584]{0} %multiply.1634), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_1_1.1 = f32[3584]{0} parameter(3)
  %multiply.1635 = f32[3584]{0} multiply(f32[3584]{0} %param_1_1.1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_1_0.3 = f32[3584]{0} parameter(2)
  %multiply.1636 = f32[3584]{0} multiply(f32[3584]{0} %param_1_0.3, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.699 = f32[3584]{0} add(f32[3584]{0} %multiply.1635, f32[3584]{0} %multiply.1636), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_2_1.1 = f32[3584]{0} parameter(5)
  %multiply.1637 = f32[3584]{0} multiply(f32[3584]{0} %param_2_1.1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_2_0.3 = f32[3584]{0} parameter(4)
  %multiply.1638 = f32[3584]{0} multiply(f32[3584]{0} %param_2_0.3, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.700 = f32[3584]{0} add(f32[3584]{0} %multiply.1637, f32[3584]{0} %multiply.1638), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_3_1 = f32[3584]{0} parameter(7)
  %multiply.1639 = f32[3584]{0} multiply(f32[3584]{0} %param_3_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3_0.2 = f32[3584]{0} parameter(6)
  %multiply.1640 = f32[3584]{0} multiply(f32[3584]{0} %param_3_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.701 = f32[3584]{0} add(f32[3584]{0} %multiply.1639, f32[3584]{0} %multiply.1640), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_4_1 = f32[3584]{0} parameter(9)
  %multiply.1641 = f32[3584]{0} multiply(f32[3584]{0} %param_4_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_4_0.2 = f32[3584]{0} parameter(8)
  %multiply.1642 = f32[3584]{0} multiply(f32[3584]{0} %param_4_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.702 = f32[3584]{0} add(f32[3584]{0} %multiply.1641, f32[3584]{0} %multiply.1642), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_5_1 = f32[3584]{0} parameter(11)
  %multiply.1643 = f32[3584]{0} multiply(f32[3584]{0} %param_5_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_5_0.2 = f32[3584]{0} parameter(10)
  %multiply.1644 = f32[3584]{0} multiply(f32[3584]{0} %param_5_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.703 = f32[3584]{0} add(f32[3584]{0} %multiply.1643, f32[3584]{0} %multiply.1644), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_6_1 = f32[3584]{0} parameter(13)
  %multiply.1645 = f32[3584]{0} multiply(f32[3584]{0} %param_6_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_6_0.2 = f32[3584]{0} parameter(12)
  %multiply.1646 = f32[3584]{0} multiply(f32[3584]{0} %param_6_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.704 = f32[3584]{0} add(f32[3584]{0} %multiply.1645, f32[3584]{0} %multiply.1646), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_7_1 = f32[3584]{0} parameter(15)
  %multiply.1647 = f32[3584]{0} multiply(f32[3584]{0} %param_7_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_7_0.2 = f32[3584]{0} parameter(14)
  %multiply.1648 = f32[3584]{0} multiply(f32[3584]{0} %param_7_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.705 = f32[3584]{0} add(f32[3584]{0} %multiply.1647, f32[3584]{0} %multiply.1648), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_8_1 = f32[3584]{0} parameter(17)
  %multiply.1649 = f32[3584]{0} multiply(f32[3584]{0} %param_8_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_8_0.2 = f32[3584]{0} parameter(16)
  %multiply.1650 = f32[3584]{0} multiply(f32[3584]{0} %param_8_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.706 = f32[3584]{0} add(f32[3584]{0} %multiply.1649, f32[3584]{0} %multiply.1650), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_9_1 = f32[3584]{0} parameter(19)
  %multiply.1651 = f32[3584]{0} multiply(f32[3584]{0} %param_9_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_9_0.2 = f32[3584]{0} parameter(18)
  %multiply.1652 = f32[3584]{0} multiply(f32[3584]{0} %param_9_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.707 = f32[3584]{0} add(f32[3584]{0} %multiply.1651, f32[3584]{0} %multiply.1652), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_10_1 = f32[3584]{0} parameter(21)
  %multiply.1653 = f32[3584]{0} multiply(f32[3584]{0} %param_10_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_10_0.2 = f32[3584]{0} parameter(20)
  %multiply.1654 = f32[3584]{0} multiply(f32[3584]{0} %param_10_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.708 = f32[3584]{0} add(f32[3584]{0} %multiply.1653, f32[3584]{0} %multiply.1654), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_11_1 = f32[3584]{0} parameter(23)
  %multiply.1655 = f32[3584]{0} multiply(f32[3584]{0} %param_11_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_11_0.2 = f32[3584]{0} parameter(22)
  %multiply.1656 = f32[3584]{0} multiply(f32[3584]{0} %param_11_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.709 = f32[3584]{0} add(f32[3584]{0} %multiply.1655, f32[3584]{0} %multiply.1656), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_12_1 = f32[3584]{0} parameter(25)
  %multiply.1657 = f32[3584]{0} multiply(f32[3584]{0} %param_12_1, f32[3584]{0} %broadcast.869), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12_0.2 = f32[3584]{0} parameter(24)
  %multiply.1658 = f32[3584]{0} multiply(f32[3584]{0} %param_12_0.2, f32[3584]{0} %broadcast.870), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.710 = f32[3584]{0} add(f32[3584]{0} %multiply.1657, f32[3584]{0} %multiply.1658), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %concatenate.3 = f32[46592]{0} concatenate(f32[3584]{0} %add.698, f32[3584]{0} %add.699, f32[3584]{0} %add.700, f32[3584]{0} %add.701, f32[3584]{0} %add.702, /*index=5*/f32[3584]{0} %add.703, f32[3584]{0} %add.704, f32[3584]{0} %add.705, f32[3584]{0} %add.706, f32[3584]{0} %add.707, /*index=10*/f32[3584]{0} %add.708, f32[3584]{0} %add.709, f32[3584]{0} %add.710), dimensions={0}
  %slice.53 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[0:3584]}
  %slice.54 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[3584:7168]}
  %slice.55 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[7168:10752]}
  %slice.56 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[10752:14336]}
  %slice.57 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[14336:17920]}
  %slice.58 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[17920:21504]}
  %slice.59 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[21504:25088]}
  %slice.60 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[25088:28672]}
  %slice.61 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[28672:32256]}
  %slice.62 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[32256:35840]}
  %slice.63 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[35840:39424]}
  %slice.64 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[39424:43008]}
  %slice.65 = f32[3584]{0} slice(f32[46592]{0} %concatenate.3), slice={[43008:46592]}
  ROOT %tuple.118 = (f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) tuple(f32[3584]{0} %slice.53, f32[3584]{0} %slice.54, f32[3584]{0} %slice.55, f32[3584]{0} %slice.56, f32[3584]{0} %slice.57, /*index=5*/f32[3584]{0} %slice.58, f32[3584]{0} %slice.59, f32[3584]{0} %slice.60, f32[3584]{0} %slice.61, f32[3584]{0} %slice.62, /*index=10*/f32[3584]{0} %slice.63, f32[3584]{0} %slice.64, f32[3584]{0} %slice.65), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
}

%horizontally_fused_computation.4 (param_0_0.4: f32[1792], param_0_1.2: f32[1792], param_1_0.4: f32[1792], param_1_1.2: f32[1792], param_2_0.4: f32[1792], param_2_1.2: f32[1792], param_3_0.3: f32[1792], param_3_1.1: f32[1792], param_4_0.3: f32[1792], param_4_1.1: f32[1792], param_5_0.3: f32[1792], param_5_1.1: f32[1792], param_6_0.3: f32[1792], param_6_1.1: f32[1792], param_7_0.3: f32[1792], param_7_1.1: f32[1792], param_8_0.3: f32[1792], param_8_1.1: f32[1792], param_9_0.3: f32[1792], param_9_1.1: f32[1792], param_10_0.3: f32[1792], param_10_1.1: f32[1792], param_11_0.3: f32[1792], param_11_1.1: f32[1792], param_12_0.3: f32[1792], param_12_1.1: f32[1792]) -> (f32[1792], f32[1792], f32[1792], f32[1792], f32[1792], /*index=5*/f32[1792], f32[1792], f32[1792], f32[1792], f32[1792], /*index=10*/f32[1792], f32[1792], f32[1792]) {
  %param_0_1.2 = f32[1792]{0} parameter(1)
  %constant_2776 = f32[] constant(0.0625)
  %broadcast.895 = f32[1792]{0} broadcast(f32[] %constant_2776), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %multiply.1659 = f32[1792]{0} multiply(f32[1792]{0} %param_0_1.2, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_0_0.4 = f32[1792]{0} parameter(0)
  %constant_2777 = f32[] constant(0.9)
  %broadcast.896 = f32[1792]{0} broadcast(f32[] %constant_2777), dimensions={}, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %multiply.1660 = f32[1792]{0} multiply(f32[1792]{0} %param_0_0.4, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.711 = f32[1792]{0} add(f32[1792]{0} %multiply.1659, f32[1792]{0} %multiply.1660), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_1_1.2 = f32[1792]{0} parameter(3)
  %multiply.1661 = f32[1792]{0} multiply(f32[1792]{0} %param_1_1.2, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_1_0.4 = f32[1792]{0} parameter(2)
  %multiply.1662 = f32[1792]{0} multiply(f32[1792]{0} %param_1_0.4, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.712 = f32[1792]{0} add(f32[1792]{0} %multiply.1661, f32[1792]{0} %multiply.1662), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_2_1.2 = f32[1792]{0} parameter(5)
  %multiply.1663 = f32[1792]{0} multiply(f32[1792]{0} %param_2_1.2, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_2_0.4 = f32[1792]{0} parameter(4)
  %multiply.1664 = f32[1792]{0} multiply(f32[1792]{0} %param_2_0.4, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.713 = f32[1792]{0} add(f32[1792]{0} %multiply.1663, f32[1792]{0} %multiply.1664), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_3_1.1 = f32[1792]{0} parameter(7)
  %multiply.1665 = f32[1792]{0} multiply(f32[1792]{0} %param_3_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_3_0.3 = f32[1792]{0} parameter(6)
  %multiply.1666 = f32[1792]{0} multiply(f32[1792]{0} %param_3_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.714 = f32[1792]{0} add(f32[1792]{0} %multiply.1665, f32[1792]{0} %multiply.1666), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_4_1.1 = f32[1792]{0} parameter(9)
  %multiply.1667 = f32[1792]{0} multiply(f32[1792]{0} %param_4_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_4_0.3 = f32[1792]{0} parameter(8)
  %multiply.1668 = f32[1792]{0} multiply(f32[1792]{0} %param_4_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.715 = f32[1792]{0} add(f32[1792]{0} %multiply.1667, f32[1792]{0} %multiply.1668), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_5_1.1 = f32[1792]{0} parameter(11)
  %multiply.1669 = f32[1792]{0} multiply(f32[1792]{0} %param_5_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_5_0.3 = f32[1792]{0} parameter(10)
  %multiply.1670 = f32[1792]{0} multiply(f32[1792]{0} %param_5_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.716 = f32[1792]{0} add(f32[1792]{0} %multiply.1669, f32[1792]{0} %multiply.1670), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_6_1.1 = f32[1792]{0} parameter(13)
  %multiply.1671 = f32[1792]{0} multiply(f32[1792]{0} %param_6_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_6_0.3 = f32[1792]{0} parameter(12)
  %multiply.1672 = f32[1792]{0} multiply(f32[1792]{0} %param_6_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.717 = f32[1792]{0} add(f32[1792]{0} %multiply.1671, f32[1792]{0} %multiply.1672), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_7_1.1 = f32[1792]{0} parameter(15)
  %multiply.1673 = f32[1792]{0} multiply(f32[1792]{0} %param_7_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_7_0.3 = f32[1792]{0} parameter(14)
  %multiply.1674 = f32[1792]{0} multiply(f32[1792]{0} %param_7_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.718 = f32[1792]{0} add(f32[1792]{0} %multiply.1673, f32[1792]{0} %multiply.1674), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_8_1.1 = f32[1792]{0} parameter(17)
  %multiply.1675 = f32[1792]{0} multiply(f32[1792]{0} %param_8_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_8_0.3 = f32[1792]{0} parameter(16)
  %multiply.1676 = f32[1792]{0} multiply(f32[1792]{0} %param_8_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.719 = f32[1792]{0} add(f32[1792]{0} %multiply.1675, f32[1792]{0} %multiply.1676), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_9_1.1 = f32[1792]{0} parameter(19)
  %multiply.1677 = f32[1792]{0} multiply(f32[1792]{0} %param_9_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_9_0.3 = f32[1792]{0} parameter(18)
  %multiply.1678 = f32[1792]{0} multiply(f32[1792]{0} %param_9_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.720 = f32[1792]{0} add(f32[1792]{0} %multiply.1677, f32[1792]{0} %multiply.1678), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_10_1.1 = f32[1792]{0} parameter(21)
  %multiply.1679 = f32[1792]{0} multiply(f32[1792]{0} %param_10_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_10_0.3 = f32[1792]{0} parameter(20)
  %multiply.1680 = f32[1792]{0} multiply(f32[1792]{0} %param_10_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.721 = f32[1792]{0} add(f32[1792]{0} %multiply.1679, f32[1792]{0} %multiply.1680), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_11_1.1 = f32[1792]{0} parameter(23)
  %multiply.1681 = f32[1792]{0} multiply(f32[1792]{0} %param_11_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_11_0.3 = f32[1792]{0} parameter(22)
  %multiply.1682 = f32[1792]{0} multiply(f32[1792]{0} %param_11_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.722 = f32[1792]{0} add(f32[1792]{0} %multiply.1681, f32[1792]{0} %multiply.1682), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_12_1.1 = f32[1792]{0} parameter(25)
  %multiply.1683 = f32[1792]{0} multiply(f32[1792]{0} %param_12_1.1, f32[1792]{0} %broadcast.895), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_12_0.3 = f32[1792]{0} parameter(24)
  %multiply.1684 = f32[1792]{0} multiply(f32[1792]{0} %param_12_0.3, f32[1792]{0} %broadcast.896), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/mul" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %add.723 = f32[1792]{0} add(f32[1792]{0} %multiply.1683, f32[1792]{0} %multiply.1684), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %concatenate.4 = f32[23296]{0} concatenate(f32[1792]{0} %add.711, f32[1792]{0} %add.712, f32[1792]{0} %add.713, f32[1792]{0} %add.714, f32[1792]{0} %add.715, /*index=5*/f32[1792]{0} %add.716, f32[1792]{0} %add.717, f32[1792]{0} %add.718, f32[1792]{0} %add.719, f32[1792]{0} %add.720, /*index=10*/f32[1792]{0} %add.721, f32[1792]{0} %add.722, f32[1792]{0} %add.723), dimensions={0}
  %slice.66 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[0:1792]}
  %slice.67 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[1792:3584]}
  %slice.68 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[3584:5376]}
  %slice.69 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[5376:7168]}
  %slice.70 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[7168:8960]}
  %slice.71 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[8960:10752]}
  %slice.72 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[10752:12544]}
  %slice.73 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[12544:14336]}
  %slice.74 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[14336:16128]}
  %slice.75 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[16128:17920]}
  %slice.76 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[17920:19712]}
  %slice.77 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[19712:21504]}
  %slice.78 = f32[1792]{0} slice(f32[23296]{0} %concatenate.4), slice={[21504:23296]}
  ROOT %tuple.119 = (f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) tuple(f32[1792]{0} %slice.66, f32[1792]{0} %slice.67, f32[1792]{0} %slice.68, f32[1792]{0} %slice.69, f32[1792]{0} %slice.70, /*index=5*/f32[1792]{0} %slice.71, f32[1792]{0} %slice.72, f32[1792]{0} %slice.73, f32[1792]{0} %slice.74, f32[1792]{0} %slice.75, /*index=10*/f32[1792]{0} %slice.76, f32[1792]{0} %slice.77, f32[1792]{0} %slice.78), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
}

ENTRY %main.10683-1_apply_grad (param_0: f32[896], param_1: f32[896], param_2: f32[1792], param_3: f32[1792], param_4: f32[3584], param_5: f32[3584], param_6: f32[1,1,3584,896], param_7: f32[3,3,896,1792], param_8: f32[1,1,1792,3584], param_9: f32[896], param_10: f32[896], param_11: f32[1792], param_12: f32[1792], param_13: f32[3584], param_14: f32[3584], param_15: f32[1,1,3584,896], param_16: f32[3,3,896,1792], param_17: f32[1,1,1792,3584], param_18: f32[896], param_19: f32[896], param_20: f32[1792], param_21: f32[1792], param_22: f32[3584], param_23: f32[3584], param_24: f32[1,1,3584,896], param_25: f32[3,3,896,1792], param_26: f32[1,1,1792,3584], param_27: f32[1792], param_28: f32[1792], param_29: f32[3584], param_30: f32[3584], param_31: f32[7168], param_32: f32[7168], param_33: f32[1,1,3584,1792], param_34: f32[3,3,1792,3584], param_35: f32[1,1,3584,7168], param_36: f32[1,1,3584,7168], param_37: f32[7168], param_38: f32[7168], param_39: f32[1792], param_40: f32[1792], param_41: f32[3584], param_42: f32[3584], param_43: f32[7168], param_44: f32[7168], param_45: f32[1,1,7168,1792], param_46: f32[3,3,1792,3584], param_47: f32[1,1,3584,7168], param_48: f32[1792], param_49: f32[1792], param_50: f32[3584], param_51: f32[3584], param_52: f32[7168], param_53: f32[7168], param_54: f32[1,1,7168,1792], param_55: f32[3,3,1792,3584], param_56: f32[1,1,3584,7168], param_57: f32[896], param_58: f32[896], param_59: f32[1792], param_60: f32[1792], param_61: f32[3584], param_62: f32[3584], param_63: f32[1,1,3584,896], param_64: f32[3,3,896,1792], param_65: f32[1,1,1792,3584], param_66: f32[896], param_67: f32[896], param_68: f32[1792], param_69: f32[1792], param_70: f32[3584], param_71: f32[3584], param_72: f32[1,1,3584,896], param_73: f32[3,3,896,1792], param_74: f32[1,1,1792,3584], param_75: f32[1024], param_76: f32[7168,1024], param_77: s32[], param_78: f32[896], param_79: f32[896], param_80: f32[1792], param_81: f32[1792], param_82: f32[3584], param_83: f32[3584], param_84: f32[1,1,3584,896], param_85: f32[3,3,896,1792], param_86: f32[1,1,1792,3584], param_87: f32[896], param_88: f32[896], param_89: f32[1792], param_90: f32[1792], param_91: f32[3584], param_92: f32[3584], param_93: f32[1,1,3584,896], param_94: f32[3,3,896,1792], param_95: f32[1,1,1792,3584], param_96: f32[896], param_97: f32[896], param_98: f32[1792], param_99: f32[1792], param_100: f32[3584], param_101: f32[3584], param_102: f32[1,1,3584,896], param_103: f32[3,3,896,1792], param_104: f32[1,1,1792,3584], param_105: f32[1792], param_106: f32[1792], param_107: f32[3584], param_108: f32[3584], param_109: f32[7168], param_110: f32[7168], param_111: f32[1,1,3584,1792], param_112: f32[3,3,1792,3584], param_113: f32[1,1,3584,7168], param_114: f32[1,1,3584,7168], param_115: f32[7168], param_116: f32[7168], param_117: f32[1792], param_118: f32[1792], param_119: f32[3584], param_120: f32[3584], param_121: f32[7168], param_122: f32[7168], param_123: f32[1,1,7168,1792], param_124: f32[3,3,1792,3584], param_125: f32[1,1,3584,7168], param_126: f32[1792], param_127: f32[1792], param_128: f32[3584], param_129: f32[3584], param_130: f32[7168], param_131: f32[7168], param_132: f32[1,1,7168,1792], param_133: f32[3,3,1792,3584], param_134: f32[1,1,3584,7168], param_135: f32[896], param_136: f32[896], param_137: f32[1792], param_138: f32[1792], param_139: f32[3584], param_140: f32[3584], param_141: f32[1,1,3584,896], param_142: f32[3,3,896,1792], param_143: f32[1,1,1792,3584], param_144: f32[896], param_145: f32[896], param_146: f32[1792], param_147: f32[1792], param_148: f32[3584], param_149: f32[3584], param_150: f32[1,1,3584,896], param_151: f32[3,3,896,1792], param_152: f32[1,1,1792,3584], param_153: f32[1024], param_154: f32[7168,1024], param_155: s32[], param_156: f32[896], param_157: f32[896], param_158: f32[1792], param_159: f32[1792], param_160: f32[3584], param_161: f32[3584], param_162: f32[896], param_163: f32[896], param_164: f32[1792], param_165: f32[1792], param_166: f32[3584], param_167: f32[3584], param_168: f32[896], param_169: f32[896], param_170: f32[1792], param_171: f32[1792], param_172: f32[3584], param_173: f32[3584], param_174: f32[1792], param_175: f32[1792], param_176: f32[3584], param_177: f32[3584], param_178: f32[7168], param_179: f32[7168], param_180: f32[7168], param_181: f32[7168], param_182: f32[1792], param_183: f32[1792], param_184: f32[3584], param_185: f32[3584], param_186: f32[7168], param_187: f32[7168], param_188: f32[1792], param_189: f32[1792], param_190: f32[3584], param_191: f32[3584], param_192: f32[7168], param_193: f32[7168], param_194: f32[896], param_195: f32[896], param_196: f32[1792], param_197: f32[1792], param_198: f32[3584], param_199: f32[3584], param_200: f32[896], param_201: f32[896], param_202: f32[1792], param_203: f32[1792], param_204: f32[3584], param_205: f32[3584], param_206: f32[896], param_207: f32[896], param_208: f32[1792], param_209: f32[1792], param_210: f32[3584], param_211: f32[3584], param_212: f32[1,1,3584,896], param_213: f32[3,3,896,1792], param_214: f32[1,1,1792,3584], param_215: f32[896], param_216: f32[896], param_217: f32[1792], param_218: f32[1792], param_219: f32[3584], param_220: f32[3584], param_221: f32[1,1,3584,896], param_222: f32[3,3,896,1792], param_223: f32[1,1,1792,3584], param_224: f32[896], param_225: f32[896], param_226: f32[1792], param_227: f32[1792], param_228: f32[3584], param_229: f32[3584], param_230: f32[1,1,3584,896], param_231: f32[3,3,896,1792], param_232: f32[1,1,1792,3584], param_233: f32[1792], param_234: f32[1792], param_235: f32[3584], param_236: f32[3584], param_237: f32[7168], param_238: f32[7168], param_239: f32[1,1,3584,1792], param_240: f32[3,3,1792,3584], param_241: f32[1,1,3584,7168], param_242: f32[1,1,3584,7168], param_243: f32[7168], param_244: f32[7168], param_245: f32[1792], param_246: f32[1792], param_247: f32[3584], param_248: f32[3584], param_249: f32[7168], param_250: f32[7168], param_251: f32[1,1,7168,1792], param_252: f32[3,3,1792,3584], param_253: f32[1,1,3584,7168], param_254: f32[1792], param_255: f32[1792], param_256: f32[3584], param_257: f32[3584], param_258: f32[7168], param_259: f32[7168], param_260: f32[1,1,7168,1792], param_261: f32[3,3,1792,3584], param_262: f32[1,1,3584,7168], param_263: f32[896], param_264: f32[896], param_265: f32[1792], param_266: f32[1792], param_267: f32[3584], param_268: f32[3584], param_269: f32[1,1,3584,896], param_270: f32[3,3,896,1792], param_271: f32[1,1,1792,3584], param_272: f32[896], param_273: f32[896], param_274: f32[1792], param_275: f32[1792], param_276: f32[3584], param_277: f32[3584], param_278: f32[1,1,3584,896], param_279: f32[3,3,896,1792], param_280: f32[1,1,1792,3584], param_281: f32[1024], param_282: f32[7168,1024], param_283: f32[896], param_284: f32[896], param_285: f32[1792], param_286: f32[1792], param_287: f32[3584], param_288: f32[3584], param_289: f32[896], param_290: f32[896], param_291: f32[1792], param_292: f32[1792], param_293: f32[3584], param_294: f32[3584], param_295: f32[896], param_296: f32[896], param_297: f32[1792], param_298: f32[1792], param_299: f32[3584], param_300: f32[3584], param_301: f32[1792], param_302: f32[1792], param_303: f32[3584], param_304: f32[3584], param_305: f32[7168], param_306: f32[7168], param_307: f32[7168], param_308: f32[7168], param_309: f32[1792], param_310: f32[1792], param_311: f32[3584], param_312: f32[3584], param_313: f32[7168], param_314: f32[7168], param_315: f32[1792], param_316: f32[1792], param_317: f32[3584], param_318: f32[3584], param_319: f32[7168], param_320: f32[7168], param_321: f32[896], param_322: f32[896], param_323: f32[1792], param_324: f32[1792], param_325: f32[3584], param_326: f32[3584], param_327: f32[896], param_328: f32[896], param_329: f32[1792], param_330: f32[1792], param_331: f32[3584], param_332: f32[3584], param_333: f32[], param_334: f32[], param_335: f32[]) -> (f32[896], f32[896], f32[1792], f32[1792], f32[3584], /*index=5*/f32[3584], f32[1,1,3584,896], f32[3,3,896,1792], f32[1,1,1792,3584], f32[896], /*index=10*/f32[896], f32[1792], f32[1792], f32[3584], f32[3584], /*index=15*/f32[1,1,3584,896], f32[3,3,896,1792], f32[1,1,1792,3584], f32[896], f32[896], /*index=20*/f32[1792], f32[1792], f32[3584], f32[3584], f32[1,1,3584,896], /*index=25*/f32[3,3,896,1792], f32[1,1,1792,3584], f32[1792], f32[1792], f32[3584], /*index=30*/f32[3584], f32[7168], f32[7168], f32[1,1,3584,1792], f32[3,3,1792,3584], /*index=35*/f32[1,1,3584,7168], f32[1,1,3584,7168], f32[7168], f32[7168], f32[1792], /*index=40*/f32[1792], f32[3584], f32[3584], f32[7168], f32[7168], /*index=45*/f32[1,1,7168,1792], f32[3,3,1792,3584], f32[1,1,3584,7168], f32[1792], f32[1792], /*index=50*/f32[3584], f32[3584], f32[7168], f32[7168], f32[1,1,7168,1792], /*index=55*/f32[3,3,1792,3584], f32[1,1,3584,7168], f32[896], f32[896], f32[1792], /*index=60*/f32[1792], f32[3584], f32[3584], f32[1,1,3584,896], f32[3,3,896,1792], /*index=65*/f32[1,1,1792,3584], f32[896], f32[896], f32[1792], f32[1792], /*index=70*/f32[3584], f32[3584], f32[1,1,3584,896], f32[3,3,896,1792], f32[1,1,1792,3584], /*index=75*/f32[1024], f32[7168,1024], s32[], f32[896], f32[896], /*index=80*/f32[1792], f32[1792], f32[3584], f32[3584], f32[1,1,3584,896], /*index=85*/f32[3,3,896,1792], f32[1,1,1792,3584], f32[896], f32[896], f32[1792], /*index=90*/f32[1792], f32[3584], f32[3584], f32[1,1,3584,896], f32[3,3,896,1792], /*index=95*/f32[1,1,1792,3584], f32[896], f32[896], f32[1792], f32[1792], /*index=100*/f32[3584], f32[3584], f32[1,1,3584,896], f32[3,3,896,1792], f32[1,1,1792,3584], /*index=105*/f32[1792], f32[1792], f32[3584], f32[3584], f32[7168], /*index=110*/f32[7168], f32[1,1,3584,1792], f32[3,3,1792,3584], f32[1,1,3584,7168], f32[1,1,3584,7168], /*index=115*/f32[7168], f32[7168], f32[1792], f32[1792], f32[3584], /*index=120*/f32[3584], f32[7168], f32[7168], f32[1,1,7168,1792], f32[3,3,1792,3584], /*index=125*/f32[1,1,3584,7168], f32[1792], f32[1792], f32[3584], f32[3584], /*index=130*/f32[7168], f32[7168], f32[1,1,7168,1792], f32[3,3,1792,3584], f32[1,1,3584,7168], /*index=135*/f32[896], f32[896], f32[1792], f32[1792], f32[3584], /*index=140*/f32[3584], f32[1,1,3584,896], f32[3,3,896,1792], f32[1,1,1792,3584], f32[896], /*index=145*/f32[896], f32[1792], f32[1792], f32[3584], f32[3584], /*index=150*/f32[1,1,3584,896], f32[3,3,896,1792], f32[1,1,1792,3584], f32[1024], f32[7168,1024], /*index=155*/s32[], f32[896], f32[896], f32[1792], f32[1792], /*index=160*/f32[3584], f32[3584], f32[896], f32[896], f32[1792], /*index=165*/f32[1792], f32[3584], f32[3584], f32[896], f32[896], /*index=170*/f32[1792], f32[1792], f32[3584], f32[3584], f32[1792], /*index=175*/f32[1792], f32[3584], f32[3584], f32[7168], f32[7168], /*index=180*/f32[7168], f32[7168], f32[1792], f32[1792], f32[3584], /*index=185*/f32[3584], f32[7168], f32[7168], f32[1792], f32[1792], /*index=190*/f32[3584], f32[3584], f32[7168], f32[7168], f32[896], /*index=195*/f32[896], f32[1792], f32[1792], f32[3584], f32[3584], /*index=200*/f32[896], f32[896], f32[1792], f32[1792], f32[3584], /*index=205*/f32[3584], f32[], f32[], f32[]) {
  %param_156 = f32[896]{0} parameter(156), metadata={op_name="1_apply_grad$start"}
  %param_157 = f32[896]{0} parameter(157), metadata={op_name="1_apply_grad$start"}
  %param_158 = f32[1792]{0} parameter(158), metadata={op_name="1_apply_grad$start"}
  %param_159 = f32[1792]{0} parameter(159), metadata={op_name="1_apply_grad$start"}
  %param_160 = f32[3584]{0} parameter(160), metadata={op_name="1_apply_grad$start"}
  %param_161 = f32[3584]{0} parameter(161), metadata={op_name="1_apply_grad$start"}
  %param_162 = f32[896]{0} parameter(162), metadata={op_name="1_apply_grad$start"}
  %param_163 = f32[896]{0} parameter(163), metadata={op_name="1_apply_grad$start"}
  %param_164 = f32[1792]{0} parameter(164), metadata={op_name="1_apply_grad$start"}
  %param_165 = f32[1792]{0} parameter(165), metadata={op_name="1_apply_grad$start"}
  %param_166 = f32[3584]{0} parameter(166), metadata={op_name="1_apply_grad$start"}
  %param_167 = f32[3584]{0} parameter(167), metadata={op_name="1_apply_grad$start"}
  %param_168 = f32[896]{0} parameter(168), metadata={op_name="1_apply_grad$start"}
  %param_169 = f32[896]{0} parameter(169), metadata={op_name="1_apply_grad$start"}
  %param_170 = f32[1792]{0} parameter(170), metadata={op_name="1_apply_grad$start"}
  %param_171 = f32[1792]{0} parameter(171), metadata={op_name="1_apply_grad$start"}
  %param_172 = f32[3584]{0} parameter(172), metadata={op_name="1_apply_grad$start"}
  %param_173 = f32[3584]{0} parameter(173), metadata={op_name="1_apply_grad$start"}
  %param_174 = f32[1792]{0} parameter(174), metadata={op_name="1_apply_grad$start"}
  %param_175 = f32[1792]{0} parameter(175), metadata={op_name="1_apply_grad$start"}
  %param_176 = f32[3584]{0} parameter(176), metadata={op_name="1_apply_grad$start"}
  %param_177 = f32[3584]{0} parameter(177), metadata={op_name="1_apply_grad$start"}
  %param_178 = f32[7168]{0} parameter(178), metadata={op_name="1_apply_grad$start"}
  %param_179 = f32[7168]{0} parameter(179), metadata={op_name="1_apply_grad$start"}
  %param_180 = f32[7168]{0} parameter(180), metadata={op_name="1_apply_grad$start"}
  %param_181 = f32[7168]{0} parameter(181), metadata={op_name="1_apply_grad$start"}
  %param_182 = f32[1792]{0} parameter(182), metadata={op_name="1_apply_grad$start"}
  %param_183 = f32[1792]{0} parameter(183), metadata={op_name="1_apply_grad$start"}
  %param_184 = f32[3584]{0} parameter(184), metadata={op_name="1_apply_grad$start"}
  %param_185 = f32[3584]{0} parameter(185), metadata={op_name="1_apply_grad$start"}
  %param_186 = f32[7168]{0} parameter(186), metadata={op_name="1_apply_grad$start"}
  %param_187 = f32[7168]{0} parameter(187), metadata={op_name="1_apply_grad$start"}
  %param_188 = f32[1792]{0} parameter(188), metadata={op_name="1_apply_grad$start"}
  %param_189 = f32[1792]{0} parameter(189), metadata={op_name="1_apply_grad$start"}
  %param_190 = f32[3584]{0} parameter(190), metadata={op_name="1_apply_grad$start"}
  %param_191 = f32[3584]{0} parameter(191), metadata={op_name="1_apply_grad$start"}
  %param_192 = f32[7168]{0} parameter(192), metadata={op_name="1_apply_grad$start"}
  %param_193 = f32[7168]{0} parameter(193), metadata={op_name="1_apply_grad$start"}
  %param_194 = f32[896]{0} parameter(194), metadata={op_name="1_apply_grad$start"}
  %param_195 = f32[896]{0} parameter(195), metadata={op_name="1_apply_grad$start"}
  %param_196 = f32[1792]{0} parameter(196), metadata={op_name="1_apply_grad$start"}
  %param_197 = f32[1792]{0} parameter(197), metadata={op_name="1_apply_grad$start"}
  %param_198 = f32[3584]{0} parameter(198), metadata={op_name="1_apply_grad$start"}
  %param_199 = f32[3584]{0} parameter(199), metadata={op_name="1_apply_grad$start"}
  %param_200 = f32[896]{0} parameter(200), metadata={op_name="1_apply_grad$start"}
  %param_201 = f32[896]{0} parameter(201), metadata={op_name="1_apply_grad$start"}
  %param_202 = f32[1792]{0} parameter(202), metadata={op_name="1_apply_grad$start"}
  %param_203 = f32[1792]{0} parameter(203), metadata={op_name="1_apply_grad$start"}
  %param_204 = f32[3584]{0} parameter(204), metadata={op_name="1_apply_grad$start"}
  %param_205 = f32[3584]{0} parameter(205), metadata={op_name="1_apply_grad$start"}
  %param_79 = f32[896]{0} parameter(79), metadata={op_name="1_apply_grad$start"}
  %param_207 = f32[896]{0} parameter(207), metadata={op_name="1_apply_grad$start"}
  %param_77 = s32[] parameter(77), metadata={op_name="1_apply_grad$start"}
  %copy.77 = s32[] copy(s32[] %param_77)
  %param_78 = f32[896]{0} parameter(78), metadata={op_name="1_apply_grad$start"}
  %param_206 = f32[896]{0} parameter(206), metadata={op_name="1_apply_grad$start"}
  %param_145 = f32[896]{0} parameter(145), metadata={op_name="1_apply_grad$start"}
  %param_273 = f32[896]{0} parameter(273), metadata={op_name="1_apply_grad$start"}
  %param_144 = f32[896]{0} parameter(144), metadata={op_name="1_apply_grad$start"}
  %param_272 = f32[896]{0} parameter(272), metadata={op_name="1_apply_grad$start"}
  %param_136 = f32[896]{0} parameter(136), metadata={op_name="1_apply_grad$start"}
  %param_264 = f32[896]{0} parameter(264), metadata={op_name="1_apply_grad$start"}
  %param_135 = f32[896]{0} parameter(135), metadata={op_name="1_apply_grad$start"}
  %param_263 = f32[896]{0} parameter(263), metadata={op_name="1_apply_grad$start"}
  %param_97 = f32[896]{0} parameter(97), metadata={op_name="1_apply_grad$start"}
  %param_225 = f32[896]{0} parameter(225), metadata={op_name="1_apply_grad$start"}
  %param_96 = f32[896]{0} parameter(96), metadata={op_name="1_apply_grad$start"}
  %param_224 = f32[896]{0} parameter(224), metadata={op_name="1_apply_grad$start"}
  %param_88 = f32[896]{0} parameter(88), metadata={op_name="1_apply_grad$start"}
  %param_216 = f32[896]{0} parameter(216), metadata={op_name="1_apply_grad$start"}
  %param_87 = f32[896]{0} parameter(87), metadata={op_name="1_apply_grad$start"}
  %param_215 = f32[896]{0} parameter(215), metadata={op_name="1_apply_grad$start"}
  %param_67 = f32[896]{0} parameter(67), metadata={op_name="1_apply_grad$start"}
  %param_66 = f32[896]{0} parameter(66), metadata={op_name="1_apply_grad$start"}
  %param_58 = f32[896]{0} parameter(58), metadata={op_name="1_apply_grad$start"}
  %param_57 = f32[896]{0} parameter(57), metadata={op_name="1_apply_grad$start"}
  %param_19 = f32[896]{0} parameter(19), metadata={op_name="1_apply_grad$start"}
  %param_18 = f32[896]{0} parameter(18), metadata={op_name="1_apply_grad$start"}
  %param_10 = f32[896]{0} parameter(10), metadata={op_name="1_apply_grad$start"}
  %param_9 = f32[896]{0} parameter(9), metadata={op_name="1_apply_grad$start"}
  %param_1 = f32[896]{0} parameter(1), metadata={op_name="1_apply_grad$start"}
  %param_0 = f32[896]{0} parameter(0), metadata={op_name="1_apply_grad$start"}
  %fusion.125 = (f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) fusion(f32[896]{0} %param_79, f32[896]{0} %param_207, s32[] %copy.77, f32[896]{0} %param_78, f32[896]{0} %param_206, /*index=5*/f32[896]{0} %param_145, f32[896]{0} %param_273, f32[896]{0} %param_144, f32[896]{0} %param_272, f32[896]{0} %param_136, /*index=10*/f32[896]{0} %param_264, f32[896]{0} %param_135, f32[896]{0} %param_263, f32[896]{0} %param_97, f32[896]{0} %param_225, /*index=15*/f32[896]{0} %param_96, f32[896]{0} %param_224, f32[896]{0} %param_88, f32[896]{0} %param_216, f32[896]{0} %param_87, /*index=20*/f32[896]{0} %param_215, f32[896]{0} %param_67, f32[896]{0} %param_66, f32[896]{0} %param_58, f32[896]{0} %param_57, /*index=25*/f32[896]{0} %param_19, f32[896]{0} %param_18, f32[896]{0} %param_10, f32[896]{0} %param_9, f32[896]{0} %param_1, /*index=30*/f32[896]{0} %param_0), kind=kLoop, calls=%fused_computation.125, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.207 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=19
  %get-tuple-element.208 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=18
  %param_2 = f32[1792]{0} parameter(2), metadata={op_name="1_apply_grad$start"}
  %param_208 = f32[1792]{0} parameter(208), metadata={op_name="1_apply_grad$start"}
  %param_60 = f32[1792]{0} parameter(60), metadata={op_name="1_apply_grad$start"}
  %param_266 = f32[1792]{0} parameter(266), metadata={op_name="1_apply_grad$start"}
  %param_59 = f32[1792]{0} parameter(59), metadata={op_name="1_apply_grad$start"}
  %param_265 = f32[1792]{0} parameter(265), metadata={op_name="1_apply_grad$start"}
  %param_49 = f32[1792]{0} parameter(49), metadata={op_name="1_apply_grad$start"}
  %param_255 = f32[1792]{0} parameter(255), metadata={op_name="1_apply_grad$start"}
  %param_48 = f32[1792]{0} parameter(48), metadata={op_name="1_apply_grad$start"}
  %param_254 = f32[1792]{0} parameter(254), metadata={op_name="1_apply_grad$start"}
  %param_40 = f32[1792]{0} parameter(40), metadata={op_name="1_apply_grad$start"}
  %param_246 = f32[1792]{0} parameter(246), metadata={op_name="1_apply_grad$start"}
  %param_39 = f32[1792]{0} parameter(39), metadata={op_name="1_apply_grad$start"}
  %param_245 = f32[1792]{0} parameter(245), metadata={op_name="1_apply_grad$start"}
  %param_28 = f32[1792]{0} parameter(28), metadata={op_name="1_apply_grad$start"}
  %param_234 = f32[1792]{0} parameter(234), metadata={op_name="1_apply_grad$start"}
  %param_27 = f32[1792]{0} parameter(27), metadata={op_name="1_apply_grad$start"}
  %param_233 = f32[1792]{0} parameter(233), metadata={op_name="1_apply_grad$start"}
  %param_21 = f32[1792]{0} parameter(21), metadata={op_name="1_apply_grad$start"}
  %param_227 = f32[1792]{0} parameter(227), metadata={op_name="1_apply_grad$start"}
  %param_20 = f32[1792]{0} parameter(20), metadata={op_name="1_apply_grad$start"}
  %param_226 = f32[1792]{0} parameter(226), metadata={op_name="1_apply_grad$start"}
  %param_12 = f32[1792]{0} parameter(12), metadata={op_name="1_apply_grad$start"}
  %param_218 = f32[1792]{0} parameter(218), metadata={op_name="1_apply_grad$start"}
  %param_11 = f32[1792]{0} parameter(11), metadata={op_name="1_apply_grad$start"}
  %param_217 = f32[1792]{0} parameter(217), metadata={op_name="1_apply_grad$start"}
  %fusion.290 = (f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) fusion(f32[1792]{0} %param_2, f32[1792]{0} %param_208, f32[1792]{0} %param_60, f32[1792]{0} %param_266, f32[1792]{0} %param_59, /*index=5*/f32[1792]{0} %param_265, f32[1792]{0} %param_49, f32[1792]{0} %param_255, f32[1792]{0} %param_48, f32[1792]{0} %param_254, /*index=10*/f32[1792]{0} %param_40, f32[1792]{0} %param_246, f32[1792]{0} %param_39, f32[1792]{0} %param_245, f32[1792]{0} %param_28, /*index=15*/f32[1792]{0} %param_234, f32[1792]{0} %param_27, f32[1792]{0} %param_233, f32[1792]{0} %param_21, f32[1792]{0} %param_227, /*index=20*/f32[1792]{0} %param_20, f32[1792]{0} %param_226, f32[1792]{0} %param_12, f32[1792]{0} %param_218, f32[1792]{0} %param_11, /*index=25*/f32[1792]{0} %param_217), kind=kInput, calls=%horizontally_fused_computation.4, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.209 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=0, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_81 = f32[1792]{0} parameter(81), metadata={op_name="1_apply_grad$start"}
  %param_209 = f32[1792]{0} parameter(209), metadata={op_name="1_apply_grad$start"}
  %param_3 = f32[1792]{0} parameter(3), metadata={op_name="1_apply_grad$start"}
  %fusion.123 = (f32[1792]{0}, f32[1792]{0}) fusion(f32[1792]{0} %param_81, f32[1792]{0} %param_209, s32[] %copy.77, f32[1792]{0} %param_3), kind=kLoop, calls=%fused_computation.123, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.210 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}) %fusion.123), index=1
  %param_4 = f32[3584]{0} parameter(4), metadata={op_name="1_apply_grad$start"}
  %param_210 = f32[3584]{0} parameter(210), metadata={op_name="1_apply_grad$start"}
  %param_62 = f32[3584]{0} parameter(62), metadata={op_name="1_apply_grad$start"}
  %param_268 = f32[3584]{0} parameter(268), metadata={op_name="1_apply_grad$start"}
  %param_61 = f32[3584]{0} parameter(61), metadata={op_name="1_apply_grad$start"}
  %param_267 = f32[3584]{0} parameter(267), metadata={op_name="1_apply_grad$start"}
  %param_51 = f32[3584]{0} parameter(51), metadata={op_name="1_apply_grad$start"}
  %param_257 = f32[3584]{0} parameter(257), metadata={op_name="1_apply_grad$start"}
  %param_50 = f32[3584]{0} parameter(50), metadata={op_name="1_apply_grad$start"}
  %param_256 = f32[3584]{0} parameter(256), metadata={op_name="1_apply_grad$start"}
  %param_42 = f32[3584]{0} parameter(42), metadata={op_name="1_apply_grad$start"}
  %param_248 = f32[3584]{0} parameter(248), metadata={op_name="1_apply_grad$start"}
  %param_41 = f32[3584]{0} parameter(41), metadata={op_name="1_apply_grad$start"}
  %param_247 = f32[3584]{0} parameter(247), metadata={op_name="1_apply_grad$start"}
  %param_30 = f32[3584]{0} parameter(30), metadata={op_name="1_apply_grad$start"}
  %param_236 = f32[3584]{0} parameter(236), metadata={op_name="1_apply_grad$start"}
  %param_29 = f32[3584]{0} parameter(29), metadata={op_name="1_apply_grad$start"}
  %param_235 = f32[3584]{0} parameter(235), metadata={op_name="1_apply_grad$start"}
  %param_23 = f32[3584]{0} parameter(23), metadata={op_name="1_apply_grad$start"}
  %param_229 = f32[3584]{0} parameter(229), metadata={op_name="1_apply_grad$start"}
  %param_22 = f32[3584]{0} parameter(22), metadata={op_name="1_apply_grad$start"}
  %param_228 = f32[3584]{0} parameter(228), metadata={op_name="1_apply_grad$start"}
  %param_14 = f32[3584]{0} parameter(14), metadata={op_name="1_apply_grad$start"}
  %param_220 = f32[3584]{0} parameter(220), metadata={op_name="1_apply_grad$start"}
  %param_13 = f32[3584]{0} parameter(13), metadata={op_name="1_apply_grad$start"}
  %param_219 = f32[3584]{0} parameter(219), metadata={op_name="1_apply_grad$start"}
  %fusion.289 = (f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) fusion(f32[3584]{0} %param_4, f32[3584]{0} %param_210, f32[3584]{0} %param_62, f32[3584]{0} %param_268, f32[3584]{0} %param_61, /*index=5*/f32[3584]{0} %param_267, f32[3584]{0} %param_51, f32[3584]{0} %param_257, f32[3584]{0} %param_50, f32[3584]{0} %param_256, /*index=10*/f32[3584]{0} %param_42, f32[3584]{0} %param_248, f32[3584]{0} %param_41, f32[3584]{0} %param_247, f32[3584]{0} %param_30, /*index=15*/f32[3584]{0} %param_236, f32[3584]{0} %param_29, f32[3584]{0} %param_235, f32[3584]{0} %param_23, f32[3584]{0} %param_229, /*index=20*/f32[3584]{0} %param_22, f32[3584]{0} %param_228, f32[3584]{0} %param_14, f32[3584]{0} %param_220, f32[3584]{0} %param_13, /*index=25*/f32[3584]{0} %param_219), kind=kInput, calls=%horizontally_fused_computation.3, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.211 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=0, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_83 = f32[3584]{0} parameter(83), metadata={op_name="1_apply_grad$start"}
  %param_211 = f32[3584]{0} parameter(211), metadata={op_name="1_apply_grad$start"}
  %param_5 = f32[3584]{0} parameter(5), metadata={op_name="1_apply_grad$start"}
  %fusion.121 = (f32[3584]{0}, f32[3584]{0}) fusion(f32[3584]{0} %param_83, f32[3584]{0} %param_211, s32[] %copy.77, f32[3584]{0} %param_5), kind=kLoop, calls=%fused_computation.121, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.212 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}) %fusion.121), index=1
  %param_84 = f32[1,1,3584,896]{3,2,1,0} parameter(84), metadata={op_name="1_apply_grad$start"}
  %param_212 = f32[1,1,3584,896]{3,2,1,0} parameter(212), metadata={op_name="1_apply_grad$start"}
  %param_150 = f32[1,1,3584,896]{3,2,1,0} parameter(150), metadata={op_name="1_apply_grad$start"}
  %param_278 = f32[1,1,3584,896]{3,2,1,0} parameter(278), metadata={op_name="1_apply_grad$start"}
  %param_141 = f32[1,1,3584,896]{3,2,1,0} parameter(141), metadata={op_name="1_apply_grad$start"}
  %param_269 = f32[1,1,3584,896]{3,2,1,0} parameter(269), metadata={op_name="1_apply_grad$start"}
  %param_102 = f32[1,1,3584,896]{3,2,1,0} parameter(102), metadata={op_name="1_apply_grad$start"}
  %param_230 = f32[1,1,3584,896]{3,2,1,0} parameter(230), metadata={op_name="1_apply_grad$start"}
  %param_93 = f32[1,1,3584,896]{3,2,1,0} parameter(93), metadata={op_name="1_apply_grad$start"}
  %param_221 = f32[1,1,3584,896]{3,2,1,0} parameter(221), metadata={op_name="1_apply_grad$start"}
  %param_72 = f32[1,1,3584,896]{3,2,1,0} parameter(72), metadata={op_name="1_apply_grad$start"}
  %param_63 = f32[1,1,3584,896]{3,2,1,0} parameter(63), metadata={op_name="1_apply_grad$start"}
  %param_24 = f32[1,1,3584,896]{3,2,1,0} parameter(24), metadata={op_name="1_apply_grad$start"}
  %param_15 = f32[1,1,3584,896]{3,2,1,0} parameter(15), metadata={op_name="1_apply_grad$start"}
  %param_6 = f32[1,1,3584,896]{3,2,1,0} parameter(6), metadata={op_name="1_apply_grad$start"}
  %fusion.120 = (f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) fusion(f32[1,1,3584,896]{3,2,1,0} %param_84, f32[1,1,3584,896]{3,2,1,0} %param_212, s32[] %copy.77, f32[1,1,3584,896]{3,2,1,0} %param_150, f32[1,1,3584,896]{3,2,1,0} %param_278, /*index=5*/f32[1,1,3584,896]{3,2,1,0} %param_141, f32[1,1,3584,896]{3,2,1,0} %param_269, f32[1,1,3584,896]{3,2,1,0} %param_102, f32[1,1,3584,896]{3,2,1,0} %param_230, f32[1,1,3584,896]{3,2,1,0} %param_93, /*index=10*/f32[1,1,3584,896]{3,2,1,0} %param_221, f32[1,1,3584,896]{3,2,1,0} %param_72, f32[1,1,3584,896]{3,2,1,0} %param_63, f32[1,1,3584,896]{3,2,1,0} %param_24, f32[1,1,3584,896]{3,2,1,0} %param_15, /*index=15*/f32[1,1,3584,896]{3,2,1,0} %param_6), kind=kLoop, calls=%fused_computation.120, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.213 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=9
  %param_85 = f32[3,3,896,1792]{3,2,1,0} parameter(85), metadata={op_name="1_apply_grad$start"}
  %param_213 = f32[3,3,896,1792]{3,2,1,0} parameter(213), metadata={op_name="1_apply_grad$start"}
  %param_151 = f32[3,3,896,1792]{3,2,1,0} parameter(151), metadata={op_name="1_apply_grad$start"}
  %param_279 = f32[3,3,896,1792]{3,2,1,0} parameter(279), metadata={op_name="1_apply_grad$start"}
  %param_142 = f32[3,3,896,1792]{3,2,1,0} parameter(142), metadata={op_name="1_apply_grad$start"}
  %param_270 = f32[3,3,896,1792]{3,2,1,0} parameter(270), metadata={op_name="1_apply_grad$start"}
  %param_103 = f32[3,3,896,1792]{3,2,1,0} parameter(103), metadata={op_name="1_apply_grad$start"}
  %param_231 = f32[3,3,896,1792]{3,2,1,0} parameter(231), metadata={op_name="1_apply_grad$start"}
  %param_94 = f32[3,3,896,1792]{3,2,1,0} parameter(94), metadata={op_name="1_apply_grad$start"}
  %param_222 = f32[3,3,896,1792]{3,2,1,0} parameter(222), metadata={op_name="1_apply_grad$start"}
  %param_73 = f32[3,3,896,1792]{3,2,1,0} parameter(73), metadata={op_name="1_apply_grad$start"}
  %param_64 = f32[3,3,896,1792]{3,2,1,0} parameter(64), metadata={op_name="1_apply_grad$start"}
  %param_25 = f32[3,3,896,1792]{3,2,1,0} parameter(25), metadata={op_name="1_apply_grad$start"}
  %param_16 = f32[3,3,896,1792]{3,2,1,0} parameter(16), metadata={op_name="1_apply_grad$start"}
  %param_7 = f32[3,3,896,1792]{3,2,1,0} parameter(7), metadata={op_name="1_apply_grad$start"}
  %fusion.119 = (f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) fusion(f32[3,3,896,1792]{3,2,1,0} %param_85, f32[3,3,896,1792]{3,2,1,0} %param_213, s32[] %copy.77, f32[3,3,896,1792]{3,2,1,0} %param_151, f32[3,3,896,1792]{3,2,1,0} %param_279, /*index=5*/f32[3,3,896,1792]{3,2,1,0} %param_142, f32[3,3,896,1792]{3,2,1,0} %param_270, f32[3,3,896,1792]{3,2,1,0} %param_103, f32[3,3,896,1792]{3,2,1,0} %param_231, f32[3,3,896,1792]{3,2,1,0} %param_94, /*index=10*/f32[3,3,896,1792]{3,2,1,0} %param_222, f32[3,3,896,1792]{3,2,1,0} %param_73, f32[3,3,896,1792]{3,2,1,0} %param_64, f32[3,3,896,1792]{3,2,1,0} %param_25, f32[3,3,896,1792]{3,2,1,0} %param_16, /*index=15*/f32[3,3,896,1792]{3,2,1,0} %param_7), kind=kLoop, calls=%fused_computation.119, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.214 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=9
  %param_86 = f32[1,1,1792,3584]{3,2,1,0} parameter(86), metadata={op_name="1_apply_grad$start"}
  %param_214 = f32[1,1,1792,3584]{3,2,1,0} parameter(214), metadata={op_name="1_apply_grad$start"}
  %param_152 = f32[1,1,1792,3584]{3,2,1,0} parameter(152), metadata={op_name="1_apply_grad$start"}
  %param_280 = f32[1,1,1792,3584]{3,2,1,0} parameter(280), metadata={op_name="1_apply_grad$start"}
  %param_143 = f32[1,1,1792,3584]{3,2,1,0} parameter(143), metadata={op_name="1_apply_grad$start"}
  %param_271 = f32[1,1,1792,3584]{3,2,1,0} parameter(271), metadata={op_name="1_apply_grad$start"}
  %param_104 = f32[1,1,1792,3584]{3,2,1,0} parameter(104), metadata={op_name="1_apply_grad$start"}
  %param_232 = f32[1,1,1792,3584]{3,2,1,0} parameter(232), metadata={op_name="1_apply_grad$start"}
  %param_95 = f32[1,1,1792,3584]{3,2,1,0} parameter(95), metadata={op_name="1_apply_grad$start"}
  %param_223 = f32[1,1,1792,3584]{3,2,1,0} parameter(223), metadata={op_name="1_apply_grad$start"}
  %param_74 = f32[1,1,1792,3584]{3,2,1,0} parameter(74), metadata={op_name="1_apply_grad$start"}
  %param_65 = f32[1,1,1792,3584]{3,2,1,0} parameter(65), metadata={op_name="1_apply_grad$start"}
  %param_26 = f32[1,1,1792,3584]{3,2,1,0} parameter(26), metadata={op_name="1_apply_grad$start"}
  %param_17 = f32[1,1,1792,3584]{3,2,1,0} parameter(17), metadata={op_name="1_apply_grad$start"}
  %param_8 = f32[1,1,1792,3584]{3,2,1,0} parameter(8), metadata={op_name="1_apply_grad$start"}
  %fusion.118 = (f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) fusion(f32[1,1,1792,3584]{3,2,1,0} %param_86, f32[1,1,1792,3584]{3,2,1,0} %param_214, s32[] %copy.77, f32[1,1,1792,3584]{3,2,1,0} %param_152, f32[1,1,1792,3584]{3,2,1,0} %param_280, /*index=5*/f32[1,1,1792,3584]{3,2,1,0} %param_143, f32[1,1,1792,3584]{3,2,1,0} %param_271, f32[1,1,1792,3584]{3,2,1,0} %param_104, f32[1,1,1792,3584]{3,2,1,0} %param_232, f32[1,1,1792,3584]{3,2,1,0} %param_95, /*index=10*/f32[1,1,1792,3584]{3,2,1,0} %param_223, f32[1,1,1792,3584]{3,2,1,0} %param_74, f32[1,1,1792,3584]{3,2,1,0} %param_65, f32[1,1,1792,3584]{3,2,1,0} %param_26, f32[1,1,1792,3584]{3,2,1,0} %param_17, /*index=15*/f32[1,1,1792,3584]{3,2,1,0} %param_8), kind=kLoop, calls=%fused_computation.118, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.215 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=9
  %get-tuple-element.216 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=17
  %get-tuple-element.217 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=16
  %get-tuple-element.218 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=12, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.219 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=11, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.220 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=12, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.221 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=11, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.222 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=8
  %get-tuple-element.223 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=8
  %get-tuple-element.224 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=8
  %get-tuple-element.225 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=15
  %get-tuple-element.226 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=14
  %get-tuple-element.227 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=10, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.228 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=9, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.229 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=10, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.230 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=9, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.231 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=7
  %get-tuple-element.232 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=7
  %get-tuple-element.233 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=7
  %get-tuple-element.234 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=8, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.235 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=7, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.236 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=8, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.237 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=7, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %param_109 = f32[7168]{0} parameter(109), metadata={op_name="1_apply_grad$start"}
  %param_237 = f32[7168]{0} parameter(237), metadata={op_name="1_apply_grad$start"}
  %param_131 = f32[7168]{0} parameter(131), metadata={op_name="1_apply_grad$start"}
  %param_259 = f32[7168]{0} parameter(259), metadata={op_name="1_apply_grad$start"}
  %param_130 = f32[7168]{0} parameter(130), metadata={op_name="1_apply_grad$start"}
  %param_258 = f32[7168]{0} parameter(258), metadata={op_name="1_apply_grad$start"}
  %param_122 = f32[7168]{0} parameter(122), metadata={op_name="1_apply_grad$start"}
  %param_250 = f32[7168]{0} parameter(250), metadata={op_name="1_apply_grad$start"}
  %param_121 = f32[7168]{0} parameter(121), metadata={op_name="1_apply_grad$start"}
  %param_249 = f32[7168]{0} parameter(249), metadata={op_name="1_apply_grad$start"}
  %param_116 = f32[7168]{0} parameter(116), metadata={op_name="1_apply_grad$start"}
  %param_244 = f32[7168]{0} parameter(244), metadata={op_name="1_apply_grad$start"}
  %param_115 = f32[7168]{0} parameter(115), metadata={op_name="1_apply_grad$start"}
  %param_243 = f32[7168]{0} parameter(243), metadata={op_name="1_apply_grad$start"}
  %param_110 = f32[7168]{0} parameter(110), metadata={op_name="1_apply_grad$start"}
  %param_238 = f32[7168]{0} parameter(238), metadata={op_name="1_apply_grad$start"}
  %param_53 = f32[7168]{0} parameter(53), metadata={op_name="1_apply_grad$start"}
  %param_52 = f32[7168]{0} parameter(52), metadata={op_name="1_apply_grad$start"}
  %param_44 = f32[7168]{0} parameter(44), metadata={op_name="1_apply_grad$start"}
  %param_43 = f32[7168]{0} parameter(43), metadata={op_name="1_apply_grad$start"}
  %param_38 = f32[7168]{0} parameter(38), metadata={op_name="1_apply_grad$start"}
  %param_37 = f32[7168]{0} parameter(37), metadata={op_name="1_apply_grad$start"}
  %param_32 = f32[7168]{0} parameter(32), metadata={op_name="1_apply_grad$start"}
  %param_31 = f32[7168]{0} parameter(31), metadata={op_name="1_apply_grad$start"}
  %fusion.95 = (f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) fusion(f32[7168]{0} %param_109, f32[7168]{0} %param_237, s32[] %copy.77, f32[7168]{0} %param_131, f32[7168]{0} %param_259, /*index=5*/f32[7168]{0} %param_130, f32[7168]{0} %param_258, f32[7168]{0} %param_122, f32[7168]{0} %param_250, f32[7168]{0} %param_121, /*index=10*/f32[7168]{0} %param_249, f32[7168]{0} %param_116, f32[7168]{0} %param_244, f32[7168]{0} %param_115, f32[7168]{0} %param_243, /*index=15*/f32[7168]{0} %param_110, f32[7168]{0} %param_238, f32[7168]{0} %param_53, f32[7168]{0} %param_52, f32[7168]{0} %param_44, /*index=20*/f32[7168]{0} %param_43, f32[7168]{0} %param_38, f32[7168]{0} %param_37, f32[7168]{0} %param_32, f32[7168]{0} %param_31), kind=kLoop, calls=%fused_computation.95, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.238 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=15
  %get-tuple-element.239 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=14
  %param_111 = f32[1,1,3584,1792]{3,2,1,0} parameter(111), metadata={op_name="1_apply_grad$start"}
  %param_239 = f32[1,1,3584,1792]{3,2,1,0} parameter(239), metadata={op_name="1_apply_grad$start"}
  %param_33 = f32[1,1,3584,1792]{3,2,1,0} parameter(33), metadata={op_name="1_apply_grad$start"}
  %fusion.93 = (f32[1,1,3584,1792]{3,2,1,0}, f32[1,1,3584,1792]{3,2,1,0}) fusion(f32[1,1,3584,1792]{3,2,1,0} %param_111, f32[1,1,3584,1792]{3,2,1,0} %param_239, s32[] %copy.77, f32[1,1,3584,1792]{3,2,1,0} %param_33), kind=kLoop, calls=%fused_computation.93, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.240 = f32[1,1,3584,1792]{3,2,1,0} get-tuple-element((f32[1,1,3584,1792]{3,2,1,0}, f32[1,1,3584,1792]{3,2,1,0}) %fusion.93), index=1
  %param_112 = f32[3,3,1792,3584]{3,2,1,0} parameter(112), metadata={op_name="1_apply_grad$start"}
  %param_240 = f32[3,3,1792,3584]{3,2,1,0} parameter(240), metadata={op_name="1_apply_grad$start"}
  %param_133 = f32[3,3,1792,3584]{3,2,1,0} parameter(133), metadata={op_name="1_apply_grad$start"}
  %param_261 = f32[3,3,1792,3584]{3,2,1,0} parameter(261), metadata={op_name="1_apply_grad$start"}
  %param_124 = f32[3,3,1792,3584]{3,2,1,0} parameter(124), metadata={op_name="1_apply_grad$start"}
  %param_252 = f32[3,3,1792,3584]{3,2,1,0} parameter(252), metadata={op_name="1_apply_grad$start"}
  %param_55 = f32[3,3,1792,3584]{3,2,1,0} parameter(55), metadata={op_name="1_apply_grad$start"}
  %param_46 = f32[3,3,1792,3584]{3,2,1,0} parameter(46), metadata={op_name="1_apply_grad$start"}
  %param_34 = f32[3,3,1792,3584]{3,2,1,0} parameter(34), metadata={op_name="1_apply_grad$start"}
  %fusion.92 = (f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=5*/f32[3,3,1792,3584]{3,2,1,0}) fusion(f32[3,3,1792,3584]{3,2,1,0} %param_112, f32[3,3,1792,3584]{3,2,1,0} %param_240, s32[] %copy.77, f32[3,3,1792,3584]{3,2,1,0} %param_133, f32[3,3,1792,3584]{3,2,1,0} %param_261, /*index=5*/f32[3,3,1792,3584]{3,2,1,0} %param_124, f32[3,3,1792,3584]{3,2,1,0} %param_252, f32[3,3,1792,3584]{3,2,1,0} %param_55, f32[3,3,1792,3584]{3,2,1,0} %param_46, f32[3,3,1792,3584]{3,2,1,0} %param_34), kind=kLoop, calls=%fused_computation.92, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.241 = f32[3,3,1792,3584]{3,2,1,0} get-tuple-element((f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=5*/f32[3,3,1792,3584]{3,2,1,0}) %fusion.92), index=5
  %param_113 = f32[1,1,3584,7168]{3,2,1,0} parameter(113), metadata={op_name="1_apply_grad$start"}
  %param_241 = f32[1,1,3584,7168]{3,2,1,0} parameter(241), metadata={op_name="1_apply_grad$start"}
  %param_134 = f32[1,1,3584,7168]{3,2,1,0} parameter(134), metadata={op_name="1_apply_grad$start"}
  %param_262 = f32[1,1,3584,7168]{3,2,1,0} parameter(262), metadata={op_name="1_apply_grad$start"}
  %param_125 = f32[1,1,3584,7168]{3,2,1,0} parameter(125), metadata={op_name="1_apply_grad$start"}
  %param_253 = f32[1,1,3584,7168]{3,2,1,0} parameter(253), metadata={op_name="1_apply_grad$start"}
  %param_114 = f32[1,1,3584,7168]{3,2,1,0} parameter(114), metadata={op_name="1_apply_grad$start"}
  %param_242 = f32[1,1,3584,7168]{3,2,1,0} parameter(242), metadata={op_name="1_apply_grad$start"}
  %param_56 = f32[1,1,3584,7168]{3,2,1,0} parameter(56), metadata={op_name="1_apply_grad$start"}
  %param_47 = f32[1,1,3584,7168]{3,2,1,0} parameter(47), metadata={op_name="1_apply_grad$start"}
  %param_36 = f32[1,1,3584,7168]{3,2,1,0} parameter(36), metadata={op_name="1_apply_grad$start"}
  %param_35 = f32[1,1,3584,7168]{3,2,1,0} parameter(35), metadata={op_name="1_apply_grad$start"}
  %fusion.91 = (f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) fusion(f32[1,1,3584,7168]{3,2,1,0} %param_113, f32[1,1,3584,7168]{3,2,1,0} %param_241, s32[] %copy.77, f32[1,1,3584,7168]{3,2,1,0} %param_134, f32[1,1,3584,7168]{3,2,1,0} %param_262, /*index=5*/f32[1,1,3584,7168]{3,2,1,0} %param_125, f32[1,1,3584,7168]{3,2,1,0} %param_253, f32[1,1,3584,7168]{3,2,1,0} %param_114, f32[1,1,3584,7168]{3,2,1,0} %param_242, f32[1,1,3584,7168]{3,2,1,0} %param_56, /*index=10*/f32[1,1,3584,7168]{3,2,1,0} %param_47, f32[1,1,3584,7168]{3,2,1,0} %param_36, f32[1,1,3584,7168]{3,2,1,0} %param_35), kind=kLoop, calls=%fused_computation.91, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.242 = f32[1,1,3584,7168]{3,2,1,0} get-tuple-element((f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) %fusion.91), index=7
  %get-tuple-element.243 = f32[1,1,3584,7168]{3,2,1,0} get-tuple-element((f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) %fusion.91), index=6
  %get-tuple-element.244 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=13
  %get-tuple-element.245 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=12
  %get-tuple-element.246 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=6, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.247 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=5, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.248 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=6, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.249 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=5, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.250 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=11
  %get-tuple-element.251 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=10
  %param_123 = f32[1,1,7168,1792]{3,2,1,0} parameter(123), metadata={op_name="1_apply_grad$start"}
  %param_251 = f32[1,1,7168,1792]{3,2,1,0} parameter(251), metadata={op_name="1_apply_grad$start"}
  %param_132 = f32[1,1,7168,1792]{3,2,1,0} parameter(132), metadata={op_name="1_apply_grad$start"}
  %param_260 = f32[1,1,7168,1792]{3,2,1,0} parameter(260), metadata={op_name="1_apply_grad$start"}
  %param_54 = f32[1,1,7168,1792]{3,2,1,0} parameter(54), metadata={op_name="1_apply_grad$start"}
  %param_45 = f32[1,1,7168,1792]{3,2,1,0} parameter(45), metadata={op_name="1_apply_grad$start"}
  %fusion.81 = (f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}) fusion(f32[1,1,7168,1792]{3,2,1,0} %param_123, f32[1,1,7168,1792]{3,2,1,0} %param_251, s32[] %copy.77, f32[1,1,7168,1792]{3,2,1,0} %param_132, f32[1,1,7168,1792]{3,2,1,0} %param_260, /*index=5*/f32[1,1,7168,1792]{3,2,1,0} %param_54, f32[1,1,7168,1792]{3,2,1,0} %param_45), kind=kLoop, calls=%fused_computation.81, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.252 = f32[1,1,7168,1792]{3,2,1,0} get-tuple-element((f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}) %fusion.81), index=3
  %get-tuple-element.253 = f32[3,3,1792,3584]{3,2,1,0} get-tuple-element((f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=5*/f32[3,3,1792,3584]{3,2,1,0}) %fusion.92), index=4
  %get-tuple-element.254 = f32[1,1,3584,7168]{3,2,1,0} get-tuple-element((f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) %fusion.91), index=5
  %get-tuple-element.255 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=4, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.256 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=3, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.257 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=4, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.258 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=3, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.259 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=9
  %get-tuple-element.260 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=8
  %get-tuple-element.261 = f32[1,1,7168,1792]{3,2,1,0} get-tuple-element((f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}) %fusion.81), index=2
  %get-tuple-element.262 = f32[3,3,1792,3584]{3,2,1,0} get-tuple-element((f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=5*/f32[3,3,1792,3584]{3,2,1,0}) %fusion.92), index=3
  %get-tuple-element.263 = f32[1,1,3584,7168]{3,2,1,0} get-tuple-element((f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) %fusion.91), index=4
  %get-tuple-element.264 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=13
  %get-tuple-element.265 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=12
  %get-tuple-element.266 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=2, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.267 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}) %fusion.290), index=1, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.268 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=2, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.269 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}) %fusion.289), index=1, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/transform.py" source_line=70}
  %get-tuple-element.270 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=6
  %get-tuple-element.271 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=6
  %get-tuple-element.272 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=6
  %get-tuple-element.273 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=11
  %get-tuple-element.274 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=10
  %param_80 = f32[1792]{0} parameter(80), metadata={op_name="1_apply_grad$start"}
  %param_147 = f32[1792]{0} parameter(147), metadata={op_name="1_apply_grad$start"}
  %param_275 = f32[1792]{0} parameter(275), metadata={op_name="1_apply_grad$start"}
  %param_146 = f32[1792]{0} parameter(146), metadata={op_name="1_apply_grad$start"}
  %param_274 = f32[1792]{0} parameter(274), metadata={op_name="1_apply_grad$start"}
  %param_138 = f32[1792]{0} parameter(138), metadata={op_name="1_apply_grad$start"}
  %param_137 = f32[1792]{0} parameter(137), metadata={op_name="1_apply_grad$start"}
  %param_127 = f32[1792]{0} parameter(127), metadata={op_name="1_apply_grad$start"}
  %param_126 = f32[1792]{0} parameter(126), metadata={op_name="1_apply_grad$start"}
  %param_118 = f32[1792]{0} parameter(118), metadata={op_name="1_apply_grad$start"}
  %param_117 = f32[1792]{0} parameter(117), metadata={op_name="1_apply_grad$start"}
  %param_106 = f32[1792]{0} parameter(106), metadata={op_name="1_apply_grad$start"}
  %param_105 = f32[1792]{0} parameter(105), metadata={op_name="1_apply_grad$start"}
  %param_99 = f32[1792]{0} parameter(99), metadata={op_name="1_apply_grad$start"}
  %param_98 = f32[1792]{0} parameter(98), metadata={op_name="1_apply_grad$start"}
  %param_90 = f32[1792]{0} parameter(90), metadata={op_name="1_apply_grad$start"}
  %param_89 = f32[1792]{0} parameter(89), metadata={op_name="1_apply_grad$start"}
  %param_69 = f32[1792]{0} parameter(69), metadata={op_name="1_apply_grad$start"}
  %param_68 = f32[1792]{0} parameter(68), metadata={op_name="1_apply_grad$start"}
  %fusion.124 = (f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) fusion(f32[1792]{0} %param_80, f32[1792]{0} %get-tuple-element.209, f32[1792]{0} %param_208, s32[] %copy.77, f32[1792]{0} %param_147, /*index=5*/f32[1792]{0} %param_275, f32[1792]{0} %param_146, f32[1792]{0} %param_274, f32[1792]{0} %param_138, f32[1792]{0} %get-tuple-element.267, /*index=10*/f32[1792]{0} %param_266, f32[1792]{0} %param_137, f32[1792]{0} %get-tuple-element.266, f32[1792]{0} %param_265, f32[1792]{0} %param_127, /*index=15*/f32[1792]{0} %get-tuple-element.256, f32[1792]{0} %param_255, f32[1792]{0} %param_126, f32[1792]{0} %get-tuple-element.255, f32[1792]{0} %param_254, /*index=20*/f32[1792]{0} %param_118, f32[1792]{0} %get-tuple-element.247, f32[1792]{0} %param_246, f32[1792]{0} %param_117, f32[1792]{0} %get-tuple-element.246, /*index=25*/f32[1792]{0} %param_245, f32[1792]{0} %param_106, f32[1792]{0} %get-tuple-element.235, f32[1792]{0} %param_234, f32[1792]{0} %param_105, /*index=30*/f32[1792]{0} %get-tuple-element.234, f32[1792]{0} %param_233, f32[1792]{0} %param_99, f32[1792]{0} %get-tuple-element.228, f32[1792]{0} %param_227, /*index=35*/f32[1792]{0} %param_98, f32[1792]{0} %get-tuple-element.227, f32[1792]{0} %param_226, f32[1792]{0} %param_90, f32[1792]{0} %get-tuple-element.219, /*index=40*/f32[1792]{0} %param_218, f32[1792]{0} %param_89, f32[1792]{0} %get-tuple-element.218, f32[1792]{0} %param_217, f32[1792]{0} %param_69, /*index=45*/f32[1792]{0} %param_68), kind=kLoop, calls=%fused_computation.124, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.275 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=16
  %get-tuple-element.276 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=15
  %param_82 = f32[3584]{0} parameter(82), metadata={op_name="1_apply_grad$start"}
  %param_149 = f32[3584]{0} parameter(149), metadata={op_name="1_apply_grad$start"}
  %param_277 = f32[3584]{0} parameter(277), metadata={op_name="1_apply_grad$start"}
  %param_148 = f32[3584]{0} parameter(148), metadata={op_name="1_apply_grad$start"}
  %param_276 = f32[3584]{0} parameter(276), metadata={op_name="1_apply_grad$start"}
  %param_140 = f32[3584]{0} parameter(140), metadata={op_name="1_apply_grad$start"}
  %param_139 = f32[3584]{0} parameter(139), metadata={op_name="1_apply_grad$start"}
  %param_129 = f32[3584]{0} parameter(129), metadata={op_name="1_apply_grad$start"}
  %param_128 = f32[3584]{0} parameter(128), metadata={op_name="1_apply_grad$start"}
  %param_120 = f32[3584]{0} parameter(120), metadata={op_name="1_apply_grad$start"}
  %param_119 = f32[3584]{0} parameter(119), metadata={op_name="1_apply_grad$start"}
  %param_108 = f32[3584]{0} parameter(108), metadata={op_name="1_apply_grad$start"}
  %param_107 = f32[3584]{0} parameter(107), metadata={op_name="1_apply_grad$start"}
  %param_101 = f32[3584]{0} parameter(101), metadata={op_name="1_apply_grad$start"}
  %param_100 = f32[3584]{0} parameter(100), metadata={op_name="1_apply_grad$start"}
  %param_92 = f32[3584]{0} parameter(92), metadata={op_name="1_apply_grad$start"}
  %param_91 = f32[3584]{0} parameter(91), metadata={op_name="1_apply_grad$start"}
  %param_71 = f32[3584]{0} parameter(71), metadata={op_name="1_apply_grad$start"}
  %param_70 = f32[3584]{0} parameter(70), metadata={op_name="1_apply_grad$start"}
  %fusion.122 = (f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) fusion(f32[3584]{0} %param_82, f32[3584]{0} %get-tuple-element.211, f32[3584]{0} %param_210, s32[] %copy.77, f32[3584]{0} %param_149, /*index=5*/f32[3584]{0} %param_277, f32[3584]{0} %param_148, f32[3584]{0} %param_276, f32[3584]{0} %param_140, f32[3584]{0} %get-tuple-element.269, /*index=10*/f32[3584]{0} %param_268, f32[3584]{0} %param_139, f32[3584]{0} %get-tuple-element.268, f32[3584]{0} %param_267, f32[3584]{0} %param_129, /*index=15*/f32[3584]{0} %get-tuple-element.258, f32[3584]{0} %param_257, f32[3584]{0} %param_128, f32[3584]{0} %get-tuple-element.257, f32[3584]{0} %param_256, /*index=20*/f32[3584]{0} %param_120, f32[3584]{0} %get-tuple-element.249, f32[3584]{0} %param_248, f32[3584]{0} %param_119, f32[3584]{0} %get-tuple-element.248, /*index=25*/f32[3584]{0} %param_247, f32[3584]{0} %param_108, f32[3584]{0} %get-tuple-element.237, f32[3584]{0} %param_236, f32[3584]{0} %param_107, /*index=30*/f32[3584]{0} %get-tuple-element.236, f32[3584]{0} %param_235, f32[3584]{0} %param_101, f32[3584]{0} %get-tuple-element.230, f32[3584]{0} %param_229, /*index=35*/f32[3584]{0} %param_100, f32[3584]{0} %get-tuple-element.229, f32[3584]{0} %param_228, f32[3584]{0} %param_92, f32[3584]{0} %get-tuple-element.221, /*index=40*/f32[3584]{0} %param_220, f32[3584]{0} %param_91, f32[3584]{0} %get-tuple-element.220, f32[3584]{0} %param_219, f32[3584]{0} %param_71, /*index=45*/f32[3584]{0} %param_70), kind=kLoop, calls=%fused_computation.122, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.277 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=16
  %get-tuple-element.278 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=15
  %get-tuple-element.279 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=5
  %get-tuple-element.280 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=5
  %get-tuple-element.281 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=5
  %param_153 = f32[1024]{0} parameter(153), metadata={op_name="1_apply_grad$start"}
  %param_281 = f32[1024]{0} parameter(281), metadata={op_name="1_apply_grad$start"}
  %param_75 = f32[1024]{0} parameter(75), metadata={op_name="1_apply_grad$start"}
  %fusion.51 = (f32[1024]{0}, f32[1024]{0}) fusion(f32[1024]{0} %param_153, f32[1024]{0} %param_281, s32[] %copy.77, f32[1024]{0} %param_75), kind=kLoop, calls=%fused_computation.51, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.282 = f32[1024]{0} get-tuple-element((f32[1024]{0}, f32[1024]{0}) %fusion.51), index=1
  %param_154 = f32[7168,1024]{1,0} parameter(154), metadata={op_name="1_apply_grad$start"}
  %param_282 = f32[7168,1024]{1,0} parameter(282), metadata={op_name="1_apply_grad$start"}
  %param_76 = f32[7168,1024]{1,0} parameter(76), metadata={op_name="1_apply_grad$start"}
  %fusion.50 = (f32[7168,1024]{1,0}, f32[7168,1024]{1,0}) fusion(f32[7168,1024]{1,0} %param_154, f32[7168,1024]{1,0} %param_282, s32[] %copy.77, f32[7168,1024]{1,0} %param_76), kind=kLoop, calls=%fused_computation.50, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/update.py" source_line=43}
  %get-tuple-element.283 = f32[7168,1024]{1,0} get-tuple-element((f32[7168,1024]{1,0}, f32[7168,1024]{1,0}) %fusion.50), index=1
  %fusion.128 = s32[] fusion(s32[] %copy.77), kind=kLoop, calls=%fused_computation.128, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/select_n" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/optax/_src/numerics.py" source_line=118}
  %get-tuple-element.285 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=1
  %get-tuple-element.286 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=0
  %get-tuple-element.287 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=0
  %get-tuple-element.288 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}) %fusion.123), index=0
  %get-tuple-element.289 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=0
  %get-tuple-element.290 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}) %fusion.121), index=0
  %get-tuple-element.291 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=0
  %get-tuple-element.292 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=0
  %get-tuple-element.293 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=0
  %get-tuple-element.294 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=9
  %get-tuple-element.295 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=8
  %get-tuple-element.296 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=14
  %get-tuple-element.297 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=13
  %get-tuple-element.298 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=14
  %get-tuple-element.299 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=13
  %get-tuple-element.300 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=4
  %get-tuple-element.301 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=4
  %get-tuple-element.302 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=4
  %get-tuple-element.303 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=7
  %get-tuple-element.304 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=6
  %get-tuple-element.305 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=12
  %get-tuple-element.306 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=11
  %get-tuple-element.307 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=12
  %get-tuple-element.308 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=11
  %get-tuple-element.309 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=3
  %get-tuple-element.310 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=3
  %get-tuple-element.311 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=3
  %get-tuple-element.312 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=10
  %get-tuple-element.313 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=9
  %get-tuple-element.314 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=10
  %get-tuple-element.315 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=9
  %get-tuple-element.316 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=0
  %get-tuple-element.317 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=7
  %get-tuple-element.318 = f32[1,1,3584,1792]{3,2,1,0} get-tuple-element((f32[1,1,3584,1792]{3,2,1,0}, f32[1,1,3584,1792]{3,2,1,0}) %fusion.93), index=0
  %get-tuple-element.319 = f32[3,3,1792,3584]{3,2,1,0} get-tuple-element((f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=5*/f32[3,3,1792,3584]{3,2,1,0}) %fusion.92), index=0
  %get-tuple-element.320 = f32[1,1,3584,7168]{3,2,1,0} get-tuple-element((f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) %fusion.91), index=0
  %get-tuple-element.321 = f32[1,1,3584,7168]{3,2,1,0} get-tuple-element((f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) %fusion.91), index=3
  %get-tuple-element.322 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=6
  %get-tuple-element.323 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=5
  %get-tuple-element.324 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=8
  %get-tuple-element.325 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=7
  %get-tuple-element.326 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=8
  %get-tuple-element.327 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=7
  %get-tuple-element.328 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=4
  %get-tuple-element.329 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=3
  %get-tuple-element.330 = f32[1,1,7168,1792]{3,2,1,0} get-tuple-element((f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}) %fusion.81), index=0
  %get-tuple-element.331 = f32[3,3,1792,3584]{3,2,1,0} get-tuple-element((f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=5*/f32[3,3,1792,3584]{3,2,1,0}) %fusion.92), index=2
  %get-tuple-element.332 = f32[1,1,3584,7168]{3,2,1,0} get-tuple-element((f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) %fusion.91), index=2
  %get-tuple-element.333 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=6
  %get-tuple-element.334 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=5
  %get-tuple-element.335 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=6
  %get-tuple-element.336 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=5
  %get-tuple-element.337 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=2
  %get-tuple-element.338 = f32[7168]{0} get-tuple-element((f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=10*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, f32[7168]{0}, /*index=15*/f32[7168]{0}) %fusion.95), index=1
  %get-tuple-element.339 = f32[1,1,7168,1792]{3,2,1,0} get-tuple-element((f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}, f32[1,1,7168,1792]{3,2,1,0}) %fusion.81), index=1
  %get-tuple-element.340 = f32[3,3,1792,3584]{3,2,1,0} get-tuple-element((f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=5*/f32[3,3,1792,3584]{3,2,1,0}) %fusion.92), index=1
  %get-tuple-element.341 = f32[1,1,3584,7168]{3,2,1,0} get-tuple-element((f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=5*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}) %fusion.91), index=1
  %get-tuple-element.342 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=5
  %get-tuple-element.343 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=4
  %get-tuple-element.344 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=4
  %get-tuple-element.345 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=3
  %get-tuple-element.346 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=4
  %get-tuple-element.347 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=3
  %get-tuple-element.348 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=2
  %get-tuple-element.349 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=2
  %get-tuple-element.350 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=2
  %get-tuple-element.351 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=3
  %get-tuple-element.352 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=5*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, /*index=15*/f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}, f32[896]{0}) %fusion.125), index=2
  %get-tuple-element.353 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=2
  %get-tuple-element.354 = f32[1792]{0} get-tuple-element((f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=5*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=10*/f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[1792]{0}) %fusion.124), index=1
  %get-tuple-element.355 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=2
  %get-tuple-element.356 = f32[3584]{0} get-tuple-element((f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[3584]{0}, f32[3584]{0}) %fusion.122), index=1
  %get-tuple-element.357 = f32[1,1,3584,896]{3,2,1,0} get-tuple-element((f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, /*index=5*/f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}, f32[1,1,3584,896]{3,2,1,0}) %fusion.120), index=1
  %get-tuple-element.358 = f32[3,3,896,1792]{3,2,1,0} get-tuple-element((f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=5*/f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}) %fusion.119), index=1
  %get-tuple-element.359 = f32[1,1,1792,3584]{3,2,1,0} get-tuple-element((f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=5*/f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}) %fusion.118), index=1
  %get-tuple-element.360 = f32[1024]{0} get-tuple-element((f32[1024]{0}, f32[1024]{0}) %fusion.51), index=0
  %get-tuple-element.361 = f32[7168,1024]{1,0} get-tuple-element((f32[7168,1024]{1,0}, f32[7168,1024]{1,0}) %fusion.50), index=0
  %param_155 = s32[] parameter(155), metadata={op_name="1_apply_grad$start"}
  %constant_391 = s32[] constant(1)
  %add.9838 = s32[] add(s32[] %param_155, s32[] %constant_391), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/add" source_file="/home/cyxue/miniconda3/envs/alpa/lib/python3.8/site-packages/flax/training/train_state.py" source_line=77}
  %param_321 = f32[896]{0} parameter(321), metadata={op_name="1_apply_grad$start"}
  %param_309 = f32[1792]{0} parameter(309), metadata={op_name="1_apply_grad$start"}
  %param_310 = f32[1792]{0} parameter(310), metadata={op_name="1_apply_grad$start"}
  %param_311 = f32[3584]{0} parameter(311), metadata={op_name="1_apply_grad$start"}
  %param_312 = f32[3584]{0} parameter(312), metadata={op_name="1_apply_grad$start"}
  %param_313 = f32[7168]{0} parameter(313), metadata={op_name="1_apply_grad$start"}
  %param_314 = f32[7168]{0} parameter(314), metadata={op_name="1_apply_grad$start"}
  %param_315 = f32[1792]{0} parameter(315), metadata={op_name="1_apply_grad$start"}
  %param_316 = f32[1792]{0} parameter(316), metadata={op_name="1_apply_grad$start"}
  %param_317 = f32[3584]{0} parameter(317), metadata={op_name="1_apply_grad$start"}
  %param_318 = f32[3584]{0} parameter(318), metadata={op_name="1_apply_grad$start"}
  %param_319 = f32[7168]{0} parameter(319), metadata={op_name="1_apply_grad$start"}
  %param_320 = f32[7168]{0} parameter(320), metadata={op_name="1_apply_grad$start"}
  %param_322 = f32[896]{0} parameter(322), metadata={op_name="1_apply_grad$start"}
  %param_323 = f32[1792]{0} parameter(323), metadata={op_name="1_apply_grad$start"}
  %param_324 = f32[1792]{0} parameter(324), metadata={op_name="1_apply_grad$start"}
  %param_325 = f32[3584]{0} parameter(325), metadata={op_name="1_apply_grad$start"}
  %param_326 = f32[3584]{0} parameter(326), metadata={op_name="1_apply_grad$start"}
  %param_327 = f32[896]{0} parameter(327), metadata={op_name="1_apply_grad$start"}
  %param_328 = f32[896]{0} parameter(328), metadata={op_name="1_apply_grad$start"}
  %param_329 = f32[1792]{0} parameter(329), metadata={op_name="1_apply_grad$start"}
  %param_330 = f32[1792]{0} parameter(330), metadata={op_name="1_apply_grad$start"}
  %param_331 = f32[3584]{0} parameter(331), metadata={op_name="1_apply_grad$start"}
  %param_332 = f32[3584]{0} parameter(332), metadata={op_name="1_apply_grad$start"}
  %param_295 = f32[896]{0} parameter(295), metadata={op_name="1_apply_grad$start"}
  %param_283 = f32[896]{0} parameter(283), metadata={op_name="1_apply_grad$start"}
  %param_284 = f32[896]{0} parameter(284), metadata={op_name="1_apply_grad$start"}
  %param_285 = f32[1792]{0} parameter(285), metadata={op_name="1_apply_grad$start"}
  %param_286 = f32[1792]{0} parameter(286), metadata={op_name="1_apply_grad$start"}
  %param_287 = f32[3584]{0} parameter(287), metadata={op_name="1_apply_grad$start"}
  %param_288 = f32[3584]{0} parameter(288), metadata={op_name="1_apply_grad$start"}
  %param_289 = f32[896]{0} parameter(289), metadata={op_name="1_apply_grad$start"}
  %fusion.287 = (f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) fusion(f32[896]{0} %param_321, f32[1792]{0} %param_309, f32[1792]{0} %param_310, f32[3584]{0} %param_311, f32[3584]{0} %param_312, /*index=5*/f32[7168]{0} %param_313, f32[7168]{0} %param_314, f32[1792]{0} %param_315, f32[1792]{0} %param_316, f32[3584]{0} %param_317, /*index=10*/f32[3584]{0} %param_318, f32[7168]{0} %param_319, f32[7168]{0} %param_320, f32[896]{0} %param_322, f32[1792]{0} %param_323, /*index=15*/f32[1792]{0} %param_324, f32[3584]{0} %param_325, f32[3584]{0} %param_326, f32[896]{0} %param_327, f32[896]{0} %param_328, /*index=20*/f32[1792]{0} %param_329, f32[1792]{0} %param_330, f32[3584]{0} %param_331, f32[3584]{0} %param_332, f32[896]{0} %param_295, /*index=25*/f32[896]{0} %param_283, f32[896]{0} %param_284, f32[1792]{0} %param_285, f32[1792]{0} %param_286, f32[3584]{0} %param_287, /*index=30*/f32[3584]{0} %param_288, f32[896]{0} %param_289), kind=kInput, calls=%horizontally_fused_computation.1, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.363 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=25, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.364 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=26, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.365 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=27, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.366 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=28, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.367 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=29, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.368 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=30, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.369 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=31, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_290 = f32[896]{0} parameter(290), metadata={op_name="1_apply_grad$start"}
  %param_291 = f32[1792]{0} parameter(291), metadata={op_name="1_apply_grad$start"}
  %param_292 = f32[1792]{0} parameter(292), metadata={op_name="1_apply_grad$start"}
  %param_293 = f32[3584]{0} parameter(293), metadata={op_name="1_apply_grad$start"}
  %param_294 = f32[3584]{0} parameter(294), metadata={op_name="1_apply_grad$start"}
  %param_308 = f32[7168]{0} parameter(308), metadata={op_name="1_apply_grad$start"}
  %param_296 = f32[896]{0} parameter(296), metadata={op_name="1_apply_grad$start"}
  %param_297 = f32[1792]{0} parameter(297), metadata={op_name="1_apply_grad$start"}
  %param_298 = f32[1792]{0} parameter(298), metadata={op_name="1_apply_grad$start"}
  %param_299 = f32[3584]{0} parameter(299), metadata={op_name="1_apply_grad$start"}
  %param_300 = f32[3584]{0} parameter(300), metadata={op_name="1_apply_grad$start"}
  %param_301 = f32[1792]{0} parameter(301), metadata={op_name="1_apply_grad$start"}
  %param_302 = f32[1792]{0} parameter(302), metadata={op_name="1_apply_grad$start"}
  %param_303 = f32[3584]{0} parameter(303), metadata={op_name="1_apply_grad$start"}
  %param_304 = f32[3584]{0} parameter(304), metadata={op_name="1_apply_grad$start"}
  %param_305 = f32[7168]{0} parameter(305), metadata={op_name="1_apply_grad$start"}
  %param_306 = f32[7168]{0} parameter(306), metadata={op_name="1_apply_grad$start"}
  %param_307 = f32[7168]{0} parameter(307), metadata={op_name="1_apply_grad$start"}
  %fusion.288 = (f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) fusion(f32[896]{0} %param_290, f32[1792]{0} %param_291, f32[1792]{0} %param_292, f32[3584]{0} %param_293, f32[3584]{0} %param_294, /*index=5*/f32[7168]{0} %param_308, f32[896]{0} %param_296, f32[1792]{0} %param_297, f32[1792]{0} %param_298, f32[3584]{0} %param_299, /*index=10*/f32[3584]{0} %param_300, f32[1792]{0} %param_301, f32[1792]{0} %param_302, f32[3584]{0} %param_303, f32[3584]{0} %param_304, /*index=15*/f32[7168]{0} %param_305, f32[7168]{0} %param_306, f32[7168]{0} %param_307), kind=kInput, calls=%horizontally_fused_computation.2, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.370 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=0, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.371 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=1, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.372 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=2, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.373 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=3, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.374 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=4, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.375 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=24, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.376 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=6, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.377 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=7, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.378 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=8, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.379 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=9, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.380 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=10, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.381 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=11, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.382 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=12, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.383 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=13, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.384 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=14, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.385 = f32[7168]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=15, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.386 = f32[7168]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=16, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.387 = f32[7168]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=17, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.388 = f32[7168]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[7168]{0}, f32[7168]{0}, f32[7168]{0}) %fusion.288), index=5, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.389 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=1, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.390 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=2, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.391 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=3, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.392 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=4, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.393 = f32[7168]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=5, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.394 = f32[7168]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=6, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.395 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=7, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.396 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=8, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.397 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=9, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.398 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=10, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.399 = f32[7168]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=11, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.400 = f32[7168]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=12, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.401 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=0, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.402 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=13, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.403 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=14, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.404 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=15, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.405 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=16, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.406 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=17, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.407 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=18, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.408 = f32[896]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=19, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.409 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=20, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.410 = f32[1792]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=21, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.411 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=22, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.412 = f32[3584]{0} get-tuple-element((f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=5*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=10*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, f32[1792]{0}, /*index=15*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, /*index=25*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[896]{0}) %fusion.287), index=23, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %param_335 = f32[] parameter(335), metadata={op_name="1_apply_grad$start"}
  %constant = f32[] constant(0.0625)
  %param_333 = f32[] parameter(333), metadata={op_name="1_apply_grad$start"}
  %param_334 = f32[] parameter(334), metadata={op_name="1_apply_grad$start"}
  %fusion.286 = (f32[1]{0}, f32[1]{0}, f32[1]{0}) fusion(f32[] %param_335, f32[] %constant, f32[] %param_333, f32[] %param_334), kind=kInput, calls=%horizontally_fused_computation, metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.129 = f32[1]{0} get-tuple-element((f32[1]{0}, f32[1]{0}, f32[1]{0}) %fusion.286), index=1
  %bitcast.1 = f32[] bitcast(f32[1]{0} %get-tuple-element.129), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.130 = f32[1]{0} get-tuple-element((f32[1]{0}, f32[1]{0}, f32[1]{0}) %fusion.286), index=2
  %bitcast.2 = f32[] bitcast(f32[1]{0} %get-tuple-element.130), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  %get-tuple-element.128 = f32[1]{0} get-tuple-element((f32[1]{0}, f32[1]{0}, f32[1]{0}) %fusion.286), index=0
  %bitcast = f32[] bitcast(f32[1]{0} %get-tuple-element.128), metadata={op_name="parallelize(train_step_func_pipeshard_parallel_mesh_1)/jit(main)/div"}
  ROOT %tuple.120 = (f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=5*/f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, /*index=10*/f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=15*/f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, f32[896]{0}, /*index=20*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, /*index=25*/f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=30*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[1,1,3584,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=35*/f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, /*index=40*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, /*index=45*/f32[1,1,7168,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1792]{0}, f32[1792]{0}, /*index=50*/f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[1,1,7168,1792]{3,2,1,0}, /*index=55*/f32[3,3,1792,3584]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, /*index=60*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=65*/f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, /*index=70*/f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=75*/f32[1024]{0}, f32[7168,1024]{1,0}, s32[], f32[896]{0}, f32[896]{0}, /*index=80*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, /*index=85*/f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, /*index=90*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, /*index=95*/f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, /*index=100*/f32[3584]{0}, f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, /*index=105*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, /*index=110*/f32[7168]{0}, f32[1,1,3584,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=115*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=120*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[1,1,7168,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, /*index=125*/f32[1,1,3584,7168]{3,2,1,0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=130*/f32[7168]{0}, f32[7168]{0}, f32[1,1,7168,1792]{3,2,1,0}, f32[3,3,1792,3584]{3,2,1,0}, f32[1,1,3584,7168]{3,2,1,0}, /*index=135*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=140*/f32[3584]{0}, f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[896]{0}, /*index=145*/f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=150*/f32[1,1,3584,896]{3,2,1,0}, f32[3,3,896,1792]{3,2,1,0}, f32[1,1,1792,3584]{3,2,1,0}, f32[1024]{0}, f32[7168,1024]{1,0}, /*index=155*/s32[], f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, /*index=160*/f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, f32[1792]{0}, /*index=165*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[896]{0}, f32[896]{0}, /*index=170*/f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[1792]{0}, /*index=175*/f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, /*index=180*/f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=185*/f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[1792]{0}, f32[1792]{0}, /*index=190*/f32[3584]{0}, f32[3584]{0}, f32[7168]{0}, f32[7168]{0}, f32[896]{0}, /*index=195*/f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, f32[3584]{0}, /*index=200*/f32[896]{0}, f32[896]{0}, f32[1792]{0}, f32[1792]{0}, f32[3584]{0}, /*index=205*/f32[3584]{0}, f32[], f32[], f32[]) tuple(f32[896]{0} %get-tuple-element.207, f32[896]{0} %get-tuple-element.208, f32[1792]{0} %get-tuple-element.209, f32[1792]{0} %get-tuple-element.210, f32[3584]{0} %get-tuple-element.211, /*index=5*/f32[3584]{0} %get-tuple-element.212, f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.213, f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.214, f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.215, f32[896]{0} %get-tuple-element.216, /*index=10*/f32[896]{0} %get-tuple-element.217, f32[1792]{0} %get-tuple-element.218, f32[1792]{0} %get-tuple-element.219, f32[3584]{0} %get-tuple-element.220, f32[3584]{0} %get-tuple-element.221, /*index=15*/f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.222, f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.223, f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.224, f32[896]{0} %get-tuple-element.225, f32[896]{0} %get-tuple-element.226, /*index=20*/f32[1792]{0} %get-tuple-element.227, f32[1792]{0} %get-tuple-element.228, f32[3584]{0} %get-tuple-element.229, f32[3584]{0} %get-tuple-element.230, f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.231, /*index=25*/f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.232, f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.233, f32[1792]{0} %get-tuple-element.234, f32[1792]{0} %get-tuple-element.235, f32[3584]{0} %get-tuple-element.236, /*index=30*/f32[3584]{0} %get-tuple-element.237, f32[7168]{0} %get-tuple-element.238, f32[7168]{0} %get-tuple-element.239, f32[1,1,3584,1792]{3,2,1,0} %get-tuple-element.240, f32[3,3,1792,3584]{3,2,1,0} %get-tuple-element.241, /*index=35*/f32[1,1,3584,7168]{3,2,1,0} %get-tuple-element.242, f32[1,1,3584,7168]{3,2,1,0} %get-tuple-element.243, f32[7168]{0} %get-tuple-element.244, f32[7168]{0} %get-tuple-element.245, f32[1792]{0} %get-tuple-element.246, /*index=40*/f32[1792]{0} %get-tuple-element.247, f32[3584]{0} %get-tuple-element.248, f32[3584]{0} %get-tuple-element.249, f32[7168]{0} %get-tuple-element.250, f32[7168]{0} %get-tuple-element.251, /*index=45*/f32[1,1,7168,1792]{3,2,1,0} %get-tuple-element.252, f32[3,3,1792,3584]{3,2,1,0} %get-tuple-element.253, f32[1,1,3584,7168]{3,2,1,0} %get-tuple-element.254, f32[1792]{0} %get-tuple-element.255, f32[1792]{0} %get-tuple-element.256, /*index=50*/f32[3584]{0} %get-tuple-element.257, f32[3584]{0} %get-tuple-element.258, f32[7168]{0} %get-tuple-element.259, f32[7168]{0} %get-tuple-element.260, f32[1,1,7168,1792]{3,2,1,0} %get-tuple-element.261, /*index=55*/f32[3,3,1792,3584]{3,2,1,0} %get-tuple-element.262, f32[1,1,3584,7168]{3,2,1,0} %get-tuple-element.263, f32[896]{0} %get-tuple-element.264, f32[896]{0} %get-tuple-element.265, f32[1792]{0} %get-tuple-element.266, /*index=60*/f32[1792]{0} %get-tuple-element.267, f32[3584]{0} %get-tuple-element.268, f32[3584]{0} %get-tuple-element.269, f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.270, f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.271, /*index=65*/f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.272, f32[896]{0} %get-tuple-element.273, f32[896]{0} %get-tuple-element.274, f32[1792]{0} %get-tuple-element.275, f32[1792]{0} %get-tuple-element.276, /*index=70*/f32[3584]{0} %get-tuple-element.277, f32[3584]{0} %get-tuple-element.278, f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.279, f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.280, f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.281, /*index=75*/f32[1024]{0} %get-tuple-element.282, f32[7168,1024]{1,0} %get-tuple-element.283, s32[] %fusion.128, f32[896]{0} %get-tuple-element.285, f32[896]{0} %get-tuple-element.286, /*index=80*/f32[1792]{0} %get-tuple-element.287, f32[1792]{0} %get-tuple-element.288, f32[3584]{0} %get-tuple-element.289, f32[3584]{0} %get-tuple-element.290, f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.291, /*index=85*/f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.292, f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.293, f32[896]{0} %get-tuple-element.294, f32[896]{0} %get-tuple-element.295, f32[1792]{0} %get-tuple-element.296, /*index=90*/f32[1792]{0} %get-tuple-element.297, f32[3584]{0} %get-tuple-element.298, f32[3584]{0} %get-tuple-element.299, f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.300, f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.301, /*index=95*/f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.302, f32[896]{0} %get-tuple-element.303, f32[896]{0} %get-tuple-element.304, f32[1792]{0} %get-tuple-element.305, f32[1792]{0} %get-tuple-element.306, /*index=100*/f32[3584]{0} %get-tuple-element.307, f32[3584]{0} %get-tuple-element.308, f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.309, f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.310, f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.311, /*index=105*/f32[1792]{0} %get-tuple-element.312, f32[1792]{0} %get-tuple-element.313, f32[3584]{0} %get-tuple-element.314, f32[3584]{0} %get-tuple-element.315, f32[7168]{0} %get-tuple-element.316, /*index=110*/f32[7168]{0} %get-tuple-element.317, f32[1,1,3584,1792]{3,2,1,0} %get-tuple-element.318, f32[3,3,1792,3584]{3,2,1,0} %get-tuple-element.319, f32[1,1,3584,7168]{3,2,1,0} %get-tuple-element.320, f32[1,1,3584,7168]{3,2,1,0} %get-tuple-element.321, /*index=115*/f32[7168]{0} %get-tuple-element.322, f32[7168]{0} %get-tuple-element.323, f32[1792]{0} %get-tuple-element.324, f32[1792]{0} %get-tuple-element.325, f32[3584]{0} %get-tuple-element.326, /*index=120*/f32[3584]{0} %get-tuple-element.327, f32[7168]{0} %get-tuple-element.328, f32[7168]{0} %get-tuple-element.329, f32[1,1,7168,1792]{3,2,1,0} %get-tuple-element.330, f32[3,3,1792,3584]{3,2,1,0} %get-tuple-element.331, /*index=125*/f32[1,1,3584,7168]{3,2,1,0} %get-tuple-element.332, f32[1792]{0} %get-tuple-element.333, f32[1792]{0} %get-tuple-element.334, f32[3584]{0} %get-tuple-element.335, f32[3584]{0} %get-tuple-element.336, /*index=130*/f32[7168]{0} %get-tuple-element.337, f32[7168]{0} %get-tuple-element.338, f32[1,1,7168,1792]{3,2,1,0} %get-tuple-element.339, f32[3,3,1792,3584]{3,2,1,0} %get-tuple-element.340, f32[1,1,3584,7168]{3,2,1,0} %get-tuple-element.341, /*index=135*/f32[896]{0} %get-tuple-element.342, f32[896]{0} %get-tuple-element.343, f32[1792]{0} %get-tuple-element.344, f32[1792]{0} %get-tuple-element.345, f32[3584]{0} %get-tuple-element.346, /*index=140*/f32[3584]{0} %get-tuple-element.347, f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.348, f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.349, f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.350, f32[896]{0} %get-tuple-element.351, /*index=145*/f32[896]{0} %get-tuple-element.352, f32[1792]{0} %get-tuple-element.353, f32[1792]{0} %get-tuple-element.354, f32[3584]{0} %get-tuple-element.355, f32[3584]{0} %get-tuple-element.356, /*index=150*/f32[1,1,3584,896]{3,2,1,0} %get-tuple-element.357, f32[3,3,896,1792]{3,2,1,0} %get-tuple-element.358, f32[1,1,1792,3584]{3,2,1,0} %get-tuple-element.359, f32[1024]{0} %get-tuple-element.360, f32[7168,1024]{1,0} %get-tuple-element.361, /*index=155*/s32[] %add.9838, f32[896]{0} %get-tuple-element.363, f32[896]{0} %get-tuple-element.364, f32[1792]{0} %get-tuple-element.365, f32[1792]{0} %get-tuple-element.366, /*index=160*/f32[3584]{0} %get-tuple-element.367, f32[3584]{0} %get-tuple-element.368, f32[896]{0} %get-tuple-element.369, f32[896]{0} %get-tuple-element.370, f32[1792]{0} %get-tuple-element.371, /*index=165*/f32[1792]{0} %get-tuple-element.372, f32[3584]{0} %get-tuple-element.373, f32[3584]{0} %get-tuple-element.374, f32[896]{0} %get-tuple-element.375, f32[896]{0} %get-tuple-element.376, /*index=170*/f32[1792]{0} %get-tuple-element.377, f32[1792]{0} %get-tuple-element.378, f32[3584]{0} %get-tuple-element.379, f32[3584]{0} %get-tuple-element.380, f32[1792]{0} %get-tuple-element.381, /*index=175*/f32[1792]{0} %get-tuple-element.382, f32[3584]{0} %get-tuple-element.383, f32[3584]{0} %get-tuple-element.384, f32[7168]{0} %get-tuple-element.385, f32[7168]{0} %get-tuple-element.386, /*index=180*/f32[7168]{0} %get-tuple-element.387, f32[7168]{0} %get-tuple-element.388, f32[1792]{0} %get-tuple-element.389, f32[1792]{0} %get-tuple-element.390, f32[3584]{0} %get-tuple-element.391, /*index=185*/f32[3584]{0} %get-tuple-element.392, f32[7168]{0} %get-tuple-element.393, f32[7168]{0} %get-tuple-element.394, f32[1792]{0} %get-tuple-element.395, f32[1792]{0} %get-tuple-element.396, /*index=190*/f32[3584]{0} %get-tuple-element.397, f32[3584]{0} %get-tuple-element.398, f32[7168]{0} %get-tuple-element.399, f32[7168]{0} %get-tuple-element.400, f32[896]{0} %get-tuple-element.401, /*index=195*/f32[896]{0} %get-tuple-element.402, f32[1792]{0} %get-tuple-element.403, f32[1792]{0} %get-tuple-element.404, f32[3584]{0} %get-tuple-element.405, f32[3584]{0} %get-tuple-element.406, /*index=200*/f32[896]{0} %get-tuple-element.407, f32[896]{0} %get-tuple-element.408, f32[1792]{0} %get-tuple-element.409, f32[1792]{0} %get-tuple-element.410, f32[3584]{0} %get-tuple-element.411, /*index=205*/f32[3584]{0} %get-tuple-element.412, f32[] %bitcast.1, f32[] %bitcast.2, f32[] %bitcast)
}

